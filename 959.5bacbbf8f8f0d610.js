"use strict";(self.webpackChunkSharaf_Resume=self.webpackChunkSharaf_Resume||[]).push([[959],{4959:(Qt,Xe,z)=>{z.d(Xe,{ST:()=>xI});var I=z(4650),re=z(4986),k=z(8306),se=z(8996),ae=z(9646),de=z(5813),me=z(4482),Ie=z(5403);function fe(){return(0,me.e)((n,e)=>{let t,r=!1;n.subscribe((0,Ie.x)(e,i=>{const o=t;t=i,r&&e.next([o,i]),r=!0}))})}var E,V=z(8675),G=z(4004),ce=z(5026),Ce=z(1884),Le=z(9300),$e=z(2011),ze=z(6895),te=(z(1451),z(3942)),R=z(5861),we=z(9681),Ee=z(4859),xe=z(1877),le=z(2090),He=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ge={},W=W||{},q=He||self;function je(){}function Pe(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Ye(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var kt="closure_uid_"+(1e9*Math.random()>>>0),Ot=0;function Mn(n,e,t){return n.call.apply(n.bind,arguments)}function nn(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function rt(n,e,t){return(rt=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Mn:nn).apply(null,arguments)}function Dt(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Ge(n,e){function t(){}t.prototype=e.prototype,n.Z=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Vb=function(r,i,o){for(var u=Array(arguments.length-2),h=2;h<arguments.length;h++)u[h-2]=arguments[h];return e.prototype[i].apply(r,u)}}function Nt(){this.s=this.s,this.o=this.o}var fr={};Nt.prototype.s=!1,Nt.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var n=function nt(n){return Object.prototype.hasOwnProperty.call(n,kt)&&n[kt]||(n[kt]=++Ot)}(this);delete fr[n]}},Nt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const it=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1},st=Array.prototype.forEach?function(n,e,t){Array.prototype.forEach.call(n,e,t)}:function(n,e,t){const r=n.length,i="string"==typeof n?n.split(""):n;for(let o=0;o<r;o++)o in i&&e.call(t,i[o],o,n)};function Yt(n){return Array.prototype.concat.apply([],arguments)}function Rt(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Ut(n){return/^[\s\xa0]*$/.test(n)}var ot,pr=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function wt(n,e){return-1!=n.indexOf(e)}function rn(n,e){return n<e?-1:n>e?1:0}e:{var gr=q.navigator;if(gr){var sn=gr.userAgent;if(sn){ot=sn;break e}}ot=""}function vn(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function Ln(n){const e={};for(const t in n)e[t]=n[t];return e}var Fn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function In(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let o=0;o<Fn.length;o++)t=Fn[o],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function qt(n){return qt[" "](n),n}qt[" "]=je;var Yn,n,mr=wt(ot,"Opera"),fn=wt(ot,"Trident")||wt(ot,"MSIE"),Ur=wt(ot,"Edge"),wn=Ur||fn,yr=wt(ot,"Gecko")&&!(wt(ot.toLowerCase(),"webkit")&&!wt(ot,"Edge"))&&!(wt(ot,"Trident")||wt(ot,"MSIE"))&&!wt(ot,"Edge"),Kt=wt(ot.toLowerCase(),"webkit")&&!wt(ot,"Edge");function En(){var n=q.document;return n?n.documentMode:void 0}e:{var _r="",vr=(n=ot,yr?/rv:([^\);]+)(\)|;)/.exec(n):Ur?/Edge\/([\d\.]+)/.exec(n):fn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Kt?/WebKit\/(\S+)/.exec(n):mr?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(vr&&(_r=vr?vr[1]:""),fn){var Tn=En();if(null!=Tn&&Tn>parseFloat(_r)){Yn=String(Tn);break e}}Yn=_r}var Jn={};var b=q.document&&fn&&(En()||parseInt(Yn,10))||void 0,x=function(){if(!q.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{q.addEventListener("test",je,e),q.removeEventListener("test",je,e)}catch{}return n}();function A(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}function $(n,e){if(A.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(yr){e:{try{qt(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:J[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&$.Z.h.call(this)}}A.prototype.h=function(){this.defaultPrevented=!0},Ge($,A);var J={2:"touch",3:"pen",4:"mouse"};$.prototype.h=function(){$.Z.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var he="closure_listenable_"+(1e6*Math.random()|0),lt=0;function Ze(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ia=i,this.key=++lt,this.ca=this.fa=!1}function At(n){n.ca=!0,n.listener=null,n.proxy=null,n.src=null,n.ia=null}function Ne(n){this.src=n,this.g={},this.h=0}function Jt(n,e){var t=e.type;if(t in n.g){var o,r=n.g[t],i=it(r,e);(o=0<=i)&&Array.prototype.splice.call(r,i,1),o&&(At(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function bn(n,e,t,r){for(var i=0;i<n.length;++i){var o=n[i];if(!o.ca&&o.listener==e&&o.capture==!!t&&o.ia==r)return i}return-1}Ne.prototype.add=function(n,e,t,r,i){var o=n.toString();(n=this.g[o])||(n=this.g[o]=[],this.h++);var u=bn(n,e,r,i);return-1<u?(e=n[u],t||(e.fa=!1)):((e=new Ze(e,this.src,o,!!r,i)).fa=t,n.push(e)),e};var Vr="closure_lm_"+(1e6*Math.random()|0),li={};function Eo(n,e,t,r,i){if(r&&r.once)return Bi(n,e,t,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Eo(n,e[o],t,r,i);return null}return t=hi(t),n&&n[he]?n.N(e,t,Ye(r)?!!r.capture:!!r,i):Ir(n,e,t,!1,r,i)}function Ir(n,e,t,r,i,o){if(!e)throw Error("Invalid event type");var u=Ye(i)?!!i.capture:!!i,h=To(n);if(h||(n[Vr]=h=new Ne(n)),(t=h.add(e,t,r,u,o)).proxy)return t;if(r=function Ra(){var e=Lc;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)x||(i=u),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(As(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function Bi(n,e,t,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Bi(n,e[o],t,r,i);return null}return t=hi(t),n&&n[he]?n.O(e,t,Ye(r)?!!r.capture:!!r,i):Ir(n,e,t,!0,r,i)}function Br(n,e,t,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Br(n,e[o],t,r,i);else r=Ye(r)?!!r.capture:!!r,t=hi(t),n&&n[he]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=bn(o=n.g[e],t,r,i))&&(At(o[t]),Array.prototype.splice.call(o,t,1),0==o.length&&(delete n.g[e],n.h--))):n&&(n=To(n))&&(e=n.g[e.toString()],n=-1,e&&(n=bn(e,t,r,i)),(t=-1<n?e[n]:null)&&Oa(t))}function Oa(n){if("number"!=typeof n&&n&&!n.ca){var e=n.src;if(e&&e[he])Jt(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(As(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=To(e))?(Jt(t,n),0==t.h&&(t.src=null,e[Vr]=null)):At(n)}}}function As(n){return n in li?li[n]:li[n]="on"+n}function Lc(n,e){if(n.ca)n=!0;else{e=new $(e,this);var t=n.listener,r=n.ia||n.src;n.fa&&Oa(n),n=t.call(r,e)}return n}function To(n){return(n=n[Vr])instanceof Ne?n:null}var bo="__closure_events_fn_"+(1e9*Math.random()>>>0);function hi(n){return"function"==typeof n?n:(n[bo]||(n[bo]=function(e){return n.handleEvent(e)}),n[bo])}function St(){Nt.call(this),this.i=new Ne(this),this.P=this,this.I=null}function Pt(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new A(e,n);else if(e instanceof A)e.target=e.target||n;else{var i=e;In(e=new A(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var u=e.g=t[o];i=yt(u,r,!0,e)&&i}if(i=yt(u=e.g=n,r,!0,e)&&i,i=yt(u,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=yt(u=e.g=t[o],r,!1,e)&&i}function yt(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var u=e[o];if(u&&!u.ca&&u.capture==t){var h=u.listener,f=u.ia||u.src;u.fa&&Jt(n.i,u),i=!1!==h.call(f,r)&&i}}return i&&!r.defaultPrevented}Ge(St,Nt),St.prototype[he]=!0,St.prototype.removeEventListener=function(n,e,t,r){Br(this,n,e,t,r)},St.prototype.M=function(){if(St.Z.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)At(t[r]);delete n.g[e],n.h--}}this.I=null},St.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},St.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var Ss=q.JSON.stringify;function Vu(){var n=ks;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Mt,Ao=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new Pa,n=>n.reset());class Pa{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Ma(n){q.setTimeout(()=>{throw n},0)}function wr(n,e){Mt||function So(){var n=q.Promise.resolve(void 0);Mt=function(){n.then(La)}}(),Cs||(Mt(),Cs=!0),ks.add(n,e)}var Cs=!1,ks=new class xs{constructor(){this.h=this.g=null}add(e,t){const r=Ao.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function La(){for(var n;n=Vu();){try{n.h.call(n.g)}catch(t){Ma(t)}var e=Ao;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Cs=!1}function di(n,e){St.call(this),this.h=n||1,this.g=e||q,this.j=rt(this.kb,this),this.l=Date.now()}function $i(n){n.da=!1,n.S&&(n.g.clearTimeout(n.S),n.S=null)}function Ds(n,e,t){if("function"==typeof n)t&&(n=rt(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=rt(n.handleEvent,n)}return 2147483647<Number(e)?-1:q.setTimeout(n,e||0)}function ji(n){n.g=Ds(()=>{n.g=null,n.i&&(n.i=!1,ji(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Ge(di,St),(E=di.prototype).da=!1,E.S=null,E.kb=function(){if(this.da){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-n):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Pt(this,"tick"),this.da&&($i(this),this.start()))}},E.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},E.M=function(){di.Z.M.call(this),$i(this),delete this.g};class Gi extends Nt{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:ji(this)}M(){super.M(),this.g&&(q.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qi(n){Nt.call(this),this.h=n,this.g={}}Ge(qi,Nt);var Ns=[];function Rs(n,e,t,r){Array.isArray(t)||(t&&(Ns[0]=t.toString()),t=Ns);for(var i=0;i<t.length;i++){var o=Eo(e,t[i],r||n.handleEvent,!1,n.h||n);if(!o)break;n.g[o.key]=o}}function xo(n){vn(n.g,function(e,t){this.g.hasOwnProperty(t)&&Oa(e)},n),n.g={}}function Co(){this.g=!0}function An(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function ko(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var u=1;u<i.length;u++)i[u]=""}}}return Ss(t)}catch{return e}}(n,t)+(r?" "+r:"")})}qi.prototype.M=function(){qi.Z.M.call(this),xo(this)},qi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Co.prototype.Aa=function(){this.g=!1},Co.prototype.info=function(){};var $r={},Os=null;function Er(){return Os=Os||new St}function Un(n){A.call(this,$r.Ma,n)}function jr(n){const e=Er();Pt(e,new Un(e,n))}function Ua(n,e){A.call(this,$r.STAT_EVENT,n),this.stat=e}function at(n){const e=Er();Pt(e,new Ua(e,n))}function Va(n,e){A.call(this,$r.Na,n),this.size=e}function Gr(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return q.setTimeout(function(){n()},e)}$r.Ma="serverreachability",Ge(Un,A),$r.STAT_EVENT="statevent",Ge(Ua,A),$r.Na="timingevent",Ge(Va,A);var qr={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Vn={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Do(){}function Ba(){}Do.prototype.h=null;var $a,Ki={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function zi(){A.call(this,"d")}function Xn(){A.call(this,"c")}function fi(){}function er(n,e,t,r){this.l=n,this.j=e,this.m=t,this.X=r||1,this.V=new qi(this),this.P=Ro,this.W=new di(n=wn?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new No}function No(){this.i=null,this.g="",this.h=!1}Ge(zi,A),Ge(Xn,A),Ge(fi,Do),fi.prototype.g=function(){return new XMLHttpRequest},fi.prototype.i=function(){return{}},$a=new fi;var Ro=45e3,Sn={},Bn={};function Tr(n,e,t){n.K=1,n.v=xr(an(e)),n.s=t,n.U=!0,Ms(n,null)}function Ms(n,e){n.F=Date.now(),tr(n),n.A=an(n.v);var t=n.A,r=n.X;Array.isArray(r)||(r=[String(r)]),Qi(t.h,"t",r),n.C=0,t=n.l.H,n.h=new No,n.g=za(n.l,t?e:null,!n.s),0<n.O&&(n.L=new Gi(rt(n.Ia,n,n.g),n.O)),Rs(n.V,n.g,"readystatechange",n.gb),e=n.H?Ln(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ea(n.A,n.u,n.s,e)):(n.u="GET",n.g.ea(n.A,n.u,null,e)),jr(1),function Fa(n,e,t,r,i,o){n.info(function(){if(n.g)if(o)for(var u="",h=o.split("&"),f=0;f<h.length;f++){var m=h[f].split("=");if(1<m.length){var v=m[0];m=m[1];var T=v.split("_");u=2<=T.length&&"type"==T[1]?u+(v+"=")+m+"&":u+(v+"=redacted&")}}else u=null;else u=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+u})}(n.j,n.u,n.A,n.m,n.X,n.s)}function Oo(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Ba}function Po(n,e,t){let i,r=!0;for(;!n.I&&n.C<t.length;){if(i=Bu(n,t),i==Bn){4==e&&(n.o=4,at(14),r=!1),An(n.j,n.m,null,"[Incomplete Response]");break}if(i==Sn){n.o=4,at(15),An(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}An(n.j,n.m,i,null),Zi(n,i)}Oo(n)&&i!=Bn&&i!=Sn&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,at(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.aa&&(n.aa=!0,(e=n.l).g==n&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+t.length),sr(e),e.L=!0,at(11))):(An(n.j,n.m,t,"[Invalid Chunked Response]"),$n(n),pi(n))}function Bu(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?Bn:(t=Number(e.substring(t,r)),isNaN(t)?Sn:(r+=1)+t>e.length?Bn:(e=e.substr(r,t),n.C=r+t,e))}function tr(n){n.Y=Date.now()+n.P,Kr(n,n.P)}function Kr(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Gr(rt(n.eb,n),e)}function zt(n){n.B&&(q.clearTimeout(n.B),n.B=null)}function pi(n){0==n.l.G||n.I||Zo(n.l,n)}function $n(n){zt(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,$i(n.W),xo(n.V),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function Zi(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||Xi(t.i,n)))if(t.I=n.N,!n.J&&Xi(t.i,n)&&3==t.G){try{var r=t.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;Et(t),Ys(t)}us(t),at(18)}}else t.ta=i[1],0<t.ta-t.U&&37500>i[2]&&t.N&&0==t.A&&!t.v&&(t.v=Gr(rt(t.ab,t),6e3));if(1>=Ji(t.i)&&t.ka){try{t.ka()}catch{}t.ka=void 0}}else ei(t,11)}else if((n.J||t.g==n)&&Et(t),!Ut(e))for(i=t.Ca.g.parse(e),e=0;e<i.length;e++){let m=i[e];if(t.U=m[0],m=m[1],2==t.G)if("c"==m[0]){t.J=m[1],t.la=m[2];const v=m[3];null!=v&&(t.ma=v,t.h.info("VER="+t.ma));const T=m[4];null!=T&&(t.za=T,t.h.info("SVER="+t.za));const O=m[5];null!=O&&"number"==typeof O&&0<O&&(t.K=r=1.5*O,t.h.info("backChannelRequestTimeoutMs_="+r)),r=t;const U=n.g;if(U){const B=U.g?U.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(B){var o=r.i;!o.g&&(wt(B,"spdy")||wt(B,"quic")||wt(B,"h2"))&&(o.j=o.l,o.g=new Set,o.h&&(es(o,o.h),o.h=null))}if(r.D){const Y=U.g?U.g.getResponseHeader("X-HTTP-Session-Id"):null;Y&&(r.sa=Y,tt(r.F,r.D,Y))}}t.G=3,t.j&&t.j.xa(),t.$&&(t.O=Date.now()-n.F,t.h.info("Handshake RTT: "+t.O+"ms"));var u=n;if((r=t).oa=_i(r,r.H?r.la:null,r.W),u.J){Ks(r.i,u);var h=u,f=r.K;f&&h.setTimeout(f),h.B&&(zt(h),tr(h)),r.g=u}else Ku(r);0<t.l.length&&as(t)}else"stop"!=m[0]&&"close"!=m[0]||ei(t,7);else 3==t.G&&("stop"==m[0]||"close"==m[0]?"stop"==m[0]?ei(t,7):os(t):"noop"!=m[0]&&t.j&&t.j.wa(m),t.A=0)}jr(4)}catch{}}function Ls(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(Pe(n)||"string"==typeof n)st(n,e,void 0);else{if(n.T&&"function"==typeof n.T)var t=n.T();else if(n.R&&"function"==typeof n.R)t=void 0;else if(Pe(n)||"string"==typeof n){t=[];for(var r=n.length,i=0;i<r;i++)t.push(i)}else for(i in t=[],r=0,n)t[r++]=i;r=function on(n){if(n.R&&"function"==typeof n.R)return n.R();if("string"==typeof n)return n.split("");if(Pe(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],t&&t[o],n)}}function br(n,e){this.h={},this.g=[],this.i=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var r=0;r<t;r+=2)this.set(arguments[r],arguments[r+1])}else if(n)if(n instanceof br)for(t=n.T(),r=0;r<t.length;r++)this.set(t[r],n.get(t[r]));else for(r in n)this.set(r,n[r])}function Wi(n){if(n.i!=n.g.length){for(var e=0,t=0;e<n.g.length;){var r=n.g[e];jn(n.h,r)&&(n.g[t++]=r),e++}n.g.length=t}if(n.i!=n.g.length){var i={};for(t=e=0;e<n.g.length;)jn(i,r=n.g[e])||(n.g[t++]=r,i[r]=1),e++;n.g.length=t}}function jn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}(E=er.prototype).setTimeout=function(n){this.P=n},E.gb=function(n){n=n.target;const e=this.L;e&&3==ir(n)?e.l():this.Ia(n)},E.Ia=function(n){try{if(n==this.g)e:{const v=ir(this.g);var e=this.g.Da();const T=this.g.ba();if(!(3>v)&&(3!=v||wn||this.g&&(this.h.h||this.g.ga()||Yr(this.g)))){this.I||4!=v||7==e||jr(8==e||0>=T?3:2),zt(this);var t=this.g.ba();this.N=t;t:if(Oo(this)){var r=Yr(this.g);n="";var i=r.length,o=4==ir(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){$n(this),pi(this);var u="";break t}this.h.i=new q.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:o&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==t,function Fc(n,e,t,r,i,o,u){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+o+" "+u})}(this.j,this.u,this.A,this.m,this.X,v,t),this.i){if(this.$&&!this.J){t:{if(this.g){var h,f=this.g;if((h=f.g?f.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ut(h)){var m=h;break t}}m=null}if(!(t=m)){this.i=!1,this.o=3,at(12),$n(this),pi(this);break e}An(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Zi(this,t)}this.U?(Po(this,v,u),wn&&this.i&&3==v&&(Rs(this.V,this.W,"tick",this.fb),this.W.start())):(An(this.j,this.m,u,null),Zi(this,u)),4==v&&$n(this),this.i&&!this.I&&(4==v?Zo(this.l,this):(this.i=!1,tr(this)))}else 400==t&&0<u.indexOf("Unknown SID")?(this.o=3,at(12)):(this.o=0,at(13)),$n(this),pi(this)}}}catch{}},E.fb=function(){if(this.g){var n=ir(this.g),e=this.g.ga();this.C<e.length&&(zt(this),Po(this,n,e),this.i&&4!=n&&tr(this))}},E.cancel=function(){this.I=!0,$n(this)},E.eb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function Uc(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(jr(3),at(17)),$n(this),this.o=2,pi(this)):Kr(this,this.Y-n)},(E=br.prototype).R=function(){Wi(this);for(var n=[],e=0;e<this.g.length;e++)n.push(this.h[this.g[e]]);return n},E.T=function(){return Wi(this),this.g.concat()},E.get=function(n,e){return jn(this.h,n)?this.h[n]:e},E.set=function(n,e){jn(this.h,n)||(this.i++,this.g.push(n)),this.h[n]=e},E.forEach=function(n,e){for(var t=this.T(),r=0;r<t.length;r++){var i=t[r],o=this.get(i);n.call(e,o,i,this)}};var Mo=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function nr(n,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,n instanceof nr){this.g=void 0!==e?e:n.g,zr(this,n.j),this.s=n.s,Sr(this,n.i),rr(this,n.m),this.l=n.l,e=n.h;var t=new Wr;t.i=e.i,e.g&&(t.g=new br(e.g),t.h=e.h),gi(this,t),this.o=n.o}else n&&(t=String(n).match(Mo))?(this.g=!!e,zr(this,t[1]||"",!0),this.s=ut(t[2]||""),Sr(this,t[3]||"",!0),rr(this,t[4]),this.l=ut(t[5]||"",!0),gi(this,t[6]||"",!0),this.o=ut(t[7]||"")):(this.g=!!e,this.h=new Wr(null,this.g))}function an(n){return new nr(n)}function zr(n,e,t){n.j=t?ut(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function Sr(n,e,t){n.i=t?ut(e,!0):e}function rr(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function gi(n,e,t){e instanceof Wr?(n.h=e,function Gs(n,e){e&&!n.j&&(pn(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(mi(this,r),Qi(this,i,t))},n)),n.j=e}(n.h,n.g)):(t||(e=Zr(e,Fo)),n.h=new Wr(e,n.g))}function tt(n,e,t){n.h.set(e,t)}function xr(n){return tt(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function ut(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Zr(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,Us),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Us(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}nr.prototype.toString=function(){var n=[],e=this.j;e&&n.push(Zr(e,Vs,!0),":");var t=this.i;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(Zr(e,Vs,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.i&&"/"!=t.charAt(0)&&n.push("/"),n.push(Zr(t,"/"==t.charAt(0)?$s:Bs,!0))),(t=this.h.toString())&&n.push("?",t),(t=this.o)&&n.push("#",Zr(t,Hi)),n.join("")};var Vs=/[#\/\?@]/g,Bs=/[#\?:]/g,$s=/[#\?]/g,Fo=/[#\?@]/g,Hi=/#/g;function Wr(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function pn(n){n.g||(n.g=new br,n.h=0,n.i&&function Ar(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var o=n[t].substring(0,r);i=n[t].substring(r+1)}else o=n[t];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function mi(n,e){pn(n),e=Cr(n,e),jn(n.g.h,e)&&(n.i=null,n.h-=n.g.get(e).length,jn((n=n.g).h,e)&&(delete n.h[e],n.i--,n.g.length>2*n.i&&Wi(n)))}function js(n,e){return pn(n),e=Cr(n,e),jn(n.g.h,e)}function Qi(n,e,t){mi(n,e),0<t.length&&(n.i=null,n.g.set(Cr(n,e),Rt(t)),n.h+=t.length)}function Cr(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function qs(n){this.l=n||Vo,n=q.PerformanceNavigationTiming?0<(n=q.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(q.g&&q.g.Ea&&q.g.Ea()&&q.g.Ea().Zb),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(E=Wr.prototype).add=function(n,e){pn(this),this.i=null,n=Cr(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},E.forEach=function(n,e){pn(this),this.g.forEach(function(t,r){st(t,function(i){n.call(e,i,r,this)},this)},this)},E.T=function(){pn(this);for(var n=this.g.R(),e=this.g.T(),t=[],r=0;r<e.length;r++)for(var i=n[r],o=0;o<i.length;o++)t.push(e[r]);return t},E.R=function(n){pn(this);var e=[];if("string"==typeof n)js(this,n)&&(e=Yt(e,this.g.get(Cr(this,n))));else{n=this.g.R();for(var t=0;t<n.length;t++)e=Yt(e,n[t])}return e},E.set=function(n,e){return pn(this),this.i=null,js(this,n=Cr(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},E.get=function(n,e){return n&&0<(n=this.R(n)).length?String(n[0]):e},E.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var n=[],e=this.g.T(),t=0;t<e.length;t++){var r=e[t],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var u=i;""!==r[o]&&(u+="="+encodeURIComponent(String(r[o]))),n.push(u)}}return this.i=n.join("&")};var Vo=10;function Yi(n){return!!n.h||!!n.g&&n.g.size>=n.j}function Ji(n){return n.h?1:n.g?n.g.size:0}function Xi(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function es(n,e){n.g?n.g.add(e):n.h=e}function Ks(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function Bo(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return Rt(n.i)}function ts(){}function $u(){this.g=new ts}function ju(n,e,t){const r=t||"";try{Ls(n,function(i,o){let u=i;Ye(i)&&(u=Ss(i)),e.push(r+o+"="+encodeURIComponent(u))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function ns(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function rs(n){this.l=n.$b||null,this.j=n.ib||!1}function kr(n,e){St.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=jo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}qs.prototype.cancel=function(){if(this.i=Bo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},ts.prototype.stringify=function(n){return q.JSON.stringify(n,void 0)},ts.prototype.parse=function(n){return q.JSON.parse(n,void 0)},Ge(rs,Do),rs.prototype.g=function(){return new kr(this.l,this.j)},rs.prototype.i=function(n){return function(){return n}}({}),Ge(kr,St);var jo=0;function is(n){n.j.read().then(n.Sa.bind(n)).catch(n.ha.bind(n))}function Hr(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Qr(n)}function Qr(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(E=kr.prototype).open=function(n,e){if(this.readyState!=jo)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Qr(this)},E.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||q).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},E.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Hr(this)),this.readyState=jo},E.Va=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Qr(this)),this.g&&(this.readyState=3,Qr(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof q.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;is(this)}else n.text().then(this.Ua.bind(this),this.ha.bind(this))},E.Sa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Hr(this):Qr(this),3==this.readyState&&is(this)}},E.Ua=function(n){this.g&&(this.response=this.responseText=n,Hr(this))},E.Ta=function(n){this.g&&(this.response=n,Hr(this))},E.ha=function(){this.g&&Hr(this)},E.setRequestHeader=function(n,e){this.v.append(n,e)},E.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},E.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(kr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Go=q.JSON.parse;function ft(n){St.call(this),this.headers=new br,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=zs,this.K=this.L=!1}Ge(ft,St);var zs="",Zs=/^https?$/i,qo=["POST","PUT"];function zo(n){return"content-type"==n.toLowerCase()}function Ws(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,ja(n),yi(n)}function ja(n){n.D||(n.D=!0,Pt(n,"complete"),Pt(n,"error"))}function Hs(n){if(n.h&&typeof W<"u"&&(!n.C[1]||4!=ir(n)||2!=n.ba()))if(n.v&&4==ir(n))Ds(n.Fa,0,n);else if(Pt(n,"readystatechange"),4==ir(n)){n.h=!1;try{const h=n.ba();e:switch(h){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===h){var i=String(n.H).match(Mo)[1]||null;if(!i&&q.self&&q.self.location){var o=q.self.location.protocol;i=o.substr(0,o.length-1)}r=!Zs.test(i?i.toLowerCase():"")}t=r}if(t)Pt(n,"complete"),Pt(n,"success");else{n.m=6;try{var u=2<ir(n)?n.g.statusText:""}catch{u=""}n.j=u+" ["+n.ba()+"]",ja(n)}}finally{yi(n)}}}function yi(n,e){if(n.g){ss(n);const t=n.g,r=n.C[0]?je:null;n.g=null,n.C=null,e||Pt(n,"ready");try{t.onreadystatechange=r}catch{}}}function ss(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(q.clearTimeout(n.A),n.A=null)}function ir(n){return n.g?n.g.readyState:0}function Yr(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case zs:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function Qs(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=function Ga(n){let e="";return vn(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):tt(n,e,t))}function Jr(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function qa(n){this.za=0,this.l=[],this.h=new Co,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Jr("failFast",!1,n),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Jr("baseRetryDelayMs",5e3,n),this.$a=Jr("retryDelaySeedMs",1e4,n),this.Ya=Jr("forwardChannelMaxRetries",2,n),this.ra=Jr("forwardChannelRequestTimeoutMs",2e4,n),this.qa=n&&n.xmlHttpFactory||void 0,this.Ba=n&&n.Yb||!1,this.K=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.J="",this.i=new qs(n&&n.concurrentRequestLimit),this.Ca=new $u,this.ja=n&&n.fastHandshake||!1,this.Ra=n&&n.Wb||!1,n&&n.Aa&&this.h.Aa(),n&&n.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&n&&n.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!n||!1!==n.Xb}function os(n){if(Vc(n),3==n.G){var e=n.V++,t=an(n.F);tt(t,"SID",n.J),tt(t,"RID",e),tt(t,"TYPE","terminate"),Xr(n,t),(e=new er(n,n.h,e,void 0)).K=2,e.v=xr(an(t)),t=!1,q.navigator&&q.navigator.sendBeacon&&(t=q.navigator.sendBeacon(e.v.toString(),"")),!t&&q.Image&&((new Image).src=e.v,t=!0),t||(e.g=za(e.l,null),e.g.ea(e.v)),e.F=Date.now(),tr(e)}Js(n)}function Ys(n){n.g&&(sr(n),n.g.cancel(),n.g=null)}function Vc(n){Ys(n),n.u&&(q.clearTimeout(n.u),n.u=null),Et(n),n.i.cancel(),n.m&&("number"==typeof n.m&&q.clearTimeout(n.m),n.m=null)}function Gu(n,e){n.l.push(new class{constructor(n,e){this.h=n,this.g=e}}(n.Za++,e)),3==n.G&&as(n)}function as(n){Yi(n.i)||n.m||(n.m=!0,wr(n.Ha,n),n.C=0)}function Bc(n,e){var t;t=e?e.m:n.V++;const r=an(n.F);tt(r,"SID",n.J),tt(r,"RID",t),tt(r,"AID",n.U),Xr(n,r),n.o&&n.s&&Qs(r,n.o,n.s),t=new er(n,n.h,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.l=e.D.concat(n.l)),e=qu(n,t,1e3),t.setTimeout(Math.round(.5*n.ra)+Math.round(.5*n.ra*Math.random())),es(n.i,t),Tr(t,r,e)}function Xr(n,e){n.j&&Ls({},function(t,r){tt(e,r,t)})}function qu(n,e,t){t=Math.min(n.l.length,t);var r=n.j?rt(n.j.Oa,n.j,n):null;e:{var i=n.l;let o=-1;for(;;){const u=["count="+t];-1==o?0<t?(o=i[0].h,u.push("ofs="+o)):o=0:u.push("ofs="+o);let h=!0;for(let f=0;f<t;f++){let m=i[f].h;const v=i[f].g;if(m-=o,0>m)o=Math.max(0,i[f].h-100),h=!1;else try{ju(v,u,"req"+m+"_")}catch{r&&r(v)}}if(h){r=u.join("&");break e}}}return n=n.l.splice(0,t),e.D=n,r}function Ku(n){n.g||n.u||(n.Y=1,wr(n.Ga,n),n.A=0)}function us(n){return!(n.g||n.u||3<=n.A||(n.Y++,n.u=Gr(rt(n.Ga,n),Ka(n,n.A)),n.A++,0))}function sr(n){null!=n.B&&(q.clearTimeout(n.B),n.B=null)}function cs(n){n.g=new er(n,n.h,"rpc",n.Y),null===n.o&&(n.g.H=n.s),n.g.O=0;var e=an(n.oa);tt(e,"RID","rpc"),tt(e,"SID",n.J),tt(e,"CI",n.N?"0":"1"),tt(e,"AID",n.U),Xr(n,e),tt(e,"TYPE","xmlhttp"),n.o&&n.s&&Qs(e,n.o,n.s),n.K&&n.g.setTimeout(n.K);var t=n.g;n=n.la,t.K=1,t.v=xr(an(e)),t.s=null,t.U=!0,Ms(t,n)}function Et(n){null!=n.v&&(q.clearTimeout(n.v),n.v=null)}function Zo(n,e){var t=null;if(n.g==e){Et(n),sr(n),n.g=null;var r=2}else{if(!Xi(n.i,e))return;t=e.D,Ks(n.i,e),r=1}if(n.I=e.N,0!=n.G)if(e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;Pt(r=Er(),new Va(r,t,e,i)),as(n)}else Ku(n);else if(3==(i=e.o)||0==i&&0<n.I||!(1==r&&function rh(n,e){return!(Ji(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.l=e.D.concat(n.l),0):1==n.G||2==n.G||n.C>=(n.Xa?0:n.Ya)||(n.m=Gr(rt(n.Ha,n,e),Ka(n,n.C)),n.C++,0)))}(n,e)||2==r&&us(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:ei(n,5);break;case 4:ei(n,10);break;case 3:ei(n,6);break;default:ei(n,2)}}function Ka(n,e){let t=n.Pa+Math.floor(Math.random()*n.$a);return n.j||(t*=2),t*e}function ei(n,e){if(n.h.info("Error code "+e),2==e){var t=null;n.j&&(t=null);var r=rt(n.jb,n);t||(t=new nr("//www.google.com/images/cleardot.gif"),q.location&&"http"==q.location.protocol||zr(t,"https"),xr(t)),function $o(n,e){const t=new Co;if(q.Image){const r=new Image;r.onload=Dt(ns,t,r,"TestLoadImage: loaded",!0,e),r.onerror=Dt(ns,t,r,"TestLoadImage: error",!1,e),r.onabort=Dt(ns,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=Dt(ns,t,r,"TestLoadImage: timeout",!1,e),q.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else at(2);n.G=0,n.j&&n.j.va(e),Js(n),Vc(n)}function Js(n){n.G=0,n.I=-1,n.j&&((0!=Bo(n.i).length||0!=n.l.length)&&(n.i.i.length=0,Rt(n.l),n.l.length=0),n.j.ua())}function _i(n,e,t){let r=function Fs(n){return n instanceof nr?an(n):new nr(n,void 0)}(t);if(""!=r.i)e&&Sr(r,e+"."+r.i),rr(r,r.m);else{const i=q.location;r=function Lo(n,e,t,r){var i=new nr(null,void 0);return n&&zr(i,n),e&&Sr(i,e),t&&rr(i,t),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,t)}return n.aa&&vn(n.aa,function(i,o){tt(r,o,i)}),t=n.sa,(e=n.D)&&t&&tt(r,e,t),tt(r,"VER",n.ma),Xr(n,r),r}function za(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new ft(t&&n.Ba&&!n.qa?new rs({ib:!0}):n.qa)).L=n.H,e}function ti(){}function ls(){if(fn&&!(10<=Number(b)))throw Error("Environmental error: no available transport.")}function un(n,e){St.call(this),this.g=new qa(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.P=n,(n=e&&e.httpHeadersOverwriteParam)&&!Ut(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ut(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Lt(this)}function Za(n){zi.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function Wa(){Xn.call(this),this.status=1}function Lt(n){this.g=n}(E=ft.prototype).ea=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():$a.g(),this.C=function Ps(n){return n.h||(n.h=n.i())}(this.u?this.u:$a),this.g.onreadystatechange=rt(this.Fa,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(o){return void Ws(this,o)}n=t||"";const i=new br(this.headers);r&&Ls(r,function(o,u){i.set(u,o)}),r=function ci(n){e:{var e=zo;const t=n.length,r="string"==typeof n?n.split(""):n;for(let i=0;i<t;i++)if(i in r&&e.call(void 0,r[i],i,n)){e=i;break e}e=-1}return 0>e?null:"string"==typeof n?n.charAt(e):n[e]}(i.T()),t=q.FormData&&n instanceof q.FormData,!(0<=it(qo,e))||r||t||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(o,u){this.g.setRequestHeader(u,o)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{ss(this),0<this.B&&((this.K=function Ko(n){return fn&&function Vi(){return function Qn(n){var e=Jn;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=pr(String(Yn)).split("."),t=pr("9").split("."),r=Math.max(e.length,t.length);for(let u=0;0==n&&u<r;u++){var i=e[u]||"",o=t[u]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==i[0].length&&0==o[0].length)break;n=rn(0==i[1].length?0:parseInt(i[1],10),0==o[1].length?0:parseInt(o[1],10))||rn(0==i[2].length,0==o[2].length)||rn(i[2],o[2]),i=i[3],o=o[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=rt(this.pa,this)):this.A=Ds(this.pa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(o){Ws(this,o)}},E.pa=function(){typeof W<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Pt(this,"timeout"),this.abort(8))},E.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Pt(this,"complete"),Pt(this,"abort"),yi(this))},E.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),yi(this,!0)),ft.Z.M.call(this)},E.Fa=function(){this.s||(this.F||this.v||this.l?Hs(this):this.cb())},E.cb=function(){Hs(this)},E.ba=function(){try{return 2<ir(this)?this.g.status:-1}catch{return-1}},E.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}},E.Qa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Go(e)}},E.Da=function(){return this.m},E.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(E=qa.prototype).ma=8,E.G=1,E.hb=function(n){try{this.h.info("Origin Trials invoked: "+n)}catch{}},E.Ha=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.V=Math.floor(1e5*Math.random()),n=this.V++;const i=new er(this,this.h,n,void 0);let o=this.s;if(this.P&&(o?(o=Ln(o),In(o,this.P)):o=this.P),null===this.o&&(i.H=o),this.ja)e:{for(var e=0,t=0;t<this.l.length;t++){var r=this.l[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.l.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=qu(this,i,e),tt(t=an(this.F),"RID",n),tt(t,"CVER",22),this.D&&tt(t,"X-HTTP-Session-Id",this.D),Xr(this,t),this.o&&o&&Qs(t,this.o,o),es(this.i,i),this.Ra&&tt(t,"TYPE","init"),this.ja?(tt(t,"$req",e),tt(t,"SID","null"),i.$=!0,Tr(i,t,null)):Tr(i,t,e),this.G=2}}else 3==this.G&&(n?Bc(this,n):0==this.l.length||Yi(this.i)||Bc(this))},E.Ga=function(){if(this.u=null,cs(this),this.$&&!(this.L||null==this.g||0>=this.O)){var n=2*this.O;this.h.info("BP detection timer enabled: "+n),this.B=Gr(rt(this.bb,this),n)}},E.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,at(10),Ys(this),cs(this))},E.ab=function(){null!=this.v&&(this.v=null,Ys(this),us(this),at(19))},E.jb=function(n){n?(this.h.info("Successfully pinged google.com"),at(2)):(this.h.info("Failed to ping google.com"),at(1))},(E=ti.prototype).xa=function(){},E.wa=function(){},E.va=function(){},E.ua=function(){},E.Oa=function(){},ls.prototype.g=function(n,e){return new un(n,e)},Ge(un,St),un.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;n.Wa&&(n.h.info("Origin Trials enabled."),wr(rt(n.hb,n,e))),at(0),n.W=e,n.aa=t||{},n.N=n.X,n.F=_i(n,null,n.W),as(n)},un.prototype.close=function(){os(this.g)},un.prototype.u=function(n){if("string"==typeof n){var e={};e.__data__=n,Gu(this.g,e)}else this.v?((e={}).__data__=Ss(n),Gu(this.g,e)):Gu(this.g,n)},un.prototype.M=function(){this.g.j=null,delete this.j,os(this.g),delete this.g,un.Z.M.call(this)},Ge(Za,zi),Ge(Wa,Xn),Ge(Lt,ti),Lt.prototype.xa=function(){Pt(this.g,"a")},Lt.prototype.wa=function(n){Pt(this.g,new Za(n))},Lt.prototype.va=function(n){Pt(this.g,new Wa(n))},Lt.prototype.ua=function(){Pt(this.g,"b")},ls.prototype.createWebChannel=ls.prototype.g,un.prototype.send=un.prototype.u,un.prototype.open=un.prototype.m,un.prototype.close=un.prototype.close,qr.NO_ERROR=0,qr.TIMEOUT=8,qr.HTTP_ERROR=6,Vn.COMPLETE="complete",Ba.EventType=Ki,Ki.OPEN="a",Ki.CLOSE="b",Ki.ERROR="c",Ki.MESSAGE="d",St.prototype.listen=St.prototype.N,ft.prototype.listenOnce=ft.prototype.O,ft.prototype.getLastError=ft.prototype.La,ft.prototype.getLastErrorCode=ft.prototype.Da,ft.prototype.getStatus=ft.prototype.ba,ft.prototype.getResponseJson=ft.prototype.Qa,ft.prototype.getResponseText=ft.prototype.ga,ft.prototype.send=ft.prototype.ea;var Xs=ge.createWebChannelTransport=function(){return new ls},$c=ge.getStatEventTarget=function(){return Er()},Gn=ge.ErrorCode=qr,Ha=ge.EventType=Vn,zu=ge.Event=$r,vi=ge.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Wo=ge.FetchXmlHttpFactory=rs,pt=ge.WebChannel=Ba,Ho=ge.XhrIo=ft;const hs="@firebase/firestore";class Tt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Tt.UNAUTHENTICATED=new Tt(null),Tt.GOOGLE_CREDENTIALS=new Tt("google-credentials-uid"),Tt.FIRST_PARTY=new Tt("first-party-uid"),Tt.MOCK_USER=new Tt("mock-user");let Dr="9.9.2";const Nr=new xe.Yd("@firebase/firestore");function Qo(){return Nr.logLevel}function Z(n,...e){if(Nr.logLevel<=xe.in.DEBUG){const t=e.map(or);Nr.debug(`Firestore (${Dr}): ${n}`,...t)}}function et(n,...e){if(Nr.logLevel<=xe.in.ERROR){const t=e.map(or);Nr.error(`Firestore (${Dr}): ${n}`,...t)}}function Rr(n,...e){if(Nr.logLevel<=xe.in.WARN){const t=e.map(or);Nr.warn(`Firestore (${Dr}): ${n}`,...t)}}function or(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function ne(n="Unexpected state"){const e=`FIRESTORE (${Dr}) INTERNAL ASSERTION FAILED: `+n;throw et(e),new Error(e)}function ve(n,e){n||ne()}function X(n,e){return n}const L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class K extends le.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class gt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class to{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Qa{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Tt.UNAUTHENTICATED))}shutdown(){}}class Zu{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Ya{constructor(e){this.t=e,this.currentUser=Tt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const o=m=>this.i!==i?(i=this.i,t(m)):Promise.resolve();let u=new gt;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new gt,e.enqueueRetryable(()=>o(this.currentUser))};const h=()=>{const m=u;e.enqueueRetryable((0,R.Z)(function*(){yield m.promise,yield o(r.currentUser)}))},f=m=>{Z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(m=>f(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(Z("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new gt)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ve("string"==typeof r.accessToken),new to(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ve(null===e||"string"==typeof e),new Tt(e)}}class Ii{constructor(e,t,r){this.type="FirstParty",this.user=Tt.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const i=e.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class Jo{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new Ii(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(Tt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ja{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ar{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,t){const r=o=>{null!=o.error&&Z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const u=o.token!==this.p;return this.p=o.token,Z("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const i=o=>{Z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.g.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.g.getImmediate({optional:!0});o?i(o):Z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ve("string"==typeof t.token),this.p=t.token,new Ja(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Xa(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class wi{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=Xa(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}}function Se(n,e){return n<e?-1:n>e?1:0}function ni(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function qn(n){return n+"\0"}class We{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new K(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new K(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new K(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return We.fromMillis(Date.now())}static fromDate(e){return We.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new We(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Se(this.nanoseconds,e.nanoseconds):Se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class be{constructor(e){this.timestamp=e}static fromTimestamp(e){return new be(e)}static min(){return new be(new We(0,0))}static max(){return new be(new We(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class ds{constructor(e,t,r){void 0===t?t=0:t>e.length&&ne(),void 0===r?r=e.length-t:r>e.length-t&&ne(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===ds.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ds?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const o=e.get(i),u=t.get(i);if(o<u)return-1;if(o>u)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Fe extends ds{construct(e,t,r){return new Fe(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new K(L.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new Fe(t)}static emptyPath(){return new Fe([])}}const eu=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mt extends ds{construct(e,t,r){return new mt(e,t,r)}static isValidIdentifier(e){return eu.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new mt(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const o=()=>{if(0===r.length)throw new K(L.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let u=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new K(L.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if("\\"!==f&&"."!==f&&"`"!==f)throw new K(L.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,i+=2}else"`"===h?(u=!u,i++):"."!==h||u?(r+=h,i++):(o(),i++)}if(o(),u)throw new K(L.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mt(t)}static emptyPath(){return new mt([])}}class ee{constructor(e){this.path=e}static fromPath(e){return new ee(Fe.fromString(e))}static fromName(e){return new ee(Fe.fromString(e).popFirst(5))}static empty(){return new ee(Fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Fe.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Fe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new Fe(e.slice()))}}class Ei{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function tu(n){return n.fields.find(e=>2===e.kind)}function Ti(n){return n.fields.filter(e=>2!==e.kind)}Ei.UNKNOWN_ID=-1;class ea{constructor(e,t){this.fieldPath=e,this.kind=t}}class fs{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new fs(0,Vt.min())}}function ta(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=be.fromTimestamp(1e9===r?new We(t+1,0):new We(t,r));return new Vt(i,ee.empty(),e)}function na(n){return new Vt(n.readTime,n.key,-1)}class Vt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Vt(be.min(),ee.empty(),-1)}static max(){return new Vt(be.max(),ee.empty(),-1)}}function ra(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=ee.comparator(n.documentKey,e.documentKey),0!==t?t:Se(n.largestBatchId,e.largestBatchId))}const no="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nu{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Kn(n){return bi.apply(this,arguments)}function bi(){return bi=(0,R.Z)(function*(n){if(n.code!==L.FAILED_PRECONDITION||n.message!==no)throw n;Z("LocalStore","Unexpectedly lost primary lease")}),bi.apply(this,arguments)}class P{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ne(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new P((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof P?t:P.resolve(t)}catch(t){return P.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):P.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):P.reject(t)}static resolve(e){return new P((t,r)=>{t(e)})}static reject(e){return new P((t,r)=>{r(e)})}static waitFor(e){return new P((t,r)=>{let i=0,o=0,u=!1;e.forEach(h=>{++i,h.next(()=>{++o,u&&o===i&&t()},f=>r(f))}),u=!0,o===i&&t()})}static or(e){let t=P.resolve(!1);for(const r of e)t=t.next(i=>i?P.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new P((r,i)=>{const o=e.length,u=new Array(o);let h=0;for(let f=0;f<o;f++){const m=f;t(e[m]).next(v=>{u[m]=v,++h,h===o&&r(u)},v=>i(v))}})}static doWhile(e,t){return new P((r,i)=>{const o=()=>{!0===e()?t().next(()=>{o()},i):r()};o()})}}class ia{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.T=new gt,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{t.error?this.T.reject(new xn(e,t.error)):this.T.resolve()},this.transaction.onerror=r=>{const i=ri(r.target.error);this.T.reject(new xn(e,i))}}static open(e,t,r,i){try{return new ia(t,e.transaction(i,r))}catch(o){throw new xn(t,o)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(Z("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Hu(t)}}class cn{constructor(e,t,r){this.name=e,this.version=t,this.P=r,12.2===cn.v((0,le.z$)())&&et("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Z("SimpleDb","Removing database:",e),ur(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!(0,le.hl)())return!1;if(cn.S())return!0;const e=(0,le.z$)(),t=cn.v(e),r=0<t&&t<10,i=cn.D(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static S(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.C)}static N(e,t){return e.store(t)}static v(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static D(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}k(e){var t=this;return(0,R.Z)(function*(){return t.db||(Z("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const o=indexedDB.open(t.name,t.version);o.onsuccess=u=>{r(u.target.result)},o.onblocked=()=>{i(new xn(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=u=>{const h=u.target.error;i("VersionError"===h.name?new K(L.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new K(L.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new xn(e,h))},o.onupgradeneeded=u=>{Z("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',u.oldVersion),t.P.M(u.target.result,o.transaction,u.oldVersion,t.version).next(()=>{Z("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.O&&(t.db.onversionchange=r=>t.O(r)),t.db})()}F(e){this.O=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var o=this;return(0,R.Z)(function*(){const u="readonly"===t;let h=0;for(;;){++h;try{o.db=yield o.k(e);const f=ia.open(o.db,e,u?"readonly":"readwrite",r),m=i(f).next(v=>(f.R(),v)).catch(v=>(f.abort(v),P.reject(v))).toPromise();return m.catch(()=>{}),yield f.A,m}catch(f){const m=f,v="FirebaseError"!==m.name&&h<3;if(Z("SimpleDb","Transaction failed with error:",m.message,"Retrying:",v),o.close(),!v)return Promise.reject(m)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class ps{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return ur(this.$.delete())}}class xn extends K{constructor(e,t){super(L.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function zn(n){return"IndexedDbTransactionError"===n.name}class Hu{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(Z("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(Z("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ur(r)}add(e){return Z("SimpleDb","ADD",this.store.name,e,e),ur(this.store.add(e))}get(e){return ur(this.store.get(e)).next(t=>(void 0===t&&(t=null),Z("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Z("SimpleDb","DELETE",this.store.name,e),ur(this.store.delete(e))}count(){return Z("SimpleDb","COUNT",this.store.name),ur(this.store.count())}K(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),o=[];return this.G(i,(u,h)=>{o.push(h)}).next(()=>o)}{const i=this.store.getAll(r.range);return new P((o,u)=>{i.onerror=h=>{u(h.target.error)},i.onsuccess=h=>{o(h.target.result)}})}}j(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new P((i,o)=>{r.onerror=u=>{o(u.target.error)},r.onsuccess=u=>{i(u.target.result)}})}W(e,t){Z("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const i=this.cursor(r);return this.G(i,(o,u,h)=>h.delete())}J(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Y(e){const t=this.cursor({});return new P((r,i)=>{t.onerror=o=>{const u=ri(o.target.error);i(u)},t.onsuccess=o=>{const u=o.target.result;u?e(u.primaryKey,u.value).next(h=>{h?u.continue():r()}):r()}})}G(e,t){const r=[];return new P((i,o)=>{e.onerror=u=>{o(u.target.error)},e.onsuccess=u=>{const h=u.target.result;if(!h)return void i();const f=new ps(h),m=t(h.primaryKey,h.value,f);if(m instanceof P){const v=m.catch(T=>(f.done(),P.reject(T)));r.push(v)}f.isDone?i():null===f.U?h.continue():h.continue(f.U)}}).next(()=>P.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ur(n){return new P((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=ri(r.target.error);t(i)}})}let ro=!1;function ri(n){const e=cn.v((0,le.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new K("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ro||(ro=!0,setTimeout(()=>{throw r},0)),r}}return n}class io{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.Z(15)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}Z(e){var t=this;Z("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,R.Z)(function*(){t.task=null;try{Z("IndexBackiller",`Documents written: ${yield t.X.tt()}`)}catch(r){zn(r)?Z("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Kn(r)}yield t.Z(1)}))}}class sa{constructor(e,t){this.localStore=e,this.persistence=t}tt(e=50){var t=this;return(0,R.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.et(r,e))})()}et(e,t){const r=new Set;let i=t,o=!0;return P.doWhile(()=>!0===o&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(u=>{if(null!==u&&!r.has(u))return Z("IndexBackiller",`Processing collection: ${u}`),this.nt(e,u,i).next(h=>{i-=h,r.add(u)});o=!1})).next(()=>t-i)}nt(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{const u=o.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next(()=>this.st(i,o)).next(h=>(Z("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>u.size)}))}st(e,t){let r=e;return t.changes.forEach((i,o)=>{const u=na(o);ra(u,r)>0&&(r=u)}),new Vt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Bt{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.it(r),this.rt=r=>t.writeSequenceNumber(r))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}function Ai(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Si(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function oa(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}Bt.ot=-1;class _t{constructor(e,t){this.comparator=e,this.root=t||xt.EMPTY}insert(e,t){return new _t(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,xt.BLACK,null,null))}remove(e){return new _t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xi(this.root,e,this.comparator,!1)}getReverseIterator(){return new xi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xi(this.root,e,this.comparator,!0)}}class xi{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(0===o){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class xt{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??xt.RED,this.left=i??xt.EMPTY,this.right=o??xt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new xt(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===o?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return xt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return xt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ne();const e=this.left.check();if(e!==this.right.check())throw ne();return e+(this.isRed()?0:1)}}xt.EMPTY=null,xt.RED=!0,xt.BLACK=!1,xt.EMPTY=new class{constructor(){this.size=0}get key(){throw ne()}get value(){throw ne()}get color(){throw ne()}get left(){throw ne()}get right(){throw ne()}copy(n,e,t,r,i){return this}insert(n,e,t){return new xt(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Be{constructor(e){this.comparator=e,this.data=new _t(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ii(this.data.getIterator())}getIteratorFrom(e){return new ii(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Be)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Be(this.comparator);return t.data=e,t}}class ii{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ci(n){return n.hasNext()?n.getNext():void 0}class ln{constructor(e){this.fields=e,e.sort(mt.comparator)}static empty(){return new ln([])}unionWith(e){let t=new Be(mt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ln(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ni(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class vt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new vt(t)}static fromUint8Array(e){const t=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new vt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vt.EMPTY_BYTE_STRING=new vt("");const lr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function si(n){if(ve(!!n),"string"==typeof n){let e=0;const t=lr.exec(n);if(ve(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ht(n.seconds),nanos:ht(n.nanos)}}function ht(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function hr(n){return"string"==typeof n?vt.fromBase64String(n):vt.fromUint8Array(n)}function so(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function ru(n){const e=n.mapValue.fields.__previous_value__;return so(e)?ru(e):e}function oo(n){const e=si(n.mapValue.fields.__local_write_time__.timestampValue);return new We(e.seconds,e.nanos)}class d{constructor(e,t,r,i,o,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.useFetchStreams=f}}class p{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new p("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof p&&e.projectId===this.projectId&&e.database===this.database}}function y(n){return null==n}function w(n){return 0===n&&1/n==-1/0}function N(n){return"number"==typeof n&&Number.isInteger(n)&&!w(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const M={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},j={nullValue:"NULL_VALUE"};function Q(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?so(n)?4:oi(n)?9007199254740991:10:ne()}function ue(n,e){if(n===e)return!0;const t=Q(n);if(t!==Q(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return oo(n).isEqual(oo(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=si(r.timestampValue),u=si(i.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,hr(n.bytesValue).isEqual(hr(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return ht(r.geoPointValue.latitude)===ht(i.geoPointValue.latitude)&&ht(r.geoPointValue.longitude)===ht(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return ht(r.integerValue)===ht(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=ht(r.doubleValue),u=ht(i.doubleValue);return o===u?w(o)===w(u):isNaN(o)&&isNaN(u)}return!1}(n,e);case 9:return ni(n.arrayValue.values||[],e.arrayValue.values||[],ue);case 10:return function(r,i){const o=r.mapValue.fields||{},u=i.mapValue.fields||{};if(Ai(o)!==Ai(u))return!1;for(const h in o)if(o.hasOwnProperty(h)&&(void 0===u[h]||!ue(o[h],u[h])))return!1;return!0}(n,e);default:return ne()}var i}function Te(n,e){return void 0!==(n.values||[]).find(t=>ue(t,e))}function Ae(n,e){if(n===e)return 0;const t=Q(n),r=Q(e);if(t!==r)return Se(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Se(n.booleanValue,e.booleanValue);case 2:return function(i,o){const u=ht(i.integerValue||i.doubleValue),h=ht(o.integerValue||o.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return ye(n.timestampValue,e.timestampValue);case 4:return ye(oo(n),oo(e));case 5:return Se(n.stringValue,e.stringValue);case 6:return function(i,o){const u=hr(i),h=hr(o);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const u=i.split("/"),h=o.split("/");for(let f=0;f<u.length&&f<h.length;f++){const m=Se(u[f],h[f]);if(0!==m)return m}return Se(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const u=Se(ht(i.latitude),ht(o.latitude));return 0!==u?u:Se(ht(i.longitude),ht(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,o){const u=i.values||[],h=o.values||[];for(let f=0;f<u.length&&f<h.length;++f){const m=Ae(u[f],h[f]);if(m)return m}return Se(u.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,o){if(i===M.mapValue&&o===M.mapValue)return 0;if(i===M.mapValue)return 1;if(o===M.mapValue)return-1;const u=i.fields||{},h=Object.keys(u),f=o.fields||{},m=Object.keys(f);h.sort(),m.sort();for(let v=0;v<h.length&&v<m.length;++v){const T=Se(h[v],m[v]);if(0!==T)return T;const O=Ae(u[h[v]],f[m[v]]);if(0!==O)return O}return Se(h.length,m.length)}(n.mapValue,e.mapValue);default:throw ne()}}function ye(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Se(n,e);const t=si(n),r=si(e),i=Se(t.seconds,r.seconds);return 0!==i?i:Se(t.nanos,r.nanos)}function dt(n){return Zt(n)}function Zt(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=si(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?hr(n.bytesValue).toBase64():"referenceValue"in n?ee.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",o=!0;for(const u of r.values||[])o?o=!1:i+=",",i+=Zt(u);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let o="{",u=!0;for(const h of i)u?u=!1:o+=",",o+=`${h}:${Zt(r.fields[h])}`;return o+"}"}(n.mapValue):ne();var e}function Cn(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Or(n){return!!n&&"integerValue"in n}function kn(n){return!!n&&"arrayValue"in n}function iu(n){return!!n&&"nullValue"in n}function gs(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Zn(n){return!!n&&"mapValue"in n}function Dn(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Si(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Dn(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Dn(n.arrayValue.values[t]);return e}return Object.assign({},n)}function oi(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function su(n){return"nullValue"in n?j:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Cn(p.empty(),ee.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:ne()}function Qu(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Cn(p.empty(),ee.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?M:ne()}function Gc(n,e){const t=Ae(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function qc(n,e){const t=Ae(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class $t{constructor(e){this.value=e}static empty(){return new $t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Zn(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dn(t)}setAll(e){let t=mt.emptyPath(),r={},i=[];e.forEach((u,h)=>{if(!t.isImmediateParentOf(h)){const f=this.getFieldsMap(t);this.applyChanges(f,r,i),r={},i=[],t=h.popLast()}u?r[h.lastSegment()]=Dn(u):i.push(h.lastSegment())});const o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){const t=this.field(e.popLast());Zn(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ue(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Zn(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Si(t,(i,o)=>e[i]=o);for(const i of r)delete e[i]}clone(){return new $t(Dn(this.value))}}function Kc(n){const e=[];return Si(n.fields,(t,r)=>{const i=new mt([t]);if(Zn(r)){const o=Kc(r.mapValue).fields;if(0===o.length)e.push(i);else for(const u of o)e.push(i.child(u))}else e.push(i)}),new ln(e)}class Je{constructor(e,t,r,i,o,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.data=o,this.documentState=u}static newInvalidDocument(e){return new Je(e,0,be.min(),be.min(),$t.empty(),0)}static newFoundDocument(e,t,r){return new Je(e,1,t,be.min(),r,0)}static newNoDocument(e,t){return new Je(e,2,t,be.min(),$t.empty(),0)}static newUnknownDocument(e,t){return new Je(e,3,t,be.min(),$t.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$t.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$t.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Je&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Je(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ih{constructor(e,t=null,r=[],i=[],o=null,u=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=u,this.endAt=h,this.ut=null}}function zc(n,e=null,t=[],r=[],i=null,o=null,u=null){return new ih(n,e,t,r,i,o,u)}function ms(n){const e=X(n);if(null===e.ut){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>{return(i=r).field.canonicalString()+i.op.toString()+dt(i.value);var i}).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),y(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>dt(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>dt(r)).join(",")),e.ut=t}return e.ut}function aa(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<n.orderBy.length;i++)if(!dh(n.orderBy[i],e.orderBy[i]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let i=0;i<n.filters.length;i++)if((t=n.filters[i]).op!==(r=e.filters[i]).op||!t.field.isEqual(r.field)||!ue(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Qc(n.startAt,e.startAt)&&Qc(n.endAt,e.endAt)}function ou(n){return ee.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function au(n,e){return n.filters.filter(t=>t instanceof Wt&&t.field.isEqual(e))}function Zc(n,e,t){let r=j,i=!0;for(const o of au(n,e)){let u=j,h=!0;switch(o.op){case"<":case"<=":u=su(o.value);break;case"==":case"in":case">=":u=o.value;break;case">":u=o.value,h=!1;break;case"!=":case"not-in":u=j}Gc({value:r,inclusive:i},{value:u,inclusive:h})<0&&(r=u,i=h)}if(null!==t)for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const u=t.position[o];Gc({value:r,inclusive:i},{value:u,inclusive:t.inclusive})<0&&(r=u,i=t.inclusive);break}return{value:r,inclusive:i}}function uu(n,e,t){let r=M,i=!0;for(const o of au(n,e)){let u=M,h=!0;switch(o.op){case">=":case">":u=Qu(o.value),h=!1;break;case"==":case"in":case"<=":u=o.value;break;case"<":u=o.value,h=!1;break;case"!=":case"not-in":u=M}qc({value:r,inclusive:i},{value:u,inclusive:h})>0&&(r=u,i=h)}if(null!==t)for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const u=t.position[o];qc({value:r,inclusive:i},{value:u,inclusive:t.inclusive})>0&&(r=u,i=t.inclusive);break}return{value:r,inclusive:i}}class Wt extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new oh(e,t,r):"array-contains"===t?new Hc(e,r):"in"===t?new ch(e,r):"not-in"===t?new lh(e,r):"array-contains-any"===t?new hh(e,r):new Wt(e,t,r)}static ct(e,t,r){return"in"===t?new ah(e,r):new uh(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(Ae(t,this.value)):null!==t&&Q(this.value)===Q(t)&&this.at(Ae(t,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ne()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class oh extends Wt{constructor(e,t,r){super(e,t,r),this.key=ee.fromName(r.referenceValue)}matches(e){const t=ee.comparator(e.key,this.key);return this.at(t)}}class ah extends Wt{constructor(e,t){super(e,"in",t),this.keys=Wc(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class uh extends Wt{constructor(e,t){super(e,"not-in",t),this.keys=Wc(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Wc(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>ee.fromName(r.referenceValue))}class Hc extends Wt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return kn(t)&&Te(t.arrayValue,this.value)}}class ch extends Wt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Te(this.value.arrayValue,t)}}class lh extends Wt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Te(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Te(this.value.arrayValue,t)}}class hh extends Wt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!kn(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Te(this.value.arrayValue,r))}}class ki{constructor(e,t){this.position=e,this.inclusive=t}}class Di{constructor(e,t="asc"){this.field=e,this.dir=t}}function dh(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function cu(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const o=e[i],u=n.position[i];if(r=o.field.isKeyField()?ee.comparator(ee.fromName(u.referenceValue),t.key):Ae(u,t.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return r}function Qc(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ue(n.position[t],e.position[t]))return!1;return!0}class Pr{constructor(e,t=null,r=[],i=[],o=null,u="F",h=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=u,this.startAt=h,this.endAt=f,this.lt=null,this.ft=null}}function Yc(n,e,t,r,i,o,u,h){return new Pr(n,e,t,r,i,o,u,h)}function Ni(n){return new Pr(n)}function Jc(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function lu(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function hu(n){for(const e of n.filters)if(e.ht())return e.field;return null}function Yu(n){return null!==n.collectionGroup}function ao(n){const e=X(n);if(null===e.lt){e.lt=[];const t=hu(e),r=lu(e);if(null!==t&&null===r)t.isKeyField()||e.lt.push(new Di(t)),e.lt.push(new Di(mt.keyField(),"asc"));else{let i=!1;for(const o of e.explicitOrderBy)e.lt.push(o),o.field.isKeyField()&&(i=!0);if(!i){const o=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new Di(mt.keyField(),o))}}}return e.lt}function gn(n){const e=X(n);if(!e.ft)if("F"===e.limitType)e.ft=zc(e.path,e.collectionGroup,ao(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const o of ao(e))t.push(new Di(o.field,"desc"===o.dir?"asc":"desc"));const r=e.endAt?new ki(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new ki(e.startAt.position,e.startAt.inclusive):null;e.ft=zc(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.ft}function Ju(n,e,t){return new Pr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function dr(n,e){return aa(gn(n),gn(e))&&n.limitType===e.limitType}function Xc(n){return`${ms(gn(n))}|lt:${n.limitType}`}function Xu(n){return`Query(target=${function sh(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${dt(r.value)}`;var r}).join(", ")}]`),y(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(r=t).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>dt(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>dt(t)).join(",")),`Target(${e})`}(gn(n))}; limitType=${n.limitType})`}function ua(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):ee.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of t.explicitOrderBy)if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,o,u){const h=cu(i,o,u);return i.inclusive?h<=0:h<0}(t.startAt,ao(t),r)||t.endAt&&!function(i,o,u){const h=cu(i,o,u);return i.inclusive?h>=0:h>0}(t.endAt,ao(t),r)));var t,r}function el(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function du(n){return(e,t)=>{let r=!1;for(const i of ao(n)){const o=fh(i,e,t);if(0!==o)return o;r=r||i.field.isKeyField()}return 0}}function fh(n,e,t){const r=n.field.isKeyField()?ee.comparator(e.key,t.key):function(i,o,u){const h=o.data.field(i),f=u.data.field(i);return null!==h&&null!==f?Ae(h,f):ne()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ne()}}function tl(n,e){if(n.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:w(e)?"-0":e}}function fu(n){return{integerValue:""+n}}function nl(n,e){return N(e)?fu(e):tl(n,e)}class pu{constructor(){this._=void 0}}function ec(n,e,t){return n instanceof uo?function(r,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof ys?il(n,e):n instanceof Ri?gu(n,e):function(r,i){const o=rl(r,i),u=sl(o)+sl(r._t);return Or(o)&&Or(r._t)?fu(u):tl(r.wt,u)}(n,e)}function ph(n,e,t){return n instanceof ys?il(n,e):n instanceof Ri?gu(n,e):t}function rl(n,e){return n instanceof co?Or(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class uo extends pu{}class ys extends pu{constructor(e){super(),this.elements=e}}function il(n,e){const t=mu(e);for(const r of n.elements)t.some(i=>ue(i,r))||t.push(r);return{arrayValue:{values:t}}}class Ri extends pu{constructor(e){super(),this.elements=e}}function gu(n,e){let t=mu(e);for(const r of n.elements)t=t.filter(i=>!ue(i,r));return{arrayValue:{values:t}}}class co extends pu{constructor(e,t){super(),this.wt=e,this._t=t}}function sl(n){return ht(n.integerValue||n.doubleValue)}function mu(n){return kn(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class _s{constructor(e,t){this.field=e,this.transform=t}}class mh{constructor(e,t){this.version=e,this.transformResults=t}}class ct{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ct}static exists(e){return new ct(void 0,e)}static updateTime(e){return new ct(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yu(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class _u{}function ol(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new ho(n.key,ct.none()):new lo(n.key,n.data,ct.none());{const t=n.data,r=$t.empty();let i=new Be(mt.comparator);for(let o of e.fields)if(!i.has(o)){let u=t.field(o);null===u&&o.length>1&&(o=o.popLast(),u=t.field(o)),null===u?r.delete(o):r.set(o,u),i=i.add(o)}return new Nn(n.key,r,new ln(i.toArray()),ct.none())}}function al(n,e,t){n instanceof lo?function(r,i,o){const u=r.value.clone(),h=tc(r.fieldTransforms,i,o.transformResults);u.setAll(h),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):n instanceof Nn?function(r,i,o){if(!yu(r.precondition,i))return void i.convertToUnknownDocument(o.version);const u=tc(r.fieldTransforms,i,o.transformResults),h=i.data;h.setAll(cl(r)),h.setAll(u),i.convertToFoundDocument(o.version,h).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function ca(n,e,t,r){return n instanceof lo?function(i,o,u,h){if(!yu(i.precondition,o))return u;const f=i.value.clone(),m=ll(i.fieldTransforms,h,o);return f.setAll(m),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof Nn?function(i,o,u,h){if(!yu(i.precondition,o))return u;const f=ll(i.fieldTransforms,h,o),m=o.data;return m.setAll(cl(i)),m.setAll(f),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),null===u?null:u.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(v=>v.field))}(n,e,t,r):(u=t,yu(n.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u);var o,u}function yh(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),o=rl(r.transform,i||null);null!=o&&(null===t&&(t=$t.empty()),t.set(r.field,o))}return t||null}function ul(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&ni(t,r,(i,o)=>function gh(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof ys&&r instanceof ys||t instanceof Ri&&r instanceof Ri?ni(t.elements,r.elements,ue):t instanceof co&&r instanceof co?ue(t._t,r._t):t instanceof uo&&r instanceof uo);var t,r}(i,o))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class lo extends _u{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Nn extends _u{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function cl(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function tc(n,e,t){const r=new Map;ve(n.length===t.length);for(let i=0;i<t.length;i++){const o=n[i],u=o.transform,h=e.data.field(o.field);r.set(o.field,ph(u,h,t[i]))}return r}function ll(n,e,t){const r=new Map;for(const i of n){const o=i.transform,u=t.data.field(i.field);r.set(i.field,ec(o,u,e))}return r}class ho extends _u{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nc extends _u{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class _h{constructor(e){this.count=e}}var Ct,Ue;function vu(n){switch(n){default:return ne();case L.CANCELLED:case L.UNKNOWN:case L.DEADLINE_EXCEEDED:case L.RESOURCE_EXHAUSTED:case L.INTERNAL:case L.UNAVAILABLE:case L.UNAUTHENTICATED:return!1;case L.INVALID_ARGUMENT:case L.NOT_FOUND:case L.ALREADY_EXISTS:case L.PERMISSION_DENIED:case L.FAILED_PRECONDITION:case L.ABORTED:case L.OUT_OF_RANGE:case L.UNIMPLEMENTED:case L.DATA_LOSS:return!0}}function rc(n){if(void 0===n)return et("GRPC error has no .code"),L.UNKNOWN;switch(n){case Ct.OK:return L.OK;case Ct.CANCELLED:return L.CANCELLED;case Ct.UNKNOWN:return L.UNKNOWN;case Ct.DEADLINE_EXCEEDED:return L.DEADLINE_EXCEEDED;case Ct.RESOURCE_EXHAUSTED:return L.RESOURCE_EXHAUSTED;case Ct.INTERNAL:return L.INTERNAL;case Ct.UNAVAILABLE:return L.UNAVAILABLE;case Ct.UNAUTHENTICATED:return L.UNAUTHENTICATED;case Ct.INVALID_ARGUMENT:return L.INVALID_ARGUMENT;case Ct.NOT_FOUND:return L.NOT_FOUND;case Ct.ALREADY_EXISTS:return L.ALREADY_EXISTS;case Ct.PERMISSION_DENIED:return L.PERMISSION_DENIED;case Ct.FAILED_PRECONDITION:return L.FAILED_PRECONDITION;case Ct.ABORTED:return L.ABORTED;case Ct.OUT_OF_RANGE:return L.OUT_OF_RANGE;case Ct.UNIMPLEMENTED:return L.UNIMPLEMENTED;case Ct.DATA_LOSS:return L.DATA_LOSS;default:return ne()}}(Ue=Ct||(Ct={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";class Oi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,o]of r)if(this.equalsFn(i,e))return o}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Si(this.inner,(t,r)=>{for(const[i,o]of r)e(i,o)})}isEmpty(){return oa(this.inner)}size(){return this.innerSize}}const ic=new _t(ee.comparator);function mn(){return ic}const yn=new _t(ee.comparator);function ai(...n){let e=yn;for(const t of n)e=e.insert(t.key,t);return e}function sc(n){let e=yn;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Mr(){return vs()}function Iu(){return vs()}function vs(){return new Oi(n=>n.toString(),(n,e)=>n.isEqual(e))}const vh=new _t(ee.comparator),hl=new Be(ee.comparator);function De(...n){let e=hl;for(const t of n)e=e.add(t);return e}const Pi=new Be(Se);function la(){return Pi}class ha{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t){const r=new Map;return r.set(e,da.createSynthesizedTargetChangeForCurrentChange(e,t)),new ha(be.min(),r,la(),mn(),De())}}class da{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t){return new da(vt.EMPTY_BYTE_STRING,t,De(),De(),De())}}class wu{constructor(e,t,r,i){this.gt=e,this.removedTargetIds=t,this.key=r,this.yt=i}}class oc{constructor(e,t){this.targetId=e,this.It=t}}class hn{constructor(e,t,r=vt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Eu{constructor(){this.Tt=0,this.Et=Lr(),this.At=vt.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return 0!==this.Tt}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=De(),t=De(),r=De();return this.Et.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ne()}}),new da(this.At,this.Rt,e,t,r)}Dt(){this.bt=!1,this.Et=Lr()}Ct(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Mt(){this.bt=!0,this.Rt=!0}}class ac{constructor(e){this.Ot=e,this.Ft=new Map,this.$t=mn(),this.Bt=dl(),this.Lt=new Be(Se)}Ut(e){for(const t of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(t,e.yt):this.Kt(t,e.key,e.yt);for(const t of e.removedTargetIds)this.Kt(t,e.key,e.yt)}Gt(e){this.forEachTarget(e,t=>{const r=this.Qt(t);switch(e.state){case 0:this.jt(t)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||this.removeTarget(t);break;case 3:this.jt(t)&&(r.Mt(),r.Vt(e.resumeToken));break;case 4:this.jt(t)&&(this.Wt(t),r.Vt(e.resumeToken));break;default:ne()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach((r,i)=>{this.jt(i)&&t(i)})}zt(e){const t=e.targetId,r=e.It.count,i=this.Ht(t);if(i){const o=i.target;if(ou(o))if(0===r){const u=new ee(o.path);this.Kt(t,u,Je.newNoDocument(u,be.min()))}else ve(1===r);else this.Jt(t)!==r&&(this.Wt(t),this.Lt=this.Lt.add(t))}}Yt(e){const t=new Map;this.Ft.forEach((o,u)=>{const h=this.Ht(u);if(h){if(o.current&&ou(h.target)){const f=new ee(h.target.path);null!==this.$t.get(f)||this.Xt(u,f)||this.Kt(u,f,Je.newNoDocument(f,e))}o.vt&&(t.set(u,o.St()),o.Dt())}});let r=De();this.Bt.forEach((o,u)=>{let h=!0;u.forEachWhile(f=>{const m=this.Ht(f);return!m||2===m.purpose||(h=!1,!1)}),h&&(r=r.add(o))}),this.$t.forEach((o,u)=>u.setReadTime(e));const i=new ha(e,t,this.Lt,this.$t,r);return this.$t=mn(),this.Bt=dl(),this.Lt=new Be(Se),i}qt(e,t){if(!this.jt(e))return;const r=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,r),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}Kt(e,t,r){if(!this.jt(e))return;const i=this.Qt(e);this.Xt(e,t)?i.Ct(t,1):i.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),r&&(this.$t=this.$t.insert(t,r))}removeTarget(e){this.Ft.delete(e)}Jt(e){const t=this.Qt(e).St();return this.Ot.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let t=this.Ft.get(e);return t||(t=new Eu,this.Ft.set(e,t)),t}Zt(e){let t=this.Bt.get(e);return t||(t=new Be(Se),this.Bt=this.Bt.insert(e,t)),t}jt(e){const t=null!==this.Ht(e);return t||Z("WatchChangeAggregator","Detected inactive target",e),t}Ht(e){const t=this.Ft.get(e);return t&&t.Pt?null:this.Ot.te(e)}Wt(e){this.Ft.set(e,new Eu),this.Ot.getRemoteKeysForTarget(e).forEach(t=>{this.Kt(e,t,null)})}Xt(e,t){return this.Ot.getRemoteKeysForTarget(e).has(t)}}function dl(){return new _t(ee.comparator)}function Lr(){return new _t(ee.comparator)}const fa={asc:"ASCENDING",desc:"DESCENDING"},fl={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class pl{constructor(e,t){this.databaseId=e,this.dt=t}}function pa(n,e){return n.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Tu(n,e){return n.dt?e.toBase64():e.toUint8Array()}function Ih(n,e){return pa(n,e.toTimestamp())}function jt(n){return ve(!!n),be.fromTimestamp(function(e){const t=si(e);return new We(t.seconds,t.nanos)}(n))}function uc(n,e){return(t=n,new Fe(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function gl(n){const e=Fe.fromString(n);return ve(bu(e)),e}function c(n,e){return uc(n.databaseId,e.path)}function s(n,e){const t=gl(e);if(t.get(1)!==n.databaseId.projectId)throw new K(L.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new K(L.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ee(_(t))}function a(n,e){return uc(n.databaseId,e)}function l(n){const e=gl(n);return 4===e.length?Fe.emptyPath():_(e)}function g(n){return new Fe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function _(n){return ve(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function C(n,e,t){return{name:c(n,e),fields:t.value.mapValue.fields}}function F(n,e,t){const r=s(n,e.name),i=jt(e.updateTime),o=new $t({mapValue:{fields:e.fields}}),u=Je.newFoundDocument(r,i,o);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function _e(n,e){let t;if(e instanceof lo)t={update:C(n,e.key,e.value)};else if(e instanceof ho)t={delete:c(n,e.key)};else if(e instanceof Nn)t={update:C(n,e.key,e.data),updateMask:wh(e.fieldMask)};else{if(!(e instanceof nc))return ne();t={verify:c(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const u=o.transform;if(u instanceof uo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof ys)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Ri)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof co)return{fieldPath:o.field.canonicalString(),increment:u._t};throw ne()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:Ih(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:ne()),t;var i}function pe(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?ct.updateTime(jt(i.updateTime)):void 0!==i.exists?ct.exists(i.exists):ct.none():ct.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,u){let h=null;"setToServerValue"in u?(ve("REQUEST_TIME"===u.setToServerValue),h=new uo):"appendMissingElements"in u?h=new ys(u.appendMissingElements.values||[]):"removeAllFromArray"in u?h=new Ri(u.removeAllFromArray.values||[]):"increment"in u?h=new co(o,u.increment):ne();const f=mt.fromServerFormat(u.fieldPath);return new _s(f,h)}(n,i)):[];var i;if(e.update){const i=s(n,e.update.name),o=new $t({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=new ln((e.updateMask.fieldPaths||[]).map(m=>mt.fromServerFormat(m)));return new Nn(i,o,u,t,r)}return new lo(i,o,t,r)}if(e.delete){const i=s(n,e.delete);return new ho(i,t)}if(e.verify){const i=s(n,e.verify);return new nc(i,t)}return ne()}function Wn(n,e){return{documents:[a(n,e.path)]}}function ga(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=a(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=a(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(f){if(0===f.length)return;const m=f.map(v=>function(T){if("=="===T.op){if(gs(T.value))return{unaryFilter:{field:Is(T.field),op:"IS_NAN"}};if(iu(T.value))return{unaryFilter:{field:Is(T.field),op:"IS_NULL"}}}else if("!="===T.op){if(gs(T.value))return{unaryFilter:{field:Is(T.field),op:"IS_NOT_NAN"}};if(iu(T.value))return{unaryFilter:{field:Is(T.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Is(T.field),op:dc(T.op),value:T.value}}}(v));return 1===m.length?m[0]:{compositeFilter:{op:"AND",filters:m}}}(e.filters);i&&(t.structuredQuery.where=i);const o=function(f){if(0!==f.length)return f.map(m=>{return{field:Is((v=m).field),direction:ml(v.dir)};var v})}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const u=(m=e.limit,n.dt||y(m)?m:{value:m});var m,h,f;return null!==u&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(t.structuredQuery.endAt={before:!(f=e.endAt).inclusive,values:f.position}),t}function cc(n){let e=l(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){ve(1===r);const v=t.from[0];v.allDescendants?i=v.collectionId:e=e.child(v.collectionId)}let o=[];t.where&&(o=hc(t.where));let u=[];t.orderBy&&(u=t.orderBy.map(v=>{return new Di(ws((T=v).field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction));var T}));let h=null;t.limit&&(h=function(v){let T;return T="object"==typeof v?v.value:v,y(T)?null:T}(t.limit));let f=null;var v;t.startAt&&(f=new ki((v=t.startAt).values||[],!!v.before));let m=null;return t.endAt&&(m=function(v){return new ki(v.values||[],!v.before)}(t.endAt)),Yc(e,i,u,o,h,"F",f,m)}function hc(n){return n?void 0!==n.unaryFilter?[yl(n)]:void 0!==n.fieldFilter?[fc(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>hc(e)).reduce((e,t)=>e.concat(t)):ne():[]}function ml(n){return fa[n]}function dc(n){return fl[n]}function Is(n){return{fieldPath:n.canonicalString()}}function ws(n){return mt.fromServerFormat(n.fieldPath)}function fc(n){return Wt.create(ws(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ne()}}(n.fieldFilter.op),n.fieldFilter.value)}function yl(n){switch(n.unaryFilter.op){case"IS_NAN":const e=ws(n.unaryFilter.field);return Wt.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=ws(n.unaryFilter.field);return Wt.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=ws(n.unaryFilter.field);return Wt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ws(n.unaryFilter.field);return Wt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ne()}}function wh(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function bu(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function dn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=xf(e)),e=gm(n.get(t),e);return xf(e)}function gm(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const o=n.charAt(i);switch(o){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=o}}return t}function xf(n){return n+"\x01\x01"}function Mi(n){const e=n.length;if(ve(e>=2),2===e)return ve("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Fe.emptyPath();const t=e-2,r=[];let i="";for(let o=0;o<e;){const u=n.indexOf("\x01",o);switch((u<0||u>t)&&ne(),n.charAt(u+1)){case"\x01":const h=n.substring(o,u);let f;0===i.length?f=h:(i+=h,f=i,i=""),r.push(f);break;case"\x10":i+=n.substring(o,u),i+="\0";break;case"\x11":i+=n.substring(o,u+1);break;default:ne()}o=u+2}return new Fe(r)}const Cf=["userId","batchId"];function _l(n,e){return[n,dn(e)]}function kf(n,e,t){return[n,dn(e),t]}const mm={},ym=["prefixPath","collectionGroup","readTime","documentId"],_m=["prefixPath","collectionGroup","documentId"],vm=["collectionGroup","readTime","prefixPath","documentId"],Im=["canonicalId","targetId"],wm=["targetId","path"],Em=["path","targetId"],Tm=["collectionId","parent"],bm=["indexId","uid"],Am=["uid","sequenceNumber"],Sm=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],xm=["indexId","uid","orderedDocumentKey"],Cm=["userId","collectionPath","documentId"],km=["userId","collectionPath","largestBatchId"],Dm=["userId","collectionGroup","largestBatchId"],Df=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Nm=[...Df,"documentOverlays"],Nf=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Rf=Nf,Rm=[...Rf,"indexConfiguration","indexState","indexEntries"];class Eh extends nu{constructor(e,t){super(),this.ee=e,this.currentSequenceNumber=t}}function Xt(n,e){const t=X(n);return cn.N(t.ee,e)}class Th{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&al(o,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ca(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ca(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Iu();return this.mutations.forEach(i=>{const o=e.get(i.key),u=o.overlayedDocument;let h=this.applyToLocalView(u,o.mutatedFields);h=t.has(i.key)?null:h;const f=ol(u,h);null!==f&&r.set(i.key,f),u.isValidDocument()||u.convertToNoDocument(be.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),De())}isEqual(e){return this.batchId===e.batchId&&ni(this.mutations,e.mutations,(t,r)=>ul(t,r))&&ni(this.baseMutations,e.baseMutations,(t,r)=>ul(t,r))}}class bh{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ve(e.mutations.length===r.length);let i=vh;const o=e.mutations;for(let u=0;u<o.length;u++)i=i.insert(o[u].key,r[u].version);return new bh(e,t,r,i)}}class Ah{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class fo{constructor(e,t,r,i,o=be.min(),u=be.min(),h=vt.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h}withSequenceNumber(e){return new fo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new fo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new fo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Of{constructor(e){this.ne=e}}function Pf(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:vl(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:c(i=n.ne,(o=e).key),fields:o.data.value.mapValue.fields,updateTime:pa(i,o.version.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:ma(e.version)};else{if(!e.isUnknownDocument())return ne();r.unknownDocument={path:t.path.toArray(),version:ma(e.version)}}var i,o;return r}function vl(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ma(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ya(n){const e=new We(n.seconds,n.nanoseconds);return be.fromTimestamp(e)}function _a(n,e){const t=(e.baseMutations||[]).map(o=>pe(n.ne,o));for(let o=0;o<e.mutations.length-1;++o){const u=e.mutations[o];o+1<e.mutations.length&&void 0!==e.mutations[o+1].transform&&(u.updateTransforms=e.mutations[o+1].transform.fieldTransforms,e.mutations.splice(o+1,1),++o)}const r=e.mutations.map(o=>pe(n.ne,o)),i=We.fromMillis(e.localWriteTimeMs);return new Th(e.batchId,i,t,r)}function pc(n){const e=ya(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?ya(n.lastLimboFreeSnapshotVersion):be.min();let r;var i;return void 0!==n.query.documents?(ve(1===(i=n.query).documents.length),r=gn(Ni(l(i.documents[0])))):r=gn(cc(n.query)),new fo(r,n.targetId,0,n.lastListenSequenceNumber,e,t,vt.fromBase64String(n.resumeToken))}function Mf(n,e){const t=ma(e.snapshotVersion),r=ma(e.lastLimboFreeSnapshotVersion);let i;i=ou(e.target)?Wn(n.ne,e.target):ga(n.ne,e.target);const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ms(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Sh(n){const e=cc({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Ju(e,e.limit,"L"):e}function xh(n,e){return new Ah(e.largestBatchId,pe(n.ne,e.overlayMutation))}function Lf(n,e){const t=e.path.lastSegment();return[n,dn(e.path.popLast()),t]}function Ff(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:ma(r.readTime),documentKey:dn(r.documentKey.path),largestBatchId:r.largestBatchId}}class Pm{getBundleMetadata(e,t){return Uf(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:ya(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return Uf(e).put({bundleId:(r=t).id,createTime:ma(jt(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return Vf(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:Sh(i.bundledQuery),readTime:ya(i.readTime)};var i})}saveNamedQuery(e,t){return Vf(e).put({name:(r=t).name,readTime:ma(jt(r.readTime)),bundledQuery:r.bundledQuery});var r}}function Uf(n){return Xt(n,"bundles")}function Vf(n){return Xt(n,"namedQueries")}class Il{constructor(e,t){this.wt=e,this.userId=t}static se(e,t){return new Il(e,t.uid||"")}getOverlay(e,t){return gc(e).get(Lf(this.userId,t)).next(r=>r?xh(this.wt,r):null)}getOverlays(e,t){const r=Mr();return P.forEach(t,i=>this.getOverlay(e,i).next(o=>{null!==o&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((o,u)=>{const h=new Ah(t,u);i.push(this.ie(e,h))}),P.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(u=>i.add(dn(u.getCollectionPath())));const o=[];return i.forEach(u=>{const h=IDBKeyRange.bound([this.userId,u,r],[this.userId,u,r+1],!1,!0);o.push(gc(e).W("collectionPathOverlayIndex",h))}),P.waitFor(o)}getOverlaysForCollection(e,t,r){const i=Mr(),o=dn(t),u=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return gc(e).K("collectionPathOverlayIndex",u).next(h=>{for(const f of h){const m=xh(this.wt,f);i.set(m.getKey(),m)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const o=Mr();let u;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return gc(e).J({index:"collectionGroupOverlayIndex",range:h},(f,m,v)=>{const T=xh(this.wt,m);o.size()<i||T.largestBatchId===u?(o.set(T.getKey(),T),u=T.largestBatchId):v.done()}).next(()=>o)}ie(e,t){return gc(e).put(function(r,i,o){const[u,h,f]=Lf(i,o.mutation.key);return{userId:i,collectionPath:h,documentId:f,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:_e(r.ne,o.mutation)}}(this.wt,this.userId,t))}}function gc(n){return Xt(n,"documentOverlays")}class va{constructor(){}re(e,t){this.oe(e,t),t.ue()}oe(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(ht(e.integerValue));else if("doubleValue"in e){const r=ht(e.doubleValue);isNaN(r)?this.ce(t,13):(this.ce(t,15),w(r)?t.ae(0):t.ae(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he(`${r.seconds||""}`),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(hr(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.ce(t,45),t.ae(r.latitude||0),t.ae(r.longitude||0)}else"mapValue"in e?oi(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):ne()}le(e,t){this.ce(t,25),this.ge(e,t)}ge(e,t){t.he(e)}we(e,t){const r=e.fields||{};this.ce(t,55);for(const i of Object.keys(r))this.le(i,t),this.oe(r[i],t)}me(e,t){const r=e.values||[];this.ce(t,50);for(const i of r)this.oe(i,t)}_e(e,t){this.ce(t,37),ee.fromName(e).path.forEach(r=>{this.ce(t,60),this.ge(r,t)})}ce(e,t){e.ae(t)}fe(e){e.ae(2)}}function Mm(n){if(0===n)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function Bf(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const o=Mm(255&t[i]);if(r+=o,8!==o)break}return r}(n);return Math.ceil(e/8)}va.ye=new va;class Lm{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ie(r.value),r=t.next();this.Te()}Ee(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ae(r.value),r=t.next();this.Re()}be(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ie(r);else if(r<2048)this.Ie(960|r>>>6),this.Ie(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ie(480|r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r);else{const i=t.codePointAt(0);this.Ie(240|i>>>18),this.Ie(128|63&i>>>12),this.Ie(128|63&i>>>6),this.Ie(128|63&i)}}this.Te()}Pe(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const i=t.codePointAt(0);this.Ae(240|i>>>18),this.Ae(128|63&i>>>12),this.Ae(128|63&i>>>6),this.Ae(128|63&i)}}this.Re()}ve(e){const t=this.Ve(e),r=Bf(t);this.Se(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}De(e){const t=this.Ve(e),r=Bf(t);this.Se(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Me(){return this.buffer.slice(0,this.position)}Ve(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ie(e){const t=255&e;0===t?(this.xe(0),this.xe(255)):255===t?(this.xe(255),this.xe(0)):this.xe(t)}Ae(e){const t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Fm{constructor(e){this.Oe=e}de(e){this.Oe.pe(e)}he(e){this.Oe.be(e)}ae(e){this.Oe.ve(e)}ue(){this.Oe.Ce()}}class Um{constructor(e){this.Oe=e}de(e){this.Oe.Ee(e)}he(e){this.Oe.Pe(e)}ae(e){this.Oe.De(e)}ue(){this.Oe.Ne()}}class mc{constructor(){this.Oe=new Lm,this.Fe=new Fm(this.Oe),this.$e=new Um(this.Oe)}seed(e){this.Oe.seed(e)}Be(e){return 0===e?this.Fe:this.$e}Me(){return this.Oe.Me()}reset(){this.Oe.reset()}}class Ia{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Le(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ia(this.indexId,this.documentKey,this.arrayValue,r)}}function wa(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=$f(n.arrayValue,e.arrayValue),0!==t?t:(t=$f(n.directionalValue,e.directionalValue),0!==t?t:ee.comparator(n.documentKey,e.documentKey)))}function $f(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class Vm{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const t of e.filters){const r=t;r.ht()?this.Ke=r:this.qe.push(r)}}Ge(e){const t=tu(e);if(void 0!==t&&!this.Qe(t))return!1;const r=Ti(e);let i=0,o=0;for(;i<r.length&&this.Qe(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.Ke){const u=r[i];if(!this.je(this.Ke,u)||!this.We(this.Ue[o++],u))return!1;++i}for(;i<r.length;++i){const u=r[i];if(o>=this.Ue.length||!this.We(this.Ue[o++],u))return!1}return!0}Qe(e){for(const t of this.qe)if(this.je(t,e))return!0;return!1}je(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}We(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class Bm{constructor(){this.ze=new Ch}addToCollectionParentIndex(e,t){return this.ze.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.ze.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(Vt.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(Vt.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}}class Ch{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Be(Fe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Be(Fe.comparator)).toArray()}}const wl=new Uint8Array(0);class $m{constructor(e,t){this.user=e,this.databaseId=t,this.He=new Ch,this.Je=new Oi(r=>ms(r),(r,i)=>aa(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.He.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.He.add(t)});const o={collectionId:r,parent:dn(i)};return jf(e).put(o)}return P.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[qn(t),""],!1,!0);return jf(e).K(i).next(o=>{for(const u of o){if(u.collectionId!==t)break;r.push(Mi(u.parent))}return r})}addFieldIndex(e,t){const r=El(e),i={indexId:(u=t).indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])};var u;delete i.indexId;const o=r.add(i);if(t.indexState){const u=_c(e);return o.next(h=>{u.put(Ff(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){const r=El(e),i=_c(e),o=yc(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=yc(e);let i=!0;const o=new Map;return P.forEach(this.Ye(t),u=>this.Xe(e,u).next(h=>{i&&(i=!!h),o.set(u,h)})).next(()=>{if(i){let u=De();const h=[];return P.forEach(o,(f,m)=>{var v;Z("IndexedDbIndexManager",`Using index ${v=f,`id=${v.indexId}|cg=${v.collectionGroup}|f=${v.fields.map(Ke=>`${Ke.fieldPath}:${Ke.kind}`).join(",")}`} to execute ${ms(t)}`);const T=function(Ke,Re){const Oe=tu(Re);if(void 0===Oe)return null;for(const Ve of au(Ke,Oe.fieldPath))switch(Ve.op){case"array-contains-any":return Ve.value.arrayValue.values||[];case"array-contains":return[Ve.value]}return null}(m,f),O=function(Ke,Re){const Oe=new Map;for(const Ve of Ti(Re))for(const Ht of au(Ke,Ve.fieldPath))switch(Ht.op){case"==":case"in":Oe.set(Ve.fieldPath.canonicalString(),Ht.value);break;case"not-in":case"!=":return Oe.set(Ve.fieldPath.canonicalString(),Ht.value),Array.from(Oe.values())}return null}(m,f),U=function(Ke,Re){const Oe=[];let Ve=!0;for(const Ht of Ti(Re)){const Mc=0===Ht.kind?Zc(Ke,Ht.fieldPath,Ke.startAt):uu(Ke,Ht.fieldPath,Ke.startAt);Oe.push(Mc.value),Ve&&(Ve=Mc.inclusive)}return new ki(Oe,Ve)}(m,f),B=function(Ke,Re){const Oe=[];let Ve=!0;for(const Ht of Ti(Re)){const Mc=0===Ht.kind?uu(Ke,Ht.fieldPath,Ke.endAt):Zc(Ke,Ht.fieldPath,Ke.endAt);Oe.push(Mc.value),Ve&&(Ve=Mc.inclusive)}return new ki(Oe,Ve)}(m,f),Y=this.Ze(f,m,U),oe=this.Ze(f,m,B),Me=this.tn(f,m,O),Qe=this.en(f.indexId,T,Y,U.inclusive,oe,B.inclusive,Me);return P.forEach(Qe,Ke=>r.j(Ke,t.limit).next(Re=>{Re.forEach(Oe=>{const Ve=ee.fromSegments(Oe.documentKey);u.has(Ve)||(u=u.add(Ve),h.push(Ve))})}))}).next(()=>h)}return P.resolve(null)})}Ye(e){let t=this.Je.get(e);return t||(t=[e],this.Je.set(e,t),t)}en(e,t,r,i,o,u,h){const f=(null!=t?t.length:1)*Math.max(r.length,o.length),m=f/(null!=t?t.length:1),v=[];for(let T=0;T<f;++T){const O=t?this.nn(t[T/m]):wl,U=this.sn(e,O,r[T%m],i),B=this.rn(e,O,o[T%m],u),Y=h.map(oe=>this.sn(e,O,oe,!0));v.push(...this.createRange(U,B,Y))}return v}sn(e,t,r,i){const o=new Ia(e,ee.empty(),t,r);return i?o:o.Le()}rn(e,t,r,i){const o=new Ia(e,ee.empty(),t,r);return i?o.Le():o}Xe(e,t){const r=new Vm(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let u=null;for(const h of o)r.Ge(h)&&(!u||h.fields.length>u.fields.length)&&(u=h);return u})}getIndexType(e,t){let r=2;return P.forEach(this.Ye(t),i=>this.Xe(e,i).next(o=>{o?0!==r&&o.fields.length<function(u){let h=new Be(mt.comparator),f=!1;for(const m of u.filters){const v=m;v.field.isKeyField()||("array-contains"===v.op||"array-contains-any"===v.op?f=!0:h=h.add(v.field))}for(const m of u.orderBy)m.field.isKeyField()||(h=h.add(m.field));return h.size+(f?1:0)}(i)&&(r=1):r=0})).next(()=>r)}on(e,t){const r=new mc;for(const i of Ti(e)){const o=t.data.field(i.fieldPath);if(null==o)return null;const u=r.Be(i.kind);va.ye.re(o,u)}return r.Me()}nn(e){const t=new mc;return va.ye.re(e,t.Be(0)),t.Me()}un(e,t){const r=new mc;return va.ye.re(Cn(this.databaseId,t),r.Be(function(i){const o=Ti(i);return 0===o.length?0:o[o.length-1].kind}(e))),r.Me()}tn(e,t,r){if(null===r)return[];let i=[];i.push(new mc);let o=0;for(const u of Ti(e)){const h=r[o++];for(const f of i)if(this.cn(t,u.fieldPath)&&kn(h))i=this.an(i,u,h);else{const m=f.Be(u.kind);va.ye.re(h,m)}}return this.hn(i)}Ze(e,t,r){return this.tn(e,t,r.position)}hn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Me();return t}an(e,t,r){const i=[...e],o=[];for(const u of r.arrayValue.values||[])for(const h of i){const f=new mc;f.seed(h.Me()),va.ye.re(u,f.Be(t.kind)),o.push(f)}return o}cn(e,t){return!!e.filters.find(r=>r instanceof Wt&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=El(e),i=_c(e);return(t?r.K("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.K()).next(o=>{const u=[];return P.forEach(o,h=>i.get([h.indexId,this.uid]).next(f=>{u.push(function(m,v){const T=v?new fs(v.sequenceNumber,new Vt(ya(v.readTime),new ee(Mi(v.documentKey)),v.largestBatchId)):fs.empty(),O=m.fields.map(([U,B])=>new ea(mt.fromServerFormat(U),B));return new Ei(m.indexId,m.collectionGroup,O,T)}(h,f))})).next(()=>u)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==o?o:Se(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=El(e),o=_c(e);return this.ln(e).next(u=>i.K("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>P.forEach(h,f=>o.put(Ff(f.indexId,this.user,u,r)))))}updateIndexEntries(e,t){const r=new Map;return P.forEach(t,(i,o)=>{const u=r.get(i.collectionGroup);return(u?P.resolve(u):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),P.forEach(h,f=>this.fn(e,i,f).next(m=>{const v=this.dn(o,f);return m.isEqual(v)?P.resolve():this._n(e,o,f,m,v)}))))})}wn(e,t,r,i){return yc(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.un(r,t.key),documentKey:t.key.path.toArray()})}mn(e,t,r,i){return yc(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.un(r,t.key),t.key.path.toArray()])}fn(e,t,r){const i=yc(e);let o=new Be(wa);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.un(r,t)])},(u,h)=>{o=o.add(new Ia(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>o)}dn(e,t){let r=new Be(wa);const i=this.on(t,e);if(null==i)return r;const o=tu(t);if(null!=o){const u=e.data.field(o.fieldPath);if(kn(u))for(const h of u.arrayValue.values||[])r=r.add(new Ia(t.indexId,e.key,this.nn(h),i))}else r=r.add(new Ia(t.indexId,e.key,wl,i));return r}_n(e,t,r,i,o){Z("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const u=[];return function(h,f,m,v,T){const O=h.getIterator(),U=f.getIterator();let B=Ci(O),Y=Ci(U);for(;B||Y;){let oe=!1,Me=!1;if(B&&Y){const Qe=m(B,Y);Qe<0?Me=!0:Qe>0&&(oe=!0)}else null!=B?Me=!0:oe=!0;oe?(v(Y),Y=Ci(U)):Me?(T(B),B=Ci(O)):(B=Ci(O),Y=Ci(U))}}(i,o,wa,h=>{u.push(this.wn(e,t,r,h))},h=>{u.push(this.mn(e,t,r,h))}),P.waitFor(u)}ln(e){let t=1;return _c(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((u,h)=>wa(u,h)).filter((u,h,f)=>!h||0!==wa(u,f[h-1]));const i=[];i.push(e);for(const u of r){const h=wa(u,e),f=wa(u,t);if(0===h)i[0]=e.Le();else if(h>0&&f<0)i.push(u),i.push(u.Le());else if(f>0)break}i.push(t);const o=[];for(let u=0;u<i.length;u+=2)o.push(IDBKeyRange.bound([i[u].indexId,this.uid,i[u].arrayValue,i[u].directionalValue,wl,[]],[i[u+1].indexId,this.uid,i[u+1].arrayValue,i[u+1].directionalValue,wl,[]]));return o}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Gf)}getMinOffset(e,t){return P.mapArray(this.Ye(t),r=>this.Xe(e,r).next(i=>i||ne())).next(Gf)}}function jf(n){return Xt(n,"collectionParents")}function yc(n){return Xt(n,"indexEntries")}function El(n){return Xt(n,"indexConfiguration")}function _c(n){return Xt(n,"indexState")}function Gf(n){ve(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;ra(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Vt(e.readTime,e.documentKey,t)}const qf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Hn{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Hn(e,Hn.DEFAULT_COLLECTION_PERCENTILE,Hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Kf(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),o=[],u=IDBKeyRange.only(t.batchId);let h=0;const f=r.J({range:u},(v,T,O)=>(h++,O.delete()));o.push(f.next(()=>{ve(1===h)}));const m=[];for(const v of t.mutations){const T=kf(e,v.key.path,t.batchId);o.push(i.delete(T)),m.push(v.key)}return P.waitFor(o).next(()=>m)}function Tl(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ne();e=n.noDocument}return JSON.stringify(e).length}Hn.DEFAULT_COLLECTION_PERCENTILE=10,Hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Hn.DEFAULT=new Hn(41943040,Hn.DEFAULT_COLLECTION_PERCENTILE,Hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Hn.DISABLED=new Hn(-1,0,0);class bl{constructor(e,t,r,i){this.userId=e,this.wt=t,this.indexManager=r,this.referenceDelegate=i,this.gn={}}static se(e,t,r,i){ve(""!==e.uid);const o=e.isAuthenticated()?e.uid:"";return new bl(o,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return po(e).J({index:"userMutationsIndex",range:r},(i,o,u)=>{t=!1,u.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const o=Au(e),u=po(e);return u.add({}).next(h=>{ve("number"==typeof h);const f=new Th(h,t,r,i),m=function(O,U,B){const Y=B.baseMutations.map(Me=>_e(O.ne,Me)),oe=B.mutations.map(Me=>_e(O.ne,Me));return{userId:U,batchId:B.batchId,localWriteTimeMs:B.localWriteTime.toMillis(),baseMutations:Y,mutations:oe}}(this.wt,this.userId,f),v=[];let T=new Be((O,U)=>Se(O.canonicalString(),U.canonicalString()));for(const O of i){const U=kf(this.userId,O.key.path,h);T=T.add(O.key.path.popLast()),v.push(u.put(m)),v.push(o.put(U,mm))}return T.forEach(O=>{v.push(this.indexManager.addToCollectionParentIndex(e,O))}),e.addOnCommittedListener(()=>{this.gn[h]=f.keys()}),P.waitFor(v).next(()=>f)})}lookupMutationBatch(e,t){return po(e).get(t).next(r=>r?(ve(r.userId===this.userId),_a(this.wt,r)):null)}yn(e,t){return this.gn[t]?P.resolve(this.gn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.gn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return po(e).J({index:"userMutationsIndex",range:i},(u,h,f)=>{h.userId===this.userId&&(ve(h.batchId>=r),o=_a(this.wt,h)),f.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return po(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,o,u)=>{r=o.batchId,u.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return po(e).K("userMutationsIndex",t).next(r=>r.map(i=>_a(this.wt,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=_l(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Au(e).J({range:i},(u,h,f)=>{const[m,v,T]=u,O=Mi(v);if(m===this.userId&&t.path.isEqual(O))return po(e).get(T).next(U=>{if(!U)throw ne();ve(U.userId===this.userId),o.push(_a(this.wt,U))});f.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Be(Se);const i=[];return t.forEach(o=>{const u=_l(this.userId,o.path),h=IDBKeyRange.lowerBound(u),f=Au(e).J({range:h},(m,v,T)=>{const[O,U,B]=m,Y=Mi(U);O===this.userId&&o.path.isEqual(Y)?r=r.add(B):T.done()});i.push(f)}),P.waitFor(i).next(()=>this.pn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,o=_l(this.userId,r),u=IDBKeyRange.lowerBound(o);let h=new Be(Se);return Au(e).J({range:u},(f,m,v)=>{const[T,O,U]=f,B=Mi(O);T===this.userId&&r.isPrefixOf(B)?B.length===i&&(h=h.add(U)):v.done()}).next(()=>this.pn(e,h))}pn(e,t){const r=[],i=[];return t.forEach(o=>{i.push(po(e).get(o).next(u=>{if(null===u)throw ne();ve(u.userId===this.userId),r.push(_a(this.wt,u))}))}),P.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return Kf(e.ee,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.In(t.batchId)}),P.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return P.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Au(e).J({range:r},(o,u,h)=>{if(o[0]===this.userId){const f=Mi(o[1]);i.push(f)}else h.done()}).next(()=>{ve(0===i.length)})})}containsKey(e,t){return zf(e,this.userId,t)}Tn(e){return Zf(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function zf(n,e,t){const r=_l(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r);let u=!1;return Au(n).J({range:o,H:!0},(h,f,m)=>{const[v,T,O]=h;v===e&&T===i&&(u=!0),m.done()}).next(()=>u)}function po(n){return Xt(n,"mutations")}function Au(n){return Xt(n,"documentMutations")}function Zf(n){return Xt(n,"mutationQueues")}class Ea{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new Ea(0)}static Rn(){return new Ea(-1)}}class jm{constructor(e,t){this.referenceDelegate=e,this.wt=t}allocateTargetId(e){return this.bn(e).next(t=>{const r=new Ea(t.highestTargetId);return t.highestTargetId=r.next(),this.Pn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(t=>be.fromTimestamp(new We(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Pn(e,i)))}addTargetData(e,t){return this.vn(e,t).next(()=>this.bn(e).next(r=>(r.targetCount+=1,this.Vn(t,r),this.Pn(e,r))))}updateTargetData(e,t){return this.vn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Su(e).delete(t.targetId)).next(()=>this.bn(e)).next(r=>(ve(r.targetCount>0),r.targetCount-=1,this.Pn(e,r)))}removeTargets(e,t,r){let i=0;const o=[];return Su(e).J((u,h)=>{const f=pc(h);f.sequenceNumber<=t&&null===r.get(f.targetId)&&(i++,o.push(this.removeTargetData(e,f)))}).next(()=>P.waitFor(o)).next(()=>i)}forEachTarget(e,t){return Su(e).J((r,i)=>{const o=pc(i);t(o)})}bn(e){return Wf(e).get("targetGlobalKey").next(t=>(ve(null!==t),t))}Pn(e,t){return Wf(e).put("targetGlobalKey",t)}vn(e,t){return Su(e).put(Mf(this.wt,t))}Vn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=ms(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return Su(e).J({range:i,index:"queryTargetsIndex"},(u,h,f)=>{const m=pc(h);aa(t,m.target)&&(o=m,f.done())}).next(()=>o)}addMatchingKeys(e,t,r){const i=[],o=go(e);return t.forEach(u=>{const h=dn(u.path);i.push(o.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,u))}),P.waitFor(i)}removeMatchingKeys(e,t,r){const i=go(e);return P.forEach(t,o=>{const u=dn(o.path);return P.waitFor([i.delete([r,u]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){const r=go(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=go(e);let o=De();return i.J({range:r,H:!0},(u,h,f)=>{const m=Mi(u[1]),v=new ee(m);o=o.add(v)}).next(()=>o)}containsKey(e,t){const r=dn(t.path),i=IDBKeyRange.bound([r],[qn(r)],!1,!0);let o=0;return go(e).J({index:"documentTargetsIndex",H:!0,range:i},([u,h],f,m)=>{0!==u&&(o++,m.done())}).next(()=>o>0)}te(e,t){return Su(e).get(t).next(r=>r?pc(r):null)}}function Su(n){return Xt(n,"targets")}function Wf(n){return Xt(n,"targetGlobal")}function go(n){return Xt(n,"targetDocuments")}function Hf([n,e],[t,r]){const i=Se(n,t);return 0===i?Se(e,r):i}class Gm{constructor(e){this.Sn=e,this.buffer=new Be(Hf),this.Dn=0}Cn(){return++this.Dn}xn(e){const t=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Hf(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class qm{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Nn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return null!==this.Nn}kn(e){var t=this;Z("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,R.Z)(function*(){t.Nn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){zn(r)?Z("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Kn(r)}yield t.kn(3e5)}))}}class Km{constructor(e,t){this.Mn=e,this.params=t}calculateTargetCount(e,t){return this.Mn.On(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return P.resolve(Bt.ot);const r=new Gm(t);return this.Mn.forEachTarget(e,i=>r.xn(i.sequenceNumber)).next(()=>this.Mn.Fn(e,i=>r.xn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Mn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Mn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(qf)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qf):this.$n(e,t))}getCacheSize(e){return this.Mn.getCacheSize(e)}$n(e,t){let r,i,o,u,h,f,m;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(T=>(T>this.params.maximumSequenceNumbersToCollect?(Z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),i=this.params.maximumSequenceNumbersToCollect):i=T,u=Date.now(),this.nthSequenceNumber(e,i))).next(T=>(r=T,h=Date.now(),this.removeTargets(e,r,t))).next(T=>(o=T,f=Date.now(),this.removeOrphanedDocuments(e,r))).next(T=>(m=Date.now(),Qo()<=xe.in.DEBUG&&Z("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${u-v}ms\n\tDetermined least recently used ${i} in `+(h-u)+`ms\n\tRemoved ${o} targets in `+(f-h)+`ms\n\tRemoved ${T} documents in `+(m-f)+`ms\nTotal Duration: ${m-v}ms`),P.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:T})))}}class zm{constructor(e,t){this.db=e,this.garbageCollector=new Km(this,t)}On(e){const t=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Bn(e){let t=0;return this.Fn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Fn(e,t){return this.Ln(e,(r,i)=>t(i))}addReference(e,t,r){return Al(e,r)}removeReference(e,t,r){return Al(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Al(e,t)}Un(e,t){return function(r,i){let o=!1;return Zf(r).Y(u=>zf(r,u,i).next(h=>(h&&(o=!0),P.resolve(!h)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.Ln(e,(u,h)=>{if(h<=t){const f=this.Un(e,u).next(m=>{if(!m)return o++,r.getEntry(e,u).next(()=>(r.removeEntry(u,be.min()),go(e).delete([0,dn(u.path)])))});i.push(f)}}).next(()=>P.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Al(e,t)}Ln(e,t){const r=go(e);let i,o=Bt.ot;return r.J({index:"documentTargetsIndex"},([u,h],{path:f,sequenceNumber:m})=>{0===u?(o!==Bt.ot&&t(new ee(Mi(i)),o),o=m,i=f):o=Bt.ot}).next(()=>{o!==Bt.ot&&t(new ee(Mi(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Al(n,e){return go(n).put((r=n.currentSequenceNumber,{targetId:0,path:dn(e.path),sequenceNumber:r}));var r}class Qf{constructor(){this.changes=new Oi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Je.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Zm{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Ta(e).put(r)}removeEntry(e,t,r){return Ta(e).delete(function(i,o){const u=i.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],vl(o),u[u.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.qn(e,r)))}getEntry(e,t){let r=Je.newInvalidDocument(t);return Ta(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(vc(t))},(i,o)=>{r=this.Kn(t,o)}).next(()=>r)}Gn(e,t){let r={size:0,document:Je.newInvalidDocument(t)};return Ta(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(vc(t))},(i,o)=>{r={document:this.Kn(t,o),size:Tl(o)}}).next(()=>r)}getEntries(e,t){let r=mn();return this.Qn(e,t,(i,o)=>{const u=this.Kn(i,o);r=r.insert(i,u)}).next(()=>r)}jn(e,t){let r=mn(),i=new _t(ee.comparator);return this.Qn(e,t,(o,u)=>{const h=this.Kn(o,u);r=r.insert(o,h),i=i.insert(o,Tl(u))}).next(()=>({documents:r,Wn:i}))}Qn(e,t,r){if(t.isEmpty())return P.resolve();let i=new Be(ep);t.forEach(f=>i=i.add(f));const o=IDBKeyRange.bound(vc(i.first()),vc(i.last())),u=i.getIterator();let h=u.getNext();return Ta(e).J({index:"documentKeyIndex",range:o},(f,m,v)=>{const T=ee.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;h&&ep(h,T)<0;)r(h,null),h=u.getNext();h&&h.isEqual(T)&&(r(h,m),h=u.hasNext()?u.getNext():null),h?v.q(vc(h)):v.done()}).next(()=>{for(;h;)r(h,null),h=u.hasNext()?u.getNext():null})}getAllFromCollection(e,t,r){const i=[t.popLast().toArray(),t.lastSegment(),vl(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],o=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ta(e).K(IDBKeyRange.bound(i,o,!0)).next(u=>{let h=mn();for(const f of u){const m=this.Kn(ee.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);h=h.insert(m.key,m)}return h})}getAllFromCollectionGroup(e,t,r,i){let o=mn();const u=Xf(t,r),h=Xf(t,Vt.max());return Ta(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(u,h,!0)},(f,m,v)=>{const T=this.Kn(ee.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);o=o.insert(T.key,T),o.size===i&&v.done()}).next(()=>o)}newChangeBuffer(e){return new Wm(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Jf(e).get("remoteDocumentGlobalKey").next(t=>(ve(!!t),t))}qn(e,t){return Jf(e).put("remoteDocumentGlobalKey",t)}Kn(e,t){if(t){const r=function Om(n,e){let t;if(e.document)t=F(n.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ee.fromSegments(e.noDocument.path),i=ya(e.noDocument.readTime);t=Je.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ne();{const r=ee.fromSegments(e.unknownDocument.path),i=ya(e.unknownDocument.version);t=Je.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new We(r[0],r[1]);return be.fromTimestamp(i)}(e.readTime)),t}(this.wt,t);if(!r.isNoDocument()||!r.version.isEqual(be.min()))return r}return Je.newInvalidDocument(e)}}function Yf(n){return new Zm(n)}class Wm extends Qf{constructor(e,t){super(),this.zn=e,this.trackRemovals=t,this.Hn=new Oi(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Be((o,u)=>Se(o.canonicalString(),u.canonicalString()));return this.changes.forEach((o,u)=>{const h=this.Hn.get(o);if(t.push(this.zn.removeEntry(e,o,h.readTime)),u.isValidDocument()){const f=Pf(this.zn.wt,u);i=i.add(o.path.popLast()),r+=Tl(f)-h.size,t.push(this.zn.addEntry(e,o,f))}else if(r-=h.size,this.trackRemovals){const f=Pf(this.zn.wt,u.convertToNoDocument(be.min()));t.push(this.zn.addEntry(e,o,f))}}),i.forEach(o=>{t.push(this.zn.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.zn.updateMetadata(e,r)),P.waitFor(t)}getFromCache(e,t){return this.zn.Gn(e,t).next(r=>(this.Hn.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.zn.jn(e,t).next(({documents:r,Wn:i})=>(i.forEach((o,u)=>{this.Hn.set(o,{size:u,readTime:r.get(o).readTime})}),r))}}function Jf(n){return Xt(n,"remoteDocumentGlobal")}function Ta(n){return Xt(n,"remoteDocumentsV14")}function vc(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Xf(n,e){const t=e.documentKey.path.toArray();return[n,vl(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function ep(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=Se(t[o],r[o]),i)return i;return i=Se(t.length,r.length),i||(i=Se(t[t.length-2],r[r.length-2]),i||Se(t[t.length-1],r[r.length-1]))}class Hm{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class tp{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.getBaseDocument(e,t,r))).next(i=>(null!==r&&ca(r.mutation,i,ln.empty(),We.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,De()).next(()=>r))}getLocalViewOfDocuments(e,t,r=De()){const i=Mr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let u=ai();return o.forEach((h,f)=>{u=u.insert(h,f.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){const r=Mr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,De()))}populateOverlays(e,t,r){const i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((u,h)=>{t.set(u,h)})})}computeViews(e,t,r,i){let o=mn();const u=vs(),h=vs();return t.forEach((f,m)=>{const v=r.get(m.key);i.has(m.key)&&(void 0===v||v.mutation instanceof Nn)?o=o.insert(m.key,m):void 0!==v&&(u.set(m.key,v.mutation.getFieldMask()),ca(v.mutation,m,v.mutation.getFieldMask(),We.now()))}),this.recalculateAndSaveOverlays(e,o).next(f=>(f.forEach((m,v)=>u.set(m,v)),t.forEach((m,v)=>{var T;return h.set(m,new Hm(v,null!==(T=u.get(m))&&void 0!==T?T:null))}),h))}recalculateAndSaveOverlays(e,t){const r=vs();let i=new _t((u,h)=>u-h),o=De();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(const h of u)h.keys().forEach(f=>{const m=t.get(f);if(null===m)return;let v=r.get(f)||ln.empty();v=h.applyToLocalView(m,v),r.set(f,v);const T=(i.get(h.batchId)||De()).add(f);i=i.insert(h.batchId,T)})}).next(()=>{const u=[],h=i.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),m=f.key,v=f.value,T=Iu();v.forEach(O=>{if(!o.has(O)){const U=ol(t.get(O),r.get(O));null!==U&&T.set(O,U),o=o.add(O)}}),u.push(this.documentOverlayCache.saveOverlays(e,m,T))}return P.waitFor(u)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return ee.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Yu(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{const u=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):P.resolve(Mr());let h=-1,f=o;return u.next(m=>P.forEach(m,(v,T)=>(h<T.largestBatchId&&(h=T.largestBatchId),o.get(v)?P.resolve():this.getBaseDocument(e,v,T).next(O=>{f=f.insert(v,O)}))).next(()=>this.populateOverlays(e,m,o)).next(()=>this.computeViews(e,f,m,De())).next(v=>({batchId:h,changes:sc(v)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ee(t)).next(r=>{let i=ai();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let o=ai();return this.indexManager.getCollectionParents(e,i).next(u=>P.forEach(u,h=>{const f=(m=t,v=h.child(i),new Pr(v,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt));var m,v;return this.getDocumentsMatchingCollectionQuery(e,f,r).next(m=>{m.forEach((v,T)=>{o=o.insert(v,T)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.remoteDocumentCache.getAllFromCollection(e,t.path,r).next(o=>(i=o,this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId))).next(o=>{o.forEach((h,f)=>{const m=f.getKey();null===i.get(m)&&(i=i.insert(m,Je.newInvalidDocument(m)))});let u=ai();return i.forEach((h,f)=>{const m=o.get(h);void 0!==m&&ca(m.mutation,f,ln.empty(),We.now()),ua(t,f)&&(u=u.insert(h,f))}),u})}getBaseDocument(e,t,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(e,t):P.resolve(Je.newInvalidDocument(t))}}class Qm{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,t){return P.resolve(this.Jn.get(t))}saveBundleMetadata(e,t){var r;return this.Jn.set(t.id,{id:(r=t).id,version:r.version,createTime:jt(r.createTime)}),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Yn.get(t))}saveNamedQuery(e,t){return this.Yn.set(t.name,{name:(r=t).name,query:Sh(r.bundledQuery),readTime:jt(r.readTime)}),P.resolve();var r}}class Ym{constructor(){this.overlays=new _t(ee.comparator),this.Xn=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Mr();return P.forEach(t,i=>this.getOverlay(e,i).next(o=>{null!==o&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ie(e,t,o)}),P.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Xn.get(r);return void 0!==i&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Xn.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){const i=Mr(),o=t.length+1,u=new ee(t.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const f=h.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===o&&f.largestBatchId>r&&i.set(f.getKey(),f)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new _t((m,v)=>m-v);const u=this.overlays.getIterator();for(;u.hasNext();){const m=u.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let v=o.get(m.largestBatchId);null===v&&(v=Mr(),o=o.insert(m.largestBatchId,v)),v.set(m.getKey(),m)}}const h=Mr(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((m,v)=>h.set(m,v)),!(h.size()>=i)););return P.resolve(h)}ie(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const u=this.Xn.get(i.largestBatchId).delete(r.key);this.Xn.set(i.largestBatchId,u)}this.overlays=this.overlays.insert(r.key,new Ah(t,r));let o=this.Xn.get(t);void 0===o&&(o=De(),this.Xn.set(t,o)),this.Xn.set(t,o.add(r.key))}}class kh{constructor(){this.Zn=new Be(en.ts),this.es=new Be(en.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const r=new en(e,t);this.Zn=this.Zn.add(r),this.es=this.es.add(r)}ss(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.rs(new en(e,t))}os(e,t){e.forEach(r=>this.removeReference(r,t))}us(e){const t=new ee(new Fe([])),r=new en(t,e),i=new en(t,e+1),o=[];return this.es.forEachInRange([r,i],u=>{this.rs(u),o.push(u.key)}),o}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new ee(new Fe([])),r=new en(t,e),i=new en(t,e+1);let o=De();return this.es.forEachInRange([r,i],u=>{o=o.add(u.key)}),o}containsKey(e){const t=new en(e,0),r=this.Zn.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class en{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return ee.comparator(e.key,t.key)||Se(e.ls,t.ls)}static ns(e,t){return Se(e.ls,t.ls)||ee.comparator(e.key,t.key)}}class Jm{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.fs=1,this.ds=new Be(en.ts)}checkEmpty(e){return P.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const o=this.fs;this.fs++;const u=new Th(o,t,r,i);this.mutationQueue.push(u);for(const h of i)this.ds=this.ds.add(new en(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return P.resolve(u)}lookupMutationBatch(e,t){return P.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.ws(t+1),o=i<0?0:i;return P.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(0===this.mutationQueue.length?-1:this.fs-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new en(t,0),i=new en(t,Number.POSITIVE_INFINITY),o=[];return this.ds.forEachInRange([r,i],u=>{const h=this._s(u.ls);o.push(h)}),P.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Be(Se);return t.forEach(i=>{const o=new en(i,0),u=new en(i,Number.POSITIVE_INFINITY);this.ds.forEachInRange([o,u],h=>{r=r.add(h.ls)})}),P.resolve(this.gs(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let o=r;ee.isDocumentKey(o)||(o=o.child(""));const u=new en(new ee(o),0);let h=new Be(Se);return this.ds.forEachWhile(f=>{const m=f.key.path;return!!r.isPrefixOf(m)&&(m.length===i&&(h=h.add(f.ls)),!0)},u),P.resolve(this.gs(h))}gs(e){const t=[];return e.forEach(r=>{const i=this._s(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){ve(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();let r=this.ds;return P.forEach(t.mutations,i=>{const o=new en(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.ds=r})}In(e){}containsKey(e,t){const r=new en(t,0),i=this.ds.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return P.resolve()}ys(e,t){return this.ws(e)}ws(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}_s(e){const t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Xm{constructor(e){this.ps=e,this.docs=new _t(ee.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),o=i?i.size:0,u=this.ps(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:u}),this.size+=u-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():Je.newInvalidDocument(t))}getEntries(e,t){let r=mn();return t.forEach(i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Je.newInvalidDocument(i))}),P.resolve(r)}getAllFromCollection(e,t,r){let i=mn();const o=new ee(t.child("")),u=this.docs.getIteratorFrom(o);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!t.isPrefixOf(h.path))break;h.path.length>t.length+1||ra(na(f),r)<=0||(i=i.insert(f.key,f.mutableCopy()))}return P.resolve(i)}getAllFromCollectionGroup(e,t,r,i){ne()}Is(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new ey(this)}getSize(e){return P.resolve(this.size)}}class ey extends Qf{constructor(e){super(),this.zn=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.zn.addEntry(e,i)):this.zn.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.zn.getEntry(e,t)}getAllFromCache(e,t){return this.zn.getEntries(e,t)}}class ty{constructor(e){this.persistence=e,this.Ts=new Oi(t=>ms(t),aa),this.lastRemoteSnapshotVersion=be.min(),this.highestTargetId=0,this.Es=0,this.As=new kh,this.targetCount=0,this.Rs=Ea.An()}forEachTarget(e,t){return this.Ts.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Es&&(this.Es=t),P.resolve()}vn(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new Ea(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,t){return this.vn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.vn(t),P.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0;const o=[];return this.Ts.forEach((u,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.Ts.delete(u),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),P.waitFor(o).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){const r=this.Ts.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.As.ss(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.As.os(t,r);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(u=>{o.push(i.markPotentiallyOrphaned(e,u))}),P.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.As.us(t),P.resolve()}getMatchingKeysForTargetId(e,t){const r=this.As.hs(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.As.containsKey(t))}}class np{constructor(e,t){this.bs={},this.overlays={},this.Ps=new Bt(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new ty(this),this.indexManager=new Bm,this.remoteDocumentCache=new Xm(r=>this.referenceDelegate.Ss(r)),this.wt=new Of(t),this.Ds=new Qm(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ym,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.bs[e.toKey()];return r||(r=new Jm(t,this.referenceDelegate),this.bs[e.toKey()]=r),r}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,t,r){Z("MemoryPersistence","Starting transaction:",e);const i=new ny(this.Ps.next());return this.referenceDelegate.Cs(),r(i).next(o=>this.referenceDelegate.xs(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ns(e,t){return P.or(Object.values(this.bs).map(r=>()=>r.containsKey(e,t)))}}class ny extends nu{constructor(e){super(),this.currentSequenceNumber=e}}class Sl{constructor(e){this.persistence=e,this.ks=new kh,this.Ms=null}static Os(e){return new Sl(e)}get Fs(){if(this.Ms)return this.Ms;throw ne()}addReference(e,t,r){return this.ks.addReference(r,t),this.Fs.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.ks.removeReference(r,t),this.Fs.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Fs.add(t.toString()),P.resolve()}removeTarget(e,t){this.ks.us(t.targetId).forEach(i=>this.Fs.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Fs.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Cs(){this.Ms=new Set}xs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Fs,r=>{const i=ee.fromPath(r);return this.$s(e,i).next(o=>{o||t.removeEntry(i,be.min())})}).next(()=>(this.Ms=null,t.apply(e)))}updateLimboDocument(e,t){return this.$s(e,t).next(r=>{r?this.Fs.delete(t.toString()):this.Fs.add(t.toString())})}Ss(e){return 0}$s(e,t){return P.or([()=>P.resolve(this.ks.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ns(e,t)])}}class ry{constructor(e){this.wt=e}M(e,t,r,i){const o=new ia("createOrUpgrade",t);var h;r<1&&i>=1&&(e.createObjectStore("owner"),(h=e).createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Cf,{unique:!0}),h.createObjectStore("documentMutations"),rp(e),function(h){h.createObjectStore("remoteDocuments")}(e));let u=P.resolve();return r<3&&i>=3&&(0!==r&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),rp(e)),u=u.next(()=>function(h){const f=h.store("targetGlobal"),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:be.min().toTimestamp(),targetCount:0};return f.put("targetGlobalKey",m)}(o))),r<4&&i>=4&&(0!==r&&(u=u.next(()=>function(h,f){return f.store("mutations").K().next(m=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Cf,{unique:!0});const v=f.store("mutations"),T=m.map(O=>v.put(O));return P.waitFor(T)})}(e,o))),u=u.next(()=>{!function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(u=u.next(()=>this.Bs(o))),r<6&&i>=6&&(u=u.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(o)))),r<7&&i>=7&&(u=u.next(()=>this.Us(o))),r<8&&i>=8&&(u=u.next(()=>this.qs(e,o))),r<9&&i>=9&&(u=u.next(()=>{!function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(u=u.next(()=>this.Ks(o))),r<11&&i>=11&&(u=u.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(u=u.next(()=>{!function(h){const f=h.createObjectStore("documentOverlays",{keyPath:Cm});f.createIndex("collectionPathOverlayIndex",km,{unique:!1}),f.createIndex("collectionGroupOverlayIndex",Dm,{unique:!1})}(e)})),r<13&&i>=13&&(u=u.next(()=>function(h){const f=h.createObjectStore("remoteDocumentsV14",{keyPath:ym});f.createIndex("documentKeyIndex",_m),f.createIndex("collectionGroupIndex",vm)}(e)).next(()=>this.Gs(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(u=u.next(()=>this.Qs(e,o))),r<15&&i>=15&&(u=u.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:bm}).createIndex("sequenceNumberIndex",Am,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:Sm}).createIndex("documentKeyIndex",xm,{unique:!1})}(e))),u}Ls(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Tl(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Bs(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.K().next(i=>P.forEach(i,o=>{const u=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.K("userMutationsIndex",u).next(h=>P.forEach(h,f=>{ve(f.userId===o.userId);const m=_a(this.wt,f);return Kf(e,o.userId,m).next(()=>{})}))}))}Us(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const o=[];return r.J((u,h)=>{const f=new Fe(u),m=[0,dn(f)];o.push(t.get(m).next(v=>v?P.resolve():t.put({targetId:0,path:dn(f),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>P.waitFor(o))})}qs(e,t){e.createObjectStore("collectionParents",{keyPath:Tm});const r=t.store("collectionParents"),i=new Ch,o=u=>{if(i.add(u)){const h=u.lastSegment(),f=u.popLast();return r.put({collectionId:h,parent:dn(f)})}};return t.store("remoteDocuments").J({H:!0},(u,h)=>{const f=new Fe(u);return o(f.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([u,h,f],m)=>{const v=Mi(h);return o(v.popLast())}))}Ks(e){const t=e.store("targets");return t.J((r,i)=>{const o=pc(i),u=Mf(this.wt,o);return t.put(u)})}Gs(e,t){const r=t.store("remoteDocuments"),i=[];return r.J((o,u)=>{const h=t.store("remoteDocumentsV14"),f=(m=u,m.document?new ee(Fe.fromString(m.document.name).popFirst(5)):m.noDocument?ee.fromSegments(m.noDocument.path):m.unknownDocument?ee.fromSegments(m.unknownDocument.path):ne()).path.toArray();var m;const v={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};i.push(h.put(v))}).next(()=>P.waitFor(i))}Qs(e,t){const r=t.store("mutations"),i=Yf(this.wt),o=new np(Sl.Os,this.wt.ne);return r.K().next(u=>{const h=new Map;return u.forEach(f=>{var m;let v=null!==(m=h.get(f.userId))&&void 0!==m?m:De();_a(this.wt,f).keys().forEach(T=>v=v.add(T)),h.set(f.userId,v)}),P.forEach(h,(f,m)=>{const v=new Tt(m),T=Il.se(this.wt,v),O=o.getIndexManager(v),U=bl.se(v,this.wt,O,o.referenceDelegate);return new tp(i,U,T,O).recalculateAndSaveOverlaysForDocumentKeys(new Eh(t,Bt.ot),f).next()})})}}function rp(n){n.createObjectStore("targetDocuments",{keyPath:wm}).createIndex("documentTargetsIndex",Em,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Im,{unique:!0}),n.createObjectStore("targetGlobal")}const Dh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Nh{constructor(e,t,r,i,o,u,h,f,m,v,T=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.js=o,this.window=u,this.document=h,this.Ws=m,this.zs=v,this.Hs=T,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=O=>Promise.resolve(),!Nh.V())throw new K(L.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new zm(this,i),this.ei=t+"main",this.wt=new Of(f),this.ni=new cn(this.ei,this.Hs,new ry(this.wt)),this.Vs=new jm(this.referenceDelegate,this.wt),this.remoteDocumentCache=Yf(this.wt),this.Ds=new Pm,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,!1===v&&et("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new K(L.FAILED_PRECONDITION,Dh);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new Bt(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){var t=this;return this.ti=function(){var r=(0,R.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(function(){var t=(0,R.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget((0,R.Z)(function*(){t.started&&(yield t.ii())})))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>xl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(t=>{t||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(t=>this.isPrimary&&!t?this.li(e).next(()=>!1):!!t&&this.fi(e).next(()=>!0))).catch(e=>{if(zn(e))return Z("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Z("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return Ic(e).get("owner").next(t=>P.resolve(this.di(t)))}_i(e){return xl(e).delete(this.clientId)}wi(){var e=this;return(0,R.Z)(function*(){if(e.isPrimary&&!e.mi(e.Zs,18e5)){e.Zs=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Xt(r,"clientMetadata");return i.K().next(o=>{const u=e.gi(o,18e5),h=o.filter(f=>-1===u.indexOf(f));return P.forEach(h,f=>i.delete(f.clientId)).next(()=>h)})}).catch(()=>[]);if(e.si)for(const r of t)e.si.removeItem(e.yi(r.clientId))}})()}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?P.resolve(!0):Ic(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)){if(this.di(t)&&this.networkEnabled)return!0;if(!this.di(t)){if(!t.allowTabSynchronization)throw new K(L.FAILED_PRECONDITION,Dh);return!1}}return!(!this.networkEnabled||!this.inForeground)||xl(e).K().next(r=>void 0===this.gi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const u=!this.inForeground&&i.inForeground,h=this.networkEnabled===i.networkEnabled;if(!this.networkEnabled&&i.networkEnabled||u&&h)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&Z("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,R.Z)(function*(){e.vs=!1,e.Ii(),e.Xs&&(e.Xs.cancel(),e.Xs=null),e.Ti(),e.Ei(),yield e.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new Eh(t,Bt.ot);return e.li(r).next(()=>e._i(r))}),e.ni.close(),e.Ai()})()}gi(e,t){return e.filter(r=>this.mi(r.updateTimeMs,t)&&!this.pi(r.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>xl(e).K().next(t=>this.gi(t,18e5).map(r=>r.clientId)))}get started(){return this.vs}getMutationQueue(e,t){return bl.se(e,this.wt,t,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new $m(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return Il.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,t,r){Z("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",o=15===(u=this.Hs)?Rm:14===u?Rf:13===u?Nf:12===u?Nm:11===u?Df:void ne();var u;let h;return this.ni.runTransaction(e,i,o,f=>(h=new Eh(f,this.Ps?this.Ps.next():Bt.ot),"readwrite-primary"===t?this.ai(h).next(m=>!!m||this.hi(h)).next(m=>{if(!m)throw et(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new K(L.FAILED_PRECONDITION,no);return r(h)}).next(m=>this.fi(h).next(()=>m)):this.bi(h).next(()=>r(h)))).then(f=>(h.raiseOnCommittedEvent(),f))}bi(e){return Ic(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)&&!this.di(t)&&!(this.zs||this.allowTabSynchronization&&t.allowTabSynchronization))throw new K(L.FAILED_PRECONDITION,Dh)})}fi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ic(e).put("owner",t)}static V(){return cn.V()}li(e){const t=Ic(e);return t.get("owner").next(r=>this.di(r)?(Z("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):P.resolve())}mi(e,t){const r=Date.now();return!(e<r-t||e>r&&(et(`Detected an update time that is in the future: ${e} > ${r}`),1))}ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground="visible"===this.document.visibilityState)}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Js=()=>{this.Ii(),(0,le.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var t;try{const r=null!==(null===(t=this.si)||void 0===t?void 0:t.getItem(this.yi(e)));return Z("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return et("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){et("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch{}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ic(n){return Xt(n,"owner")}function xl(n){return Xt(n,"clientMetadata")}function Rh(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Oh{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Pi=r,this.vi=i}static Vi(e,t){let r=De(),i=De();for(const o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new Oh(e,t.fromCache,r,i)}}class ip{constructor(){this.Si=!1}initialize(e,t){this.Di=e,this.indexManager=t,this.Si=!0}getDocumentsMatchingQuery(e,t,r,i){return this.Ci(e,t).next(o=>o||this.xi(e,t,i,r)).next(o=>o||this.Ni(e,t))}Ci(e,t){if(Jc(t))return P.resolve(null);let r=gn(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Ju(t,null,"F"),r=gn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const u=De(...o);return this.Di.getDocuments(e,u).next(h=>this.indexManager.getMinOffset(e,r).next(f=>{const m=this.ki(t,h);return this.Mi(t,m,u,f.readTime)?this.Ci(e,Ju(t,null,"F")):this.Oi(e,m,t,f)}))})))}xi(e,t,r,i){return Jc(t)||i.isEqual(be.min())?this.Ni(e,t):this.Di.getDocuments(e,r).next(o=>{const u=this.ki(t,o);return this.Mi(t,u,r,i)?this.Ni(e,t):(Qo()<=xe.in.DEBUG&&Z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Xu(t)),this.Oi(e,u,t,ta(i,-1)))})}ki(e,t){let r=new Be(du(e));return t.forEach((i,o)=>{ua(e,o)&&(r=r.add(o))}),r}Mi(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const o="F"===e.limitType?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ni(e,t){return Qo()<=xe.in.DEBUG&&Z("QueryEngine","Using full collection scan to execute query:",Xu(t)),this.Di.getDocumentsMatchingQuery(e,t,Vt.min())}Oi(e,t,r,i){return this.Di.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(u=>{o=o.insert(u.key,u)}),o))}}class iy{constructor(e,t,r,i){this.persistence=e,this.Fi=t,this.wt=i,this.$i=new _t(Se),this.Bi=new Oi(o=>ms(o),aa),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(r)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tp(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.$i))}}function sp(n,e,t,r){return new iy(n,e,t,r)}function op(n,e){return Ph.apply(this,arguments)}function Ph(){return Ph=(0,R.Z)(function*(n,e){const t=X(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.qi(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{const u=[],h=[];let f=De();for(const m of i){u.push(m.batchId);for(const v of m.mutations)f=f.add(v.key)}for(const m of o){h.push(m.batchId);for(const v of m.mutations)f=f.add(v.key)}return t.localDocuments.getDocuments(r,f).next(m=>({Ki:m,removedBatchIds:u,addedBatchIds:h}))})})}),Ph.apply(this,arguments)}function sy(n,e){const t=X(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),o=t.Ui.newChangeBuffer({trackRemovals:!0});return function(u,h,f,m){const v=f.batch,T=v.keys();let O=P.resolve();return T.forEach(U=>{O=O.next(()=>m.getEntry(h,U)).next(B=>{const Y=f.docVersions.get(U);ve(null!==Y),B.version.compareTo(Y)<0&&(v.applyToRemoteDocument(B,f),B.isValidDocument()&&(B.setReadTime(f.commitVersion),m.addEntry(B)))})}),O.next(()=>u.mutationQueue.removeMutationBatch(h,v))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=De();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(h=h.add(u.batch.mutations[f].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function ap(n){const e=X(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Vs.getLastRemoteSnapshotVersion(t))}function oy(n,e){const t=X(n),r=e.snapshotVersion;let i=t.$i;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const u=t.Ui.newChangeBuffer({trackRemovals:!0});i=t.$i;const h=[];e.targetChanges.forEach((v,T)=>{const O=i.get(T);if(!O)return;h.push(t.Vs.removeMatchingKeys(o,v.removedDocuments,T).next(()=>t.Vs.addMatchingKeys(o,v.addedDocuments,T)));let U=O.withSequenceNumber(o.currentSequenceNumber);var B,Y,oe;e.targetMismatches.has(T)?U=U.withResumeToken(vt.EMPTY_BYTE_STRING,be.min()).withLastLimboFreeSnapshotVersion(be.min()):v.resumeToken.approximateByteSize()>0&&(U=U.withResumeToken(v.resumeToken,r)),i=i.insert(T,U),Y=U,oe=v,(0===(B=O).resumeToken.approximateByteSize()||Y.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=3e8||oe.addedDocuments.size+oe.modifiedDocuments.size+oe.removedDocuments.size>0)&&h.push(t.Vs.updateTargetData(o,U))});let f=mn(),m=De();if(e.documentUpdates.forEach(v=>{e.resolvedLimboDocuments.has(v)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(o,v))}),h.push(up(o,u,e.documentUpdates).next(v=>{f=v.Gi,m=v.Qi})),!r.isEqual(be.min())){const v=t.Vs.getLastRemoteSnapshotVersion(o).next(T=>t.Vs.setTargetsMetadata(o,o.currentSequenceNumber,r));h.push(v)}return P.waitFor(h).next(()=>u.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,f,m)).next(()=>f)}).then(o=>(t.$i=i,o))}function up(n,e,t){let r=De(),i=De();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let u=mn();return t.forEach((h,f)=>{const m=o.get(h);f.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(h)),f.isNoDocument()&&f.version.isEqual(be.min())?(e.removeEntry(h,f.readTime),u=u.insert(h,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||0===f.version.compareTo(m.version)&&m.hasPendingWrites?(e.addEntry(f),u=u.insert(h,f)):Z("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",f.version)}),{Gi:u,Qi:i}})}function ay(n,e){const t=X(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function xu(n,e){const t=X(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Vs.getTargetData(r,e).next(o=>o?(i=o,P.resolve(i)):t.Vs.allocateTargetId(r).next(u=>(i=new fo(e,u,0,r.currentSequenceNumber),t.Vs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.$i.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.$i=t.$i.insert(r.targetId,r),t.Bi.set(e,r.targetId)),r})}function Cu(n,e,t){return Mh.apply(this,arguments)}function Mh(){return Mh=(0,R.Z)(function*(n,e,t){const r=X(n),i=r.$i.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,u=>r.persistence.referenceDelegate.removeTarget(u,i)))}catch(u){if(!zn(u))throw u;Z("LocalStore",`Failed to update sequence numbers for target ${e}: ${u}`)}r.$i=r.$i.remove(e),r.Bi.delete(i.target)}),Mh.apply(this,arguments)}function Cl(n,e,t){const r=X(n);let i=be.min(),o=De();return r.persistence.runTransaction("Execute query","readonly",u=>function(h,f,m){const v=X(h),T=v.Bi.get(m);return void 0!==T?P.resolve(v.$i.get(T)):v.Vs.getTargetData(f,m)}(r,u,gn(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(u,h.targetId).next(f=>{o=f})}).next(()=>r.Fi.getDocumentsMatchingQuery(u,e,t?i:be.min(),t?o:De())).next(h=>(hp(r,el(e),h),{documents:h,ji:o})))}function cp(n,e){const t=X(n),r=X(t.Vs),i=t.$i.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.te(o,e).next(u=>u?u.target:null))}function lp(n,e){const t=X(n),r=t.Li.get(e)||be.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Ui.getAllFromCollectionGroup(i,e,ta(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(hp(t,e,i),i))}function hp(n,e,t){let r=be.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.Li.set(e,r)}function Lh(){return Lh=(0,R.Z)(function*(n,e,t,r){const i=X(n);let o=De(),u=mn();for(const m of t){const v=e.Wi(m.metadata.name);m.document&&(o=o.add(v));const T=e.zi(m);T.setReadTime(e.Hi(m.metadata.readTime)),u=u.insert(v,T)}const h=i.Ui.newChangeBuffer({trackRemovals:!0}),f=yield xu(i,(m=r,gn(Ni(Fe.fromString(`__bundle__/docs/${m}`)))));var m;return i.persistence.runTransaction("Apply bundle documents","readwrite",m=>up(m,h,u).next(v=>(h.apply(m),v)).next(v=>i.Vs.removeMatchingKeysForTargetId(m,f.targetId).next(()=>i.Vs.addMatchingKeys(m,o,f.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(m,v.Gi,v.Qi)).next(()=>v.Gi)))}),Lh.apply(this,arguments)}function cy(n,e){return Fh.apply(this,arguments)}function Fh(){return Fh=(0,R.Z)(function*(n,e,t=De()){const r=yield xu(n,gn(Sh(e.bundledQuery))),i=X(n);return i.persistence.runTransaction("Save named query","readwrite",o=>{const u=jt(e.readTime);if(r.snapshotVersion.compareTo(u)>=0)return i.Ds.saveNamedQuery(o,e);const h=r.withResumeToken(vt.EMPTY_BYTE_STRING,u);return i.$i=i.$i.insert(h.targetId,h),i.Vs.updateTargetData(o,h).next(()=>i.Vs.removeMatchingKeysForTargetId(o,r.targetId)).next(()=>i.Vs.addMatchingKeys(o,t,r.targetId)).next(()=>i.Ds.saveNamedQuery(o,e))})}),Fh.apply(this,arguments)}function dp(n,e){return`firestore_clients_${n}_${e}`}function fp(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Uh(n,e){return`firestore_targets_${n}_${e}`}class kl{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ji(e,t,r){const i=JSON.parse(r);let o,u="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return u&&i.error&&(u="string"==typeof i.error.message&&"string"==typeof i.error.code,u&&(o=new K(i.error.code,i.error.message))),u?new kl(e,t,i.state,o):(et("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class wc{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ji(e,t){const r=JSON.parse(t);let i,o="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return o&&r.error&&(o="string"==typeof r.error.message&&"string"==typeof r.error.code,o&&(i=new K(r.error.code,r.error.message))),o?new wc(e,r.state,i):(et("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Dl{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ji(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,o=la();for(let u=0;i&&u<r.activeTargetIds.length;++u)i=N(r.activeTargetIds[u]),o=o.add(r.activeTargetIds[u]);return i?new Dl(e,o):(et("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Vh{constructor(e,t){this.clientId=e,this.onlineState=t}static Ji(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Vh(t.clientId,t.onlineState):(et("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Bh{constructor(){this.activeTargetIds=la()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class $h{constructor(e,t,r,i,o){this.window=e,this.js=t,this.persistenceKey=r,this.tr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new _t(Se),this.started=!1,this.ir=[];const u=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.rr=dp(this.persistenceKey,this.tr),this.ur=`firestore_sequence_number_${this.persistenceKey}`,this.sr=this.sr.insert(this.tr,new Bh),this.cr=new RegExp(`^firestore_clients_${u}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${u}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${u}_(\\d+)$`),this.lr=`firestore_online_state_${this.persistenceKey}`,this.dr=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,R.Z)(function*(){const t=yield e.syncEngine.Ri();for(const i of t){if(i===e.tr)continue;const o=e.getItem(dp(e.persistenceKey,i));if(o){const u=Dl.Ji(i,o);u&&(e.sr=e.sr.insert(u.clientId,u))}}e._r();const r=e.storage.getItem(e.lr);if(r){const i=e.wr(r);i&&e.mr(i)}for(const i of e.ir)e.nr(i);e.ir=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let t=!1;return this.sr.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,t,r){this.yr(e,t,r),this.pr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Uh(this.persistenceKey,e));if(r){const i=wc.Ji(e,r);i&&(t=i.state)}}return this.Ir.Xi(e),this._r(),t}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Uh(this.persistenceKey,e))}updateQueryState(e,t,r){this.Tr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.pr(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Z("SharedClientState","READ",e,t),t}setItem(e,t){Z("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Z("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(Z("SharedClientState","EVENT",r.key,r.newValue),r.key===this.rr)return void et("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable((0,R.Z)(function*(){if(t.started){if(null!==r.key)if(t.cr.test(r.key)){if(null==r.newValue){const i=t.Rr(r.key);return t.br(i,null)}{const i=t.Pr(r.key,r.newValue);if(i)return t.br(i.clientId,i)}}else if(t.ar.test(r.key)){if(null!==r.newValue){const i=t.vr(r.key,r.newValue);if(i)return t.Vr(i)}}else if(t.hr.test(r.key)){if(null!==r.newValue){const i=t.Sr(r.key,r.newValue);if(i)return t.Dr(i)}}else if(r.key===t.lr){if(null!==r.newValue){const i=t.wr(r.newValue);if(i)return t.mr(i)}}else if(r.key===t.ur){const i=function(o){let u=Bt.ot;if(null!=o)try{const h=JSON.parse(o);ve("number"==typeof h),u=h}catch(h){et("SharedClientState","Failed to read sequence number from WebStorage",h)}return u}(r.newValue);i!==Bt.ot&&t.sequenceNumberHandler(i)}else if(r.key===t.dr){const i=t.Cr(r.newValue);yield Promise.all(i.map(o=>t.syncEngine.Nr(o)))}}else t.ir.push(r)}))}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,t,r){const i=new kl(this.currentUser,e,t,r),o=fp(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Yi())}pr(e){const t=fp(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Er(e){this.storage.setItem(this.lr,JSON.stringify({clientId:this.tr,onlineState:e}))}Tr(e,t,r){const i=Uh(this.persistenceKey,e),o=new wc(e,t,r);this.setItem(i,o.Yi())}Ar(e){const t=JSON.stringify(Array.from(e));this.setItem(this.dr,t)}Rr(e){const t=this.cr.exec(e);return t?t[1]:null}Pr(e,t){const r=this.Rr(e);return Dl.Ji(r,t)}vr(e,t){const r=this.ar.exec(e),i=Number(r[1]);return kl.Ji(new Tt(void 0!==r[2]?r[2]:null),i,t)}Sr(e,t){const r=this.hr.exec(e),i=Number(r[1]);return wc.Ji(i,t)}wr(e){return Vh.Ji(e)}Cr(e){return JSON.parse(e)}Vr(e){var t=this;return(0,R.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.kr(e.batchId,e.state,e.error);Z("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Dr(e){return this.syncEngine.Mr(e.targetId,e.state,e.error)}br(e,t){const r=t?this.sr.insert(e,t):this.sr.remove(e),i=this.gr(this.sr),o=this.gr(r),u=[],h=[];return o.forEach(f=>{i.has(f)||u.push(f)}),i.forEach(f=>{o.has(f)||h.push(f)}),this.syncEngine.Or(u,h).then(()=>{this.sr=r})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let t=la();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class pp{constructor(){this.Fr=new Bh,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,t,r){this.$r[e]=t}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Bh,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ly{Br(e){}shutdown(){}}class gp{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){Z("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){Z("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const hy={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class dy{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}class fy extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.so=(e.ssl?"https":"http")+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,t,r,i,o){const u=this.oo(e,t);Z("RestConnection","Sending: ",u,r);const h={};return this.uo(h,i,o),this.co(e,u,h,r).then(f=>(Z("RestConnection","Received: ",f),f),f=>{throw Rr("RestConnection",`${e} failed with error: `,f,"url: ",u,"request:",r),f})}ao(e,t,r,i,o,u){return this.ro(e,t,r,i,o)}uo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Dr,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}oo(e,t){return`${this.so}/v1/${t}:${hy[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,t,r,i){return new Promise((o,u)=>{const h=new Ho;h.listenOnce(Ha.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Gn.NO_ERROR:const m=h.getResponseJson();Z("Connection","XHR received:",JSON.stringify(m)),o(m);break;case Gn.TIMEOUT:Z("Connection",'RPC "'+e+'" timed out'),u(new K(L.DEADLINE_EXCEEDED,"Request time out"));break;case Gn.HTTP_ERROR:const v=h.getStatus();if(Z("Connection",'RPC "'+e+'" failed with status:',v,"response text:",h.getResponseText()),v>0){const T=h.getResponseJson().error;if(T&&T.status&&T.message){const O=function(U){const B=U.toLowerCase().replace(/_/g,"-");return Object.values(L).indexOf(B)>=0?B:L.UNKNOWN}(T.status);u(new K(O,T.message))}else u(new K(L.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new K(L.UNAVAILABLE,"Connection failed."));break;default:ne()}}finally{Z("Connection",'RPC "'+e+'" completed.')}});const f=JSON.stringify(i);h.send(t,"POST",f,r,15)})}ho(e,t,r){const i=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Xs(),u=$c(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(h.xmlHttpFactory=new Wo({})),this.uo(h.initMessageHeaders,t,r),(0,le.uI)()||(0,le.b$)()||(0,le.d)()||(0,le.w1)()||(0,le.Mn)()||(0,le.ru)()||(h.httpHeadersOverwriteParam="$httpHeaders");const f=i.join("");Z("Connection","Creating WebChannel: "+f,h);const m=o.createWebChannel(f,h);let v=!1,T=!1;const O=new dy({jr:B=>{T?Z("Connection","Not sending because WebChannel is closed:",B):(v||(Z("Connection","Opening WebChannel transport."),m.open(),v=!0),Z("Connection","WebChannel sending:",B),m.send(B))},Wr:()=>m.close()}),U=(B,Y,oe)=>{B.listen(Y,Me=>{try{oe(Me)}catch(Qe){setTimeout(()=>{throw Qe},0)}})};return U(m,pt.EventType.OPEN,()=>{T||Z("Connection","WebChannel transport opened.")}),U(m,pt.EventType.CLOSE,()=>{T||(T=!0,Z("Connection","WebChannel transport closed"),O.eo())}),U(m,pt.EventType.ERROR,B=>{T||(T=!0,Rr("Connection","WebChannel transport errored:",B),O.eo(new K(L.UNAVAILABLE,"The operation could not be completed")))}),U(m,pt.EventType.MESSAGE,B=>{var Y;if(!T){const oe=B.data[0];ve(!!oe);const Me=oe,Qe=Me.error||(null===(Y=Me[0])||void 0===Y?void 0:Y.error);if(Qe){Z("Connection","WebChannel received error:",Qe);const Ke=Qe.status;let Re=function(Ve){const Ht=Ct[Ve];if(void 0!==Ht)return rc(Ht)}(Ke),Oe=Qe.message;void 0===Re&&(Re=L.INTERNAL,Oe="Unknown error status: "+Ke+" with message "+Qe.message),T=!0,O.eo(new K(Re,Oe)),m.close()}else Z("Connection","WebChannel received:",oe),O.no(oe)}}),U(u,zu.STAT_EVENT,B=>{B.stat===vi.PROXY?Z("Connection","Detected buffering proxy"):B.stat===vi.NOPROXY&&Z("Connection","Detected no buffering proxy")}),setTimeout(()=>{O.Zr()},0),O}}function mp(){return typeof window<"u"?window:null}function Nl(){return typeof document<"u"?document:null}function Ec(n){return new pl(n,!0)}class jh{constructor(e,t,r=1e3,i=1.5,o=6e4){this.js=e,this.timerId=t,this.lo=r,this.fo=i,this._o=o,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const t=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,t-r);i>0&&Z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.wo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,i,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}cancel(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}class yp{constructor(e,t,r,i,o,u,h,f){this.js=e,this.Ao=r,this.Ro=i,this.bo=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new jh(e,t)}Do(){return 1===this.state||5===this.state||this.Co()}Co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.xo()}stop(){var e=this;return(0,R.Z)(function*(){e.Do()&&(yield e.close(0))})()}No(){this.state=0,this.So.reset()}ko(){this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Mo()))}Oo(e){this.Fo(),this.stream.send(e)}Mo(){var e=this;return(0,R.Z)(function*(){if(e.Co())return e.close(0)})()}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}close(e,t){var r=this;return(0,R.Z)(function*(){r.Fo(),r.$o(),r.So.cancel(),r.Po++,4!==e?r.So.reset():t&&t.code===L.RESOURCE_EXHAUSTED?(et(t.toString()),et("Using maximum backoff delay to prevent overloading the backend."),r.So.po()):t&&t.code===L.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Bo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Jr(t)})()}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),t=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Po===t&&this.Uo(r,i)},r=>{e(()=>{const i=new K(L.UNKNOWN,"Fetching auth token failed: "+r.message);return this.qo(i)})})}Uo(e,t){const r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(()=>{r(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(i=>{r(()=>this.qo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}xo(){var e=this;this.state=5,this.So.Io((0,R.Z)(function*(){e.state=0,e.start()}))}qo(e){return Z("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return t=>{this.js.enqueueAndForget(()=>this.Po===e?t():(Z("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class py extends yp{constructor(e,t,r,i,o,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,u),this.wt=o}Ko(e,t){return this.bo.ho("Listen",e,t)}onMessage(e){this.So.reset();const t=function ie(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(f=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===f?1:"REMOVE"===f?2:"CURRENT"===f?3:"RESET"===f?4:ne(),i=e.targetChange.targetIds||[],o=function(f,m){return f.dt?(ve(void 0===m||"string"==typeof m),vt.fromBase64String(m||"")):(ve(void 0===m||m instanceof Uint8Array),vt.fromUint8Array(m||new Uint8Array))}(n,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&function(f){const m=void 0===f.code?L.UNKNOWN:rc(f.code);return new K(m,f.message||"")}(u);t=new hn(r,i,o,h||null)}else if("documentChange"in e){const r=e.documentChange,i=s(n,r.document.name),o=jt(r.document.updateTime),u=new $t({mapValue:{fields:r.document.fields}}),h=Je.newFoundDocument(i,o,u);t=new wu(r.targetIds||[],r.removedTargetIds||[],h.key,h)}else if("documentDelete"in e){const r=e.documentDelete,i=s(n,r.document),o=r.readTime?jt(r.readTime):be.min(),u=Je.newNoDocument(i,o);t=new wu([],r.removedTargetIds||[],u.key,u)}else if("documentRemove"in e){const r=e.documentRemove,i=s(n,r.document);t=new wu([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return ne();{const r=e.filter,o=new _h(r.count||0);t=new oc(r.targetId,o)}}var f;return t}(this.wt,e),r=function(i){if(!("targetChange"in i))return be.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?be.min():o.readTime?jt(o.readTime):be.min()}(e);return this.listener.Go(t,r)}Qo(e){const t={};t.database=g(this.wt),t.addTarget=function(i,o){let u;const h=o.target;return u=ou(h)?{documents:Wn(i,h)}:{query:ga(i,h)},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0?u.resumeToken=Tu(i,o.resumeToken):o.snapshotVersion.compareTo(be.min())>0&&(u.readTime=pa(i,o.snapshotVersion.toTimestamp())),u}(this.wt,e);const r=function lc(n,e){const t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ne()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Oo(t)}jo(e){const t={};t.database=g(this.wt),t.removeTarget=e,this.Oo(t)}}class gy extends yp{constructor(e,t,r,i,o,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,u),this.wt=o,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,t){return this.bo.ho("Write",e,t)}onMessage(e){if(ve(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const t=function Ft(n,e){return n&&n.length>0?(ve(void 0!==e),n.map(t=>function(r,i){let o=jt(r.updateTime?r.updateTime:i);return o.isEqual(be.min())&&(o=jt(i)),new mh(o,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=jt(e.commitTime);return this.listener.Jo(r,t)}return ve(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=g(this.wt),this.Oo(e)}Ho(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>_e(this.wt,r))};this.Oo(t)}}class my extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.bo=r,this.wt=i,this.Zo=!1}tu(){if(this.Zo)throw new K(L.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,t,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.bo.ro(e,t,r,i,o)).catch(i=>{throw"FirebaseError"===i.name?(i.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new K(L.UNKNOWN,i.toString())})}ao(e,t,r,i){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.bo.ao(e,t,r,o,u,i)).catch(o=>{throw"FirebaseError"===o.name?(o.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new K(L.UNKNOWN,o.toString())})}terminate(){this.Zo=!0}}class yy{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(et(t),this.su=!1):Z("OnlineStateTracker",t)}cu(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}class _y{constructor(e,t,r,i,o){var u=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=o,this.du.Br(h=>{r.enqueueAndForget((0,R.Z)(function*(){var f;mo(u)&&(Z("RemoteStore","Restarting streams for network reachability change."),yield(f=(0,R.Z)(function*(m){const v=X(m);v.lu.add(4),yield ku(v),v._u.set("Unknown"),v.lu.delete(4),yield Tc(v)}),function(m){return f.apply(this,arguments)})(u))}))}),this._u=new yy(r,i)}}function Tc(n){return Gh.apply(this,arguments)}function Gh(){return Gh=(0,R.Z)(function*(n){if(mo(n))for(const e of n.fu)yield e(!0)}),Gh.apply(this,arguments)}function ku(n){return qh.apply(this,arguments)}function qh(){return qh=(0,R.Z)(function*(n){for(const e of n.fu)yield e(!1)}),qh.apply(this,arguments)}function Rl(n,e){const t=X(n);t.hu.has(e.targetId)||(t.hu.set(e.targetId,e),Zh(t)?zh(t):Nu(t).Co()&&Kh(t,e))}function bc(n,e){const t=X(n),r=Nu(t);t.hu.delete(e),r.Co()&&_p(t,e),0===t.hu.size&&(r.Co()?r.ko():mo(t)&&t._u.set("Unknown"))}function Kh(n,e){n.wu.Nt(e.targetId),Nu(n).Qo(e)}function _p(n,e){n.wu.Nt(e),Nu(n).jo(e)}function zh(n){n.wu=new ac({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),te:e=>n.hu.get(e)||null}),Nu(n).start(),n._u.iu()}function Zh(n){return mo(n)&&!Nu(n).Do()&&n.hu.size>0}function mo(n){return 0===X(n).lu.size}function vp(n){n.wu=void 0}function vy(n){return Wh.apply(this,arguments)}function Wh(){return Wh=(0,R.Z)(function*(n){n.hu.forEach((e,t)=>{Kh(n,e)})}),Wh.apply(this,arguments)}function Iy(n,e){return Hh.apply(this,arguments)}function Hh(){return Hh=(0,R.Z)(function*(n,e){vp(n),Zh(n)?(n._u.uu(e),zh(n)):n._u.set("Unknown")}),Hh.apply(this,arguments)}function wy(n,e,t){return Qh.apply(this,arguments)}function Qh(){return Qh=(0,R.Z)(function*(n,e,t){if(n._u.set("Online"),e instanceof hn&&2===e.state&&e.cause)try{yield(r=(0,R.Z)(function*(i,o){const u=o.cause;for(const h of o.targetIds)i.hu.has(h)&&(yield i.remoteSyncer.rejectListen(h,u),i.hu.delete(h),i.wu.removeTarget(h))}),function(i,o){return r.apply(this,arguments)})(n,e)}catch(r){Z("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Ol(n,r)}else if(e instanceof wu?n.wu.Ut(e):e instanceof oc?n.wu.zt(e):n.wu.Gt(e),!t.isEqual(be.min()))try{const r=yield ap(n.localStore);t.compareTo(r)>=0&&(yield function(i,o){const u=i.wu.Yt(o);return u.targetChanges.forEach((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const m=i.hu.get(f);m&&i.hu.set(f,m.withResumeToken(h.resumeToken,o))}}),u.targetMismatches.forEach(h=>{const f=i.hu.get(h);if(!f)return;i.hu.set(h,f.withResumeToken(vt.EMPTY_BYTE_STRING,f.snapshotVersion)),_p(i,h);const m=new fo(f.target,h,1,f.sequenceNumber);Kh(i,m)}),i.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){Z("RemoteStore","Failed to raise snapshot:",r),yield Ol(n,r)}var r}),Qh.apply(this,arguments)}function Ol(n,e,t){return Yh.apply(this,arguments)}function Yh(){return Yh=(0,R.Z)(function*(n,e,t){if(!zn(e))throw e;n.lu.add(1),yield ku(n),n._u.set("Offline"),t||(t=()=>ap(n.localStore)),n.asyncQueue.enqueueRetryable((0,R.Z)(function*(){Z("RemoteStore","Retrying IndexedDB access"),yield t(),n.lu.delete(1),yield Tc(n)}))}),Yh.apply(this,arguments)}function Ip(n,e){return e().catch(t=>Ol(n,t,e))}function Du(n){return Jh.apply(this,arguments)}function Jh(){return Jh=(0,R.Z)(function*(n){const e=X(n),t=yo(e);let r=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;Ey(e);)try{const i=yield ay(e.localStore,r);if(null===i){0===e.au.length&&t.ko();break}r=i.batchId,Ty(e,i)}catch(i){yield Ol(e,i)}wp(e)&&Ep(e)}),Jh.apply(this,arguments)}function Ey(n){return mo(n)&&n.au.length<10}function Ty(n,e){n.au.push(e);const t=yo(n);t.Co()&&t.zo&&t.Ho(e.mutations)}function wp(n){return mo(n)&&!yo(n).Do()&&n.au.length>0}function Ep(n){yo(n).start()}function by(n){return Xh.apply(this,arguments)}function Xh(){return Xh=(0,R.Z)(function*(n){yo(n).Xo()}),Xh.apply(this,arguments)}function Ay(n){return ed.apply(this,arguments)}function ed(){return ed=(0,R.Z)(function*(n){const e=yo(n);for(const t of n.au)e.Ho(t.mutations)}),ed.apply(this,arguments)}function Sy(n,e,t){return td.apply(this,arguments)}function td(){return td=(0,R.Z)(function*(n,e,t){const r=n.au.shift(),i=bh.from(r,e,t);yield Ip(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Du(n)}),td.apply(this,arguments)}function xy(n,e){return nd.apply(this,arguments)}function nd(){return nd=(0,R.Z)(function*(n,e){var t;e&&yo(n).zo&&(yield(t=(0,R.Z)(function*(r,i){if(vu(o=i.code)&&o!==L.ABORTED){const u=r.au.shift();yo(r).No(),yield Ip(r,()=>r.remoteSyncer.rejectFailedWrite(u.batchId,i)),yield Du(r)}var o}),function(r,i){return t.apply(this,arguments)})(n,e)),wp(n)&&Ep(n)}),nd.apply(this,arguments)}function Tp(n,e){return rd.apply(this,arguments)}function rd(){return rd=(0,R.Z)(function*(n,e){const t=X(n);t.asyncQueue.verifyOperationInProgress(),Z("RemoteStore","RemoteStore received new credentials");const r=mo(t);t.lu.add(3),yield ku(t),r&&t._u.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.lu.delete(3),yield Tc(t)}),rd.apply(this,arguments)}function id(n,e){return sd.apply(this,arguments)}function sd(){return sd=(0,R.Z)(function*(n,e){const t=X(n);e?(t.lu.delete(2),yield Tc(t)):e||(t.lu.add(2),yield ku(t),t._u.set("Unknown"))}),sd.apply(this,arguments)}function Nu(n){return n.mu||(n.mu=function(e,t,r){const i=X(e);return i.tu(),new py(t,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)}(n.datastore,n.asyncQueue,{zr:vy.bind(null,n),Jr:Iy.bind(null,n),Go:wy.bind(null,n)}),n.fu.push(function(){var e=(0,R.Z)(function*(t){t?(n.mu.No(),Zh(n)?zh(n):n._u.set("Unknown")):(yield n.mu.stop(),vp(n))});return function(t){return e.apply(this,arguments)}}())),n.mu}function yo(n){return n.gu||(n.gu=function(e,t,r){const i=X(e);return i.tu(),new gy(t,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)}(n.datastore,n.asyncQueue,{zr:by.bind(null,n),Jr:xy.bind(null,n),Yo:Ay.bind(null,n),Jo:Sy.bind(null,n)}),n.fu.push(function(){var e=(0,R.Z)(function*(t){t?(n.gu.No(),yield Du(n)):(yield n.gu.stop(),n.au.length>0&&(Z("RemoteStore",`Stopping write stream with ${n.au.length} pending writes`),n.au=[]))});return function(t){return e.apply(this,arguments)}}())),n.gu}class od{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new gt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}static createAndSchedule(e,t,r,i,o){const u=Date.now()+r,h=new od(e,t,u,i,o);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new K(L.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ru(n,e){if(et("AsyncQueue",`${e}: ${n}`),zn(n))return new K(L.UNAVAILABLE,`${e}: ${n}`);throw n}class Ou{constructor(e){this.comparator=e?(t,r)=>e(t,r)||ee.comparator(t.key,r.key):(t,r)=>ee.comparator(t.key,r.key),this.keyedMap=ai(),this.sortedSet=new _t(this.comparator)}static emptySet(e){return new Ou(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ou)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Ou;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class bp{constructor(){this.yu=new _t(ee.comparator)}track(e){const t=e.doc.key,r=this.yu.get(t);r?0!==e.type&&3===r.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==r.type?this.yu=this.yu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.yu=this.yu.remove(t):1===e.type&&2===r.type?this.yu=this.yu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):ne():this.yu=this.yu.insert(t,e)}pu(){const e=[];return this.yu.inorderTraversal((t,r)=>{e.push(r)}),e}}class Pu{constructor(e,t,r,i,o,u,h,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=f}static fromInitialDocuments(e,t,r,i){const o=[];return t.forEach(u=>{o.push({type:0,doc:u})}),new Pu(e,t,Ou.emptySet(t),o,r,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&dr(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Cy{constructor(){this.Iu=void 0,this.listeners=[]}}class ky{constructor(){this.queries=new Oi(e=>Xc(e),dr),this.onlineState="Unknown",this.Tu=new Set}}function ad(n,e){return ud.apply(this,arguments)}function ud(){return ud=(0,R.Z)(function*(n,e){const t=X(n),r=e.query;let i=!1,o=t.queries.get(r);if(o||(i=!0,o=new Cy),i)try{o.Iu=yield t.onListen(r)}catch(u){const h=Ru(u,`Initialization of query '${Xu(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,o),o.listeners.push(e),e.Eu(t.onlineState),o.Iu&&e.Au(o.Iu)&&hd(t)}),ud.apply(this,arguments)}function cd(n,e){return ld.apply(this,arguments)}function ld(){return ld=(0,R.Z)(function*(n,e){const t=X(n),r=e.query;let i=!1;const o=t.queries.get(r);if(o){const u=o.listeners.indexOf(e);u>=0&&(o.listeners.splice(u,1),i=0===o.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),ld.apply(this,arguments)}function Dy(n,e){const t=X(n);let r=!1;for(const i of e){const u=t.queries.get(i.query);if(u){for(const h of u.listeners)h.Au(i)&&(r=!0);u.Iu=i}}r&&hd(t)}function Ny(n,e,t){const r=X(n),i=r.queries.get(e);if(i)for(const o of i.listeners)o.onError(t);r.queries.delete(e)}function hd(n){n.Tu.forEach(e=>{e.next()})}class dd{constructor(e,t,r){this.query=e,this.Ru=t,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}Au(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Pu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),t=!0):this.Vu(e,this.onlineState)&&(this.Su(e),t=!0),this.Pu=e,t}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}Vu(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}vu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Su(e){e=Pu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}class Ry{constructor(e,t){this.payload=e,this.byteLength=t}Cu(){return"metadata"in this.payload}}class Ap{constructor(e){this.wt=e}Wi(e){return s(this.wt,e)}zi(e){return e.metadata.exists?F(this.wt,e.document,!1):Je.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return jt(e)}}class Oy{constructor(e,t,r){this.xu=e,this.localStore=t,this.wt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Sp(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;const r=Fe.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ku(e){const t=new Map,r=new Ap(this.wt);for(const i of e)if(i.metadata.queries){const o=r.Wi(i.metadata.name);for(const u of i.metadata.queries){const h=(t.get(u)||De()).add(o);t.set(u,h)}}return t}complete(){var e=this;return(0,R.Z)(function*(){const t=yield function uy(n,e,t,r){return Lh.apply(this,arguments)}(e.localStore,new Ap(e.wt),e.documents,e.xu.id),r=e.ku(e.documents);for(const i of e.queries)yield cy(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Mu:e.collectionGroups,Ou:t}})()}}function Sp(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class xp{constructor(e){this.key=e}}class Cp{constructor(e){this.key=e}}class kp{constructor(e,t){this.query=e,this.Fu=t,this.$u=null,this.current=!1,this.Bu=De(),this.mutatedKeys=De(),this.Lu=du(e),this.Uu=new Ou(this.Lu)}get qu(){return this.Fu}Ku(e,t){const r=t?t.Gu:new bp,i=t?t.Uu:this.Uu;let o=t?t.mutatedKeys:this.mutatedKeys,u=i,h=!1;const f="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,m="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((v,T)=>{const O=i.get(v),U=ua(this.query,T)?T:null,B=!!O&&this.mutatedKeys.has(O.key),Y=!!U&&(U.hasLocalMutations||this.mutatedKeys.has(U.key)&&U.hasCommittedMutations);let oe=!1;O&&U?O.data.isEqual(U.data)?B!==Y&&(r.track({type:3,doc:U}),oe=!0):this.Qu(O,U)||(r.track({type:2,doc:U}),oe=!0,(f&&this.Lu(U,f)>0||m&&this.Lu(U,m)<0)&&(h=!0)):!O&&U?(r.track({type:0,doc:U}),oe=!0):O&&!U&&(r.track({type:1,doc:O}),oe=!0,(f||m)&&(h=!0)),oe&&(U?(u=u.add(U),o=Y?o.add(v):o.delete(v)):(u=u.delete(v),o=o.delete(v)))}),null!==this.query.limit)for(;u.size>this.query.limit;){const v="F"===this.query.limitType?u.last():u.first();u=u.delete(v.key),o=o.delete(v.key),r.track({type:1,doc:v})}return{Uu:u,Gu:r,Mi:h,mutatedKeys:o}}Qu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const o=e.Gu.pu();o.sort((m,v)=>function(T,O){const U=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ne()}};return U(T)-U(O)}(m.type,v.type)||this.Lu(m.doc,v.doc)),this.ju(r);const u=t?this.Wu():[],h=0===this.Bu.size&&this.current?1:0,f=h!==this.$u;return this.$u=h,0!==o.length||f?{snapshot:new Pu(this.query,e.Uu,i,o,e.mutatedKeys,0===h,f,!1),zu:u}:{zu:u}}Eu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new bp,mutatedKeys:this.mutatedKeys,Mi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(t=>this.Fu=this.Fu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Fu=this.Fu.delete(t)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=De(),this.Uu.forEach(r=>{this.Hu(r.key)&&(this.Bu=this.Bu.add(r.key))});const t=[];return e.forEach(r=>{this.Bu.has(r)||t.push(new Cp(r))}),this.Bu.forEach(r=>{e.has(r)||t.push(new xp(r))}),t}Ju(e){this.Fu=e.ji,this.Bu=De();const t=this.Ku(e.documents);return this.applyChanges(t,!0)}Yu(){return Pu.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}class Py{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class My{constructor(e){this.key=e,this.Xu=!1}}class Ly{constructor(e,t,r,i,o,u){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.Zu={},this.tc=new Oi(h=>Xc(h),dr),this.ec=new Map,this.nc=new Set,this.sc=new _t(ee.comparator),this.ic=new Map,this.rc=new kh,this.oc={},this.uc=new Map,this.cc=Ea.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return!0===this.ac}}function Fy(n,e){return fd.apply(this,arguments)}function fd(){return fd=(0,R.Z)(function*(n,e){const t=Ld(n);let r,i;const o=t.tc.get(e);if(o)r=o.targetId,t.sharedClientState.addLocalQueryTarget(r),i=o.view.Yu();else{const u=yield xu(t.localStore,gn(e));t.isPrimaryClient&&Rl(t.remoteStore,u);const h=t.sharedClientState.addLocalQueryTarget(u.targetId);r=u.targetId,i=yield pd(t,e,r,"current"===h)}return i}),fd.apply(this,arguments)}function pd(n,e,t,r){return gd.apply(this,arguments)}function gd(){return gd=(0,R.Z)(function*(n,e,t,r){n.hc=(v,T,O)=>{return(U=(0,R.Z)(function*(B,Y,oe,Me){let Qe=Y.view.Ku(oe);Qe.Mi&&(Qe=yield Cl(B.localStore,Y.query,!1).then(({documents:Oe})=>Y.view.Ku(Oe,Qe)));const Ke=Me&&Me.targetChanges.get(Y.targetId),Re=Y.view.applyChanges(Qe,B.isPrimaryClient,Ke);return Ad(B,Y.targetId,Re.zu),Re.snapshot}),function(B,Y,oe,Me){return U.apply(this,arguments)})(n,v,T,O);var U};const i=yield Cl(n.localStore,e,!0),o=new kp(e,i.ji),u=o.Ku(i.documents),h=da.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState),f=o.applyChanges(u,n.isPrimaryClient,h);Ad(n,t,f.zu);const m=new Py(e,t,o);return n.tc.set(e,m),n.ec.has(t)?n.ec.get(t).push(e):n.ec.set(t,[e]),f.snapshot}),gd.apply(this,arguments)}function Uy(n,e){return md.apply(this,arguments)}function md(){return md=(0,R.Z)(function*(n,e){const t=X(n),r=t.tc.get(e),i=t.ec.get(r.targetId);if(i.length>1)return t.ec.set(r.targetId,i.filter(o=>!dr(o,e))),void t.tc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Cu(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),bc(t.remoteStore,r.targetId),Mu(t,r.targetId)}).catch(Kn))):(Mu(t,r.targetId),yield Cu(t.localStore,r.targetId,!0))}),md.apply(this,arguments)}function yd(){return yd=(0,R.Z)(function*(n,e,t){const r=Fd(n);try{const i=yield function(o,u){const h=X(o),f=We.now(),m=u.reduce((O,U)=>O.add(U.key),De());let v,T;return h.persistence.runTransaction("Locally write mutations","readwrite",O=>{let U=mn(),B=De();return h.Ui.getEntries(O,m).next(Y=>{U=Y,U.forEach((oe,Me)=>{Me.isValidDocument()||(B=B.add(oe))})}).next(()=>h.localDocuments.getOverlayedDocuments(O,U)).next(Y=>{v=Y;const oe=[];for(const Me of u){const Qe=yh(Me,v.get(Me.key).overlayedDocument);null!=Qe&&oe.push(new Nn(Me.key,Qe,Kc(Qe.value.mapValue),ct.exists(!0)))}return h.mutationQueue.addMutationBatch(O,f,oe,u)}).next(Y=>{T=Y;const oe=Y.applyToLocalDocumentSet(v,B);return h.documentOverlayCache.saveOverlays(O,Y.batchId,oe)})}).then(()=>({batchId:T.batchId,changes:sc(v)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,h){let f=o.oc[o.currentUser.toKey()];f||(f=new _t(Se)),f=f.insert(u,h),o.oc[o.currentUser.toKey()]=f}(r,i.batchId,t),yield Es(r,i.changes),yield Du(r.remoteStore)}catch(i){const o=Ru(i,"Failed to persist write");t.reject(o)}}),yd.apply(this,arguments)}function Dp(n,e){return _d.apply(this,arguments)}function _d(){return _d=(0,R.Z)(function*(n,e){const t=X(n);try{const r=yield oy(t.localStore,e);e.targetChanges.forEach((i,o)=>{const u=t.ic.get(o);u&&(ve(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?u.Xu=!0:i.modifiedDocuments.size>0?ve(u.Xu):i.removedDocuments.size>0&&(ve(u.Xu),u.Xu=!1))}),yield Es(t,r,e)}catch(r){yield Kn(r)}}),_d.apply(this,arguments)}function Np(n,e,t){const r=X(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.tc.forEach((o,u)=>{const h=u.view.Eu(e);h.snapshot&&i.push(h.snapshot)}),function(o,u){const h=X(o);h.onlineState=u;let f=!1;h.queries.forEach((m,v)=>{for(const T of v.listeners)T.Eu(u)&&(f=!0)}),f&&hd(h)}(r.eventManager,e),i.length&&r.Zu.Go(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function By(n,e,t){return vd.apply(this,arguments)}function vd(){return vd=(0,R.Z)(function*(n,e,t){const r=X(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ic.get(e),o=i&&i.key;if(o){let u=new _t(ee.comparator);u=u.insert(o,Je.newNoDocument(o,be.min()));const h=De().add(o),f=new ha(be.min(),new Map,new Be(Se),u,h);yield Dp(r,f),r.sc=r.sc.remove(o),r.ic.delete(e),Sd(r)}else yield Cu(r.localStore,e,!1).then(()=>Mu(r,e,t)).catch(Kn)}),vd.apply(this,arguments)}function $y(n,e){return Id.apply(this,arguments)}function Id(){return Id=(0,R.Z)(function*(n,e){const t=X(n),r=e.batch.batchId;try{const i=yield sy(t.localStore,e);bd(t,r,null),Td(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Es(t,i)}catch(i){yield Kn(i)}}),Id.apply(this,arguments)}function jy(n,e,t){return wd.apply(this,arguments)}function wd(){return wd=(0,R.Z)(function*(n,e,t){const r=X(n);try{const i=yield function(o,u){const h=X(o);return h.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let m;return h.mutationQueue.lookupMutationBatch(f,u).next(v=>(ve(null!==v),m=v.keys(),h.mutationQueue.removeMutationBatch(f,v))).next(()=>h.mutationQueue.performConsistencyCheck(f)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(f,m,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m)).next(()=>h.localDocuments.getDocuments(f,m))})}(r.localStore,e);bd(r,e,t),Td(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Es(r,i)}catch(i){yield Kn(i)}}),wd.apply(this,arguments)}function Ed(){return Ed=(0,R.Z)(function*(n,e){const t=X(n);mo(t.remoteStore)||Z("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(o){const u=X(o);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>u.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(-1===r)return void e.resolve();const i=t.uc.get(r)||[];i.push(e),t.uc.set(r,i)}catch(r){const i=Ru(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),Ed.apply(this,arguments)}function Td(n,e){(n.uc.get(e)||[]).forEach(t=>{t.resolve()}),n.uc.delete(e)}function bd(n,e,t){const r=X(n);let i=r.oc[r.currentUser.toKey()];if(i){const o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.oc[r.currentUser.toKey()]=i}}function Mu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.ec.get(e))n.tc.delete(r),t&&n.Zu.lc(r,t);n.ec.delete(e),n.isPrimaryClient&&n.rc.us(e).forEach(r=>{n.rc.containsKey(r)||Rp(n,r)})}function Rp(n,e){n.nc.delete(e.path.canonicalString());const t=n.sc.get(e);null!==t&&(bc(n.remoteStore,t),n.sc=n.sc.remove(e),n.ic.delete(t),Sd(n))}function Ad(n,e,t){for(const r of t)r instanceof xp?(n.rc.addReference(r.key,e),qy(n,r)):r instanceof Cp?(Z("SyncEngine","Document no longer in limbo: "+r.key),n.rc.removeReference(r.key,e),n.rc.containsKey(r.key)||Rp(n,r.key)):ne()}function qy(n,e){const t=e.key,r=t.path.canonicalString();n.sc.get(t)||n.nc.has(r)||(Z("SyncEngine","New document in limbo: "+t),n.nc.add(r),Sd(n))}function Sd(n){for(;n.nc.size>0&&n.sc.size<n.maxConcurrentLimboResolutions;){const e=n.nc.values().next().value;n.nc.delete(e);const t=new ee(Fe.fromString(e)),r=n.cc.next();n.ic.set(r,new My(t)),n.sc=n.sc.insert(t,r),Rl(n.remoteStore,new fo(gn(Ni(t.path)),r,2,Bt.ot))}}function Es(n,e,t){return xd.apply(this,arguments)}function xd(){return xd=(0,R.Z)(function*(n,e,t){const r=X(n),i=[],o=[],u=[];var h;r.tc.isEmpty()||(r.tc.forEach((h,f)=>{u.push(r.hc(f,e,t).then(m=>{if(m){r.isPrimaryClient&&r.sharedClientState.updateQueryState(f.targetId,m.fromCache?"not-current":"current"),i.push(m);const v=Oh.Vi(f.targetId,m);o.push(v)}}))}),yield Promise.all(u),r.Zu.Go(i),yield(h=(0,R.Z)(function*(f,m){const v=X(f);try{yield v.persistence.runTransaction("notifyLocalViewChanges","readwrite",T=>P.forEach(m,O=>P.forEach(O.Pi,U=>v.persistence.referenceDelegate.addReference(T,O.targetId,U)).next(()=>P.forEach(O.vi,U=>v.persistence.referenceDelegate.removeReference(T,O.targetId,U)))))}catch(T){if(!zn(T))throw T;Z("LocalStore","Failed to update sequence numbers: "+T)}for(const T of m){const O=T.targetId;if(!T.fromCache){const U=v.$i.get(O),Y=U.withLastLimboFreeSnapshotVersion(U.snapshotVersion);v.$i=v.$i.insert(O,Y)}}}),function(f,m){return h.apply(this,arguments)})(r.localStore,o))}),xd.apply(this,arguments)}function Ky(n,e){return Cd.apply(this,arguments)}function Cd(){return Cd=(0,R.Z)(function*(n,e){const t=X(n);if(!t.currentUser.isEqual(e)){Z("SyncEngine","User change. New user:",e.toKey());const r=yield op(t.localStore,e);t.currentUser=e,(i=t).uc.forEach(u=>{u.forEach(h=>{h.reject(new K(L.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.uc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Es(t,r.Ki)}var i}),Cd.apply(this,arguments)}function zy(n,e){const t=X(n),r=t.ic.get(e);if(r&&r.Xu)return De().add(r.key);{let i=De();const o=t.ec.get(e);if(!o)return i;for(const u of o){const h=t.tc.get(u);i=i.unionWith(h.view.qu)}return i}}function Zy(n,e){return kd.apply(this,arguments)}function kd(){return kd=(0,R.Z)(function*(n,e){const t=X(n),r=yield Cl(t.localStore,e.query,!0),i=e.view.Ju(r);return t.isPrimaryClient&&Ad(t,e.targetId,i.zu),i}),kd.apply(this,arguments)}function Wy(n,e){return Dd.apply(this,arguments)}function Dd(){return Dd=(0,R.Z)(function*(n,e){const t=X(n);return lp(t.localStore,e).then(r=>Es(t,r))}),Dd.apply(this,arguments)}function Hy(n,e,t,r){return Nd.apply(this,arguments)}function Nd(){return Nd=(0,R.Z)(function*(n,e,t,r){const i=X(n),o=yield function(u,h){const f=X(u),m=X(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",v=>m.yn(v,h).next(T=>T?f.localDocuments.getDocuments(v,T):P.resolve(null)))}(i.localStore,e);var h;null!==o?("pending"===t?yield Du(i.remoteStore):"acknowledged"===t||"rejected"===t?(bd(i,e,r||null),Td(i,e),h=e,X(X(i.localStore).mutationQueue).In(h)):ne(),yield Es(i,o)):Z("SyncEngine","Cannot apply mutation batch with id: "+e)}),Nd.apply(this,arguments)}function Rd(){return Rd=(0,R.Z)(function*(n,e){const t=X(n);if(Ld(t),Fd(t),!0===e&&!0!==t.ac){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield Op(t,r.toArray());t.ac=!0,yield id(t.remoteStore,!0);for(const o of i)Rl(t.remoteStore,o)}else if(!1===e&&!1!==t.ac){const r=[];let i=Promise.resolve();t.ec.forEach((o,u)=>{t.sharedClientState.isLocalQueryTarget(u)?r.push(u):i=i.then(()=>(Mu(t,u),Cu(t.localStore,u,!0))),bc(t.remoteStore,u)}),yield i,yield Op(t,r),function(o){const u=X(o);u.ic.forEach((h,f)=>{bc(u.remoteStore,f)}),u.rc.cs(),u.ic=new Map,u.sc=new _t(ee.comparator)}(t),t.ac=!1,yield id(t.remoteStore,!1)}}),Rd.apply(this,arguments)}function Op(n,e,t){return Od.apply(this,arguments)}function Od(){return Od=(0,R.Z)(function*(n,e,t){const r=X(n),i=[],o=[];for(const u of e){let h;const f=r.ec.get(u);if(f&&0!==f.length){h=yield xu(r.localStore,gn(f[0]));for(const m of f){const v=r.tc.get(m),T=yield Zy(r,v);T.snapshot&&o.push(T.snapshot)}}else{const m=yield cp(r.localStore,u);h=yield xu(r.localStore,m),yield pd(r,Pp(m),u,!1)}i.push(h)}return r.Zu.Go(o),i}),Od.apply(this,arguments)}function Pp(n){return Yc(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Yy(n){const e=X(n);return X(X(e.localStore).persistence).Ri()}function Jy(n,e,t,r){return Pd.apply(this,arguments)}function Pd(){return Pd=(0,R.Z)(function*(n,e,t,r){const i=X(n);if(i.ac)return void Z("SyncEngine","Ignoring unexpected query state notification.");const o=i.ec.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const u=yield lp(i.localStore,el(o[0])),h=ha.createSynthesizedRemoteEventForCurrentChange(e,"current"===t);yield Es(i,u,h);break}case"rejected":yield Cu(i.localStore,e,!0),Mu(i,e,r);break;default:ne()}}),Pd.apply(this,arguments)}function Xy(n,e,t){return Md.apply(this,arguments)}function Md(){return Md=(0,R.Z)(function*(n,e,t){const r=Ld(n);if(r.ac){for(const i of e){if(r.ec.has(i)){Z("SyncEngine","Adding an already active target "+i);continue}const o=yield cp(r.localStore,i),u=yield xu(r.localStore,o);yield pd(r,Pp(o),u.targetId,!1),Rl(r.remoteStore,u)}for(const i of t)r.ec.has(i)&&(yield Cu(r.localStore,i,!1).then(()=>{bc(r.remoteStore,i),Mu(r,i)}).catch(Kn))}}),Md.apply(this,arguments)}function Ld(n){const e=X(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Dp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=zy.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=By.bind(null,e),e.Zu.Go=Dy.bind(null,e.eventManager),e.Zu.lc=Ny.bind(null,e.eventManager),e}function Fd(n){const e=X(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$y.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=jy.bind(null,e),e}class Mp{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,R.Z)(function*(){t.wt=Ec(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),yield t.persistence.start(),t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore)})()}mc(e,t){return null}gc(e,t){return null}wc(e){return sp(this.persistence,new ip,e.initialUser,this.wt)}_c(e){return new np(Sl.Os,this.wt)}dc(e){return new pp}terminate(){var e=this;return(0,R.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Lp extends Mp{constructor(e,t,r){super(),this.yc=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,R.Z)(function*(){yield t().call(r,e),yield r.yc.initialize(r,e),yield Fd(r.yc.syncEngine),yield Du(r.yc.remoteStore),yield r.persistence.ci(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}wc(e){return sp(this.persistence,new ip,e.initialUser,this.wt)}mc(e,t){return new qm(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}gc(e,t){const r=new sa(t,this.persistence);return new io(e.asyncQueue,r)}_c(e){const t=Rh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Hn.withCacheSize(this.cacheSizeBytes):Hn.DEFAULT;return new Nh(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,mp(),Nl(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new pp}}class t_ extends Lp{constructor(e,t){super(e,t,!1),this.yc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,R.Z)(function*(){yield t().call(r,e);const i=r.yc.syncEngine;r.sharedClientState instanceof $h&&(r.sharedClientState.syncEngine={kr:Hy.bind(null,i),Mr:Jy.bind(null,i),Or:Xy.bind(null,i),Ri:Yy.bind(null,i),Nr:Wy.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.ci(function(){var o=(0,R.Z)(function*(u){yield function Qy(n,e){return Rd.apply(this,arguments)}(r.yc.syncEngine,u),r.gcScheduler&&(u&&!r.gcScheduler.started?r.gcScheduler.start():u||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(u&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():u||r.indexBackfillerScheduler.stop())});return function(u){return o.apply(this,arguments)}}())})()}dc(e){const t=mp();if(!$h.V(t))throw new K(L.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Rh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new $h(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Ud{initialize(e,t){var r=this;return(0,R.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>Np(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=Ky.bind(null,r.syncEngine),yield id(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new ky}createDatastore(e){const t=Ec(e.databaseInfo.databaseId),r=new fy(e.databaseInfo);return new my(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,o=h=>Np(this.syncEngine,h,0),u=gp.V()?new gp:new ly,new _y(t,r,i,o,u);var t,r,i,o,u}createSyncEngine(e,t){return function(r,i,o,u,h,f,m){const v=new Ly(r,i,o,u,h,f);return m&&(v.ac=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,R.Z)(function*(t){const r=X(t);Z("RemoteStore","RemoteStore shutting down."),r.lu.add(5),yield ku(r),r.du.shutdown(),r._u.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function Fp(n,e=10240){let t=0;return{read:()=>(0,R.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,R.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class Pl{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):et("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class n_{constructor(e,t){this.Ec=e,this.wt=t,this.metadata=new gt,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(r=>{r&&r.Cu()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.payload)}`))},r=>this.metadata.reject(r))}close(){return this.Ec.cancel()}getMetadata(){var e=this;return(0,R.Z)(function*(){return e.metadata.promise})()}fc(){var e=this;return(0,R.Z)(function*(){return yield e.getMetadata(),e.Rc()})()}Rc(){var e=this;return(0,R.Z)(function*(){const t=yield e.bc();if(null===t)return null;const r=e.Ac.decode(t),i=Number(r);isNaN(i)&&e.Pc(`length string (${r}) is not valid number`);const o=yield e.vc(i);return new Ry(JSON.parse(o),t.length+i)})()}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}bc(){var e=this;return(0,R.Z)(function*(){for(;e.Vc()<0&&!(yield e.Sc()););if(0===e.buffer.length)return null;const t=e.Vc();t<0&&e.Pc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}vc(e){var t=this;return(0,R.Z)(function*(){for(;t.buffer.length<e;)(yield t.Sc())&&t.Pc("Reached the end of bundle when more is expected.");const r=t.Ac.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}Sc(){var e=this;return(0,R.Z)(function*(){const t=yield e.Ec.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class r_{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,R.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new K(L.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,R.Z)(function*(o,u){const h=X(o),f=g(h.wt)+"/documents",m={documents:u.map(U=>c(h.wt,U))},v=yield h.ao("BatchGetDocuments",f,m,u.length),T=new Map;v.forEach(U=>{const B=function H(n,e){return"found"in e?function(t,r){ve(!!r.found);const i=s(t,r.found.name),o=jt(r.found.updateTime),u=new $t({mapValue:{fields:r.found.fields}});return Je.newFoundDocument(i,o,u)}(n,e):"missing"in e?function(t,r){ve(!!r.missing),ve(!!r.readTime);const i=s(t,r.missing),o=jt(r.readTime);return Je.newNoDocument(i,o)}(n,e):ne()}(h.wt,U);T.set(B.key.toString(),B)});const O=[];return u.forEach(U=>{const B=T.get(U.toString());ve(!!B),O.push(B)}),O}),function(o,u){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ho(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,R.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const o=ee.fromPath(i);e.mutations.push(new nc(o,e.precondition(o)))}),yield(r=(0,R.Z)(function*(i,o){const u=X(i),h=g(u.wt)+"/documents",f={writes:o.map(m=>_e(u.wt,m))};yield u.ro("Commit",h,f)}),function(i,o){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ne();t=be.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new K(L.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?ct.updateTime(t):ct.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(be.min()))throw new K(L.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ct.updateTime(t)}return ct.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class i_{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this.Dc=r.maxAttempts,this.So=new jh(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){var e=this;this.So.Io((0,R.Z)(function*(){const t=new r_(e.datastore),r=e.xc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(o=>{e.Nc(o)}))}).catch(i=>{e.Nc(i)})}))}xc(e){try{const t=this.updateFunction(e);return!y(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!vu(t)}return!1}}class s_{constructor(e,t,r,i){var o=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Tt.UNAUTHENTICATED,this.clientId=wi.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var u=(0,R.Z)(function*(h){Z("FirestoreClient","Received user=",h.uid),yield o.authCredentialListener(h),o.user=h});return function(h){return u.apply(this,arguments)}}()),this.appCheckCredentials.start(r,u=>(Z("FirestoreClient","Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}getConfiguration(){var e=this;return(0,R.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new K(L.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new gt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,R.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=Ru(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function Up(n,e){return Vd.apply(this,arguments)}function Vd(){return Vd=(0,R.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),Z("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,R.Z)(function*(o){r.isEqual(o)||(yield op(e.localStore,o),r=o)});return function(o){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),Vd.apply(this,arguments)}function Vp(n,e){return Bd.apply(this,arguments)}function Bd(){return Bd=(0,R.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield $d(n);Z("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>Tp(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,o)=>Tp(e.remoteStore,o)),n.onlineComponents=e}),Bd.apply(this,arguments)}function $d(n){return jd.apply(this,arguments)}function jd(){return jd=(0,R.Z)(function*(n){return n.offlineComponents||(Z("FirestoreClient","Using default OfflineComponentProvider"),yield Up(n,new Mp)),n.offlineComponents}),jd.apply(this,arguments)}function Ml(n){return Gd.apply(this,arguments)}function Gd(){return Gd=(0,R.Z)(function*(n){return n.onlineComponents||(Z("FirestoreClient","Using default OnlineComponentProvider"),yield Vp(n,new Ud)),n.onlineComponents}),Gd.apply(this,arguments)}function Bp(n){return $d(n).then(e=>e.persistence)}function Ll(n){return $d(n).then(e=>e.localStore)}function $p(n){return Ml(n).then(e=>e.remoteStore)}function qd(n){return Ml(n).then(e=>e.syncEngine)}function Lu(n){return Kd.apply(this,arguments)}function Kd(){return Kd=(0,R.Z)(function*(n){const e=yield Ml(n),t=e.eventManager;return t.onListen=Fy.bind(null,e.syncEngine),t.onUnlisten=Uy.bind(null,e.syncEngine),t}),Kd.apply(this,arguments)}function jp(n,e,t={}){const r=new gt;return n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return function(i,o,u,h,f){const m=new Pl({next:T=>{o.enqueueAndForget(()=>cd(i,v));const O=T.docs.has(u);!O&&T.fromCache?f.reject(new K(L.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&T.fromCache&&h&&"server"===h.source?f.reject(new K(L.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(T)},error:T=>f.reject(T)}),v=new dd(Ni(u.path),m,{includeMetadataChanges:!0,Du:!0});return ad(i,v)}(yield Lu(n),n.asyncQueue,e,t,r)})),r.promise}function Gp(n,e,t={}){const r=new gt;return n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return function(i,o,u,h,f){const m=new Pl({next:T=>{o.enqueueAndForget(()=>cd(i,v)),T.fromCache&&"server"===h.source?f.reject(new K(L.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(T)},error:T=>f.reject(T)}),v=new dd(u,m,{includeMetadataChanges:!0,Du:!0});return ad(i,v)}(yield Lu(n),n.asyncQueue,e,t,r)})),r.promise}const qp=new Map;function zd(n,e,t){if(!t)throw new K(L.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Kp(n,e,t,r){if(!0===e&&!0===r)throw new K(L.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function zp(n){if(!ee.isDocumentKey(n))throw new K(L.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Zp(n){if(ee.isDocumentKey(n))throw new K(L.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Fl(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":ne()}function qe(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new K(L.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Fl(n);throw new K(L.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Wp(n,e){if(e<=0)throw new K(L.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class Hp{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new K(L.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new K(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,Kp("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ac{constructor(e,t,r){this._authCredentials=t,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Hp({}),this._settingsFrozen=!1,e instanceof p?this._databaseId=e:(this._app=e,this._databaseId=function(i){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new K(L.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new p(i.options.projectId)}(e))}get app(){if(!this._app)throw new K(L.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new K(L.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Hp(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new Qa;switch(t.type){case"gapi":const r=t.client;return ve(!("object"!=typeof r||null===r||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new Jo(r,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new K(L.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=qp.get(e);t&&(Z("ComponentProvider","Removing Datastore"),qp.delete(e),t.terminate())}(this),Promise.resolve()}}class It{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Li(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new It(this.firestore,e,this._key)}}class _n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new _n(this.firestore,e,this._query)}}class Li extends _n{constructor(e,t,r){super(e,t,Ni(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new It(this.firestore,null,new ee(e))}withConverter(e){return new Li(this.firestore,e,this._path)}}function Qp(n,e,...t){if(n=(0,le.m9)(n),zd("collection","path",e),n instanceof Ac){const r=Fe.fromString(e,...t);return Zp(r),new Li(n,null,r)}{if(!(n instanceof It||n instanceof Li))throw new K(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Fe.fromString(e,...t));return Zp(r),new Li(n.firestore,null,r)}}function Ul(n,e,...t){if(n=(0,le.m9)(n),1===arguments.length&&(e=wi.I()),zd("doc","path",e),n instanceof Ac){const r=Fe.fromString(e,...t);return zp(r),new It(n,null,new ee(r))}{if(!(n instanceof It||n instanceof Li))throw new K(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Fe.fromString(e,...t));return zp(r),new It(n.firestore,n instanceof Li?n.converter:null,new ee(r))}}function Yp(n,e){return n=(0,le.m9)(n),e=(0,le.m9)(e),(n instanceof It||n instanceof Li)&&(e instanceof It||e instanceof Li)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Jp(n,e){return n=(0,le.m9)(n),e=(0,le.m9)(e),n instanceof _n&&e instanceof _n&&n.firestore===e.firestore&&dr(n._query,e._query)&&n.converter===e.converter}class m_{constructor(){this.Mc=Promise.resolve(),this.Oc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new jh(this,"async_queue_retry"),this.Kc=()=>{const t=Nl();t&&Z("AsyncQueue","Visibility state changed to "+t.visibilityState),this.So.Eo()};const e=Nl();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const t=Nl();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const t=new gt;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Oc.push(e),this.jc()))}jc(){var e=this;return(0,R.Z)(function*(){if(0!==e.Oc.length){try{yield e.Oc[0](),e.Oc.shift(),e.So.reset()}catch(t){if(!zn(t))throw t;Z("AsyncQueue","Operation failed with retryable error: "+t)}e.Oc.length>0&&e.So.Io(()=>e.jc())}})()}Qc(e){const t=this.Mc.then(()=>(this.Lc=!0,e().catch(r=>{throw this.Bc=r,this.Lc=!1,et("INTERNAL UNHANDLED ERROR: ",function(o){let u=o.message||"";return o.stack&&(u=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),u}(r)),r}).then(r=>(this.Lc=!1,r))));return this.Mc=t,t}enqueueAfterDelay(e,t,r){this.Gc(),this.qc.indexOf(e)>-1&&(t=0);const i=od.createAndSchedule(this,e,t,r,o=>this.Wc(o));return this.$c.push(i),i}Gc(){this.Bc&&ne()}verifyOperationInProgress(){}zc(){var e=this;return(0,R.Z)(function*(){let t;do{t=e.Mc,yield t}while(t!==e.Mc)})()}Hc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}function Zd(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class y_{constructor(){this._progressObserver={},this._taskCompletionResolver=new gt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class bt extends Ac{constructor(e,t,r){super(e,t,r),this.type="firestore",this._queue=new m_,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Xp(this),this._firestoreClient.terminate()}}function Gt(n){return n._firestoreClient||Xp(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Xp(n){var e;const t=n._freezeSettings(),r=(o=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new d(n._databaseId,o,n._persistenceKey,(h=t).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,h.useFetchStreams));var o,h;n._firestoreClient=new s_(n._authCredentials,n._appCheckCredentials,n._queue,r)}function eg(n,e,t){const r=new gt;return n.asyncQueue.enqueue((0,R.Z)(function*(){try{yield Up(n,t),yield Vp(n,e),r.resolve()}catch(i){const o=i;if(!("FirebaseError"===(u=o).name?u.code===L.FAILED_PRECONDITION||u.code===L.UNIMPLEMENTED:!(typeof DOMException<"u"&&u instanceof DOMException)||22===u.code||20===u.code||11===u.code))throw o;Rr("Error enabling offline persistence. Falling back to persistence disabled: "+o),r.reject(o)}var u})).then(()=>r.promise)}function tg(n){if(n._initialized||n._terminated)throw new K(L.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Ts{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new K(L.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Fi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fi(vt.fromBase64String(e))}catch(t){throw new K(L.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Fi(vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class ba{constructor(e){this._methodName=e}}class Vl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new K(L.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new K(L.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Se(this._lat,e._lat)||Se(this._long,e._long)}}const x_=/^__.*__$/;class C_{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Nn(e,this.data,this.fieldMask,t,this.fieldTransforms):new lo(e,this.data,t,this.fieldTransforms)}}class ng{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Nn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function rg(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ne()}}class Bl{constructor(e,t,r,i,o,u){this.settings=e,this.databaseId=t,this.wt=r,this.ignoreUndefinedProperties=i,void 0===o&&this.Xc(),this.fieldTransforms=o||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new Bl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ta({path:r,na:!1});return i.sa(e),i}ia(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ta({path:r,na:!1});return i.Xc(),i}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return Gl(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(rg(this.Zc)&&x_.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class k_{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.wt=r||Ec(e)}aa(e,t,r,i=!1){return new Bl({Zc:e,methodName:t,ca:r,path:mt.emptyPath(),na:!1,ua:i},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function Aa(n){const e=n._freezeSettings(),t=Ec(n._databaseId);return new k_(n._databaseId,!!e.ignoreUndefinedProperties,t)}function $l(n,e,t,r,i,o={}){const u=n.aa(o.merge||o.mergeFields?2:0,e,t,i);Yd("Data must be an object, but it was:",u,r);const h=og(r,u);let f,m;if(o.merge)f=new ln(u.fieldMask),m=u.fieldTransforms;else if(o.mergeFields){const v=[];for(const T of o.mergeFields){const O=Jd(e,T,t);if(!u.contains(O))throw new K(L.INVALID_ARGUMENT,`Field '${O}' is specified in your field mask but missing from your input data.`);ug(v,O)||v.push(O)}f=new ln(v),m=u.fieldTransforms.filter(T=>f.covers(T.field))}else f=null,m=u.fieldTransforms;return new C_(new $t(h),f,m)}class Sc extends ba{_toFieldTransform(e){if(2!==e.Zc)throw e.oa(1===e.Zc?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Sc}}function ig(n,e,t){return new Bl({Zc:3,ca:e.settings.ca,methodName:n._methodName,na:t},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class Wd extends ba{_toFieldTransform(e){return new _s(e.path,new uo)}isEqual(e){return e instanceof Wd}}class D_ extends ba{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=ig(this,e,!0),r=this.ha.map(o=>Sa(o,t)),i=new ys(r);return new _s(e.path,i)}isEqual(e){return this===e}}class N_ extends ba{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=ig(this,e,!0),r=this.ha.map(o=>Sa(o,t)),i=new Ri(r);return new _s(e.path,i)}isEqual(e){return this===e}}class R_ extends ba{constructor(e,t){super(e),this.la=t}_toFieldTransform(e){const t=new co(e.wt,nl(e.wt,this.la));return new _s(e.path,t)}isEqual(e){return this===e}}function Hd(n,e,t,r){const i=n.aa(1,e,t);Yd("Data must be an object, but it was:",i,r);const o=[],u=$t.empty();Si(r,(f,m)=>{const v=jl(e,f,t);m=(0,le.m9)(m);const T=i.ia(v);if(m instanceof Sc)o.push(v);else{const O=Sa(m,T);null!=O&&(o.push(v),u.set(v,O))}});const h=new ln(o);return new ng(u,h,i.fieldTransforms)}function Qd(n,e,t,r,i,o){const u=n.aa(1,e,t),h=[Jd(e,r,t)],f=[i];if(o.length%2!=0)throw new K(L.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let O=0;O<o.length;O+=2)h.push(Jd(e,o[O])),f.push(o[O+1]);const m=[],v=$t.empty();for(let O=h.length-1;O>=0;--O)if(!ug(m,h[O])){const U=h[O];let B=f[O];B=(0,le.m9)(B);const Y=u.ia(U);if(B instanceof Sc)m.push(U);else{const oe=Sa(B,Y);null!=oe&&(m.push(U),v.set(U,oe))}}const T=new ln(m);return new ng(v,T,u.fieldTransforms)}function sg(n,e,t,r=!1){return Sa(t,n.aa(r?4:3,e))}function Sa(n,e){if(ag(n=(0,le.m9)(n)))return Yd("Unsupported field value:",e,n),og(n,e);if(n instanceof ba)return function(t,r){if(!rg(r.Zc))throw r.oa(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.oa(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.na&&4!==e.Zc)throw e.oa("Nested arrays are not supported");return function(t,r){const i=[];let o=0;for(const u of t){let h=Sa(u,r.ra(o));null==h&&(h={nullValue:"NULL_VALUE"}),i.push(h),o++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,le.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return nl(r.wt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=We.fromDate(t);return{timestampValue:pa(r.wt,i)}}if(t instanceof We){const i=new We(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:pa(r.wt,i)}}if(t instanceof Vl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Fi)return{bytesValue:Tu(r.wt,t._byteString)};if(t instanceof It){const i=r.databaseId,o=t.firestore._databaseId;if(!o.isEqual(i))throw r.oa(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:uc(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.oa(`Unsupported field value: ${Fl(t)}`)}(n,e)}function og(n,e){const t={};return oa(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Si(n,(r,i)=>{const o=Sa(i,e.ea(r));null!=o&&(t[r]=o)}),{mapValue:{fields:t}}}function ag(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof We||n instanceof Vl||n instanceof Fi||n instanceof It||n instanceof ba)}function Yd(n,e,t){if(!ag(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=Fl(t);throw e.oa("an object"===r?n+" a custom object":n+" "+r)}var r}function Jd(n,e,t){if((e=(0,le.m9)(e))instanceof Ts)return e._internalPath;if("string"==typeof e)return jl(n,e);throw Gl("Field path arguments must be of type string or ",n,!1,void 0,t)}const O_=new RegExp("[~\\*/\\[\\]]");function jl(n,e,t){if(e.search(O_)>=0)throw Gl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ts(...e.split("."))._internalPath}catch{throw Gl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Gl(n,e,t,r,i){const o=r&&!r.isEmpty(),u=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(o||u)&&(f+=" (found",o&&(f+=` in field ${r}`),u&&(f+=` in document ${i}`),f+=")"),new K(L.INVALID_ARGUMENT,h+n+f)}function ug(n,e){return n.some(t=>t.isEqual(e))}class xc{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new It(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new P_(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ql("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class P_ extends xc{data(){return super.data()}}function ql(n,e){return"string"==typeof e?jl(n,e):e instanceof Ts?e._internalPath:e._delegate._internalPath}class xa{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class bs extends xc{constructor(e,t,r,i,o,u){super(e,t,r,i,u),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Cc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(ql("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Cc extends bs{data(e={}){return super.data(e)}}class _o{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new xa(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Cc(this._firestore,this._userDataWriter,r.key,r,new xa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new K(L.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(u=>({type:"added",doc:new Cc(r._firestore,r._userDataWriter,u.doc.key,u.doc,new xa(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:o++}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(u=>i||3!==u.type).map(u=>{const h=new Cc(r._firestore,r._userDataWriter,u.doc.key,u.doc,new xa(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);let f=-1,m=-1;return 0!==u.type&&(f=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),1!==u.type&&(o=o.add(u.doc),m=o.indexOf(u.doc.key)),{type:M_(u.type),doc:h,oldIndex:f,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function M_(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ne()}}function cg(n,e){return n instanceof bs&&e instanceof bs?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof _o&&e instanceof _o&&n._firestore===e._firestore&&Jp(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function lg(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new K(L.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class kc{}function vo(n,...e){for(const t of e)n=t._apply(n);return n}class L_ extends kc{constructor(e,t,r){super(),this.fa=e,this.da=t,this._a=r,this.type="where"}_apply(e){const t=Aa(e.firestore),r=function(i,o,u,h,f,m,v){let T;if(f.isKeyField()){if("array-contains"===m||"array-contains-any"===m)throw new K(L.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if("in"===m||"not-in"===m){mg(v,m);const U=[];for(const B of v)U.push(gg(h,i,B));T={arrayValue:{values:U}}}else T=gg(h,i,v)}else"in"!==m&&"not-in"!==m&&"array-contains-any"!==m||mg(v,m),T=sg(u,"where",v,"in"===m||"not-in"===m);const O=Wt.create(f,m,T);return function(U,B){if(B.ht()){const oe=hu(U);if(null!==oe&&!oe.isEqual(B.field))throw new K(L.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${oe.toString()}' and '${B.field.toString()}'`);const Me=lu(U);null!==Me&&yg(0,B.field,Me)}const Y=function(oe,Me){for(const Qe of oe.filters)if(Me.indexOf(Qe.op)>=0)return Qe.op;return null}(U,function(oe){switch(oe){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(B.op));if(null!==Y)throw new K(L.INVALID_ARGUMENT,Y===B.op?`Invalid query. You cannot use more than one '${B.op.toString()}' filter.`:`Invalid query. You cannot use '${B.op.toString()}' filters with '${Y.toString()}' filters.`)}(i,O),O}(e._query,0,t,e.firestore._databaseId,this.fa,this.da,this._a);return new _n(e.firestore,e.converter,function(i,o){const u=i.filters.concat([o]);return new Pr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),u,i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}class U_ extends kc{constructor(e,t){super(),this.fa=e,this.wa=t,this.type="orderBy"}_apply(e){const t=function(r,i,o){if(null!==r.startAt)throw new K(L.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new K(L.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const u=new Di(i,o);return function(h,f){if(null===lu(h)){const m=hu(h);null!==m&&yg(0,m,f.field)}}(r,u),u}(e._query,this.fa,this.wa);return new _n(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new Pr(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class hg extends kc{constructor(e,t,r){super(),this.type=e,this.ma=t,this.ga=r}_apply(e){return new _n(e.firestore,e.converter,Ju(e._query,this.ma,this.ga))}}class dg extends kc{constructor(e,t,r){super(),this.type=e,this.ya=t,this.pa=r}_apply(e){const t=pg(e,this.type,this.ya,this.pa);return new _n(e.firestore,e.converter,(i=t,new Pr((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class fg extends kc{constructor(e,t,r){super(),this.type=e,this.ya=t,this.pa=r}_apply(e){const t=pg(e,this.type,this.ya,this.pa);return new _n(e.firestore,e.converter,(i=t,new Pr((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function pg(n,e,t,r){if(t[0]=(0,le.m9)(t[0]),t[0]instanceof xc)return function(i,o,u,h,f){if(!h)throw new K(L.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);const m=[];for(const v of ao(i))if(v.field.isKeyField())m.push(Cn(o,h.key));else{const T=h.data.field(v.field);if(so(T))throw new K(L.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+v.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===T){const O=v.field.canonicalString();throw new K(L.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${O}' (used as the orderBy) does not exist.`)}m.push(T)}return new ki(m,f)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Aa(n.firestore);return function(o,u,h,f,m,v){const T=o.explicitOrderBy;if(m.length>T.length)throw new K(L.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const O=[];for(let U=0;U<m.length;U++){const B=m[U];if(T[U].field.isKeyField()){if("string"!=typeof B)throw new K(L.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof B}`);if(!Yu(o)&&-1!==B.indexOf("/"))throw new K(L.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${B}' contains a slash.`);const Y=o.path.child(Fe.fromString(B));if(!ee.isDocumentKey(Y))throw new K(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${Y}' is not because it contains an odd number of segments.`);const oe=new ee(Y);O.push(Cn(u,oe))}else{const Y=sg(h,f,B);O.push(Y)}}return new ki(O,v)}(n._query,n.firestore._databaseId,i,e,t,r)}}function gg(n,e,t){if("string"==typeof(t=(0,le.m9)(t))){if(""===t)throw new K(L.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Yu(e)&&-1!==t.indexOf("/"))throw new K(L.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Fe.fromString(t));if(!ee.isDocumentKey(r))throw new K(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Cn(n,new ee(r))}if(t instanceof It)return Cn(n,t._key);throw new K(L.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Fl(t)}.`)}function mg(n,e){if(!Array.isArray(n)||0===n.length)throw new K(L.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new K(L.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function yg(n,e,t){if(!t.isEqual(e))throw new K(L.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}const z_={maxAttempts:5};class Xd{convertValue(e,t="none"){switch(Q(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ht(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(hr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ne()}}convertObject(e,t){const r={};return Si(e.fields,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertGeoPoint(e){return new Vl(ht(e.latitude),ht(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=ru(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(oo(e));default:return null}}convertTimestamp(e){const t=si(e);return new We(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Fe.fromString(e);ve(bu(r));const i=new p(r.get(1),r.get(3)),o=new ee(r.popFirst(5));return i.isEqual(t)||et(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}function Kl(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Z_ extends Xd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new It(this.firestore,null,t)}}class _g{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Aa(e)}set(e,t,r){this._verifyNotCommitted();const i=Io(e,this._firestore),o=Kl(i.converter,t,r),u=$l(this._dataReader,"WriteBatch.set",i._key,o,null!==i.converter,r);return this._mutations.push(u.toMutation(i._key,ct.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const o=Io(e,this._firestore);let u;return u="string"==typeof(t=(0,le.m9)(t))||t instanceof Ts?Qd(this._dataReader,"WriteBatch.update",o._key,t,r,i):Hd(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(u.toMutation(o._key,ct.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Io(e,this._firestore);return this._mutations=this._mutations.concat(new ho(t._key,ct.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new K(L.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Io(n,e){if((n=(0,le.m9)(n)).firestore!==e)throw new K(L.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class Ca extends Xd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new It(this.firestore,null,t)}}function vg(n,e,t){n=qe(n,It);const r=qe(n.firestore,bt),i=Kl(n.converter,e,t);return Fu(r,[$l(Aa(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,ct.none())])}function Ig(n,e,t,...r){n=qe(n,It);const i=qe(n.firestore,bt),o=Aa(i);let u;return u="string"==typeof(e=(0,le.m9)(e))||e instanceof Ts?Qd(o,"updateDoc",n._key,e,t,r):Hd(o,"updateDoc",n._key,e),Fu(i,[u.toMutation(n._key,ct.exists(!0))])}function wg(n,...e){var t,r,i;n=(0,le.m9)(n);let o={includeMetadataChanges:!1},u=0;"object"!=typeof e[u]||Zd(e[u])||(o=e[u],u++);const h={includeMetadataChanges:o.includeMetadataChanges};if(Zd(e[u])){const T=e[u];e[u]=null===(t=T.next)||void 0===t?void 0:t.bind(T),e[u+1]=null===(r=T.error)||void 0===r?void 0:r.bind(T),e[u+2]=null===(i=T.complete)||void 0===i?void 0:i.bind(T)}let f,m,v;if(n instanceof It)m=qe(n.firestore,bt),v=Ni(n._key.path),f={next:T=>{e[u]&&e[u](ef(m,n,T))},error:e[u+1],complete:e[u+2]};else{const T=qe(n,_n);m=qe(T.firestore,bt),v=T._query;const O=new Ca(m);f={next:U=>{e[u]&&e[u](new _o(m,O,T,U))},error:e[u+1],complete:e[u+2]},lg(n._query)}return function(T,O,U,B){const Y=new Pl(B),oe=new dd(O,Y,U);return T.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return ad(yield Lu(T),oe)})),()=>{Y.Tc(),T.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return cd(yield Lu(T),oe)}))}}(Gt(m),v,h,f)}function Fu(n,e){return function(t,r){const i=new gt;return t.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return function Vy(n,e,t){return yd.apply(this,arguments)}(yield qd(t),r,i)})),i.promise}(Gt(n),e)}function ef(n,e,t){const r=t.docs.get(e._key),i=new Ca(n);return new bs(n,i,e._key,r,new xa(t.hasPendingWrites,t.fromCache),e.converter)}class rv extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Aa(e)}get(e){const t=Io(e,this._firestore),r=new Z_(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return ne();const o=i[0];if(o.isFoundDocument())return new xc(this._firestore,r,o.key,o,t.converter);if(o.isNoDocument())return new xc(this._firestore,r,t._key,null,t.converter);throw ne()})}set(e,t,r){const i=Io(e,this._firestore),o=Kl(i.converter,t,r),u=$l(this._dataReader,"Transaction.set",i._key,o,null!==i.converter,r);return this._transaction.set(i._key,u),this}update(e,t,r,...i){const o=Io(e,this._firestore);let u;return u="string"==typeof(t=(0,le.m9)(t))||t instanceof Ts?Qd(this._dataReader,"Transaction.update",o._key,t,r,i):Hd(this._dataReader,"Transaction.update",o._key,t),this._transaction.update(o._key,u),this}delete(e){const t=Io(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Io(e,this._firestore),r=new Ca(this._firestore);return super.get(e).then(i=>new bs(this._firestore,r,t._key,i._document,new xa(!1,!1),t.converter))}}function tf(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new K("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function Tg(){if(typeof Uint8Array>"u")throw new K("unimplemented","Uint8Arrays are not available in this environment.")}function bg(){if(!function cr(){return typeof atob<"u"}())throw new K("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){Dr=we.SDK_VERSION,(0,we._registerComponent)(new Ee.wA("firestore",(t,{options:r})=>{const i=t.getProvider("app").getImmediate(),o=new bt(i,new Ya(t.getProvider("auth-internal")),new ar(t.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC")),(0,we.registerVersion)(hs,"3.4.14",n),(0,we.registerVersion)(hs,"3.4.14","esm2017")}();class Dc{constructor(e){this._delegate=e}static fromBase64String(e){return bg(),new Dc(Fi.fromBase64String(e))}static fromUint8Array(e){return Tg(),new Dc(Fi.fromUint8Array(e))}toBase64(){return bg(),this._delegate.toBase64()}toUint8Array(){return Tg(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function nf(n){return function dv(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class fv{enableIndexedDbPersistence(e,t){return function v_(n,e){tg(n=qe(n,bt));const t=Gt(n),r=n._freezeSettings(),i=new Ud;return eg(t,i,new Lp(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function I_(n){tg(n=qe(n,bt));const e=Gt(n),t=n._freezeSettings(),r=new Ud;return eg(e,r,new t_(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function w_(n){if(n._initialized&&!n._terminated)throw new K(L.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new gt;return n._queue.enqueueAndForgetEvenWhileRestricted((0,R.Z)(function*(){try{yield(t=(0,R.Z)(function*(r){if(!cn.V())return Promise.resolve();const i=r+"main";yield cn.delete(i)}),function(r){return t.apply(this,arguments)})(Rh(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class Ag{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof p||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Rr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function p_(n,e,t,r={}){var i;const o=(n=qe(n,Ac))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&Rr("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},o),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let u,h;if("string"==typeof r.mockUserToken)u=r.mockUserToken,h=Tt.MOCK_USER;else{u=(0,le.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new K(L.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Tt(f)}n._authCredentials=new Zu(new to(u,h))}}(this._delegate,e,t,r)}enableNetwork(){return function T_(n){return function o_(n){return n.asyncQueue.enqueue((0,R.Z)(function*(){const e=yield Bp(n),t=yield $p(n);return e.setNetworkEnabled(!0),function(r){const i=X(r);return i.lu.delete(0),Tc(i)}(t)}))}(Gt(n=qe(n,bt)))}(this._delegate)}disableNetwork(){return function b_(n){return function a_(n){return n.asyncQueue.enqueue((0,R.Z)(function*(){const e=yield Bp(n),t=yield $p(n);return e.setNetworkEnabled(!1),(r=(0,R.Z)(function*(i){const o=X(i);o.lu.add(0),yield ku(o),o._u.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(Gt(n=qe(n,bt)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Kp("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function E_(n){return function(e){const t=new gt;return e.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return function Gy(n,e){return Ed.apply(this,arguments)}(yield qd(e),t)})),t.promise}(Gt(n=qe(n,bt)))}(this._delegate)}onSnapshotsInSync(e){return function nv(n,e){return function l_(n,e){const t=new Pl(e);return n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return r=yield Lu(n),i=t,X(r).Tu.add(i),void i.next();var r,i})),()=>{t.Tc(),n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return r=yield Lu(n),i=t,void X(r).Tu.delete(i);var r,i}))}}(Gt(n=qe(n,bt)),Zd(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new K("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Uu(this,Qp(this._delegate,e))}catch(t){throw Rn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Fr(this,Ul(this._delegate,e))}catch(t){throw Rn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new On(this,function g_(n,e){if(n=qe(n,Ac),zd("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new K(L.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new _n(n,null,(t=e,new Pr(Fe.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Rn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function iv(n,e,t){n=qe(n,bt);const r=Object.assign(Object.assign({},z_),t);return function(i){if(i.maxAttempts<1)throw new K(L.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function h_(n,e,t){const r=new gt;return n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){const i=yield(o=n,Ml(o).then(u=>u.datastore));var o;new i_(n.asyncQueue,i,t,e,r).run()})),r.promise}(Gt(n),i=>e(new rv(n,i)),r)}(this._delegate,t=>e(new Sg(this,t)))}batch(){return Gt(this._delegate),new xg(new _g(this._delegate,e=>Fu(this._delegate,e)))}loadBundle(e){return function A_(n,e){const t=Gt(n=qe(n,bt)),r=new y_;return function d_(n,e,t,r){const i=function(o,u){let h;return h="string"==typeof o?(new TextEncoder).encode(o):o,f=function(f,m){if(f instanceof Uint8Array)return Fp(f,m);if(f instanceof ArrayBuffer)return Fp(new Uint8Array(f),m);if(f instanceof ReadableStream)return f.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),new n_(f,u);var f}(t,Ec(e));n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){!function e_(n,e,t){const r=X(n);var i;(i=(0,R.Z)(function*(o,u,h){try{const f=yield u.getMetadata();if(yield function(O,U){const B=X(O),Y=jt(U.createTime);return B.persistence.runTransaction("hasNewerBundle","readonly",oe=>B.Ds.getBundleMetadata(oe,U.id)).then(oe=>!!oe&&oe.createTime.compareTo(Y)>=0)}(o.localStore,f))return yield u.close(),h._completeWith({taskState:"Success",documentsLoaded:(O=f).totalDocuments,bytesLoaded:O.totalBytes,totalDocuments:O.totalDocuments,totalBytes:O.totalBytes}),Promise.resolve(new Set);h._updateProgress(Sp(f));const m=new Oy(f,o.localStore,u.wt);let v=yield u.fc();for(;v;){const O=yield m.Nu(v);O&&h._updateProgress(O),v=yield u.fc()}const T=yield m.complete();return yield Es(o,T.Ou,void 0),yield function(O,U){const B=X(O);return B.persistence.runTransaction("Save bundle","readwrite",Y=>B.Ds.saveBundleMetadata(Y,U))}(o.localStore,f),h._completeWith(T.progress),Promise.resolve(T.Mu)}catch(f){return Rr("SyncEngine",`Loading bundle failed with ${f}`),h._failWith(f),Promise.resolve(new Set)}var O}),function(o,u,h){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield qd(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function S_(n,e){return function f_(n,e){return n.asyncQueue.enqueue((0,R.Z)(function*(){return function(t,r){const i=X(t);return i.persistence.runTransaction("Get named query","readonly",o=>i.Ds.getNamedQuery(o,r))}(yield Ll(n),e)}))}(Gt(n=qe(n,bt)),e).then(t=>t?new _n(n,null,t.query):null)}(this._delegate,e).then(t=>t?new On(this,t):null)}}class zl extends Xd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dc(new Fi(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Fr.forKey(t,this.firestore,null)}}class Sg{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new zl(e)}get(e){const t=Da(e);return this._delegate.get(t).then(r=>new Nc(this._firestore,new bs(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Da(e);return r?(tf("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const o=Da(e);return 2===arguments.length?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){const t=Da(e);return this._delegate.delete(t),this}}class xg{constructor(e){this._delegate=e}set(e,t,r){const i=Da(e);return r?(tf("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const o=Da(e);return 2===arguments.length?this._delegate.update(o,t):this._delegate.update(o,t,r,...i),this}delete(e){const t=Da(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class ka{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Cc(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Rc(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=ka.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let o=i.get(t);return o||(o=new ka(e,new zl(e),t),i.set(t,o)),o}}ka.INSTANCES=new WeakMap;class Fr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new zl(e)}static forPath(e,t,r){if(e.length%2!=0)throw new K("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Fr(t,new It(t._delegate,r,new ee(e)))}static forKey(e,t,r){return new Fr(t,new It(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Uu(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Uu(this.firestore,Qp(this._delegate,e))}catch(t){throw Rn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,le.m9)(e))instanceof It&&Yp(this._delegate,e)}set(e,t){t=tf("DocumentReference.set",t);try{return t?vg(this._delegate,e,t):vg(this._delegate,e)}catch(r){throw Rn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?Ig(this._delegate,e):Ig(this._delegate,e,t,...r)}catch(i){throw Rn(i,"updateDoc()","DocumentReference.update()")}}delete(){return function ev(n){return Fu(qe(n.firestore,bt),[new ho(n._key,ct.none())])}(this._delegate)}onSnapshot(...e){const t=Cg(e),r=kg(e,i=>new Nc(this.firestore,new bs(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return wg(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function H_(n){n=qe(n,It);const e=qe(n.firestore,bt),t=Gt(e),r=new Ca(e);return function u_(n,e){const t=new gt;return n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return(r=(0,R.Z)(function*(i,o,u){try{const h=yield function(f,m){const v=X(f);return v.persistence.runTransaction("read document","readonly",T=>v.localDocuments.getDocument(T,m))}(i,o);h.isFoundDocument()?u.resolve(h):h.isNoDocument()?u.resolve(null):u.reject(new K(L.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const f=Ru(h,`Failed to get document '${o} from cache`);u.reject(f)}}),function(i,o,u){return r.apply(this,arguments)})(yield Ll(n),e,t);var r})),t.promise}(t,n._key).then(i=>new bs(e,r,n._key,i,new xa(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function Q_(n){n=qe(n,It);const e=qe(n.firestore,bt);return jp(Gt(e),n._key,{source:"server"}).then(t=>ef(e,n,t))}(this._delegate):function W_(n){n=qe(n,It);const e=qe(n.firestore,bt);return jp(Gt(e),n._key).then(t=>ef(e,n,t))}(this._delegate),t.then(r=>new Nc(this.firestore,new bs(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Fr(this.firestore,this._delegate.withConverter(e?ka.getInstance(this.firestore,e):null))}}function Rn(n,e,t){return n.message=n.message.replace(e,t),n}function Cg(n){for(const e of n)if("object"==typeof e&&!nf(e))return e;return{}}function kg(n,e){var t,r;let i;return i=nf(n[0])?n[0]:nf(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:o=>{i.next&&i.next(e(o))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class Nc{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Fr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return cg(this._delegate,e._delegate)}}class Rc extends Nc{data(e){const t=this._delegate.data(e);return function Yo(n,e){n||ne()}(void 0!==t),t}}class On{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new zl(e)}where(e,t,r){try{return new On(this.firestore,vo(this._delegate,function F_(n,e,t){const r=e,i=ql("where",n);return new L_(i,r,t)}(e,t,r)))}catch(i){throw Rn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new On(this.firestore,vo(this._delegate,function V_(n,e="asc"){const t=e,r=ql("orderBy",n);return new U_(r,t)}(e,t)))}catch(r){throw Rn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new On(this.firestore,vo(this._delegate,function B_(n){return Wp("limit",n),new hg("limit",n,"F")}(e)))}catch(t){throw Rn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new On(this.firestore,vo(this._delegate,function $_(n){return Wp("limitToLast",n),new hg("limitToLast",n,"L")}(e)))}catch(t){throw Rn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new On(this.firestore,vo(this._delegate,function j_(...n){return new dg("startAt",n,!0)}(...e)))}catch(t){throw Rn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new On(this.firestore,vo(this._delegate,function G_(...n){return new dg("startAfter",n,!1)}(...e)))}catch(t){throw Rn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new On(this.firestore,vo(this._delegate,function q_(...n){return new fg("endBefore",n,!1)}(...e)))}catch(t){throw Rn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new On(this.firestore,vo(this._delegate,function K_(...n){return new fg("endAt",n,!0)}(...e)))}catch(t){throw Rn(t,"endAt()","Query.endAt()")}}isEqual(e){return Jp(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function J_(n){n=qe(n,_n);const e=qe(n.firestore,bt),t=Gt(e),r=new Ca(e);return function c_(n,e){const t=new gt;return n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return(r=(0,R.Z)(function*(i,o,u){try{const h=yield Cl(i,o,!0),f=new kp(o,h.ji),m=f.Ku(h.documents),v=f.applyChanges(m,!1);u.resolve(v.snapshot)}catch(h){const f=Ru(h,`Failed to execute query '${o} against cache`);u.reject(f)}}),function(i,o,u){return r.apply(this,arguments)})(yield Ll(n),e,t);var r})),t.promise}(t,n._query).then(i=>new _o(e,r,n,i))}(this._delegate):"server"===e?.source?function X_(n){n=qe(n,_n);const e=qe(n.firestore,bt),t=Gt(e),r=new Ca(e);return Gp(t,n._query,{source:"server"}).then(i=>new _o(e,r,n,i))}(this._delegate):function Y_(n){n=qe(n,_n);const e=qe(n.firestore,bt),t=Gt(e),r=new Ca(e);return lg(n._query),Gp(t,n._query).then(i=>new _o(e,r,n,i))}(this._delegate),t.then(r=>new rf(this.firestore,new _o(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=Cg(e),r=kg(e,i=>new rf(this.firestore,new _o(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return wg(this._delegate,t,r)}withConverter(e){return new On(this.firestore,this._delegate.withConverter(e?ka.getInstance(this.firestore,e):null))}}class gv{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Rc(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class rf{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new On(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Rc(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new gv(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Rc(this._firestore,r))})}isEqual(e){return cg(this._delegate,e._delegate)}}class Uu extends On{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Fr(this.firestore,e):null}doc(e){try{return new Fr(this.firestore,void 0===e?Ul(this._delegate):Ul(this._delegate,e))}catch(t){throw Rn(t,"doc()","CollectionReference.doc()")}}add(e){return function tv(n,e){const t=qe(n.firestore,bt),r=Ul(n),i=Kl(n.converter,e);return Fu(t,[$l(Aa(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,ct.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Fr(this.firestore,t))}isEqual(e){return Yp(this._delegate,e._delegate)}withConverter(e){return new Uu(this.firestore,this._delegate.withConverter(e?ka.getInstance(this.firestore,e):null))}}function Da(n){return qe(n,It)}class sf{constructor(...e){this._delegate=new Ts(...e)}static documentId(){return new sf(mt.keyField().canonicalString())}isEqual(e){return(e=(0,le.m9)(e))instanceof Ts&&this._delegate._internalPath.isEqual(e._internalPath)}}class Na{constructor(e){this._delegate=e}static serverTimestamp(){const e=function ov(){return new Wd("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Na(e)}static delete(){const e=function sv(){return new Sc("deleteField")}();return e._methodName="FieldValue.delete",new Na(e)}static arrayUnion(...e){const t=function av(...n){return new D_("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Na(t)}static arrayRemove(...e){const t=function uv(...n){return new N_("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Na(t)}static increment(e){const t=function cv(n){return new R_("increment",n)}(e);return t._methodName="FieldValue.increment",new Na(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const mv={Firestore:Ag,GeoPoint:Vl,Timestamp:We,Blob:Dc,Transaction:Sg,WriteBatch:xg,DocumentReference:Fr,DocumentSnapshot:Nc,Query:On,QueryDocumentSnapshot:Rc,QuerySnapshot:rf,CollectionReference:Uu,FieldPath:sf,FieldValue:Na,setLogLevel:function pv(n){!function eo(n){Nr.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function _v(n){(function yv(n,e){n.INTERNAL.registerComponent(new Ee.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},mv)))})(n,(e,t)=>new Ag(e,t,new fv)),n.registerVersion("@firebase/firestore-compat","0.1.23")}(te.Z);var vv=z(7579),Iv=z(6451),Zl=z(5363),wo=z(3900),Dg=z(4782),wv=z(590),Ev=z(576);function Ng(n,e){return(0,Ev.m)(e)?(0,wo.w)(()=>n,e):(0,wo.w)(()=>n)}var of=z(9468);z(7835);const Og=new Map,xv={activated:!1,tokenObservers:[]},Cv={initialized:!1,enabled:!1};function tn(n){return Og.get(n)||xv}function ui(n,e){Og.set(n,e)}function Hl(){return Cv}class Ov{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,R.Z)(function*(){t.stop();try{t.pending=new le.BH,yield function Pv(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new le.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Pn=new le.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function Mg(n){if(!tn(n).activated)throw Pn.create("use-before-activation",{appName:n.name})}function lf(n,e){return hf.apply(this,arguments)}function hf(){return hf=(0,R.Z)(function*({url:n,body:e},t){var r,i;const o={"Content-Type":"application/json"},u=t.getImmediate({optional:!0});if(u){const U=yield u.getHeartbeatsHeader();U&&(o["X-Firebase-Client"]=U)}const h={method:"POST",body:JSON.stringify(e),headers:o};let f,m;try{f=yield fetch(n,h)}catch(U){throw Pn.create("fetch-network-error",{originalErrorMessage:null===(r=U)||void 0===r?void 0:r.message})}if(200!==f.status)throw Pn.create("fetch-status-error",{httpStatus:f.status});try{m=yield f.json()}catch(U){throw Pn.create("fetch-parse-error",{originalErrorMessage:null===(i=U)||void 0===i?void 0:i.message})}const v=m.ttl.match(/^([\d.]+)(s)$/);if(!v||!v[2]||isNaN(Number(v[1])))throw Pn.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${m.ttl}`});const T=1e3*Number(v[1]),O=Date.now();return{token:m.token,expireTimeMillis:O+T,issuedAtTimeMillis:O}}),hf.apply(this,arguments)}function Uv(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:e}}}const Oc="firebase-app-check-store";let Jl=null;function Fg(){return Jl||(Jl=new Promise((n,e)=>{var t;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=i=>{n(i.target.result)},r.onerror=i=>{var o;e(Pn.create("storage-open",{originalErrorMessage:null===(o=i.target.error)||void 0===o?void 0:o.message}))},r.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(Oc,{keyPath:"compositeKey"})}}catch(r){e(Pn.create("storage-open",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message}))}}),Jl)}function df(){return df=(0,R.Z)(function*(n,e){const r=(yield Fg()).transaction(Oc,"readwrite"),o=r.objectStore(Oc).put({compositeKey:n,value:e});return new Promise((u,h)=>{o.onsuccess=f=>{u()},r.onerror=f=>{var m;h(Pn.create("storage-set",{originalErrorMessage:null===(m=f.target.error)||void 0===m?void 0:m.message}))}})}),df.apply(this,arguments)}const Pc=new xe.Yd("@firebase/app-check");function $g(n,e){return(0,le.hl)()?function jv(n,e){return function Ug(n,e){return df.apply(this,arguments)}(function Bg(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{Pc.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function jg(){return Hl().enabled}function Gg(){return mf.apply(this,arguments)}function mf(){return mf=(0,R.Z)(function*(){const n=Hl();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),mf.apply(this,arguments)}const Wv={error:"UNKNOWN_ERROR"};function Hv(n){return le.US.encodeString(JSON.stringify(n),!1)}function Xl(n){return yf.apply(this,arguments)}function yf(){return yf=(0,R.Z)(function*(n,e=!1){const t=n.app;Mg(t);const r=tn(t);let o,i=r.token;if(!i){const f=yield r.cachedTokenPromise;f&&eh(f)&&(i=f)}if(!e&&i&&eh(i))return{token:i.token};let h,u=!1;if(jg()){r.exchangeTokenPromise||(r.exchangeTokenPromise=lf(Uv(t,yield Gg()),n.heartbeatServiceProvider).then(m=>(r.exchangeTokenPromise=void 0,m)),u=!0);const f=yield r.exchangeTokenPromise;return yield $g(t,f),ui(t,Object.assign(Object.assign({},r),{token:f})),{token:f.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(f=>(r.exchangeTokenPromise=void 0,f)),u=!0),i=yield r.exchangeTokenPromise}catch(f){"appCheck/throttled"===f.code?Pc.warn(f.message):Pc.error(f),o=f}return i?(h={token:i.token},ui(t,Object.assign(Object.assign({},r),{token:i})),yield $g(t,i)):h=Yv(o),u&&Kg(t,h),h}),yf.apply(this,arguments)}function vf(n,e){const t=tn(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),ui(n,Object.assign(Object.assign({},t),{tokenObservers:r}))}function qg(n){const{app:e}=n,t=tn(e);let r=t.tokenRefresher;r||(r=function Qv(n){const{app:e}=n;return new Ov((0,R.Z)(function*(){let r;if(r=tn(e).token?yield Xl(n,!0):yield Xl(n),r.error)throw r.error}),()=>!0,()=>{const t=tn(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),ui(e,Object.assign(Object.assign({},t),{tokenRefresher:r}))),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Kg(n,e){const t=tn(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch{}}function eh(n){return n.expireTimeMillis-Date.now()>0}function Yv(n){return{token:Hv(Wv),error:n}}class Jv{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=tn(this.app);for(const t of e)vf(this.app,t.next);return Promise.resolve()}}const Xg="app-check-internal";!function dI(){(0,we._registerComponent)(new Ee.wA("app-check",n=>function Xv(n,e){return new Jv(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Xg).initialize()})),(0,we._registerComponent)(new Ee.wA(Xg,n=>function eI(n){return{getToken:e=>Xl(n,e),addTokenListener:e=>function _f(n,e,t,r){const{app:i}=n,o=tn(i),u={next:t,error:r,type:e};if(ui(i,Object.assign(Object.assign({},o),{tokenObservers:[...o.tokenObservers,u]})),o.token&&eh(o.token)){const h=o.token;Promise.resolve().then(()=>{t({token:h.token}),qg(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>qg(n))}(n,"INTERNAL",e),removeTokenListener:e=>vf(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,we.registerVersion)("@firebase/app-check","0.5.12")}();class Tf{constructor(){return(0,de.vb)("app-check")}}typeof window<"u"&&window,z(127);const tm=new I.OlP("angularfire2.auth.use-emulator"),nm=new I.OlP("angularfire2.auth.settings"),rm=new I.OlP("angularfire2.auth.tenant-id"),im=new I.OlP("angularfire2.auth.langugage-code"),sm=new I.OlP("angularfire2.auth.use-device-language"),om=new I.OlP("angularfire.auth.persistence"),am=(n,e,t,r,i,o,u,h)=>(0,$e.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const f=e.runOutsideAngular(()=>n.auth());if(t&&f.useEmulator(...t),r&&(f.tenantId=r),f.languageCode=i,o&&f.useDeviceLanguage(),u)for(const[m,v]of Object.entries(u))f.settings[m]=v;return h&&f.setPersistence(h),f},[t,r,i,o,u,h]);let um=(()=>{class n{constructor(t,r,i,o,u,h,f,m,v,T,O,U){const B=new vv.x,Y=(0,ae.of)(void 0).pipe((0,Zl.Q)(u.outsideAngular),(0,wo.w)(()=>o.runOutsideAngular(()=>Promise.resolve().then(z.bind(z,1451)))),(0,G.U)(()=>(0,$e.on)(t,o,r)),(0,G.U)(oe=>am(oe,o,h,m,v,T,f,O)),(0,Dg.d)({bufferSize:1,refCount:!1}));if((0,ze.PM)(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,ae.of)(null);else{Y.pipe((0,wv.P)()).subscribe();const Me=Y.pipe((0,wo.w)(Re=>Re.getRedirectResult().then(Oe=>Oe,()=>null)),de.iC,(0,Dg.d)({bufferSize:1,refCount:!1})),Qe=Y.pipe((0,wo.w)(Re=>new k.y(Oe=>({unsubscribe:o.runOutsideAngular(()=>Re.onAuthStateChanged(Ve=>Oe.next(Ve),Ve=>Oe.error(Ve),()=>Oe.complete()))})))),Ke=Y.pipe((0,wo.w)(Re=>new k.y(Oe=>({unsubscribe:o.runOutsideAngular(()=>Re.onIdTokenChanged(Ve=>Oe.next(Ve),Ve=>Oe.error(Ve),()=>Oe.complete()))}))));this.authState=Me.pipe(Ng(Qe),(0,of.R)(u.outsideAngular),(0,Zl.Q)(u.insideAngular)),this.user=Me.pipe(Ng(Ke),(0,of.R)(u.outsideAngular),(0,Zl.Q)(u.insideAngular)),this.idToken=this.user.pipe((0,wo.w)(Re=>Re?(0,se.D)(Re.getIdToken()):(0,ae.of)(null))),this.idTokenResult=this.user.pipe((0,wo.w)(Re=>Re?(0,se.D)(Re.getIdTokenResult()):(0,ae.of)(null))),this.credential=(0,Iv.T)(Me,B,this.authState.pipe((0,Le.h)(Re=>!Re))).pipe((0,G.U)(Re=>Re?.user?Re:null),(0,of.R)(u.outsideAngular),(0,Zl.Q)(u.insideAngular))}return(0,$e.pX)(this,Y,o,{spy:{apply:(oe,Me,Qe)=>{(oe.startsWith("signIn")||oe.startsWith("createUser"))&&Qe.then(Ke=>B.next(Ke))}}})}}return n.\u0275fac=function(t){return new(t||n)(I.LFG($e.Dh),I.LFG($e.xv,8),I.LFG(I.Lbi),I.LFG(I.R0b),I.LFG(de.HU),I.LFG(tm,8),I.LFG(nm,8),I.LFG(rm,8),I.LFG(im,8),I.LFG(sm,8),I.LFG(om,8),I.LFG(Tf,8))},n.\u0275prov=I.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})();function cm(n,e){return function _I(n,e=re.z){return new k.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function Af(n,e){return cm(n,e).pipe((0,G.U)(t=>({payload:t,type:"query"})))}function nh(n,e){return Af(n,e).pipe((0,V.O)(void 0),fe(),(0,G.U)(([t,r])=>{const i=r.payload.docChanges(),o=i.map(u=>({type:u.type,payload:u}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((u,h)=>{const f=i.find(v=>v.doc.ref.isEqual(u.ref)),m=t?.payload.docs.find(v=>v.ref.isEqual(u.ref));f&&JSON.stringify(f.doc.metadata)===JSON.stringify(u.metadata)||!f&&m&&JSON.stringify(m.metadata)===JSON.stringify(u.metadata)||o.push({type:"modified",payload:{oldIndex:h,newIndex:h,type:"modified",doc:u}})}),o}))}function lm(n,e,t){return nh(n,t).pipe((0,ce.R)((r,i)=>function II(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function wI(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return Sf(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return Sf(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Sf(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(o=>o.payload),e),[]),(0,Ce.x)(),(0,G.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function Sf(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function hm(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class dm{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=nh(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,G.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe((0,V.O)(void 0),fe(),(0,Le.h)(([r,i])=>i.length>0||!r),(0,G.U)(([r,i])=>i),de.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,ce.R)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=hm(e);return lm(this.query,t,this.afs.schedulers.outsideAngular).pipe(de.iC)}valueChanges(e={}){return Af(this.query,this.afs.schedulers.outsideAngular).pipe((0,G.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),de.iC)}get(e){return(0,se.D)(this.query.get(e)).pipe(de.iC)}add(e){return this.ref.add(e)}doc(e){return new fm(this.ref.doc(e),this.afs)}}class fm{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:o}=pm(r,t);return new dm(i,o,this.afs)}snapshotChanges(){return function vI(n,e){return cm(n,e).pipe((0,V.O)(void 0),fe(),(0,G.U)(([t,r])=>r.exists?t?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(de.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,G.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,se.D)(this.ref.get(e)).pipe(de.iC)}}class EI{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?nh(this.query,this.afs.schedulers.outsideAngular).pipe((0,G.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),(0,Le.h)(t=>t.length>0),de.iC):nh(this.query,this.afs.schedulers.outsideAngular).pipe(de.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,ce.R)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=hm(e);return lm(this.query,t,this.afs.schedulers.outsideAngular).pipe(de.iC)}valueChanges(e={}){return Af(this.query,this.afs.schedulers.outsideAngular).pipe((0,G.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),de.iC)}get(e){return(0,se.D)(this.query.get(e)).pipe(de.iC)}}const TI=new I.OlP("angularfire2.enableFirestorePersistence"),bI=new I.OlP("angularfire2.firestore.persistenceSettings"),AI=new I.OlP("angularfire2.firestore.settings"),SI=new I.OlP("angularfire2.firestore.use-emulator");function pm(n,e=(t=>t)){return{query:e(n),ref:n}}let xI=(()=>{class n{constructor(t,r,i,o,u,h,f,m,v,T,O,U,B,Y,oe,Me,Qe){this.schedulers=f;const Ke=(0,$e.on)(t,h,r),Re=v;T&&am(Ke,h,O,B,Y,oe,U,Me),[this.firestore,this.persistenceEnabled$]=(0,$e.cc)(`${Ke.name}.firestore`,"AngularFirestore",Ke.name,()=>{const Oe=h.runOutsideAngular(()=>Ke.firestore());if(o&&Oe.settings(o),Re&&Oe.useEmulator(...Re),i&&!(0,ze.PM)(u)){const Ve=()=>{try{return(0,se.D)(Oe.enablePersistence(m||void 0).then(()=>!0,()=>!1))}catch(Ht){return typeof console<"u"&&console.warn(Ht),(0,ae.of)(!1)}};return[Oe,h.runOutsideAngular(Ve)]}return[Oe,(0,ae.of)(!1)]},[o,Re,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:o,query:u}=pm(i,r),h=this.schedulers.ngZone.run(()=>o);return new dm(h,u,this)}collectionGroup(t,r){const i=r||(u=>u),o=this.firestore.collectionGroup(t);return new EI(i(o),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new fm(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(I.LFG($e.Dh),I.LFG($e.xv,8),I.LFG(TI,8),I.LFG(AI,8),I.LFG(I.Lbi),I.LFG(I.R0b),I.LFG(de.HU),I.LFG(bI,8),I.LFG(SI,8),I.LFG(um,8),I.LFG(tm,8),I.LFG(nm,8),I.LFG(rm,8),I.LFG(im,8),I.LFG(sm,8),I.LFG(om,8),I.LFG(Tf,8))},n.\u0275prov=I.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})()},2011:(Qt,Xe,z)=>{z.d(Xe,{Dh:()=>Ie,GT:()=>de,cc:()=>Le,hO:()=>Ce,on:()=>V,pX:()=>ae,xv:()=>fe});var I=z(4650),re=z(127),k=z(5813);Qt=z.hmd(Qt);const se=["ngOnDestroy"],ae=(te,R,we,Ee={})=>new Proxy(te,{get:(xe,le)=>we.runOutsideAngular(()=>{var He;if(te[le])return!(null===(He=Ee?.spy)||void 0===He)&&He.get&&Ee.spy.get(le,te[le]),te[le];if(se.indexOf(le)>-1)return()=>{};const ge=R.toPromise().then(E=>{const W=E&&E[le];return"function"==typeof W?W.bind(E):W&&W.then?W.then(q=>we.run(()=>q)):we.run(()=>W)});return new Proxy(()=>{},{get:(E,W)=>ge[W],apply:(E,W,q)=>ge.then(je=>{var Pe;const Ye=je&&je(...q);return!(null===(Pe=Ee?.spy)||void 0===Pe)&&Pe.apply&&Ee.spy.apply(le,q,Ye),Ye})})})}),de=(te,R)=>{R.forEach(we=>{Object.getOwnPropertyNames(we.prototype||we).forEach(Ee=>{Object.defineProperty(te.prototype,Ee,Object.getOwnPropertyDescriptor(we.prototype||we,Ee))})})};class me{constructor(R){return R}}const Ie=new I.OlP("angularfire2.app.options"),fe=new I.OlP("angularfire2.app.name");function V(te,R,we){const xe="object"==typeof we&&we||{};xe.name=xe.name||"string"==typeof we&&we||"[DEFAULT]";const He=re.Z.apps.filter(ge=>ge&&ge.name===xe.name)[0]||R.runOutsideAngular(()=>re.Z.initializeApp(te,xe));try{JSON.stringify(te)!==JSON.stringify(He.options)&&G("error",`${He.name} Firebase App already initialized with different options${Qt.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new me(He)}const G=(te,...R)=>{(0,I.X6Q)()&&typeof console<"u"&&console[te](...R)},ce={provide:me,useFactory:V,deps:[Ie,I.R0b,[new I.FiY,fe]]};let Ce=(()=>{class te{constructor(we){re.Z.registerVersion("angularfire",k.q4.full,"core"),re.Z.registerVersion("angularfire",k.q4.full,"app-compat"),re.Z.registerVersion("angular",I.q4F.full,we.toString())}static initializeApp(we,Ee){return{ngModule:te,providers:[{provide:Ie,useValue:we},{provide:fe,useValue:Ee}]}}}return te.\u0275fac=function(we){return new(we||te)(I.LFG(I.Lbi))},te.\u0275mod=I.oAB({type:te}),te.\u0275inj=I.cJS({providers:[ce]}),te})();function Le(te,R,we,Ee,xe){const[,le,He]=globalThis.\u0275AngularfireInstanceCache.find(ge=>ge[0]===te)||[];if(le)return function $e(te,R){try{return te.toString()===R.toString()}catch{return te===R}}(xe,He)||(ke("error",`${R} was already initialized on the ${we} Firebase App with different settings.${ze?" You may need to reload as Firebase is not HMR aware.":""}`),ke("warn",{is:xe,was:He})),le;{const ge=Ee();return globalThis.\u0275AngularfireInstanceCache.push([te,ge,xe]),ge}}const ze=!!Qt.hot,ke=(te,...R)=>{(0,I.X6Q)()&&typeof console<"u"&&console[te](...R)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},5813:(Qt,Xe,z)=>{z.d(Xe,{q4:()=>Hu,iC:()=>hr,HU:()=>ln,vb:()=>xt,JM:()=>xi});var I=z(4650),re=z(7835),k=z(5861),se=z(9681),ae=z(2090),de=z(4859),me=z(1877),Ie=z(8766);const fe="@firebase/installations",V="0.5.12",ce=`w:${V}`,Ce="FIS_v2",R=new ae.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function we(d){return d instanceof ae.ZR&&d.code.includes("request-failed")}function Ee({projectId:d}){return`https://firebaseinstallations.googleapis.com/v1/projects/${d}/installations`}function xe(d){return{token:d.token,requestStatus:2,expiresIn:je(d.expiresIn),creationTime:Date.now()}}function le(d,p){return He.apply(this,arguments)}function He(){return(He=(0,k.Z)(function*(d,p){const w=(yield p.json()).error;return R.create("request-failed",{requestName:d,serverCode:w.code,serverMessage:w.message,serverStatus:w.status})})).apply(this,arguments)}function ge({apiKey:d}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":d})}function E(d,{refreshToken:p}){const y=ge(d);return y.append("Authorization",function Pe(d){return`${Ce} ${d}`}(p)),y}function W(d){return q.apply(this,arguments)}function q(){return(q=(0,k.Z)(function*(d){const p=yield d();return p.status>=500&&p.status<600?d():p})).apply(this,arguments)}function je(d){return Number(d.replace("s","000"))}function Ye(d,p){return nt.apply(this,arguments)}function nt(){return(nt=(0,k.Z)(function*({appConfig:d,heartbeatServiceProvider:p},{fid:y}){const w=Ee(d),N=ge(d),M=p.getImmediate({optional:!0});if(M){const Te=yield M.getHeartbeatsHeader();Te&&N.append("x-firebase-client",Te)}const Q={method:"POST",headers:N,body:JSON.stringify({fid:y,authVersion:Ce,appId:d.appId,sdkVersion:ce})},ue=yield W(()=>fetch(w,Q));if(ue.ok){const Te=yield ue.json();return{fid:Te.fid||y,registrationStatus:2,refreshToken:Te.refreshToken,authToken:xe(Te.authToken)}}throw yield le("Create Installation",ue)})).apply(this,arguments)}function kt(d){return new Promise(p=>{setTimeout(p,d)})}const Mn=/^[cdef][\w-]{21}$/;function rt(){try{const d=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(d),d[0]=112+d[0]%16;const y=function Dt(d){return function Ot(d){return btoa(String.fromCharCode(...d)).replace(/\+/g,"-").replace(/\//g,"_")}(d).substr(0,22)}(d);return Mn.test(y)?y:""}catch{return""}}function Ge(d){return`${d.appName}!${d.appId}`}const Nt=new Map;function Ui(d,p){const y=Ge(d);st(y,p),function ci(d,p){const y=function Rt(){return!Yt&&"BroadcastChannel"in self&&(Yt=new BroadcastChannel("[Firebase] FID Change"),Yt.onmessage=d=>{st(d.data.key,d.data.fid)}),Yt}();y&&y.postMessage({key:d,fid:p}),function Ut(){0===Nt.size&&Yt&&(Yt.close(),Yt=null)}()}(y,p)}function st(d,p){const y=Nt.get(d);if(y)for(const w of y)w(p)}let Yt=null;const rn="firebase-installations-store";let ot=null;function gr(){return ot||(ot=(0,Ie.X3)("firebase-installations-database",1,{upgrade:(d,p)=>{0===p&&d.createObjectStore(rn)}})),ot}function sn(d,p){return vn.apply(this,arguments)}function vn(){return(vn=(0,k.Z)(function*(d,p){const y=Ge(d),N=(yield gr()).transaction(rn,"readwrite"),M=N.objectStore(rn),j=yield M.get(y);return yield M.put(p,y),yield N.done,(!j||j.fid!==p.fid)&&Ui(d,p.fid),p})).apply(this,arguments)}function Ln(d){return Fn.apply(this,arguments)}function Fn(){return(Fn=(0,k.Z)(function*(d){const p=Ge(d),w=(yield gr()).transaction(rn,"readwrite");yield w.objectStore(rn).delete(p),yield w.done})).apply(this,arguments)}function In(d,p){return qt.apply(this,arguments)}function qt(){return(qt=(0,k.Z)(function*(d,p){const y=Ge(d),N=(yield gr()).transaction(rn,"readwrite"),M=N.objectStore(rn),j=yield M.get(y),Q=p(j);return void 0===Q?yield M.delete(y):yield M.put(Q,y),yield N.done,Q&&(!j||j.fid!==Q.fid)&&Ui(d,Q.fid),Q})).apply(this,arguments)}function Qn(d){return mr.apply(this,arguments)}function mr(){return(mr=(0,k.Z)(function*(d){let p;const y=yield In(d.appConfig,w=>{const N=fn(w),M=Ur(d,N);return p=M.registrationPromise,M.installationEntry});return""===y.fid?{installationEntry:yield p}:{installationEntry:y,registrationPromise:p}})).apply(this,arguments)}function fn(d){return _r(d||{fid:rt(),registrationStatus:0})}function Ur(d,p){if(0===p.registrationStatus){if(!navigator.onLine)return{installationEntry:p,registrationPromise:Promise.reject(R.create("app-offline"))};const y={fid:p.fid,registrationStatus:1,registrationTime:Date.now()},w=function wn(d,p){return yr.apply(this,arguments)}(d,y);return{installationEntry:y,registrationPromise:w}}return 1===p.registrationStatus?{installationEntry:p,registrationPromise:Kt(d)}:{installationEntry:p}}function yr(){return(yr=(0,k.Z)(function*(d,p){try{const y=yield Ye(d,p);return sn(d.appConfig,y)}catch(y){throw we(y)&&409===y.customData.serverCode?yield Ln(d.appConfig):yield sn(d.appConfig,{fid:p.fid,registrationStatus:0}),y}})).apply(this,arguments)}function Kt(d){return En.apply(this,arguments)}function En(){return(En=(0,k.Z)(function*(d){let p=yield Yn(d.appConfig);for(;1===p.registrationStatus;)yield kt(100),p=yield Yn(d.appConfig);if(0===p.registrationStatus){const{installationEntry:y,registrationPromise:w}=yield Qn(d);return w||y}return p})).apply(this,arguments)}function Yn(d){return In(d,p=>{if(!p)throw R.create("installation-not-found");return _r(p)})}function _r(d){return function vr(d){return 1===d.registrationStatus&&d.registrationTime+1e4<Date.now()}(d)?{fid:d.fid,registrationStatus:0}:d}function Tn(d,p){return Jn.apply(this,arguments)}function Jn(){return(Jn=(0,k.Z)(function*({appConfig:d,heartbeatServiceProvider:p},y){const w=Vi(d,y),N=E(d,y),M=p.getImmediate({optional:!0});if(M){const Te=yield M.getHeartbeatsHeader();Te&&N.append("x-firebase-client",Te)}const Q={method:"POST",headers:N,body:JSON.stringify({installation:{sdkVersion:ce,appId:d.appId}})},ue=yield W(()=>fetch(w,Q));if(ue.ok)return xe(yield ue.json());throw yield le("Generate Auth Token",ue)})).apply(this,arguments)}function Vi(d,{fid:p}){return`${Ee(d)}/${p}/authTokens:generate`}function D(d){return S.apply(this,arguments)}function S(){return(S=(0,k.Z)(function*(d,p=!1){let y;const w=yield In(d.appConfig,M=>{if(!he(M))throw R.create("not-registered");const j=M.authToken;if(!p&&lt(j))return M;if(1===j.requestStatus)return y=b(d,p),M;{if(!navigator.onLine)throw R.create("app-offline");const Q=At(M);return y=$(d,Q),Q}});return y?yield y:w.authToken})).apply(this,arguments)}function b(d,p){return x.apply(this,arguments)}function x(){return(x=(0,k.Z)(function*(d,p){let y=yield A(d.appConfig);for(;1===y.authToken.requestStatus;)yield kt(100),y=yield A(d.appConfig);const w=y.authToken;return 0===w.requestStatus?D(d,p):w})).apply(this,arguments)}function A(d){return In(d,p=>{if(!he(p))throw R.create("not-registered");return function Ne(d){return 1===d.requestStatus&&d.requestTime+1e4<Date.now()}(p.authToken)?Object.assign(Object.assign({},p),{authToken:{requestStatus:0}}):p})}function $(d,p){return J.apply(this,arguments)}function J(){return(J=(0,k.Z)(function*(d,p){try{const y=yield Tn(d,p),w=Object.assign(Object.assign({},p),{authToken:y});return yield sn(d.appConfig,w),y}catch(y){if(!we(y)||401!==y.customData.serverCode&&404!==y.customData.serverCode){const w=Object.assign(Object.assign({},p),{authToken:{requestStatus:0}});yield sn(d.appConfig,w)}else yield Ln(d.appConfig);throw y}})).apply(this,arguments)}function he(d){return void 0!==d&&2===d.registrationStatus}function lt(d){return 2===d.requestStatus&&!function Ze(d){const p=Date.now();return p<d.creationTime||d.creationTime+d.expiresIn<p+36e5}(d)}function At(d){const p={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},d),{authToken:p})}function bn(){return(bn=(0,k.Z)(function*(d){const p=d,{installationEntry:y,registrationPromise:w}=yield Qn(p);return w?w.catch(console.error):D(p).catch(console.error),y.fid})).apply(this,arguments)}function li(){return(li=(0,k.Z)(function*(d,p=!1){const y=d;return yield Eo(y),(yield D(y,p)).token})).apply(this,arguments)}function Eo(d){return Ir.apply(this,arguments)}function Ir(){return(Ir=(0,k.Z)(function*(d){const{registrationPromise:p}=yield Qn(d);p&&(yield p)})).apply(this,arguments)}function hi(d){return R.create("missing-app-config-values",{valueName:d})}const St="installations",yt=d=>{const p=d.getProvider("app").getImmediate(),y=function bo(d){if(!d||!d.options)throw hi("App Configuration");if(!d.name)throw hi("App Name");const p=["projectId","apiKey","appId"];for(const y of p)if(!d.options[y])throw hi(y);return{appName:d.name,projectId:d.options.projectId,apiKey:d.options.apiKey,appId:d.options.appId}}(p);return{app:p,appConfig:y,heartbeatServiceProvider:(0,se._getProvider)(p,"heartbeat"),_delete:()=>Promise.resolve()}},Ss=d=>{const p=d.getProvider("app").getImmediate(),y=(0,se._getProvider)(p,St).getImmediate();return{getId:()=>function Jt(d){return bn.apply(this,arguments)}(y),getToken:N=>function Vr(d){return li.apply(this,arguments)}(y,N)}};(function Vu(){(0,se._registerComponent)(new de.wA(St,yt,"PUBLIC")),(0,se._registerComponent)(new de.wA("installations-internal",Ss,"PRIVATE"))})(),(0,se.registerVersion)(fe,V),(0,se.registerVersion)(fe,V,"esm2017");const xs="@firebase/remote-config",Mt=new ae.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class $r{constructor(p,y,w,N){this.client=p,this.storage=y,this.storageCache=w,this.logger=N}isCachedDataFresh(p,y){if(!y)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const w=Date.now()-y,N=w<=p;return this.logger.debug(`Config fetch cache check. Cache age millis: ${w}. Cache max age millis (minimumFetchIntervalMillis setting): ${p}. Is cache hit: ${N}.`),N}fetch(p){var y=this;return(0,k.Z)(function*(){const[w,N]=yield Promise.all([y.storage.getLastSuccessfulFetchTimestampMillis(),y.storage.getLastSuccessfulFetchResponse()]);if(N&&y.isCachedDataFresh(p.cacheMaxAgeMillis,w))return N;p.eTag=N&&N.eTag;const M=yield y.client.fetch(p),j=[y.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===M.status&&j.push(y.storage.setLastSuccessfulFetchResponse(M)),yield Promise.all(j),M})()}}function Os(d=navigator){return d.languages&&d.languages[0]||d.language}class Er{constructor(p,y,w,N,M,j){this.firebaseInstallations=p,this.sdkVersion=y,this.namespace=w,this.projectId=N,this.apiKey=M,this.appId=j}fetch(p){var y=this;return(0,k.Z)(function*(){var w,N,M;const[j,Q]=yield Promise.all([y.firebaseInstallations.getId(),y.firebaseInstallations.getToken()]),Te=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${y.projectId}/namespaces/${y.namespace}:fetch?key=${y.apiKey}`,Ae={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":p.eTag||"*"},ye={sdk_version:y.sdkVersion,app_instance_id:j,app_instance_id_token:Q,app_id:y.appId,language_code:Os()},dt={method:"POST",headers:Ae,body:JSON.stringify(ye)},Zt=fetch(Te,dt),Cn=new Promise((Dn,oi)=>{p.signal.addEventListener(()=>{const su=new Error("The operation was aborted.");su.name="AbortError",oi(su)})});let Or;try{yield Promise.race([Zt,Cn]),Or=yield Zt}catch(Dn){let oi="fetch-client-network";throw"AbortError"===(null===(w=Dn)||void 0===w?void 0:w.name)&&(oi="fetch-timeout"),Mt.create(oi,{originalErrorMessage:null===(N=Dn)||void 0===N?void 0:N.message})}let kn=Or.status;const iu=Or.headers.get("ETag")||void 0;let gs,Zn;if(200===Or.status){let Dn;try{Dn=yield Or.json()}catch(oi){throw Mt.create("fetch-client-parse",{originalErrorMessage:null===(M=oi)||void 0===M?void 0:M.message})}gs=Dn.entries,Zn=Dn.state}if("INSTANCE_STATE_UNSPECIFIED"===Zn?kn=500:"NO_CHANGE"===Zn?kn=304:("NO_TEMPLATE"===Zn||"EMPTY_CONFIG"===Zn)&&(gs={}),304!==kn&&200!==kn)throw Mt.create("fetch-status",{httpStatus:kn});return{status:kn,eTag:iu,config:gs}})()}}class Ua{constructor(p,y){this.client=p,this.storage=y}fetch(p){var y=this;return(0,k.Z)(function*(){const w=(yield y.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return y.attemptFetch(p,w)})()}attemptFetch(p,{throttleEndTimeMillis:y,backoffCount:w}){var N=this;return(0,k.Z)(function*(){yield function Un(d,p){return new Promise((y,w)=>{const N=Math.max(p-Date.now(),0),M=setTimeout(y,N);d.addEventListener(()=>{clearTimeout(M),w(Mt.create("fetch-throttle",{throttleEndTimeMillis:p}))})})}(p.signal,y);try{const M=yield N.client.fetch(p);return yield N.storage.deleteThrottleMetadata(),M}catch(M){if(!function jr(d){if(!(d instanceof ae.ZR&&d.customData))return!1;const p=Number(d.customData.httpStatus);return 429===p||500===p||503===p||504===p}(M))throw M;const j={throttleEndTimeMillis:Date.now()+(0,ae.$s)(w),backoffCount:w+1};return yield N.storage.setThrottleMetadata(j),N.attemptFetch(p,j)}})()}}class Gr{constructor(p,y,w,N,M){this.app=p,this._client=y,this._storageCache=w,this._storage=N,this._logger=M,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function qr(d,p){var y;const w=d.target.error||void 0;return Mt.create(p,{originalErrorMessage:w&&(null===(y=w)||void 0===y?void 0:y.message)})}const Vn="app_namespace_store";class Ki{constructor(p,y,w,N=function Ba(){return new Promise((d,p)=>{var y;try{const w=indexedDB.open("firebase_remote_config",1);w.onerror=N=>{p(qr(N,"storage-open"))},w.onsuccess=N=>{d(N.target.result)},w.onupgradeneeded=N=>{0===N.oldVersion&&N.target.result.createObjectStore(Vn,{keyPath:"compositeKey"})}}catch(w){p(Mt.create("storage-open",{originalErrorMessage:null===(y=w)||void 0===y?void 0:y.message}))}})}()){this.appId=p,this.appName=y,this.namespace=w,this.openDbPromise=N}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(p){return this.set("last_fetch_status",p)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(p){return this.set("last_successful_fetch_timestamp_millis",p)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(p){return this.set("last_successful_fetch_response",p)}getActiveConfig(){return this.get("active_config")}setActiveConfig(p){return this.set("active_config",p)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(p){return this.set("active_config_etag",p)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(p){return this.set("throttle_metadata",p)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(p){var y=this;return(0,k.Z)(function*(){const w=yield y.openDbPromise;return new Promise((N,M)=>{var j;const ue=w.transaction([Vn],"readonly").objectStore(Vn),Te=y.createCompositeKey(p);try{const Ae=ue.get(Te);Ae.onerror=ye=>{M(qr(ye,"storage-get"))},Ae.onsuccess=ye=>{const dt=ye.target.result;N(dt?dt.value:void 0)}}catch(Ae){M(Mt.create("storage-get",{originalErrorMessage:null===(j=Ae)||void 0===j?void 0:j.message}))}})})()}set(p,y){var w=this;return(0,k.Z)(function*(){const N=yield w.openDbPromise;return new Promise((M,j)=>{var Q;const Te=N.transaction([Vn],"readwrite").objectStore(Vn),Ae=w.createCompositeKey(p);try{const ye=Te.put({compositeKey:Ae,value:y});ye.onerror=dt=>{j(qr(dt,"storage-set"))},ye.onsuccess=()=>{M()}}catch(ye){j(Mt.create("storage-set",{originalErrorMessage:null===(Q=ye)||void 0===Q?void 0:Q.message}))}})})()}delete(p){var y=this;return(0,k.Z)(function*(){const w=yield y.openDbPromise;return new Promise((N,M)=>{var j;const ue=w.transaction([Vn],"readwrite").objectStore(Vn),Te=y.createCompositeKey(p);try{const Ae=ue.delete(Te);Ae.onerror=ye=>{M(qr(ye,"storage-delete"))},Ae.onsuccess=()=>{N()}}catch(Ae){M(Mt.create("storage-delete",{originalErrorMessage:null===(j=Ae)||void 0===j?void 0:j.message}))}})})()}createCompositeKey(p){return[this.appId,this.appName,this.namespace,p].join()}}class zi{constructor(p){this.storage=p}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var p=this;return(0,k.Z)(function*(){const y=p.storage.getLastFetchStatus(),w=p.storage.getLastSuccessfulFetchTimestampMillis(),N=p.storage.getActiveConfig(),M=yield y;M&&(p.lastFetchStatus=M);const j=yield w;j&&(p.lastSuccessfulFetchTimestampMillis=j);const Q=yield N;Q&&(p.activeConfig=Q)})()}setLastFetchStatus(p){return this.lastFetchStatus=p,this.storage.setLastFetchStatus(p)}setLastSuccessfulFetchTimestampMillis(p){return this.lastSuccessfulFetchTimestampMillis=p,this.storage.setLastSuccessfulFetchTimestampMillis(p)}setActiveConfig(p){return this.activeConfig=p,this.storage.setActiveConfig(p)}}function er(){return No.apply(this,arguments)}function No(){return(No=(0,k.Z)(function*(){if(!(0,ae.hl)())return!1;try{return yield(0,ae.eu)()}catch{return!1}})).apply(this,arguments)}!function Xn(){(0,se._registerComponent)(new de.wA("remote-config",function d(p,{instanceIdentifier:y}){const w=p.getProvider("app").getImmediate(),N=p.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Mt.create("registration-window");if(!(0,ae.hl)())throw Mt.create("indexed-db-unavailable");const{projectId:M,apiKey:j,appId:Q}=w.options;if(!M)throw Mt.create("registration-project-id");if(!j)throw Mt.create("registration-api-key");if(!Q)throw Mt.create("registration-app-id");const ue=new Ki(Q,w.name,y=y||"firebase"),Te=new zi(ue),Ae=new me.Yd(xs);Ae.logLevel=me.in.ERROR;const ye=new Er(N,se.SDK_VERSION,y,M,j,Q),dt=new Ua(ye,ue),Zt=new $r(dt,ue,Te,Ae),Cn=new Gr(w,Zt,Te,ue,Ae);return function qi(d){const p=(0,ae.m9)(d);p._initializePromise||(p._initializePromise=p._storageCache.loadFromStorage().then(()=>{p._isInitializationComplete=!0}))}(Cn),Cn},"PUBLIC").setMultipleInstances(!0)),(0,se.registerVersion)(xs,"0.3.11"),(0,se.registerVersion)(xs,"0.3.11","esm2017")}();const Ro="/firebase-messaging-sw.js",Sn="/firebase-cloud-messaging-push-scope",Bn="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Ms="google.c.a.c_id",Oo="google.c.a.c_l",Po="google.c.a.ts",Bu="google.c.a.e";var Kr=(()=>{return(d=Kr||(Kr={})).PUSH_RECEIVED="push-received",d.NOTIFICATION_CLICKED="notification-clicked",Kr;var d})();function zt(d){const p=new Uint8Array(d);return btoa(String.fromCharCode(...p)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function pi(d){const y=(d+"=".repeat((4-d.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),w=atob(y),N=new Uint8Array(w.length);for(let M=0;M<w.length;++M)N[M]=w.charCodeAt(M);return N}const $n="fcm_token_details_db",on="fcm_token_object_Store";function Ls(d){return br.apply(this,arguments)}function br(){return br=(0,k.Z)(function*(d){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(M=>M.name).includes($n))return null;let p=null;return(yield(0,Ie.X3)($n,5,{upgrade:(w=(0,k.Z)(function*(N,M,j,Q){var ue;if(M<2||!N.objectStoreNames.contains(on))return;const Te=Q.objectStore(on),Ae=yield Te.index("fcmSenderId").get(d);if(yield Te.clear(),Ae)if(2===M){const ye=Ae;if(!ye.auth||!ye.p256dh||!ye.endpoint)return;p={token:ye.fcmToken,createTime:null!==(ue=ye.createTime)&&void 0!==ue?ue:Date.now(),subscriptionOptions:{auth:ye.auth,p256dh:ye.p256dh,endpoint:ye.endpoint,swScope:ye.swScope,vapidKey:"string"==typeof ye.vapidKey?ye.vapidKey:zt(ye.vapidKey)}}}else if(3===M){const ye=Ae;p={token:ye.fcmToken,createTime:ye.createTime,subscriptionOptions:{auth:zt(ye.auth),p256dh:zt(ye.p256dh),endpoint:ye.endpoint,swScope:ye.swScope,vapidKey:zt(ye.vapidKey)}}}else if(4===M){const ye=Ae;p={token:ye.fcmToken,createTime:ye.createTime,subscriptionOptions:{auth:zt(ye.auth),p256dh:zt(ye.p256dh),endpoint:ye.endpoint,swScope:ye.swScope,vapidKey:zt(ye.vapidKey)}}}}),function(M,j,Q,ue){return w.apply(this,arguments)})})).close(),yield(0,Ie.Lj)($n),yield(0,Ie.Lj)("fcm_vapid_details_db"),yield(0,Ie.Lj)("undefined"),Wi(p)?p:null;var w}),br.apply(this,arguments)}function Wi(d){if(!d||!d.subscriptionOptions)return!1;const{subscriptionOptions:p}=d;return"number"==typeof d.createTime&&d.createTime>0&&"string"==typeof d.token&&d.token.length>0&&"string"==typeof p.auth&&p.auth.length>0&&"string"==typeof p.p256dh&&p.p256dh.length>0&&"string"==typeof p.endpoint&&p.endpoint.length>0&&"string"==typeof p.swScope&&p.swScope.length>0&&"string"==typeof p.vapidKey&&p.vapidKey.length>0}const Ar="firebase-messaging-store";let nr=null;function an(){return nr||(nr=(0,Ie.X3)("firebase-messaging-database",1,{upgrade:(d,p)=>{0===p&&d.createObjectStore(Ar)}})),nr}function zr(d){return Sr.apply(this,arguments)}function Sr(){return(Sr=(0,k.Z)(function*(d){const p=Fs(d),w=yield(yield an()).transaction(Ar).objectStore(Ar).get(p);if(w)return w;{const N=yield Ls(d.appConfig.senderId);if(N)return yield rr(d,N),N}})).apply(this,arguments)}function rr(d,p){return gi.apply(this,arguments)}function gi(){return(gi=(0,k.Z)(function*(d,p){const y=Fs(d),N=(yield an()).transaction(Ar,"readwrite");return yield N.objectStore(Ar).put(p,y),yield N.done,p})).apply(this,arguments)}function tt(d){return xr.apply(this,arguments)}function xr(){return(xr=(0,k.Z)(function*(d){const p=Fs(d),w=(yield an()).transaction(Ar,"readwrite");yield w.objectStore(Ar).delete(p),yield w.done})).apply(this,arguments)}function Fs({appConfig:d}){return d.appId}const ut=new ae.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function Zr(d,p){return Us.apply(this,arguments)}function Us(){return(Us=(0,k.Z)(function*(d,p){var y;const w=yield Wr(d),N=mi(p),M={method:"POST",headers:w,body:JSON.stringify(N)};let j;try{j=yield(yield fetch(Hi(d.appConfig),M)).json()}catch(Q){throw ut.create("token-subscribe-failed",{errorInfo:null===(y=Q)||void 0===y?void 0:y.toString()})}if(j.error)throw ut.create("token-subscribe-failed",{errorInfo:j.error.message});if(!j.token)throw ut.create("token-subscribe-no-token");return j.token})).apply(this,arguments)}function Vs(d,p){return Bs.apply(this,arguments)}function Bs(){return(Bs=(0,k.Z)(function*(d,p){var y;const w=yield Wr(d),N=mi(p.subscriptionOptions),M={method:"PATCH",headers:w,body:JSON.stringify(N)};let j;try{j=yield(yield fetch(`${Hi(d.appConfig)}/${p.token}`,M)).json()}catch(Q){throw ut.create("token-update-failed",{errorInfo:null===(y=Q)||void 0===y?void 0:y.toString()})}if(j.error)throw ut.create("token-update-failed",{errorInfo:j.error.message});if(!j.token)throw ut.create("token-update-no-token");return j.token})).apply(this,arguments)}function $s(d,p){return Fo.apply(this,arguments)}function Fo(){return(Fo=(0,k.Z)(function*(d,p){var y;const N={method:"DELETE",headers:yield Wr(d)};try{const j=yield(yield fetch(`${Hi(d.appConfig)}/${p}`,N)).json();if(j.error)throw ut.create("token-unsubscribe-failed",{errorInfo:j.error.message})}catch(M){throw ut.create("token-unsubscribe-failed",{errorInfo:null===(y=M)||void 0===y?void 0:y.toString()})}})).apply(this,arguments)}function Hi({projectId:d}){return`https://fcmregistrations.googleapis.com/v1/projects/${d}/registrations`}function Wr(d){return pn.apply(this,arguments)}function pn(){return(pn=(0,k.Z)(function*({appConfig:d,installations:p}){const y=yield p.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":d.apiKey,"x-goog-firebase-installations-auth":`FIS ${y}`})})).apply(this,arguments)}function mi({p256dh:d,auth:p,endpoint:y,vapidKey:w}){const N={web:{endpoint:y,auth:p,p256dh:d}};return w!==Bn&&(N.web.applicationPubKey=w),N}const js=6048e5;function Qi(d){return Cr.apply(this,arguments)}function Cr(){return(Cr=(0,k.Z)(function*(d){const p=yield Xi(d.swRegistration,d.vapidKey),y={vapidKey:d.vapidKey,swScope:d.swRegistration.scope,endpoint:p.endpoint,auth:zt(p.getKey("auth")),p256dh:zt(p.getKey("p256dh"))},w=yield zr(d.firebaseDependencies);if(w){if(Ks(w.subscriptionOptions,y))return Date.now()>=w.createTime+js?qs(d,{token:w.token,createTime:Date.now(),subscriptionOptions:y}):w.token;try{yield $s(d.firebaseDependencies,w.token)}catch(N){console.warn(N)}return Yi(d.firebaseDependencies,y)}return Yi(d.firebaseDependencies,y)})).apply(this,arguments)}function Gs(d){return Uo.apply(this,arguments)}function Uo(){return(Uo=(0,k.Z)(function*(d){const p=yield zr(d.firebaseDependencies);p&&(yield $s(d.firebaseDependencies,p.token),yield tt(d.firebaseDependencies));const y=yield d.swRegistration.pushManager.getSubscription();return!y||y.unsubscribe()})).apply(this,arguments)}function qs(d,p){return Vo.apply(this,arguments)}function Vo(){return(Vo=(0,k.Z)(function*(d,p){try{const y=yield Vs(d.firebaseDependencies,p),w=Object.assign(Object.assign({},p),{token:y,createTime:Date.now()});return yield rr(d.firebaseDependencies,w),y}catch(y){throw yield Gs(d),y}})).apply(this,arguments)}function Yi(d,p){return Ji.apply(this,arguments)}function Ji(){return(Ji=(0,k.Z)(function*(d,p){const w={token:yield Zr(d,p),createTime:Date.now(),subscriptionOptions:p};return yield rr(d,w),w.token})).apply(this,arguments)}function Xi(d,p){return es.apply(this,arguments)}function es(){return(es=(0,k.Z)(function*(d,p){return(yield d.pushManager.getSubscription())||d.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:pi(p)})})).apply(this,arguments)}function Ks(d,p){return p.vapidKey===d.vapidKey&&p.endpoint===d.endpoint&&p.auth===d.auth&&p.p256dh===d.p256dh}function Bo(d){const p={from:d.from,collapseKey:d.collapse_key,messageId:d.fcmMessageId};return function ts(d,p){if(!p.notification)return;d.notification={};const y=p.notification.title;y&&(d.notification.title=y);const w=p.notification.body;w&&(d.notification.body=w);const N=p.notification.image;N&&(d.notification.image=N)}(p,d),function $u(d,p){!p.data||(d.data=p.data)}(p,d),function ju(d,p){var y,w,N,M,j;if(!(p.fcmOptions||null!==(y=p.notification)&&void 0!==y&&y.click_action))return;d.fcmOptions={};const Q=null!==(N=null===(w=p.fcmOptions)||void 0===w?void 0:w.link)&&void 0!==N?N:null===(M=p.notification)||void 0===M?void 0:M.click_action;Q&&(d.fcmOptions.link=Q);const ue=null===(j=p.fcmOptions)||void 0===j?void 0:j.analytics_label;ue&&(d.fcmOptions.analyticsLabel=ue)}(p,d),p}function $o(d){return"object"==typeof d&&!!d&&Ms in d}function ns(d,p){const y=[];for(let w=0;w<d.length;w++)y.push(d.charAt(w)),w<p.length&&y.push(p.charAt(w));return y.join("")}function kr(d){return ut.create("missing-app-config-values",{valueName:d})}ns("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),ns("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class jo{constructor(p,y,w){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const N=function rs(d){if(!d||!d.options)throw kr("App Configuration Object");if(!d.name)throw kr("App Name");const p=["projectId","apiKey","appId","messagingSenderId"],{options:y}=d;for(const w of p)if(!y[w])throw kr(w);return{appName:d.name,projectId:y.projectId,apiKey:y.apiKey,appId:y.appId,senderId:y.messagingSenderId}}(p);this.firebaseDependencies={app:p,appConfig:N,installations:y,analyticsProvider:w}}_delete(){return Promise.resolve()}}function is(d){return Hr.apply(this,arguments)}function Hr(){return(Hr=(0,k.Z)(function*(d){var p;try{d.swRegistration=yield navigator.serviceWorker.register(Ro,{scope:Sn}),d.swRegistration.update().catch(()=>{})}catch(y){throw ut.create("failed-service-worker-registration",{browserErrorMessage:null===(p=y)||void 0===p?void 0:p.message})}})).apply(this,arguments)}function Qr(d,p){return Go.apply(this,arguments)}function Go(){return(Go=(0,k.Z)(function*(d,p){if(!p&&!d.swRegistration&&(yield is(d)),p||!d.swRegistration){if(!(p instanceof ServiceWorkerRegistration))throw ut.create("invalid-sw-registration");d.swRegistration=p}})).apply(this,arguments)}function ft(d,p){return zs.apply(this,arguments)}function zs(){return(zs=(0,k.Z)(function*(d,p){p?d.vapidKey=p:d.vapidKey||(d.vapidKey=Bn)})).apply(this,arguments)}function qo(){return(qo=(0,k.Z)(function*(d,p){if(!navigator)throw ut.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw ut.create("permission-blocked");return yield ft(d,p?.vapidKey),yield Qr(d,p?.serviceWorkerRegistration),Qi(d)})).apply(this,arguments)}function Ko(d,p,y){return zo.apply(this,arguments)}function zo(){return(zo=(0,k.Z)(function*(d,p,y){const w=Ws(p);(yield d.firebaseDependencies.analyticsProvider.get()).logEvent(w,{message_id:y[Ms],message_name:y[Oo],message_time:y[Po],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function Ws(d){switch(d){case Kr.NOTIFICATION_CLICKED:return"notification_open";case Kr.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Hs(){return(Hs=(0,k.Z)(function*(d,p){const y=p.data;if(!y.isFirebaseMessaging)return;d.onMessageHandler&&y.messageType===Kr.PUSH_RECEIVED&&("function"==typeof d.onMessageHandler?d.onMessageHandler(Bo(y)):d.onMessageHandler.next(Bo(y)));const w=y.data;$o(w)&&"1"===w[Bu]&&(yield Ko(d,y.messageType,w))})).apply(this,arguments)}const yi="@firebase/messaging",ir=d=>{const p=new jo(d.getProvider("app").getImmediate(),d.getProvider("installations-internal").getImmediate(),d.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",y=>function ja(d,p){return Hs.apply(this,arguments)}(p,y)),p},Yr=d=>{const p=d.getProvider("messaging").getImmediate();return{getToken:w=>function Zs(d,p){return qo.apply(this,arguments)}(p,w)}};function Qs(){return Jr.apply(this,arguments)}function Jr(){return(Jr=(0,k.Z)(function*(){try{yield(0,ae.eu)()}catch{return!1}return typeof window<"u"&&(0,ae.hl)()&&(0,ae.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function Ga(){(0,se._registerComponent)(new de.wA("messaging",ir,"PUBLIC")),(0,se._registerComponent)(new de.wA("messaging-internal",Yr,"PRIVATE")),(0,se.registerVersion)(yi,"0.9.16"),(0,se.registerVersion)(yi,"0.9.16","esm2017")}();const Xr="analytics",qu="firebase_id",sr="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",cs="https://www.googletagmanager.com/gtag/js",Et=new me.Yd("@firebase/analytics");function Zo(d){return Promise.all(d.map(p=>p.catch(y=>y)))}function Ka(d,p){const y=document.createElement("script");y.src=`${cs}?l=${d}&id=${p}`,y.async=!0,document.head.appendChild(y)}function Js(d,p,y,w,N,M){return _i.apply(this,arguments)}function _i(){return(_i=(0,k.Z)(function*(d,p,y,w,N,M){const j=w[N];try{if(j)yield p[j];else{const ue=(yield Zo(y)).find(Te=>Te.measurementId===N);ue&&(yield p[ue.appId])}}catch(Q){Et.error(Q)}d("config",N,M)})).apply(this,arguments)}function za(d,p,y,w,N){return ti.apply(this,arguments)}function ti(){return(ti=(0,k.Z)(function*(d,p,y,w,N){try{let M=[];if(N&&N.send_to){let j=N.send_to;Array.isArray(j)||(j=[j]);const Q=yield Zo(y);for(const ue of j){const Te=Q.find(ye=>ye.measurementId===ue),Ae=Te&&p[Te.appId];if(!Ae){M=[];break}M.push(Ae)}}0===M.length&&(M=Object.values(p)),yield Promise.all(M),d("event",w,N||{})}catch(M){Et.error(M)}})).apply(this,arguments)}function Za(){const d=window.document.getElementsByTagName("script");for(const p of Object.values(d))if(p.src&&p.src.includes(cs))return p;return null}const Lt=new ae.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),Ha=new class Gn{constructor(p={},y=1e3){this.throttleMetadata=p,this.intervalMillis=y}getThrottleMetadata(p){return this.throttleMetadata[p]}setThrottleMetadata(p,y){this.throttleMetadata[p]=y}deleteThrottleMetadata(p){delete this.throttleMetadata[p]}};function zu(d){return new Headers({Accept:"application/json","x-goog-api-key":d})}function vi(d){return Wo.apply(this,arguments)}function Wo(){return(Wo=(0,k.Z)(function*(d){var p;const{appId:y,apiKey:w}=d,N={method:"GET",headers:zu(w)},M=sr.replace("{app-id}",y),j=yield fetch(M,N);if(200!==j.status&&304!==j.status){let Q="";try{const ue=yield j.json();null!==(p=ue.error)&&void 0!==p&&p.message&&(Q=ue.error.message)}catch{}throw Lt.create("config-fetch-failed",{httpStatus:j.status,responseMessage:Q})}return j.json()})).apply(this,arguments)}function pt(d){return Ho.apply(this,arguments)}function Ho(){return(Ho=(0,k.Z)(function*(d,p=Ha,y){const{appId:w,apiKey:N,measurementId:M}=d.options;if(!w)throw Lt.create("no-app-id");if(!N){if(M)return{measurementId:M,appId:w};throw Lt.create("no-api-key")}const j=p.getThrottleMetadata(w)||{backoffCount:0,throttleEndTimeMillis:Date.now()},Q=new Qo;return setTimeout((0,k.Z)(function*(){Q.abort()}),void 0!==y?y:6e4),hs({appId:w,apiKey:N,measurementId:M},j,Q,p)})).apply(this,arguments)}function hs(d,p,y){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,k.Z)(function*(d,{throttleEndTimeMillis:p,backoffCount:y},w,N=Ha){var M,j;const{appId:Q,measurementId:ue}=d;try{yield Dr(w,p)}catch(Te){if(ue)return Et.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${ue} provided in the "measurementId" field in the local Firebase config. [${null===(M=Te)||void 0===M?void 0:M.message}]`),{appId:Q,measurementId:ue};throw Te}try{const Te=yield vi(d);return N.deleteThrottleMetadata(Q),Te}catch(Te){const Ae=Te;if(!Nr(Ae)){if(N.deleteThrottleMetadata(Q),ue)return Et.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${ue} provided in the "measurementId" field in the local Firebase config. [${Ae?.message}]`),{appId:Q,measurementId:ue};throw Te}const ye=503===Number(null===(j=Ae?.customData)||void 0===j?void 0:j.httpStatus)?(0,ae.$s)(y,N.intervalMillis,30):(0,ae.$s)(y,N.intervalMillis),dt={throttleEndTimeMillis:Date.now()+ye,backoffCount:y+1};return N.setThrottleMetadata(Q,dt),Et.debug(`Calling attemptFetch again in ${ye} millis`),hs(d,dt,w,N)}})).apply(this,arguments)}function Dr(d,p){return new Promise((y,w)=>{const N=Math.max(p-Date.now(),0),M=setTimeout(y,N);d.addEventListener(()=>{clearTimeout(M),w(Lt.create("fetch-throttle",{throttleEndTimeMillis:p}))})})}function Nr(d){if(!(d instanceof ae.ZR&&d.customData))return!1;const p=Number(d.customData.httpStatus);return 429===p||500===p||503===p||504===p}class Qo{constructor(){this.listeners=[]}addEventListener(p){this.listeners.push(p)}abort(){this.listeners.forEach(p=>p())}}let eo,gt;function et(){return(et=(0,k.Z)(function*(d,p,y,w,N){if(N&&N.global)d("event",y,w);else{const M=yield p;d("event",y,Object.assign(Object.assign({},w),{send_to:M}))}})).apply(this,arguments)}function to(d){gt=d}function Qa(d){eo=d}function Zu(){return Ya.apply(this,arguments)}function Ya(){return(Ya=(0,k.Z)(function*(){var d;if(!(0,ae.hl)())return Et.warn(Lt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,ae.eu)()}catch(p){return Et.warn(Lt.create("indexeddb-unavailable",{errorInfo:null===(d=p)||void 0===d?void 0:d.toString()}).message),!1}return!0})).apply(this,arguments)}function Jo(){return(Jo=(0,k.Z)(function*(d,p,y,w,N,M,j){var Q;const ue=pt(d);ue.then(Zt=>{y[Zt.measurementId]=Zt.appId,d.options.measurementId&&Zt.measurementId!==d.options.measurementId&&Et.warn(`The measurement ID in the local Firebase config (${d.options.measurementId}) does not match the measurement ID fetched from the server (${Zt.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(Zt=>Et.error(Zt)),p.push(ue);const Te=Zu().then(Zt=>{if(Zt)return w.getId()}),[Ae,ye]=yield Promise.all([ue,Te]);Za()||Ka(M,Ae.measurementId),gt&&(N("consent","default",gt),to(void 0)),N("js",new Date);const dt=null!==(Q=j?.config)&&void 0!==Q?Q:{};return dt.origin="firebase",dt.update=!0,null!=ye&&(dt[qu]=ye),N("config",Ae.measurementId,dt),eo&&(N("set",eo),Qa(void 0)),Ae.measurementId})).apply(this,arguments)}class Ja{constructor(p){this.app=p}_delete(){return delete ar[this.app.options.appId],Promise.resolve()}}let ar={},Xo=[];const Xa={};let ni,qn,wi="dataLayer",We=!1;function Fe(d,p,y){!function ds(){const d=[];if((0,ae.ru)()&&d.push("This is a browser extension environment."),(0,ae.zI)()||d.push("Cookies are not available."),d.length>0){const p=d.map((w,N)=>`(${N+1}) ${w}`).join(" "),y=Lt.create("invalid-analytics-context",{errorInfo:p});Et.warn(y.message)}}();const w=d.options.appId;if(!w)throw Lt.create("no-app-id");if(!d.options.apiKey){if(!d.options.measurementId)throw Lt.create("no-api-key");Et.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${d.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=ar[w])throw Lt.create("already-exists",{id:w});if(!We){!function ei(d){let p=[];Array.isArray(window[d])?p=window[d]:window[d]=p}(wi);const{wrappedGtag:M,gtagCore:j}=function un(d,p,y,w,N){let M=function(...j){window[w].push(arguments)};return window[N]&&"function"==typeof window[N]&&(M=window[N]),window[N]=function ls(d,p,y,w){function M(){return(M=(0,k.Z)(function*(j,Q,ue){try{"event"===j?yield za(d,p,y,Q,ue):"config"===j?yield Js(d,p,y,w,Q,ue):"consent"===j?d("consent","update",ue):d("set",Q)}catch(Te){Et.error(Te)}})).apply(this,arguments)}return function N(j,Q,ue){return M.apply(this,arguments)}}(M,d,p,y),{gtagCore:M,wrappedGtag:window[N]}}(ar,Xo,Xa,wi,"gtag");qn=M,ni=j,We=!0}return ar[w]=function Ii(d,p,y,w,N,M,j){return Jo.apply(this,arguments)}(d,Xo,Xa,p,ni,wi,y),new Ja(d)}function ee(){return Ei.apply(this,arguments)}function Ei(){return(Ei=(0,k.Z)(function*(){if((0,ae.ru)()||!(0,ae.zI)()||!(0,ae.hl)())return!1;try{return yield(0,ae.eu)()}catch{return!1}})).apply(this,arguments)}const na="@firebase/analytics";!function ra(){(0,se._registerComponent)(new de.wA(Xr,(p,{options:y})=>Fe(p.getProvider("app").getImmediate(),p.getProvider("installations-internal").getImmediate(),y),"PUBLIC")),(0,se._registerComponent)(new de.wA("analytics-internal",function d(p){try{const y=p.getProvider(Xr).getImmediate();return{logEvent:(w,N,M)=>function fs(d,p,y,w){d=(0,ae.m9)(d),function Z(d,p,y,w,N){return et.apply(this,arguments)}(qn,ar[d.app.options.appId],p,y,w).catch(N=>Et.error(N))}(y,w,N,M)}}catch(y){throw Lt.create("interop-component-reg-failed",{reason:y})}},"PRIVATE")),(0,se.registerVersion)(na,"0.8.0"),(0,se.registerVersion)(na,"0.8.0","esm2017")}();var no=z(4408),Kn=z(7565);const P=new class bi extends Kn.v{}(class nu extends no.o{constructor(p,y){super(p,y),this.scheduler=p,this.work=y}schedule(p,y=0){return y>0?super.schedule(p,y):(this.delay=y,this.state=p,this.scheduler.flush(this),this)}execute(p,y){return y>0||this.closed?super.execute(p,y):this._execute(p,y)}requestAsyncId(p,y,w=0){return null!=w&&w>0||null==w&&this.delay>0?super.requestAsyncId(p,y,w):p.flush(this)}});var cn=z(4986),ps=z(8505),xn=z(9468),zn=z(5363);const Hu=new I.GfV("7.4.1"),ur="__angularfire_symbol__analyticsIsSupportedValue",ro="__angularfire_symbol__analyticsIsSupported",ri="__angularfire_symbol__remoteConfigIsSupportedValue",io="__angularfire_symbol__remoteConfigIsSupported",sa="__angularfire_symbol__messagingIsSupportedValue",Bt="__angularfire_symbol__messagingIsSupported";function xi(d,p,y){if(p){if(1===p.length)return p[0];const M=p.filter(j=>j.app===y);if(1===M.length)return M[0]}return y.container.getProvider(d).getImmediate({optional:!0})}globalThis[ro]||(globalThis[ro]=ee().then(d=>globalThis[ur]=d).catch(()=>globalThis[ur]=!1)),globalThis[Bt]||(globalThis[Bt]=Qs().then(d=>globalThis[sa]=d).catch(()=>globalThis[sa]=!1)),globalThis[io]||(globalThis[io]=er().then(d=>globalThis[ri]=d).catch(()=>globalThis[ri]=!1));const xt=(d,p)=>{const y=p?[p]:(0,re.C6)(),w=[];return y.forEach(N=>{N.container.getProvider(d).instances.forEach(j=>{w.includes(j)||w.push(j)})}),w};function Be(){}class ii{constructor(p,y=P){this.zone=p,this.delegate=y}now(){return this.delegate.now()}schedule(p,y,w){const N=this.zone;return this.delegate.schedule(function(j){N.runGuarded(()=>{p.apply(this,[j])})},y,w)}}class Ci{constructor(p){this.zone=p,this.task=null}call(p,y){const w=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Be,{},Be,Be)),y.pipe((0,ps.b)({next:w,complete:w,error:w})).subscribe(p).add(w)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let ln=(()=>{class d{constructor(y){this.ngZone=y,this.outsideAngular=y.runOutsideAngular(()=>new ii(Zone.current)),this.insideAngular=y.run(()=>new ii(Zone.current,cn.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return d.\u0275fac=function(y){return new(y||d)(I.LFG(I.R0b))},d.\u0275prov=I.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();function cr(){const d=globalThis.\u0275AngularFireScheduler;if(!d)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return d}function hr(d){return cr(),function so(d){return function(y){return(y=y.lift(new Ci(d.ngZone))).pipe((0,xn.R)(d.outsideAngular),(0,zn.Q)(d.insideAngular))}}(cr())(d)}},2090:(Qt,Xe,z)=>{z.d(Xe,{$s:()=>vr,BH:()=>Ce,G6:()=>ge,L:()=>Ie,LL:()=>nt,Mn:()=>le,Sg:()=>Le,UG:()=>ke,US:()=>de,ZB:()=>G,ZR:()=>Ye,b$:()=>we,d:()=>Ee,eu:()=>W,hl:()=>E,jU:()=>te,m9:()=>Vi,ne:()=>gr,pd:()=>rn,r3:()=>fr,ru:()=>R,tV:()=>fe,uI:()=>ze,vZ:()=>Yt,w1:()=>xe,xO:()=>pr,xb:()=>st,z$:()=>$e,zI:()=>q,zd:()=>wt});const se=function(D){const S=[];let b=0;for(let x=0;x<D.length;x++){let A=D.charCodeAt(x);A<128?S[b++]=A:A<2048?(S[b++]=A>>6|192,S[b++]=63&A|128):55296==(64512&A)&&x+1<D.length&&56320==(64512&D.charCodeAt(x+1))?(A=65536+((1023&A)<<10)+(1023&D.charCodeAt(++x)),S[b++]=A>>18|240,S[b++]=A>>12&63|128,S[b++]=A>>6&63|128,S[b++]=63&A|128):(S[b++]=A>>12|224,S[b++]=A>>6&63|128,S[b++]=63&A|128)}return S},de={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(D,S){if(!Array.isArray(D))throw Error("encodeByteArray takes an array as a parameter");this.init_();const b=S?this.byteToCharMapWebSafe_:this.byteToCharMap_,x=[];for(let A=0;A<D.length;A+=3){const $=D[A],J=A+1<D.length,he=J?D[A+1]:0,lt=A+2<D.length,Ze=lt?D[A+2]:0;let Jt=(15&he)<<2|Ze>>6,bn=63&Ze;lt||(bn=64,J||(Jt=64)),x.push(b[$>>2],b[(3&$)<<4|he>>4],b[Jt],b[bn])}return x.join("")},encodeString(D,S){return this.HAS_NATIVE_SUPPORT&&!S?btoa(D):this.encodeByteArray(se(D),S)},decodeString(D,S){return this.HAS_NATIVE_SUPPORT&&!S?atob(D):function(D){const S=[];let b=0,x=0;for(;b<D.length;){const A=D[b++];if(A<128)S[x++]=String.fromCharCode(A);else if(A>191&&A<224){const $=D[b++];S[x++]=String.fromCharCode((31&A)<<6|63&$)}else if(A>239&&A<365){const lt=((7&A)<<18|(63&D[b++])<<12|(63&D[b++])<<6|63&D[b++])-65536;S[x++]=String.fromCharCode(55296+(lt>>10)),S[x++]=String.fromCharCode(56320+(1023&lt))}else{const $=D[b++],J=D[b++];S[x++]=String.fromCharCode((15&A)<<12|(63&$)<<6|63&J)}}return S.join("")}(this.decodeStringToByteArray(D,S))},decodeStringToByteArray(D,S){this.init_();const b=S?this.charToByteMapWebSafe_:this.charToByteMap_,x=[];for(let A=0;A<D.length;){const $=b[D.charAt(A++)],he=A<D.length?b[D.charAt(A)]:0;++A;const Ze=A<D.length?b[D.charAt(A)]:64;++A;const Ne=A<D.length?b[D.charAt(A)]:64;if(++A,null==$||null==he||null==Ze||null==Ne)throw Error();x.push($<<2|he>>4),64!==Ze&&(x.push(he<<4&240|Ze>>2),64!==Ne&&x.push(Ze<<6&192|Ne))}return x},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let D=0;D<this.ENCODED_VALS.length;D++)this.byteToCharMap_[D]=this.ENCODED_VALS.charAt(D),this.charToByteMap_[this.byteToCharMap_[D]]=D,this.byteToCharMapWebSafe_[D]=this.ENCODED_VALS_WEBSAFE.charAt(D),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[D]]=D,D>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(D)]=D,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(D)]=D)}}},Ie=function(D){return function(D){const S=se(D);return de.encodeByteArray(S,!0)}(D).replace(/\./g,"")},fe=function(D){try{return de.decodeString(D,!0)}catch(S){console.error("base64Decode failed: ",S)}return null};function G(D,S){if(!(S instanceof Object))return S;switch(S.constructor){case Date:return new Date(S.getTime());case Object:void 0===D&&(D={});break;case Array:D=[];break;default:return S}for(const b in S)!S.hasOwnProperty(b)||!ce(b)||(D[b]=G(D[b],S[b]));return D}function ce(D){return"__proto__"!==D}class Ce{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((S,b)=>{this.resolve=S,this.reject=b})}wrapCallback(S){return(b,x)=>{b?this.reject(b):this.resolve(x),"function"==typeof S&&(this.promise.catch(()=>{}),1===S.length?S(b):S(b,x))}}}function Le(D,S){if(D.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const x=S||"demo-project",A=D.iat||0,$=D.sub||D.user_id;if(!$)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const J=Object.assign({iss:`https://securetoken.google.com/${x}`,aud:x,iat:A,exp:A+3600,auth_time:A,sub:$,user_id:$,firebase:{sign_in_provider:"custom",identities:{}}},D);return[Ie(JSON.stringify({alg:"none",type:"JWT"})),Ie(JSON.stringify(J)),""].join(".")}function $e(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function ze(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($e())}function ke(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function te(){return"object"==typeof self&&self.self===self}function R(){const D="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof D&&void 0!==D.id}function we(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Ee(){return $e().indexOf("Electron/")>=0}function xe(){const D=$e();return D.indexOf("MSIE ")>=0||D.indexOf("Trident/")>=0}function le(){return $e().indexOf("MSAppHost/")>=0}function ge(){return!ke()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function E(){return"object"==typeof indexedDB}function W(){return new Promise((D,S)=>{try{let b=!0;const x="validate-browser-context-for-indexeddb-analytics-module",A=self.indexedDB.open(x);A.onsuccess=()=>{A.result.close(),b||self.indexedDB.deleteDatabase(x),D(!0)},A.onupgradeneeded=()=>{b=!1},A.onerror=()=>{var $;S((null===($=A.error)||void 0===$?void 0:$.message)||"")}}catch(b){S(b)}})}function q(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class Ye extends Error{constructor(S,b,x){super(b),this.code=S,this.customData=x,this.name="FirebaseError",Object.setPrototypeOf(this,Ye.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,nt.prototype.create)}}class nt{constructor(S,b,x){this.service=S,this.serviceName=b,this.errors=x}create(S,...b){const x=b[0]||{},A=`${this.service}/${S}`,$=this.errors[S],J=$?function kt(D,S){return D.replace(Ot,(b,x)=>{const A=S[x];return null!=A?String(A):`<${x}?>`})}($,x):"Error";return new Ye(A,`${this.serviceName}: ${J} (${A}).`,x)}}const Ot=/\{\$([^}]+)}/g;function fr(D,S){return Object.prototype.hasOwnProperty.call(D,S)}function st(D){for(const S in D)if(Object.prototype.hasOwnProperty.call(D,S))return!1;return!0}function Yt(D,S){if(D===S)return!0;const b=Object.keys(D),x=Object.keys(S);for(const A of b){if(!x.includes(A))return!1;const $=D[A],J=S[A];if(Rt($)&&Rt(J)){if(!Yt($,J))return!1}else if($!==J)return!1}for(const A of x)if(!b.includes(A))return!1;return!0}function Rt(D){return null!==D&&"object"==typeof D}function pr(D){const S=[];for(const[b,x]of Object.entries(D))Array.isArray(x)?x.forEach(A=>{S.push(encodeURIComponent(b)+"="+encodeURIComponent(A))}):S.push(encodeURIComponent(b)+"="+encodeURIComponent(x));return S.length?"&"+S.join("&"):""}function wt(D){const S={};return D.replace(/^\?/,"").split("&").forEach(x=>{if(x){const[A,$]=x.split("=");S[decodeURIComponent(A)]=decodeURIComponent($)}}),S}function rn(D){const S=D.indexOf("?");if(!S)return"";const b=D.indexOf("#",S);return D.substring(S,b>0?b:void 0)}function gr(D,S){const b=new sn(D,S);return b.subscribe.bind(b)}class sn{constructor(S,b){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=b,this.task.then(()=>{S(this)}).catch(x=>{this.error(x)})}next(S){this.forEachObserver(b=>{b.next(S)})}error(S){this.forEachObserver(b=>{b.error(S)}),this.close(S)}complete(){this.forEachObserver(S=>{S.complete()}),this.close()}subscribe(S,b,x){let A;if(void 0===S&&void 0===b&&void 0===x)throw new Error("Missing Observer.");A=function Ln(D,S){if("object"!=typeof D||null===D)return!1;for(const b of S)if(b in D&&"function"==typeof D[b])return!0;return!1}(S,["next","error","complete"])?S:{next:S,error:b,complete:x},void 0===A.next&&(A.next=Fn),void 0===A.error&&(A.error=Fn),void 0===A.complete&&(A.complete=Fn);const $=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?A.error(this.finalError):A.complete()}catch{}}),this.observers.push(A),$}unsubscribeOne(S){void 0===this.observers||void 0===this.observers[S]||(delete this.observers[S],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(S){if(!this.finalized)for(let b=0;b<this.observers.length;b++)this.sendOne(b,S)}sendOne(S,b){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[S])try{b(this.observers[S])}catch(x){typeof console<"u"&&console.error&&console.error(x)}})}close(S){this.finalized||(this.finalized=!0,void 0!==S&&(this.finalError=S),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Fn(){}function vr(D,S=1e3,b=2){const x=S*Math.pow(b,D),A=Math.round(.5*x*(Math.random()-.5)*2);return Math.min(144e5,x+A)}function Vi(D){return D&&D._delegate?D._delegate:D}},7835:(Qt,Xe,z)=>{z.d(Xe,{C6:()=>I.getApps,Mq:()=>I.getApp});var I=z(9681);(0,I.registerVersion)("firebase","9.9.3","app")},127:(Qt,Xe,z)=>{z.d(Xe,{Z:()=>I.Z});var I=z(3942);I.Z.registerVersion("firebase","9.9.3","app-compat")},1451:(Qt,Xe,z)=>{z.r(Xe);var I=z(5861),re=z(3942),k=z(2090),se=z(9681),ae=z(655),de=z(1877),me=z(4859);const $e=function Ce(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},ze=function Le(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ke=new k.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),R=new de.Yd("@firebase/auth");function we(c,...s){R.logLevel<=de.in.ERROR&&R.error(`Auth (${se.SDK_VERSION}): ${c}`,...s)}function Ee(c,...s){throw ge(c,...s)}function xe(c,...s){return ge(c,...s)}function le(c,s,a){const l=Object.assign(Object.assign({},ze()),{[s]:a});return new k.LL("auth","Firebase",l).create(s,{appName:c.name})}function He(c,s,a){if(!(s instanceof a))throw a.name!==s.constructor.name&&Ee(c,"argument-error"),le(c,"argument-error",`Type of ${s.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ge(c,...s){if("string"!=typeof c){const a=s[0],l=[...s.slice(1)];return l[0]&&(l[0].appName=c.name),c._errorFactory.create(a,...l)}return ke.create(c,...s)}function E(c,s,...a){if(!c)throw ge(s,...a)}function W(c){const s="INTERNAL ASSERTION FAILED: "+c;throw we(s),new Error(s)}function q(c,s){c||W(s)}const je=new Map;function Pe(c){q(c instanceof Function,"Expected a class definition");let s=je.get(c);return s?(q(s instanceof c,"Instance stored in cache mismatched with class"),s):(s=new c,je.set(c,s),s)}function kt(){var c;return typeof self<"u"&&(null===(c=self.location)||void 0===c?void 0:c.href)||""}function Ot(){return"http:"===Mn()||"https:"===Mn()}function Mn(){var c;return typeof self<"u"&&(null===(c=self.location)||void 0===c?void 0:c.protocol)||null}class Dt{constructor(s,a){this.shortDelay=s,this.longDelay=a,q(a>s,"Short delay should be less than long delay!"),this.isMobile=(0,k.uI)()||(0,k.b$)()}get(){return function nn(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Ot()||(0,k.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ge(c,s){q(c.emulator,"Emulator should always be set here");const{url:a}=c.emulator;return s?`${a}${s.startsWith("/")?s.slice(1):s}`:a}class Nt{static initialize(s,a,l){this.fetchImpl=s,a&&(this.headersImpl=a),l&&(this.responseImpl=l)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void W("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void W("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void W("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ui={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},fr=new Dt(3e4,6e4);function it(c,s){return c.tenantId&&!s.tenantId?Object.assign(Object.assign({},s),{tenantId:c.tenantId}):s}function st(c,s,a,l){return ci.apply(this,arguments)}function ci(){return(ci=(0,I.Z)(function*(c,s,a,l,g={}){return Yt(c,g,(0,I.Z)(function*(){let _={},C={};l&&("GET"===s?C=l:_={body:JSON.stringify(l)});const F=(0,k.xO)(Object.assign({key:c.config.apiKey},C)).slice(1),H=yield c._getAdditionalHeaders();return H["Content-Type"]="application/json",c.languageCode&&(H["X-Firebase-Locale"]=c.languageCode),Nt.fetch()(wt(c,c.config.apiHost,a,F),Object.assign({method:s,headers:H,referrerPolicy:"no-referrer"},_))}))})).apply(this,arguments)}function Yt(c,s,a){return Rt.apply(this,arguments)}function Rt(){return(Rt=(0,I.Z)(function*(c,s,a){c._canInitEmulator=!1;const l=Object.assign(Object.assign({},Ui),s);try{const g=new rn(c),_=yield Promise.race([a(),g.promise]);g.clearNetworkTimeout();const C=yield _.json();if("needConfirmation"in C)throw ot(c,"account-exists-with-different-credential",C);if(_.ok&&!("errorMessage"in C))return C;{const F=_.ok?C.errorMessage:C.error.message,[H,ie]=F.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===H)throw ot(c,"credential-already-in-use",C);if("EMAIL_EXISTS"===H)throw ot(c,"email-already-in-use",C);if("USER_DISABLED"===H)throw ot(c,"user-disabled",C);const _e=l[H]||H.toLowerCase().replace(/[_\s]+/g,"-");if(ie)throw le(c,_e,ie);Ee(c,_e)}}catch(g){if(g instanceof k.ZR)throw g;Ee(c,"network-request-failed")}})).apply(this,arguments)}function Ut(c,s,a,l){return pr.apply(this,arguments)}function pr(){return(pr=(0,I.Z)(function*(c,s,a,l,g={}){const _=yield st(c,s,a,l,g);return"mfaPendingCredential"in _&&Ee(c,"multi-factor-auth-required",{_serverResponse:_}),_})).apply(this,arguments)}function wt(c,s,a,l){const g=`${s}${a}?${l}`;return c.config.emulator?Ge(c.config,g):`${c.config.apiScheme}://${g}`}class rn{constructor(s){this.auth=s,this.timer=null,this.promise=new Promise((a,l)=>{this.timer=setTimeout(()=>l(xe(this.auth,"network-request-failed")),fr.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ot(c,s,a){const l={appName:c.name};a.email&&(l.email=a.email),a.phoneNumber&&(l.phoneNumber=a.phoneNumber);const g=xe(c,s,l);return g.customData._tokenResponse=a,g}function sn(){return(sn=(0,I.Z)(function*(c,s){return st(c,"POST","/v1/accounts:delete",s)})).apply(this,arguments)}function vn(c,s){return Ln.apply(this,arguments)}function Ln(){return(Ln=(0,I.Z)(function*(c,s){return st(c,"POST","/v1/accounts:update",s)})).apply(this,arguments)}function Fn(c,s){return In.apply(this,arguments)}function In(){return(In=(0,I.Z)(function*(c,s){return st(c,"POST","/v1/accounts:lookup",s)})).apply(this,arguments)}function qt(c){if(c)try{const s=new Date(Number(c));if(!isNaN(s.getTime()))return s.toUTCString()}catch{}}function fn(){return(fn=(0,I.Z)(function*(c,s=!1){const a=(0,k.m9)(c),l=yield a.getIdToken(s),g=wn(l);E(g&&g.exp&&g.auth_time&&g.iat,a.auth,"internal-error");const _="object"==typeof g.firebase?g.firebase:void 0,C=_?.sign_in_provider;return{claims:g,token:l,authTime:qt(Ur(g.auth_time)),issuedAtTime:qt(Ur(g.iat)),expirationTime:qt(Ur(g.exp)),signInProvider:C||null,signInSecondFactor:_?.sign_in_second_factor||null}})).apply(this,arguments)}function Ur(c){return 1e3*Number(c)}function wn(c){var s;const[a,l,g]=c.split(".");if(void 0===a||void 0===l||void 0===g)return we("JWT malformed, contained fewer than 3 sections"),null;try{const _=(0,k.tV)(l);return _?JSON.parse(_):(we("Failed to decode base64 JWT payload"),null)}catch(_){return we("Caught error parsing JWT payload as JSON",null===(s=_)||void 0===s?void 0:s.toString()),null}}function Kt(c,s){return En.apply(this,arguments)}function En(){return(En=(0,I.Z)(function*(c,s,a=!1){if(a)return s;try{return yield s}catch(l){throw l instanceof k.ZR&&Yn(l)&&c.auth.currentUser===c&&(yield c.auth.signOut()),l}})).apply(this,arguments)}function Yn({code:c}){return"auth/user-disabled"===c||"auth/user-token-expired"===c}class _r{constructor(s){this.user=s,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(s){var a;if(s){const l=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),l}{this.errorBackoff=3e4;const g=(null!==(a=this.user.stsTokenManager.expirationTime)&&void 0!==a?a:0)-Date.now()-3e5;return Math.max(0,g)}}schedule(s=!1){var a=this;if(!this.isRunning)return;const l=this.getInterval(s);this.timerId=setTimeout((0,I.Z)(function*(){yield a.iteration()}),l)}iteration(){var s=this;return(0,I.Z)(function*(){var a;try{yield s.user.getIdToken(!0)}catch(l){return void("auth/network-request-failed"===(null===(a=l)||void 0===a?void 0:a.code)&&s.schedule(!0))}s.schedule()})()}}class vr{constructor(s,a){this.createdAt=s,this.lastLoginAt=a,this._initializeTime()}_initializeTime(){this.lastSignInTime=qt(this.lastLoginAt),this.creationTime=qt(this.createdAt)}_copy(s){this.createdAt=s.createdAt,this.lastLoginAt=s.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Tn(c){return Jn.apply(this,arguments)}function Jn(){return(Jn=(0,I.Z)(function*(c){var s;const a=c.auth,l=yield c.getIdToken(),g=yield Kt(c,Fn(a,{idToken:l}));E(g?.users.length,a,"internal-error");const _=g.users[0];c._notifyReloadListener(_);const C=null!==(s=_.providerUserInfo)&&void 0!==s&&s.length?b(_.providerUserInfo):[],F=S(c.providerData,C),_e=!!c.isAnonymous&&!(c.email&&_.passwordHash||F?.length),pe={uid:_.localId,displayName:_.displayName||null,photoURL:_.photoUrl||null,email:_.email||null,emailVerified:_.emailVerified||!1,phoneNumber:_.phoneNumber||null,tenantId:_.tenantId||null,providerData:F,metadata:new vr(_.createdAt,_.lastLoginAt),isAnonymous:_e};Object.assign(c,pe)})).apply(this,arguments)}function D(){return(D=(0,I.Z)(function*(c){const s=(0,k.m9)(c);yield Tn(s),yield s.auth._persistUserIfCurrent(s),s.auth._notifyListenersIfCurrent(s)})).apply(this,arguments)}function S(c,s){return[...c.filter(l=>!s.some(g=>g.providerId===l.providerId)),...s]}function b(c){return c.map(s=>{var{providerId:a}=s,l=(0,ae._T)(s,["providerId"]);return{providerId:a,uid:l.rawId||"",displayName:l.displayName||null,email:l.email||null,phoneNumber:l.phoneNumber||null,photoURL:l.photoUrl||null}})}function A(){return(A=(0,I.Z)(function*(c,s){const a=yield Yt(c,{},(0,I.Z)(function*(){const l=(0,k.xO)({grant_type:"refresh_token",refresh_token:s}).slice(1),{tokenApiHost:g,apiKey:_}=c.config,C=wt(c,g,"/v1/token",`key=${_}`),F=yield c._getAdditionalHeaders();return F["Content-Type"]="application/x-www-form-urlencoded",Nt.fetch()(C,{method:"POST",headers:F,body:l})}));return{accessToken:a.access_token,expiresIn:a.expires_in,refreshToken:a.refresh_token}})).apply(this,arguments)}class ${constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(s){E(s.idToken,"internal-error"),E(typeof s.idToken<"u","internal-error"),E(typeof s.refreshToken<"u","internal-error");const a="expiresIn"in s&&typeof s.expiresIn<"u"?Number(s.expiresIn):function yr(c){const s=wn(c);return E(s,"internal-error"),E(typeof s.exp<"u","internal-error"),E(typeof s.iat<"u","internal-error"),Number(s.exp)-Number(s.iat)}(s.idToken);this.updateTokensAndExpiration(s.idToken,s.refreshToken,a)}getToken(s,a=!1){var l=this;return(0,I.Z)(function*(){return E(!l.accessToken||l.refreshToken,s,"user-token-expired"),a||!l.accessToken||l.isExpired?l.refreshToken?(yield l.refresh(s,l.refreshToken),l.accessToken):null:l.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(s,a){var l=this;return(0,I.Z)(function*(){const{accessToken:g,refreshToken:_,expiresIn:C}=yield function x(c,s){return A.apply(this,arguments)}(s,a);l.updateTokensAndExpiration(g,_,Number(C))})()}updateTokensAndExpiration(s,a,l){this.refreshToken=a||null,this.accessToken=s||null,this.expirationTime=Date.now()+1e3*l}static fromJSON(s,a){const{refreshToken:l,accessToken:g,expirationTime:_}=a,C=new $;return l&&(E("string"==typeof l,"internal-error",{appName:s}),C.refreshToken=l),g&&(E("string"==typeof g,"internal-error",{appName:s}),C.accessToken=g),_&&(E("number"==typeof _,"internal-error",{appName:s}),C.expirationTime=_),C}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(s){this.accessToken=s.accessToken,this.refreshToken=s.refreshToken,this.expirationTime=s.expirationTime}_clone(){return Object.assign(new $,this.toJSON())}_performRefresh(){return W("not implemented")}}function J(c,s){E("string"==typeof c||typeof c>"u","internal-error",{appName:s})}class he{constructor(s){var{uid:a,auth:l,stsTokenManager:g}=s,_=(0,ae._T)(s,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new _r(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=a,this.auth=l,this.stsTokenManager=g,this.accessToken=g.accessToken,this.displayName=_.displayName||null,this.email=_.email||null,this.emailVerified=_.emailVerified||!1,this.phoneNumber=_.phoneNumber||null,this.photoURL=_.photoURL||null,this.isAnonymous=_.isAnonymous||!1,this.tenantId=_.tenantId||null,this.providerData=_.providerData?[..._.providerData]:[],this.metadata=new vr(_.createdAt||void 0,_.lastLoginAt||void 0)}getIdToken(s){var a=this;return(0,I.Z)(function*(){const l=yield Kt(a,a.stsTokenManager.getToken(a.auth,s));return E(l,a.auth,"internal-error"),a.accessToken!==l&&(a.accessToken=l,yield a.auth._persistUserIfCurrent(a),a.auth._notifyListenersIfCurrent(a)),l})()}getIdTokenResult(s){return function mr(c){return fn.apply(this,arguments)}(this,s)}reload(){return function Vi(c){return D.apply(this,arguments)}(this)}_assign(s){this!==s&&(E(this.uid===s.uid,this.auth,"internal-error"),this.displayName=s.displayName,this.photoURL=s.photoURL,this.email=s.email,this.emailVerified=s.emailVerified,this.phoneNumber=s.phoneNumber,this.isAnonymous=s.isAnonymous,this.tenantId=s.tenantId,this.providerData=s.providerData.map(a=>Object.assign({},a)),this.metadata._copy(s.metadata),this.stsTokenManager._assign(s.stsTokenManager))}_clone(s){return new he(Object.assign(Object.assign({},this),{auth:s,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(s){E(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=s,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(s){this.reloadListener?this.reloadListener(s):this.reloadUserInfo=s}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(s,a=!1){var l=this;return(0,I.Z)(function*(){let g=!1;s.idToken&&s.idToken!==l.stsTokenManager.accessToken&&(l.stsTokenManager.updateFromServerResponse(s),g=!0),a&&(yield Tn(l)),yield l.auth._persistUserIfCurrent(l),g&&l.auth._notifyListenersIfCurrent(l)})()}delete(){var s=this;return(0,I.Z)(function*(){const a=yield s.getIdToken();return yield Kt(s,function gr(c,s){return sn.apply(this,arguments)}(s.auth,{idToken:a})),s.stsTokenManager.clearRefreshToken(),s.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(s=>Object.assign({},s)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(s,a){var l,g,_,C,F,H,ie,_e;const pe=null!==(l=a.displayName)&&void 0!==l?l:void 0,Ft=null!==(g=a.email)&&void 0!==g?g:void 0,Wn=null!==(_=a.phoneNumber)&&void 0!==_?_:void 0,ga=null!==(C=a.photoURL)&&void 0!==C?C:void 0,cc=null!==(F=a.tenantId)&&void 0!==F?F:void 0,lc=null!==(H=a._redirectEventId)&&void 0!==H?H:void 0,hc=null!==(ie=a.createdAt)&&void 0!==ie?ie:void 0,ml=null!==(_e=a.lastLoginAt)&&void 0!==_e?_e:void 0,{uid:dc,emailVerified:Is,isAnonymous:ws,providerData:fc,stsTokenManager:yl}=a;E(dc&&yl,s,"internal-error");const wh=$.fromJSON(this.name,yl);E("string"==typeof dc,s,"internal-error"),J(pe,s.name),J(Ft,s.name),E("boolean"==typeof Is,s,"internal-error"),E("boolean"==typeof ws,s,"internal-error"),J(Wn,s.name),J(ga,s.name),J(cc,s.name),J(lc,s.name),J(hc,s.name),J(ml,s.name);const bu=new he({uid:dc,auth:s,email:Ft,emailVerified:Is,displayName:pe,isAnonymous:ws,photoURL:ga,phoneNumber:Wn,tenantId:cc,stsTokenManager:wh,createdAt:hc,lastLoginAt:ml});return fc&&Array.isArray(fc)&&(bu.providerData=fc.map(dn=>Object.assign({},dn))),lc&&(bu._redirectEventId=lc),bu}static _fromIdTokenResponse(s,a,l=!1){return(0,I.Z)(function*(){const g=new $;g.updateFromServerResponse(a);const _=new he({uid:a.localId,auth:s,stsTokenManager:g,isAnonymous:l});return yield Tn(_),_})()}}const Ze=(()=>{class c{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,I.Z)(function*(){return!0})()}_set(a,l){var g=this;return(0,I.Z)(function*(){g.storage[a]=l})()}_get(a){var l=this;return(0,I.Z)(function*(){const g=l.storage[a];return void 0===g?null:g})()}_remove(a){var l=this;return(0,I.Z)(function*(){delete l.storage[a]})()}_addListener(a,l){}_removeListener(a,l){}}return c.type="NONE",c})();function At(c,s,a){return`firebase:${c}:${s}:${a}`}class Ne{constructor(s,a,l){this.persistence=s,this.auth=a,this.userKey=l;const{config:g,name:_}=this.auth;this.fullUserKey=At(this.userKey,g.apiKey,_),this.fullPersistenceKey=At("persistence",g.apiKey,_),this.boundEventHandler=a._onStorageEvent.bind(a),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(s){return this.persistence._set(this.fullUserKey,s.toJSON())}getCurrentUser(){var s=this;return(0,I.Z)(function*(){const a=yield s.persistence._get(s.fullUserKey);return a?he._fromJSON(s.auth,a):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(s){var a=this;return(0,I.Z)(function*(){if(a.persistence===s)return;const l=yield a.getCurrentUser();return yield a.removeCurrentUser(),a.persistence=s,l?a.setCurrentUser(l):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(s,a,l="authUser"){return(0,I.Z)(function*(){if(!a.length)return new Ne(Pe(Ze),s,l);const g=(yield Promise.all(a.map(function(){var ie=(0,I.Z)(function*(_e){if(yield _e._isAvailable())return _e});return function(_e){return ie.apply(this,arguments)}}()))).filter(ie=>ie);let _=g[0]||Pe(Ze);const C=At(l,s.config.apiKey,s.name);let F=null;for(const ie of a)try{const _e=yield ie._get(C);if(_e){const pe=he._fromJSON(s,_e);ie!==_&&(F=pe),_=ie;break}}catch{}const H=g.filter(ie=>ie._shouldAllowMigration);return _._shouldAllowMigration&&H.length?(_=H[0],F&&(yield _._set(C,F.toJSON())),yield Promise.all(a.map(function(){var ie=(0,I.Z)(function*(_e){if(_e!==_)try{yield _e._remove(C)}catch{}});return function(_e){return ie.apply(this,arguments)}}())),new Ne(_,s,l)):new Ne(_,s,l)})()}}function Jt(c){const s=c.toLowerCase();if(s.includes("opera/")||s.includes("opr/")||s.includes("opios/"))return"Opera";if(Eo(s))return"IEMobile";if(s.includes("msie")||s.includes("trident/"))return"IE";if(s.includes("edge/"))return"Edge";if(bn(s))return"Firefox";if(s.includes("silk/"))return"Silk";if(Ra(s))return"Blackberry";if(Bi(s))return"Webos";if(Vr(s))return"Safari";if((s.includes("chrome/")||li(s))&&!s.includes("edge/"))return"Chrome";if(Ir(s))return"Android";{const l=c.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===l?.length)return l[1]}return"Other"}function bn(c=(0,k.z$)()){return/firefox\//i.test(c)}function Vr(c=(0,k.z$)()){const s=c.toLowerCase();return s.includes("safari/")&&!s.includes("chrome/")&&!s.includes("crios/")&&!s.includes("android")}function li(c=(0,k.z$)()){return/crios\//i.test(c)}function Eo(c=(0,k.z$)()){return/iemobile/i.test(c)}function Ir(c=(0,k.z$)()){return/android/i.test(c)}function Ra(c=(0,k.z$)()){return/blackberry/i.test(c)}function Bi(c=(0,k.z$)()){return/webos/i.test(c)}function Br(c=(0,k.z$)()){return/iphone|ipad|ipod/i.test(c)||/macintosh/i.test(c)&&/mobile/i.test(c)}function To(c=(0,k.z$)()){return Br(c)||Ir(c)||Bi(c)||Ra(c)||/windows phone/i.test(c)||Eo(c)}function hi(c,s=[]){let a;switch(c){case"Browser":a=Jt((0,k.z$)());break;case"Worker":a=`${Jt((0,k.z$)())}-${c}`;break;default:a=c}const l=s.length?s.join(","):"FirebaseCore-web";return`${a}/JsCore/${se.SDK_VERSION}/${l}`}class St{constructor(s){this.auth=s,this.queue=[]}pushCallback(s,a){const l=_=>new Promise((C,F)=>{try{C(s(_))}catch(H){F(H)}});l.onAbort=a,this.queue.push(l);const g=this.queue.length-1;return()=>{this.queue[g]=()=>Promise.resolve()}}runMiddleware(s){var a=this;return(0,I.Z)(function*(){var l;if(a.auth.currentUser===s)return;const g=[];try{for(const _ of a.queue)yield _(s),_.onAbort&&g.push(_.onAbort)}catch(_){g.reverse();for(const C of g)try{C()}catch{}throw a.auth._errorFactory.create("login-blocked",{originalMessage:null===(l=_)||void 0===l?void 0:l.message})}})()}}class Pt{constructor(s,a,l){this.app=s,this.heartbeatServiceProvider=a,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ss(this),this.idTokenSubscription=new Ss(this),this.beforeStateQueue=new St(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ke,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=s.name,this.clientVersion=l.sdkClientVersion}_initializeWithPersistence(s,a){var l=this;return a&&(this._popupRedirectResolver=Pe(a)),this._initializationPromise=this.queue((0,I.Z)(function*(){var g,_;if(!l._deleted&&(l.persistenceManager=yield Ne.create(l,s),!l._deleted)){if(null!==(g=l._popupRedirectResolver)&&void 0!==g&&g._shouldInitProactively)try{yield l._popupRedirectResolver._initialize(l)}catch{}yield l.initializeCurrentUser(a),l.lastNotifiedUid=(null===(_=l.currentUser)||void 0===_?void 0:_.uid)||null,!l._deleted&&(l._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var s=this;return(0,I.Z)(function*(){if(s._deleted)return;const a=yield s.assertedPersistence.getCurrentUser();if(s.currentUser||a){if(s.currentUser&&a&&s.currentUser.uid===a.uid)return s._currentUser._assign(a),void(yield s.currentUser.getIdToken());yield s._updateCurrentUser(a,!0)}})()}initializeCurrentUser(s){var a=this;return(0,I.Z)(function*(){var l;const g=yield a.assertedPersistence.getCurrentUser();let _=g,C=!1;if(s&&a.config.authDomain){yield a.getOrInitRedirectPersistenceManager();const F=null===(l=a.redirectUser)||void 0===l?void 0:l._redirectEventId,H=_?._redirectEventId,ie=yield a.tryRedirectSignIn(s);(!F||F===H)&&ie?.user&&(_=ie.user,C=!0)}if(!_)return a.directlySetCurrentUser(null);if(!_._redirectEventId){if(C)try{yield a.beforeStateQueue.runMiddleware(_)}catch(F){_=g,a._popupRedirectResolver._overrideRedirectResult(a,()=>Promise.reject(F))}return _?a.reloadAndSetCurrentUserOrClear(_):a.directlySetCurrentUser(null)}return E(a._popupRedirectResolver,a,"argument-error"),yield a.getOrInitRedirectPersistenceManager(),a.redirectUser&&a.redirectUser._redirectEventId===_._redirectEventId?a.directlySetCurrentUser(_):a.reloadAndSetCurrentUserOrClear(_)})()}tryRedirectSignIn(s){var a=this;return(0,I.Z)(function*(){let l=null;try{l=yield a._popupRedirectResolver._completeRedirectFn(a,s,!0)}catch{yield a._setRedirectUser(null)}return l})()}reloadAndSetCurrentUserOrClear(s){var a=this;return(0,I.Z)(function*(){var l;try{yield Tn(s)}catch(g){if("auth/network-request-failed"!==(null===(l=g)||void 0===l?void 0:l.code))return a.directlySetCurrentUser(null)}return a.directlySetCurrentUser(s)})()}useDeviceLanguage(){this.languageCode=function rt(){if(typeof navigator>"u")return null;const c=navigator;return c.languages&&c.languages[0]||c.language||null}()}_delete(){var s=this;return(0,I.Z)(function*(){s._deleted=!0})()}updateCurrentUser(s){var a=this;return(0,I.Z)(function*(){const l=s?(0,k.m9)(s):null;return l&&E(l.auth.config.apiKey===a.config.apiKey,a,"invalid-user-token"),a._updateCurrentUser(l&&l._clone(a))})()}_updateCurrentUser(s,a=!1){var l=this;return(0,I.Z)(function*(){if(!l._deleted)return s&&E(l.tenantId===s.tenantId,l,"tenant-id-mismatch"),a||(yield l.beforeStateQueue.runMiddleware(s)),l.queue((0,I.Z)(function*(){yield l.directlySetCurrentUser(s),l.notifyAuthListeners()}))})()}signOut(){var s=this;return(0,I.Z)(function*(){return yield s.beforeStateQueue.runMiddleware(null),(s.redirectPersistenceManager||s._popupRedirectResolver)&&(yield s._setRedirectUser(null)),s._updateCurrentUser(null,!0)})()}setPersistence(s){var a=this;return this.queue((0,I.Z)(function*(){yield a.assertedPersistence.setPersistence(Pe(s))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(s){this._errorFactory=new k.LL("auth","Firebase",s())}onAuthStateChanged(s,a,l){return this.registerStateListener(this.authStateSubscription,s,a,l)}beforeAuthStateChanged(s,a){return this.beforeStateQueue.pushCallback(s,a)}onIdTokenChanged(s,a,l){return this.registerStateListener(this.idTokenSubscription,s,a,l)}toJSON(){var s;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(s=this._currentUser)||void 0===s?void 0:s.toJSON()}}_setRedirectUser(s,a){var l=this;return(0,I.Z)(function*(){const g=yield l.getOrInitRedirectPersistenceManager(a);return null===s?g.removeCurrentUser():g.setCurrentUser(s)})()}getOrInitRedirectPersistenceManager(s){var a=this;return(0,I.Z)(function*(){if(!a.redirectPersistenceManager){const l=s&&Pe(s)||a._popupRedirectResolver;E(l,a,"argument-error"),a.redirectPersistenceManager=yield Ne.create(a,[Pe(l._redirectPersistence)],"redirectUser"),a.redirectUser=yield a.redirectPersistenceManager.getCurrentUser()}return a.redirectPersistenceManager})()}_redirectUserForId(s){var a=this;return(0,I.Z)(function*(){var l,g;return a._isInitialized&&(yield a.queue((0,I.Z)(function*(){}))),(null===(l=a._currentUser)||void 0===l?void 0:l._redirectEventId)===s?a._currentUser:(null===(g=a.redirectUser)||void 0===g?void 0:g._redirectEventId)===s?a.redirectUser:null})()}_persistUserIfCurrent(s){var a=this;return(0,I.Z)(function*(){if(s===a.currentUser)return a.queue((0,I.Z)(function*(){return a.directlySetCurrentUser(s)}))})()}_notifyListenersIfCurrent(s){s===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var s,a;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const l=null!==(a=null===(s=this.currentUser)||void 0===s?void 0:s.uid)&&void 0!==a?a:null;this.lastNotifiedUid!==l&&(this.lastNotifiedUid=l,this.authStateSubscription.next(this.currentUser))}registerStateListener(s,a,l,g){if(this._deleted)return()=>{};const _="function"==typeof a?a:a.next.bind(a),C=this._isInitialized?Promise.resolve():this._initializationPromise;return E(C,this,"internal-error"),C.then(()=>_(this.currentUser)),"function"==typeof a?s.addObserver(a,l,g):s.addObserver(a)}directlySetCurrentUser(s){var a=this;return(0,I.Z)(function*(){a.currentUser&&a.currentUser!==s&&(a._currentUser._stopProactiveRefresh(),s&&a.isProactiveRefreshEnabled&&s._startProactiveRefresh()),a.currentUser=s,s?yield a.assertedPersistence.setCurrentUser(s):yield a.assertedPersistence.removeCurrentUser()})()}queue(s){return this.operations=this.operations.then(s,s),this.operations}get assertedPersistence(){return E(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(s){!s||this.frameworks.includes(s)||(this.frameworks.push(s),this.frameworks.sort(),this.clientVersion=hi(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var s=this;return(0,I.Z)(function*(){var a;const l={"X-Client-Version":s.clientVersion};s.app.options.appId&&(l["X-Firebase-gmpid"]=s.app.options.appId);const g=yield null===(a=s.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===a?void 0:a.getHeartbeatsHeader();return g&&(l["X-Firebase-Client"]=g),l})()}}function yt(c){return(0,k.m9)(c)}class Ss{constructor(s){this.auth=s,this.observer=null,this.addObserver=(0,k.ne)(a=>this.observer=a)}get next(){return E(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function xs(c){const s=c.indexOf(":");return s<0?"":c.substr(0,s+1)}function Pa(c){if(!c)return null;const s=Number(c);return isNaN(s)?null:s}class wr{constructor(s,a){this.providerId=s,this.signInMethod=a}toJSON(){return W("not implemented")}_getIdTokenResponse(s){return W("not implemented")}_linkToIdToken(s,a){return W("not implemented")}_getReauthenticationResolver(s){return W("not implemented")}}function Mt(c,s){return So.apply(this,arguments)}function So(){return(So=(0,I.Z)(function*(c,s){return st(c,"POST","/v1/accounts:resetPassword",it(c,s))})).apply(this,arguments)}function Cs(c,s){return ks.apply(this,arguments)}function ks(){return(ks=(0,I.Z)(function*(c,s){return st(c,"POST","/v1/accounts:update",s)})).apply(this,arguments)}function La(c,s){return di.apply(this,arguments)}function di(){return(di=(0,I.Z)(function*(c,s){return st(c,"POST","/v1/accounts:update",it(c,s))})).apply(this,arguments)}function Ds(){return(Ds=(0,I.Z)(function*(c,s){return Ut(c,"POST","/v1/accounts:signInWithPassword",it(c,s))})).apply(this,arguments)}function ji(c,s){return Gi.apply(this,arguments)}function Gi(){return(Gi=(0,I.Z)(function*(c,s){return st(c,"POST","/v1/accounts:sendOobCode",it(c,s))})).apply(this,arguments)}function qi(c,s){return Ns.apply(this,arguments)}function Ns(){return(Ns=(0,I.Z)(function*(c,s){return ji(c,s)})).apply(this,arguments)}function Rs(c,s){return xo.apply(this,arguments)}function xo(){return(xo=(0,I.Z)(function*(c,s){return ji(c,s)})).apply(this,arguments)}function Co(c,s){return Fa.apply(this,arguments)}function Fa(){return(Fa=(0,I.Z)(function*(c,s){return ji(c,s)})).apply(this,arguments)}function Fc(c,s){return An.apply(this,arguments)}function An(){return(An=(0,I.Z)(function*(c,s){return ji(c,s)})).apply(this,arguments)}function ko(){return(ko=(0,I.Z)(function*(c,s){return Ut(c,"POST","/v1/accounts:signInWithEmailLink",it(c,s))})).apply(this,arguments)}function Os(){return(Os=(0,I.Z)(function*(c,s){return Ut(c,"POST","/v1/accounts:signInWithEmailLink",it(c,s))})).apply(this,arguments)}class Er extends wr{constructor(s,a,l,g=null){super("password",l),this._email=s,this._password=a,this._tenantId=g}static _fromEmailAndPassword(s,a){return new Er(s,a,"password")}static _fromEmailAndCode(s,a,l=null){return new Er(s,a,"emailLink",l)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(s){const a="string"==typeof s?JSON.parse(s):s;if(a?.email&&a?.password){if("password"===a.signInMethod)return this._fromEmailAndPassword(a.email,a.password);if("emailLink"===a.signInMethod)return this._fromEmailAndCode(a.email,a.password,a.tenantId)}return null}_getIdTokenResponse(s){var a=this;return(0,I.Z)(function*(){switch(a.signInMethod){case"password":return function $i(c,s){return Ds.apply(this,arguments)}(s,{returnSecureToken:!0,email:a._email,password:a._password});case"emailLink":return function Uc(c,s){return ko.apply(this,arguments)}(s,{email:a._email,oobCode:a._password});default:Ee(s,"internal-error")}})()}_linkToIdToken(s,a){var l=this;return(0,I.Z)(function*(){switch(l.signInMethod){case"password":return Cs(s,{idToken:a,returnSecureToken:!0,email:l._email,password:l._password});case"emailLink":return function $r(c,s){return Os.apply(this,arguments)}(s,{idToken:a,email:l._email,oobCode:l._password});default:Ee(s,"internal-error")}})()}_getReauthenticationResolver(s){return this._getIdTokenResponse(s)}}function Un(c,s){return jr.apply(this,arguments)}function jr(){return(jr=(0,I.Z)(function*(c,s){return Ut(c,"POST","/v1/accounts:signInWithIdp",it(c,s))})).apply(this,arguments)}class at extends wr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(s){const a=new at(s.providerId,s.signInMethod);return s.idToken||s.accessToken?(s.idToken&&(a.idToken=s.idToken),s.accessToken&&(a.accessToken=s.accessToken),s.nonce&&!s.pendingToken&&(a.nonce=s.nonce),s.pendingToken&&(a.pendingToken=s.pendingToken)):s.oauthToken&&s.oauthTokenSecret?(a.accessToken=s.oauthToken,a.secret=s.oauthTokenSecret):Ee("argument-error"),a}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(s){const a="string"==typeof s?JSON.parse(s):s,{providerId:l,signInMethod:g}=a,_=(0,ae._T)(a,["providerId","signInMethod"]);if(!l||!g)return null;const C=new at(l,g);return C.idToken=_.idToken||void 0,C.accessToken=_.accessToken||void 0,C.secret=_.secret,C.nonce=_.nonce,C.pendingToken=_.pendingToken||null,C}_getIdTokenResponse(s){return Un(s,this.buildRequest())}_linkToIdToken(s,a){const l=this.buildRequest();return l.idToken=a,Un(s,l)}_getReauthenticationResolver(s){const a=this.buildRequest();return a.autoCreate=!1,Un(s,a)}buildRequest(){const s={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)s.pendingToken=this.pendingToken;else{const a={};this.idToken&&(a.id_token=this.idToken),this.accessToken&&(a.access_token=this.accessToken),this.secret&&(a.oauth_token_secret=this.secret),a.providerId=this.providerId,this.nonce&&!this.pendingToken&&(a.nonce=this.nonce),s.postBody=(0,k.xO)(a)}return s}}function Va(c,s){return Gr.apply(this,arguments)}function Gr(){return(Gr=(0,I.Z)(function*(c,s){return st(c,"POST","/v1/accounts:sendVerificationCode",it(c,s))})).apply(this,arguments)}function Vn(){return(Vn=(0,I.Z)(function*(c,s){return Ut(c,"POST","/v1/accounts:signInWithPhoneNumber",it(c,s))})).apply(this,arguments)}function Ps(){return(Ps=(0,I.Z)(function*(c,s){const a=yield Ut(c,"POST","/v1/accounts:signInWithPhoneNumber",it(c,s));if(a.temporaryProof)throw ot(c,"account-exists-with-different-credential",a);return a})).apply(this,arguments)}const Ba={USER_NOT_FOUND:"user-not-found"};function zi(){return(zi=(0,I.Z)(function*(c,s){return Ut(c,"POST","/v1/accounts:signInWithPhoneNumber",it(c,Object.assign(Object.assign({},s),{operation:"REAUTH"})),Ba)})).apply(this,arguments)}class Xn extends wr{constructor(s){super("phone","phone"),this.params=s}static _fromVerification(s,a){return new Xn({verificationId:s,verificationCode:a})}static _fromTokenResponse(s,a){return new Xn({phoneNumber:s,temporaryProof:a})}_getIdTokenResponse(s){return function qr(c,s){return Vn.apply(this,arguments)}(s,this._makeVerificationRequest())}_linkToIdToken(s,a){return function Do(c,s){return Ps.apply(this,arguments)}(s,Object.assign({idToken:a},this._makeVerificationRequest()))}_getReauthenticationResolver(s){return function Ki(c,s){return zi.apply(this,arguments)}(s,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:s,phoneNumber:a,verificationId:l,verificationCode:g}=this.params;return s&&a?{temporaryProof:s,phoneNumber:a}:{sessionInfo:l,code:g}}toJSON(){const s={providerId:this.providerId};return this.params.phoneNumber&&(s.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(s.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(s.verificationCode=this.params.verificationCode),this.params.verificationId&&(s.verificationId=this.params.verificationId),s}static fromJSON(s){"string"==typeof s&&(s=JSON.parse(s));const{verificationId:a,verificationCode:l,phoneNumber:g,temporaryProof:_}=s;return l||a||g||_?new Xn({verificationId:a,verificationCode:l,phoneNumber:g,temporaryProof:_}):null}}class er{constructor(s){var a,l,g,_,C,F;const H=(0,k.zd)((0,k.pd)(s)),ie=null!==(a=H.apiKey)&&void 0!==a?a:null,_e=null!==(l=H.oobCode)&&void 0!==l?l:null,pe=function $a(c){switch(c){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(g=H.mode)&&void 0!==g?g:null);E(ie&&_e&&pe,"argument-error"),this.apiKey=ie,this.operation=pe,this.code=_e,this.continueUrl=null!==(_=H.continueUrl)&&void 0!==_?_:null,this.languageCode=null!==(C=H.languageCode)&&void 0!==C?C:null,this.tenantId=null!==(F=H.tenantId)&&void 0!==F?F:null}static parseLink(s){const a=function fi(c){const s=(0,k.zd)((0,k.pd)(c)).link,a=s?(0,k.zd)((0,k.pd)(s)).deep_link_id:null,l=(0,k.zd)((0,k.pd)(c)).deep_link_id;return(l?(0,k.zd)((0,k.pd)(l)).link:null)||l||a||s||c}(s);try{return new er(a)}catch{return null}}}let Ro=(()=>{class c{constructor(){this.providerId=c.PROVIDER_ID}static credential(a,l){return Er._fromEmailAndPassword(a,l)}static credentialWithLink(a,l){const g=er.parseLink(l);return E(g,"argument-error"),Er._fromEmailAndCode(a,g.code,g.tenantId)}}return c.PROVIDER_ID="password",c.EMAIL_PASSWORD_SIGN_IN_METHOD="password",c.EMAIL_LINK_SIGN_IN_METHOD="emailLink",c})();class Sn{constructor(s){this.providerId=s,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(s){this.defaultLanguageCode=s}setCustomParameters(s){return this.customParameters=s,this}getCustomParameters(){return this.customParameters}}class Bn extends Sn{constructor(){super(...arguments),this.scopes=[]}addScope(s){return this.scopes.includes(s)||this.scopes.push(s),this}getScopes(){return[...this.scopes]}}class Tr extends Bn{static credentialFromJSON(s){const a="string"==typeof s?JSON.parse(s):s;return E("providerId"in a&&"signInMethod"in a,"argument-error"),at._fromParams(a)}credential(s){return this._credential(Object.assign(Object.assign({},s),{nonce:s.rawNonce}))}_credential(s){return E(s.idToken||s.accessToken,"argument-error"),at._fromParams(Object.assign(Object.assign({},s),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(s){return Tr.oauthCredentialFromTaggedObject(s)}static credentialFromError(s){return Tr.oauthCredentialFromTaggedObject(s.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:s}){if(!s)return null;const{oauthIdToken:a,oauthAccessToken:l,oauthTokenSecret:g,pendingToken:_,nonce:C,providerId:F}=s;if(!l&&!g&&!a&&!_||!F)return null;try{return new Tr(F)._credential({idToken:a,accessToken:l,nonce:C,pendingToken:_})}catch{return null}}}let Ms=(()=>{class c extends Bn{constructor(){super("facebook.com")}static credential(a){return at._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.FACEBOOK_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return c.credential(a.oauthAccessToken)}catch{return null}}}return c.FACEBOOK_SIGN_IN_METHOD="facebook.com",c.PROVIDER_ID="facebook.com",c})(),Oo=(()=>{class c extends Bn{constructor(){super("google.com"),this.addScope("profile")}static credential(a,l){return at._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.GOOGLE_SIGN_IN_METHOD,idToken:a,accessToken:l})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{oauthIdToken:l,oauthAccessToken:g}=a;if(!l&&!g)return null;try{return c.credential(l,g)}catch{return null}}}return c.GOOGLE_SIGN_IN_METHOD="google.com",c.PROVIDER_ID="google.com",c})(),Po=(()=>{class c extends Bn{constructor(){super("github.com")}static credential(a){return at._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.GITHUB_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return c.credential(a.oauthAccessToken)}catch{return null}}}return c.GITHUB_SIGN_IN_METHOD="github.com",c.PROVIDER_ID="github.com",c})();class tr extends wr{constructor(s,a){super(s,s),this.pendingToken=a}_getIdTokenResponse(s){return Un(s,this.buildRequest())}_linkToIdToken(s,a){const l=this.buildRequest();return l.idToken=a,Un(s,l)}_getReauthenticationResolver(s){const a=this.buildRequest();return a.autoCreate=!1,Un(s,a)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(s){const a="string"==typeof s?JSON.parse(s):s,{providerId:l,signInMethod:g,pendingToken:_}=a;return l&&g&&_&&l===g?new tr(l,_):null}static _create(s,a){return new tr(s,a)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class zt extends Sn{constructor(s){E(s.startsWith("saml."),"argument-error"),super(s)}static credentialFromResult(s){return zt.samlCredentialFromTaggedObject(s)}static credentialFromError(s){return zt.samlCredentialFromTaggedObject(s.customData||{})}static credentialFromJSON(s){const a=tr.fromJSON(s);return E(a,"argument-error"),a}static samlCredentialFromTaggedObject({_tokenResponse:s}){if(!s)return null;const{pendingToken:a,providerId:l}=s;if(!a||!l)return null;try{return tr._create(l,a)}catch{return null}}}let pi=(()=>{class c extends Bn{constructor(){super("twitter.com")}static credential(a,l){return at._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.TWITTER_SIGN_IN_METHOD,oauthToken:a,oauthTokenSecret:l})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{oauthAccessToken:l,oauthTokenSecret:g}=a;if(!l||!g)return null;try{return c.credential(l,g)}catch{return null}}}return c.TWITTER_SIGN_IN_METHOD="twitter.com",c.PROVIDER_ID="twitter.com",c})();function $n(c,s){return Zi.apply(this,arguments)}function Zi(){return(Zi=(0,I.Z)(function*(c,s){return Ut(c,"POST","/v1/accounts:signUp",it(c,s))})).apply(this,arguments)}class on{constructor(s){this.user=s.user,this.providerId=s.providerId,this._tokenResponse=s._tokenResponse,this.operationType=s.operationType}static _fromIdTokenResponse(s,a,l,g=!1){return(0,I.Z)(function*(){const _=yield he._fromIdTokenResponse(s,l,g),C=Ls(l);return new on({user:_,providerId:C,_tokenResponse:l,operationType:a})})()}static _forOperation(s,a,l){return(0,I.Z)(function*(){yield s._updateTokensIfNecessary(l,!0);const g=Ls(l);return new on({user:s,providerId:g,_tokenResponse:l,operationType:a})})()}}function Ls(c){return c.providerId?c.providerId:"phoneNumber"in c?"phone":null}function Wi(){return(Wi=(0,I.Z)(function*(c){var s;const a=yt(c);if(yield a._initializationPromise,null!==(s=a.currentUser)&&void 0!==s&&s.isAnonymous)return new on({user:a.currentUser,providerId:null,operationType:"signIn"});const l=yield $n(a,{returnSecureToken:!0}),g=yield on._fromIdTokenResponse(a,"signIn",l,!0);return yield a._updateCurrentUser(g.user),g})).apply(this,arguments)}class jn extends k.ZR{constructor(s,a,l,g){var _;super(a.code,a.message),this.operationType=l,this.user=g,Object.setPrototypeOf(this,jn.prototype),this.customData={appName:s.name,tenantId:null!==(_=s.tenantId)&&void 0!==_?_:void 0,_serverResponse:a.customData._serverResponse,operationType:l}}static _fromErrorAndOperation(s,a,l,g){return new jn(s,a,l,g)}}function Mo(c,s,a,l){return("reauthenticate"===s?a._getReauthenticationResolver(c):a._getIdTokenResponse(c)).catch(_=>{throw"auth/multi-factor-auth-required"===_.code?jn._fromErrorAndOperation(c,_,s,l):_})}function Ar(c){return new Set(c.map(({providerId:s})=>s).filter(s=>!!s))}function an(){return(an=(0,I.Z)(function*(c,s){const a=(0,k.m9)(c);yield rr(!0,a,s);const{providerUserInfo:l}=yield vn(a.auth,{idToken:yield a.getIdToken(),deleteProvider:[s]}),g=Ar(l||[]);return a.providerData=a.providerData.filter(_=>g.has(_.providerId)),g.has("phone")||(a.phoneNumber=null),yield a.auth._persistUserIfCurrent(a),a})).apply(this,arguments)}function zr(c,s){return Sr.apply(this,arguments)}function Sr(){return(Sr=(0,I.Z)(function*(c,s,a=!1){const l=yield Kt(c,s._linkToIdToken(c.auth,yield c.getIdToken()),a);return on._forOperation(c,"link",l)})).apply(this,arguments)}function rr(c,s,a){return gi.apply(this,arguments)}function gi(){return(gi=(0,I.Z)(function*(c,s,a){yield Tn(s);const g=!1===c?"provider-already-linked":"no-such-provider";E(Ar(s.providerData).has(a)===c,s.auth,g)})).apply(this,arguments)}function tt(c,s){return xr.apply(this,arguments)}function xr(){return(xr=(0,I.Z)(function*(c,s,a=!1){var l;const{auth:g}=c,_="reauthenticate";try{const C=yield Kt(c,Mo(g,_,s,c),a);E(C.idToken,g,"internal-error");const F=wn(C.idToken);E(F,g,"internal-error");const{sub:H}=F;return E(c.uid===H,g,"user-mismatch"),on._forOperation(c,_,C)}catch(C){throw"auth/user-not-found"===(null===(l=C)||void 0===l?void 0:l.code)&&Ee(g,"user-mismatch"),C}})).apply(this,arguments)}function Fs(c,s){return Lo.apply(this,arguments)}function Lo(){return(Lo=(0,I.Z)(function*(c,s,a=!1){const l="signIn",g=yield Mo(c,l,s),_=yield on._fromIdTokenResponse(c,l,g);return a||(yield c._updateCurrentUser(_.user)),_})).apply(this,arguments)}function ut(c,s){return Zr.apply(this,arguments)}function Zr(){return(Zr=(0,I.Z)(function*(c,s){return Fs(yt(c),s)})).apply(this,arguments)}function Us(c,s){return Vs.apply(this,arguments)}function Vs(){return(Vs=(0,I.Z)(function*(c,s){const a=(0,k.m9)(c);return yield rr(!1,a,s.providerId),zr(a,s)})).apply(this,arguments)}function Bs(c,s){return $s.apply(this,arguments)}function $s(){return($s=(0,I.Z)(function*(c,s){return tt((0,k.m9)(c),s)})).apply(this,arguments)}function Fo(c,s){return Hi.apply(this,arguments)}function Hi(){return(Hi=(0,I.Z)(function*(c,s){return Ut(c,"POST","/v1/accounts:signInWithCustomToken",it(c,s))})).apply(this,arguments)}function pn(){return(pn=(0,I.Z)(function*(c,s){const a=yt(c),l=yield Fo(a,{token:s,returnSecureToken:!0}),g=yield on._fromIdTokenResponse(a,"signIn",l);return yield a._updateCurrentUser(g.user),g})).apply(this,arguments)}class mi{constructor(s,a){this.factorId=s,this.uid=a.mfaEnrollmentId,this.enrollmentTime=new Date(a.enrolledAt).toUTCString(),this.displayName=a.displayName}static _fromServerResponse(s,a){return"phoneInfo"in a?js._fromServerResponse(s,a):Ee(s,"internal-error")}}class js extends mi{constructor(s){super("phone",s),this.phoneNumber=s.phoneInfo}static _fromServerResponse(s,a){return new js(a)}}function Qi(c,s,a){var l;E((null===(l=a.url)||void 0===l?void 0:l.length)>0,c,"invalid-continue-uri"),E(typeof a.dynamicLinkDomain>"u"||a.dynamicLinkDomain.length>0,c,"invalid-dynamic-link-domain"),s.continueUrl=a.url,s.dynamicLinkDomain=a.dynamicLinkDomain,s.canHandleCodeInApp=a.handleCodeInApp,a.iOS&&(E(a.iOS.bundleId.length>0,c,"missing-ios-bundle-id"),s.iOSBundleId=a.iOS.bundleId),a.android&&(E(a.android.packageName.length>0,c,"missing-android-pkg-name"),s.androidInstallApp=a.android.installApp,s.androidMinimumVersionCode=a.android.minimumVersion,s.androidPackageName=a.android.packageName)}function Gs(){return(Gs=(0,I.Z)(function*(c,s,a){const l=(0,k.m9)(c),g={requestType:"PASSWORD_RESET",email:s};a&&Qi(l,g,a),yield Rs(l,g)})).apply(this,arguments)}function qs(){return(qs=(0,I.Z)(function*(c,s,a){yield Mt((0,k.m9)(c),{oobCode:s,newPassword:a})})).apply(this,arguments)}function Yi(){return(Yi=(0,I.Z)(function*(c,s){yield La((0,k.m9)(c),{oobCode:s})})).apply(this,arguments)}function Ji(c,s){return Xi.apply(this,arguments)}function Xi(){return(Xi=(0,I.Z)(function*(c,s){const a=(0,k.m9)(c),l=yield Mt(a,{oobCode:s}),g=l.requestType;switch(E(g,a,"internal-error"),g){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":E(l.newEmail,a,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":E(l.mfaInfo,a,"internal-error");default:E(l.email,a,"internal-error")}let _=null;return l.mfaInfo&&(_=mi._fromServerResponse(yt(a),l.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===l.requestType?l.newEmail:l.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===l.requestType?l.email:l.newEmail)||null,multiFactorInfo:_},operation:g}})).apply(this,arguments)}function Ks(){return(Ks=(0,I.Z)(function*(c,s){const{data:a}=yield Ji((0,k.m9)(c),s);return a.email})).apply(this,arguments)}function ts(){return(ts=(0,I.Z)(function*(c,s,a){const l=yt(c),g=yield $n(l,{returnSecureToken:!0,email:s,password:a}),_=yield on._fromIdTokenResponse(l,"signIn",g);return yield l._updateCurrentUser(_.user),_})).apply(this,arguments)}function $o(){return($o=(0,I.Z)(function*(c,s,a){const l=(0,k.m9)(c),g={requestType:"EMAIL_SIGNIN",email:s};E(a.handleCodeInApp,l,"argument-error"),a&&Qi(l,g,a),yield Co(l,g)})).apply(this,arguments)}function kr(){return(kr=(0,I.Z)(function*(c,s,a){const l=(0,k.m9)(c),g=Ro.credentialWithLink(s,a||kt());return E(g._tenantId===(l.tenantId||null),l,"tenant-id-mismatch"),ut(l,g)})).apply(this,arguments)}function jo(c,s){return is.apply(this,arguments)}function is(){return(is=(0,I.Z)(function*(c,s){return st(c,"POST","/v1/accounts:createAuthUri",it(c,s))})).apply(this,arguments)}function Qr(){return(Qr=(0,I.Z)(function*(c,s){const l={identifier:s,continueUri:Ot()?kt():"http://localhost"},{signinMethods:g}=yield jo((0,k.m9)(c),l);return g||[]})).apply(this,arguments)}function ft(){return(ft=(0,I.Z)(function*(c,s){const a=(0,k.m9)(c),g={requestType:"VERIFY_EMAIL",idToken:yield c.getIdToken()};s&&Qi(a.auth,g,s);const{email:_}=yield qi(a.auth,g);_!==c.email&&(yield c.reload())})).apply(this,arguments)}function Zs(){return(Zs=(0,I.Z)(function*(c,s,a){const l=(0,k.m9)(c),_={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield c.getIdToken(),newEmail:s};a&&Qi(l.auth,_,a);const{email:C}=yield Fc(l.auth,_);C!==c.email&&(yield c.reload())})).apply(this,arguments)}function qo(c,s){return Ko.apply(this,arguments)}function Ko(){return(Ko=(0,I.Z)(function*(c,s){return st(c,"POST","/v1/accounts:update",s)})).apply(this,arguments)}function Ws(){return(Ws=(0,I.Z)(function*(c,{displayName:s,photoURL:a}){if(void 0===s&&void 0===a)return;const l=(0,k.m9)(c),_={idToken:yield l.getIdToken(),displayName:s,photoUrl:a,returnSecureToken:!0},C=yield Kt(l,qo(l.auth,_));l.displayName=C.displayName||null,l.photoURL=C.photoUrl||null;const F=l.providerData.find(({providerId:H})=>"password"===H);F&&(F.displayName=l.displayName,F.photoURL=l.photoURL),yield l._updateTokensIfNecessary(C)})).apply(this,arguments)}function yi(c,s,a){return ss.apply(this,arguments)}function ss(){return(ss=(0,I.Z)(function*(c,s,a){const{auth:l}=c,_={idToken:yield c.getIdToken(),returnSecureToken:!0};s&&(_.email=s),a&&(_.password=a);const C=yield Kt(c,Cs(l,_));yield c._updateTokensIfNecessary(C,!0)})).apply(this,arguments)}class Yr{constructor(s,a,l={}){this.isNewUser=s,this.providerId=a,this.profile=l}}class Ga extends Yr{constructor(s,a,l,g){super(s,a,l),this.username=g}}class Qs extends Yr{constructor(s,a){super(s,"facebook.com",a)}}class Jr extends Ga{constructor(s,a){super(s,"github.com",a,"string"==typeof a?.login?a?.login:null)}}class qa extends Yr{constructor(s,a){super(s,"google.com",a)}}class os extends Ga{constructor(s,a,l){super(s,"twitter.com",a,l)}}function Ys(c){const{user:s,_tokenResponse:a}=c;return s.isAnonymous&&!a?{providerId:null,isNewUser:!1,profile:null}:function ir(c){var s,a;if(!c)return null;const{providerId:l}=c,g=c.rawUserInfo?JSON.parse(c.rawUserInfo):{},_=c.isNewUser||"identitytoolkit#SignupNewUserResponse"===c.kind;if(!l&&c?.idToken){const C=null===(a=null===(s=wn(c.idToken))||void 0===s?void 0:s.firebase)||void 0===a?void 0:a.sign_in_provider;if(C)return new Yr(_,"anonymous"!==C&&"custom"!==C?C:null)}if(!l)return null;switch(l){case"facebook.com":return new Qs(_,g);case"github.com":return new Jr(_,g);case"google.com":return new qa(_,g);case"twitter.com":return new os(_,g,c.screenName||null);case"custom":case"anonymous":return new Yr(_,null);default:return new Yr(_,l,g)}}(a)}class sr{constructor(s,a){this.type=s,this.credential=a}static _fromIdtoken(s){return new sr("enroll",s)}static _fromMfaPendingCredential(s){return new sr("signin",s)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(s){var a,l;if(s?.multiFactorSession){if(null!==(a=s.multiFactorSession)&&void 0!==a&&a.pendingCredential)return sr._fromMfaPendingCredential(s.multiFactorSession.pendingCredential);if(null!==(l=s.multiFactorSession)&&void 0!==l&&l.idToken)return sr._fromIdtoken(s.multiFactorSession.idToken)}return null}}class cs{constructor(s,a,l){this.session=s,this.hints=a,this.signInResolver=l}static _fromError(s,a){const l=yt(s),g=a.customData._serverResponse,_=(g.mfaInfo||[]).map(F=>mi._fromServerResponse(l,F));E(g.mfaPendingCredential,l,"internal-error");const C=sr._fromMfaPendingCredential(g.mfaPendingCredential);return new cs(C,_,function(){var F=(0,I.Z)(function*(H){const ie=yield H._process(l,C);delete g.mfaInfo,delete g.mfaPendingCredential;const _e=Object.assign(Object.assign({},g),{idToken:ie.idToken,refreshToken:ie.refreshToken});switch(a.operationType){case"signIn":const pe=yield on._fromIdTokenResponse(l,a.operationType,_e);return yield l._updateCurrentUser(pe.user),pe;case"reauthenticate":return E(a.user,l,"internal-error"),on._forOperation(a.user,a.operationType,_e);default:Ee(l,"internal-error")}});return function(H){return F.apply(this,arguments)}}())}resolveSignIn(s){var a=this;return(0,I.Z)(function*(){return a.signInResolver(s)})()}}function Zo(c,s){return st(c,"POST","/v2/accounts/mfaEnrollment:start",it(c,s))}class Js{constructor(s){this.user=s,this.enrolledFactors=[],s._onReload(a=>{a.mfaInfo&&(this.enrolledFactors=a.mfaInfo.map(l=>mi._fromServerResponse(s.auth,l)))})}static _fromUser(s){return new Js(s)}getSession(){var s=this;return(0,I.Z)(function*(){return sr._fromIdtoken(yield s.user.getIdToken())})()}enroll(s,a){var l=this;return(0,I.Z)(function*(){const g=s,_=yield l.getSession(),C=yield Kt(l.user,g._process(l.user.auth,_,a));return yield l.user._updateTokensIfNecessary(C),l.user.reload()})()}unenroll(s){var a=this;return(0,I.Z)(function*(){var l;const g="string"==typeof s?s:s.uid,_=yield a.user.getIdToken(),C=yield Kt(a.user,function ei(c,s){return st(c,"POST","/v2/accounts/mfaEnrollment:withdraw",it(c,s))}(a.user.auth,{idToken:_,mfaEnrollmentId:g}));a.enrolledFactors=a.enrolledFactors.filter(({uid:F})=>F!==g),yield a.user._updateTokensIfNecessary(C);try{yield a.user.reload()}catch(F){if("auth/user-token-expired"!==(null===(l=F)||void 0===l?void 0:l.code))throw F}})()}}const _i=new WeakMap,ti="__sak";class ls{constructor(s,a){this.storageRetriever=s,this.type=a}_isAvailable(){try{return this.storage?(this.storage.setItem(ti,"1"),this.storage.removeItem(ti),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(s,a){return this.storage.setItem(s,JSON.stringify(a)),Promise.resolve()}_get(s){const a=this.storage.getItem(s);return Promise.resolve(a?JSON.parse(a):null)}_remove(s){return this.storage.removeItem(s),Promise.resolve()}get storage(){return this.storageRetriever()}}const Xs=(()=>{class c extends ls{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(a,l)=>this.onStorageEvent(a,l),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function un(){const c=(0,k.z$)();return Vr(c)||Br(c)}()&&function bo(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=To(),this._shouldAllowMigration=!0}forAllChangedKeys(a){for(const l of Object.keys(this.listeners)){const g=this.storage.getItem(l),_=this.localCache[l];g!==_&&a(l,_,g)}}onStorageEvent(a,l=!1){if(!a.key)return void this.forAllChangedKeys((F,H,ie)=>{this.notifyListeners(F,ie)});const g=a.key;if(l?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const F=this.storage.getItem(g);if(a.newValue!==F)null!==a.newValue?this.storage.setItem(g,a.newValue):this.storage.removeItem(g);else if(this.localCache[g]===a.newValue&&!l)return}const _=()=>{const F=this.storage.getItem(g);!l&&this.localCache[g]===F||this.notifyListeners(g,F)},C=this.storage.getItem(g);!function Lc(){return(0,k.w1)()&&10===document.documentMode}()||C===a.newValue||a.newValue===a.oldValue?_():setTimeout(_,10)}notifyListeners(a,l){this.localCache[a]=l;const g=this.listeners[a];if(g)for(const _ of Array.from(g))_(l&&JSON.parse(l))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((a,l,g)=>{this.onStorageEvent(new StorageEvent("storage",{key:a,oldValue:l,newValue:g}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(a,l){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[a]||(this.listeners[a]=new Set,this.localCache[a]=this.storage.getItem(a)),this.listeners[a].add(l)}_removeListener(a,l){this.listeners[a]&&(this.listeners[a].delete(l),0===this.listeners[a].size&&delete this.listeners[a]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(a,l){var g=()=>super._set,_=this;return(0,I.Z)(function*(){yield g().call(_,a,l),_.localCache[a]=JSON.stringify(l)})()}_get(a){var l=()=>super._get,g=this;return(0,I.Z)(function*(){const _=yield l().call(g,a);return g.localCache[a]=JSON.stringify(_),_})()}_remove(a){var l=()=>super._remove,g=this;return(0,I.Z)(function*(){yield l().call(g,a),delete g.localCache[a]})()}}return c.type="LOCAL",c})(),Gn=(()=>{class c extends ls{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(a,l){}_removeListener(a,l){}}return c.type="SESSION",c})();let zu=(()=>{class c{constructor(a){this.eventTarget=a,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(a){const l=this.receivers.find(_=>_.isListeningto(a));if(l)return l;const g=new c(a);return this.receivers.push(g),g}isListeningto(a){return this.eventTarget===a}handleEvent(a){var l=this;return(0,I.Z)(function*(){const g=a,{eventId:_,eventType:C,data:F}=g.data,H=l.handlersMap[C];if(!H?.size)return;g.ports[0].postMessage({status:"ack",eventId:_,eventType:C});const ie=Array.from(H).map(function(){var pe=(0,I.Z)(function*(Ft){return Ft(g.origin,F)});return function(Ft){return pe.apply(this,arguments)}}()),_e=yield function Ha(c){return Promise.all(c.map(function(){var s=(0,I.Z)(function*(a){try{return{fulfilled:!0,value:yield a}}catch(l){return{fulfilled:!1,reason:l}}});return function(a){return s.apply(this,arguments)}}()))}(ie);g.ports[0].postMessage({status:"done",eventId:_,eventType:C,response:_e})})()}_subscribe(a,l){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[a]||(this.handlersMap[a]=new Set),this.handlersMap[a].add(l)}_unsubscribe(a,l){this.handlersMap[a]&&l&&this.handlersMap[a].delete(l),(!l||0===this.handlersMap[a].size)&&delete this.handlersMap[a],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return c.receivers=[],c})();function vi(c="",s=10){let a="";for(let l=0;l<s;l++)a+=Math.floor(10*Math.random());return c+a}class Wo{constructor(s){this.target=s,this.handlers=new Set}removeMessageHandler(s){s.messageChannel&&(s.messageChannel.port1.removeEventListener("message",s.onMessage),s.messageChannel.port1.close()),this.handlers.delete(s)}_send(s,a,l=50){var g=this;return(0,I.Z)(function*(){const _=typeof MessageChannel<"u"?new MessageChannel:null;if(!_)throw new Error("connection_unavailable");let C,F;return new Promise((H,ie)=>{const _e=vi("",20);_.port1.start();const pe=setTimeout(()=>{ie(new Error("unsupported_event"))},l);F={messageChannel:_,onMessage(Ft){const Wn=Ft;if(Wn.data.eventId===_e)switch(Wn.data.status){case"ack":clearTimeout(pe),C=setTimeout(()=>{ie(new Error("timeout"))},3e3);break;case"done":clearTimeout(C),H(Wn.data.response);break;default:clearTimeout(pe),clearTimeout(C),ie(new Error("invalid_response"))}}},g.handlers.add(F),_.port1.addEventListener("message",F.onMessage),g.target.postMessage({eventType:s,eventId:_e,data:a},[_.port2])}).finally(()=>{F&&g.removeMessageHandler(F)})})()}}function pt(){return window}function hs(){return typeof pt().WorkerGlobalScope<"u"&&"function"==typeof pt().importScripts}function Dr(){return(Dr=(0,I.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const eo="firebaseLocalStorageDb",et="firebaseLocalStorage",Rr="fbase_key";class or{constructor(s){this.request=s}toPromise(){return new Promise((s,a)=>{this.request.addEventListener("success",()=>{s(this.request.result)}),this.request.addEventListener("error",()=>{a(this.request.error)})})}}function ne(c,s){return c.transaction([et],s?"readwrite":"readonly").objectStore(et)}function Yo(){const c=indexedDB.open(eo,1);return new Promise((s,a)=>{c.addEventListener("error",()=>{a(c.error)}),c.addEventListener("upgradeneeded",()=>{const l=c.result;try{l.createObjectStore(et,{keyPath:Rr})}catch(g){a(g)}}),c.addEventListener("success",(0,I.Z)(function*(){const l=c.result;l.objectStoreNames.contains(et)?s(l):(l.close(),yield function ve(){const c=indexedDB.deleteDatabase(eo);return new or(c).toPromise()}(),s(yield Yo()))}))})}function X(c,s,a){return L.apply(this,arguments)}function L(){return(L=(0,I.Z)(function*(c,s,a){const l=ne(c,!0).put({[Rr]:s,value:a});return new or(l).toPromise()})).apply(this,arguments)}function gt(){return(gt=(0,I.Z)(function*(c,s){const a=ne(c,!1).get(s),l=yield new or(a).toPromise();return void 0===l?null:l.value})).apply(this,arguments)}function to(c,s){const a=ne(c,!0).delete(s);return new or(a).toPromise()}const Ii=(()=>{class c{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var a=this;return(0,I.Z)(function*(){return a.db||(a.db=yield Yo()),a.db})()}_withRetries(a){var l=this;return(0,I.Z)(function*(){let g=0;for(;;)try{const _=yield l._openDb();return yield a(_)}catch(_){if(g++>3)throw _;l.db&&(l.db.close(),l.db=void 0)}})()}initializeServiceWorkerMessaging(){var a=this;return(0,I.Z)(function*(){return hs()?a.initializeReceiver():a.initializeSender()})()}initializeReceiver(){var a=this;return(0,I.Z)(function*(){a.receiver=zu._getInstance(function Qo(){return hs()?self:null}()),a.receiver._subscribe("keyChanged",function(){var l=(0,I.Z)(function*(g,_){return{keyProcessed:(yield a._poll()).includes(_.key)}});return function(g,_){return l.apply(this,arguments)}}()),a.receiver._subscribe("ping",function(){var l=(0,I.Z)(function*(g,_){return["keyChanged"]});return function(g,_){return l.apply(this,arguments)}}())})()}initializeSender(){var a=this;return(0,I.Z)(function*(){var l,g;if(a.activeServiceWorker=yield function Tt(){return Dr.apply(this,arguments)}(),!a.activeServiceWorker)return;a.sender=new Wo(a.activeServiceWorker);const _=yield a.sender._send("ping",{},800);!_||(null===(l=_[0])||void 0===l?void 0:l.fulfilled)&&(null===(g=_[0])||void 0===g?void 0:g.value.includes("keyChanged"))&&(a.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(a){var l=this;return(0,I.Z)(function*(){if(l.sender&&l.activeServiceWorker&&function Nr(){var c;return(null===(c=navigator?.serviceWorker)||void 0===c?void 0:c.controller)||null}()===l.activeServiceWorker)try{yield l.sender._send("keyChanged",{key:a},l.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,I.Z)(function*(){try{if(!indexedDB)return!1;const a=yield Yo();return yield X(a,ti,"1"),yield to(a,ti),!0}catch{}return!1})()}_withPendingWrite(a){var l=this;return(0,I.Z)(function*(){l.pendingWrites++;try{yield a()}finally{l.pendingWrites--}})()}_set(a,l){var g=this;return(0,I.Z)(function*(){return g._withPendingWrite((0,I.Z)(function*(){return yield g._withRetries(_=>X(_,a,l)),g.localCache[a]=l,g.notifyServiceWorker(a)}))})()}_get(a){var l=this;return(0,I.Z)(function*(){const g=yield l._withRetries(_=>function K(c,s){return gt.apply(this,arguments)}(_,a));return l.localCache[a]=g,g})()}_remove(a){var l=this;return(0,I.Z)(function*(){return l._withPendingWrite((0,I.Z)(function*(){return yield l._withRetries(g=>to(g,a)),delete l.localCache[a],l.notifyServiceWorker(a)}))})()}_poll(){var a=this;return(0,I.Z)(function*(){const l=yield a._withRetries(C=>{const F=ne(C,!1).getAll();return new or(F).toPromise()});if(!l)return[];if(0!==a.pendingWrites)return[];const g=[],_=new Set;for(const{fbase_key:C,value:F}of l)_.add(C),JSON.stringify(a.localCache[C])!==JSON.stringify(F)&&(a.notifyListeners(C,F),g.push(C));for(const C of Object.keys(a.localCache))a.localCache[C]&&!_.has(C)&&(a.notifyListeners(C,null),g.push(C));return g})()}notifyListeners(a,l){this.localCache[a]=l;const g=this.listeners[a];if(g)for(const _ of Array.from(g))_(l)}startPolling(){var a=this;this.stopPolling(),this.pollTimer=setInterval((0,I.Z)(function*(){return a._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(a,l){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[a]||(this.listeners[a]=new Set,this._get(a)),this.listeners[a].add(l)}_removeListener(a,l){this.listeners[a]&&(this.listeners[a].delete(l),0===this.listeners[a].size&&delete this.listeners[a]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return c.type="LOCAL",c})();function Jo(c,s){return st(c,"POST","/v2/accounts/mfaSignIn:start",it(c,s))}function Xo(){return(Xo=(0,I.Z)(function*(c){return(yield st(c,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function wi(c){return new Promise((s,a)=>{const l=document.createElement("script");l.setAttribute("src",c),l.onload=s,l.onerror=g=>{const _=xe("internal-error");_.customData=g,a(_)},l.type="text/javascript",l.charset="UTF-8",function Xa(){var c,s;return null!==(s=null===(c=document.getElementsByTagName("head"))||void 0===c?void 0:c[0])&&void 0!==s?s:document}().appendChild(l)})}function Se(c){return`__${c}${Math.floor(1e6*Math.random())}`}const We=1e12;class be{constructor(s){this.auth=s,this.counter=We,this._widgets=new Map}render(s,a){const l=this.counter;return this._widgets.set(l,new ds(s,this.auth.name,a||{})),this.counter++,l}reset(s){var a;const l=s||We;null===(a=this._widgets.get(l))||void 0===a||a.delete(),this._widgets.delete(l)}getResponse(s){var a;return(null===(a=this._widgets.get(s||We))||void 0===a?void 0:a.getResponse())||""}execute(s){var a=this;return(0,I.Z)(function*(){var l;return null===(l=a._widgets.get(s||We))||void 0===l||l.execute(),""})()}}class ds{constructor(s,a,l){this.params=l,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const g="string"==typeof s?document.getElementById(s):s;E(g,"argument-error",{appName:a}),this.container=g,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Fe(c){const s=[],a="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let l=0;l<c;l++)s.push(a.charAt(Math.floor(Math.random()*a.length)));return s.join("")}(50);const{callback:s,"expired-callback":a}=this.params;if(s)try{s(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,a)try{a()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const eu=Se("rcb"),mt=new Dt(3e4,6e4);class Ei{constructor(){var s;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(s=pt().grecaptcha)||void 0===s||!s.render)}load(s,a=""){return E(function tu(c){return c.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(c)}(a),s,"argument-error"),this.shouldResolveImmediately(a)?Promise.resolve(pt().grecaptcha):new Promise((l,g)=>{const _=pt().setTimeout(()=>{g(xe(s,"network-request-failed"))},mt.get());pt()[eu]=()=>{pt().clearTimeout(_),delete pt()[eu];const F=pt().grecaptcha;if(!F)return void g(xe(s,"internal-error"));const H=F.render;F.render=(ie,_e)=>{const pe=H(ie,_e);return this.counter++,pe},this.hostLanguage=a,l(F)},wi(`https://www.google.com/recaptcha/api.js??${(0,k.xO)({onload:eu,render:"explicit",hl:a})}`).catch(()=>{clearTimeout(_),g(xe(s,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(s){var a;return!(null===(a=pt().grecaptcha)||void 0===a||!a.render)&&(s===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Ti{load(s){return(0,I.Z)(function*(){return new be(s)})()}clearedOneInstance(){}}const Wu="recaptcha",ea={theme:"light",type:"image"};class jc{constructor(s,a=Object.assign({},ea),l){this.parameters=a,this.type=Wu,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=yt(l),this.isInvisible="invisible"===this.parameters.size,E(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const g="string"==typeof s?document.getElementById(s):s;E(g,this.auth,"argument-error"),this.container=g,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Ti:new Ei,this.validateStartingState()}verify(){var s=this;return(0,I.Z)(function*(){s.assertNotDestroyed();const a=yield s.render(),l=s.getAssertedRecaptcha();return l.getResponse(a)||new Promise(_=>{const C=F=>{!F||(s.tokenChangeListeners.delete(C),_(F))};s.tokenChangeListeners.add(C),s.isInvisible&&l.execute(a)})})()}render(){try{this.assertNotDestroyed()}catch(s){return Promise.reject(s)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(s=>{throw this.renderPromise=null,s})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(s=>{this.container.removeChild(s)})}validateStartingState(){E(!this.parameters.sitekey,this.auth,"argument-error"),E(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),E(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(s){return a=>{if(this.tokenChangeListeners.forEach(l=>l(a)),"function"==typeof s)s(a);else if("string"==typeof s){const l=pt()[s];"function"==typeof l&&l(a)}}}assertNotDestroyed(){E(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var s=this;return(0,I.Z)(function*(){if(yield s.init(),!s.widgetId){let a=s.container;if(!s.isInvisible){const l=document.createElement("div");a.appendChild(l),a=l}s.widgetId=s.getAssertedRecaptcha().render(a,s.parameters)}return s.widgetId})()}init(){var s=this;return(0,I.Z)(function*(){E(Ot()&&!hs(),s.auth,"internal-error"),yield function fs(){let c=null;return new Promise(s=>{"complete"!==document.readyState?(c=()=>s(),window.addEventListener("load",c)):s()}).catch(s=>{throw c&&window.removeEventListener("load",c),s})}(),s.recaptcha=yield s._recaptchaLoader.load(s.auth,s.auth.languageCode||void 0);const a=yield function ar(c){return Xo.apply(this,arguments)}(s.auth);E(a,s.auth,"internal-error"),s.parameters.sitekey=a})()}getAssertedRecaptcha(){return E(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class ta{constructor(s,a){this.verificationId=s,this.onConfirmation=a}confirm(s){const a=Xn._fromVerification(this.verificationId,s);return this.onConfirmation(a)}}function Vt(){return(Vt=(0,I.Z)(function*(c,s,a){const l=yt(c),g=yield bi(l,s,(0,k.m9)(a));return new ta(g,_=>ut(l,_))})).apply(this,arguments)}function no(){return(no=(0,I.Z)(function*(c,s,a){const l=(0,k.m9)(c);yield rr(!1,l,"phone");const g=yield bi(l.auth,s,(0,k.m9)(a));return new ta(g,_=>Us(l,_))})).apply(this,arguments)}function Kn(){return(Kn=(0,I.Z)(function*(c,s,a){const l=(0,k.m9)(c),g=yield bi(l.auth,s,(0,k.m9)(a));return new ta(g,_=>Bs(l,_))})).apply(this,arguments)}function bi(c,s,a){return P.apply(this,arguments)}function P(){return(P=(0,I.Z)(function*(c,s,a){var l;const g=yield a.verify();try{let _;if(E("string"==typeof g,c,"argument-error"),E(a.type===Wu,c,"argument-error"),_="string"==typeof s?{phoneNumber:s}:s,"session"in _){const C=_.session;if("phoneNumber"in _)return E("enroll"===C.type,c,"internal-error"),(yield Zo(c,{idToken:C.credential,phoneEnrollmentInfo:{phoneNumber:_.phoneNumber,recaptchaToken:g}})).phoneSessionInfo.sessionInfo;{E("signin"===C.type,c,"internal-error");const F=(null===(l=_.multiFactorHint)||void 0===l?void 0:l.uid)||_.multiFactorUid;return E(F,c,"missing-multi-factor-info"),(yield Jo(c,{mfaPendingCredential:C.credential,mfaEnrollmentId:F,phoneSignInInfo:{recaptchaToken:g}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:C}=yield Va(c,{phoneNumber:_.phoneNumber,recaptchaToken:g});return C}}finally{a._reset()}})).apply(this,arguments)}function cn(){return(cn=(0,I.Z)(function*(c,s){yield zr((0,k.m9)(c),s)})).apply(this,arguments)}let ps=(()=>{class c{constructor(a){this.providerId=c.PROVIDER_ID,this.auth=yt(a)}verifyPhoneNumber(a,l){return bi(this.auth,a,(0,k.m9)(l))}static credential(a,l){return Xn._fromVerification(a,l)}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{phoneNumber:l,temporaryProof:g}=a;return l&&g?Xn._fromTokenResponse(l,g):null}}return c.PROVIDER_ID="phone",c.PHONE_SIGN_IN_METHOD="phone",c})();function xn(c,s){return s?Pe(s):(E(c._popupRedirectResolver,c,"argument-error"),c._popupRedirectResolver)}class zn extends wr{constructor(s){super("custom","custom"),this.params=s}_getIdTokenResponse(s){return Un(s,this._buildIdpRequest())}_linkToIdToken(s,a){return Un(s,this._buildIdpRequest(a))}_getReauthenticationResolver(s){return Un(s,this._buildIdpRequest())}_buildIdpRequest(s){const a={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return s&&(a.idToken=s),a}}function Hu(c){return Fs(c.auth,new zn(c),c.bypassAuthState)}function ur(c){const{auth:s,user:a}=c;return E(a,s,"internal-error"),tt(a,new zn(c),c.bypassAuthState)}function ro(c){return ri.apply(this,arguments)}function ri(){return(ri=(0,I.Z)(function*(c){const{auth:s,user:a}=c;return E(a,s,"internal-error"),zr(a,new zn(c),c.bypassAuthState)})).apply(this,arguments)}class io{constructor(s,a,l,g,_=!1){this.auth=s,this.resolver=l,this.user=g,this.bypassAuthState=_,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(a)?a:[a]}execute(){var s=this;return new Promise(function(){var a=(0,I.Z)(function*(l,g){s.pendingPromise={resolve:l,reject:g};try{s.eventManager=yield s.resolver._initialize(s.auth),yield s.onExecution(),s.eventManager.registerConsumer(s)}catch(_){s.reject(_)}});return function(l,g){return a.apply(this,arguments)}}())}onAuthEvent(s){var a=this;return(0,I.Z)(function*(){const{urlResponse:l,sessionId:g,postBody:_,tenantId:C,error:F,type:H}=s;if(F)return void a.reject(F);const ie={auth:a.auth,requestUri:l,sessionId:g,tenantId:C||void 0,postBody:_||void 0,user:a.user,bypassAuthState:a.bypassAuthState};try{a.resolve(yield a.getIdpTask(H)(ie))}catch(_e){a.reject(_e)}})()}onError(s){this.reject(s)}getIdpTask(s){switch(s){case"signInViaPopup":case"signInViaRedirect":return Hu;case"linkViaPopup":case"linkViaRedirect":return ro;case"reauthViaPopup":case"reauthViaRedirect":return ur;default:Ee(this.auth,"internal-error")}}resolve(s){q(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(s),this.unregisterAndCleanUp()}reject(s){q(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(s),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const sa=new Dt(2e3,1e4);function Ai(){return(Ai=(0,I.Z)(function*(c,s,a){const l=yt(c);He(c,s,Sn);const g=xn(l,a);return new xt(l,"signInViaPopup",s,g).executeNotNull()})).apply(this,arguments)}function oa(){return(oa=(0,I.Z)(function*(c,s,a){const l=(0,k.m9)(c);He(l.auth,s,Sn);const g=xn(l.auth,a);return new xt(l.auth,"reauthViaPopup",s,g,l).executeNotNull()})).apply(this,arguments)}function xi(){return(xi=(0,I.Z)(function*(c,s,a){const l=(0,k.m9)(c);He(l.auth,s,Sn);const g=xn(l.auth,a);return new xt(l.auth,"linkViaPopup",s,g,l).executeNotNull()})).apply(this,arguments)}let xt=(()=>{class c extends io{constructor(a,l,g,_,C){super(a,l,_,C),this.provider=g,this.authWindow=null,this.pollId=null,c.currentPopupAction&&c.currentPopupAction.cancel(),c.currentPopupAction=this}executeNotNull(){var a=this;return(0,I.Z)(function*(){const l=yield a.execute();return E(l,a.auth,"internal-error"),l})()}onExecution(){var a=this;return(0,I.Z)(function*(){q(1===a.filter.length,"Popup operations only handle one event");const l=vi();a.authWindow=yield a.resolver._openPopup(a.auth,a.provider,a.filter[0],l),a.authWindow.associatedEvent=l,a.resolver._originValidation(a.auth).catch(g=>{a.reject(g)}),a.resolver._isIframeWebStorageSupported(a.auth,g=>{g||a.reject(xe(a.auth,"web-storage-unsupported"))}),a.pollUserCancellation()})()}get eventId(){var a;return(null===(a=this.authWindow)||void 0===a?void 0:a.associatedEvent)||null}cancel(){this.reject(xe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,c.currentPopupAction=null}pollUserCancellation(){const a=()=>{var l,g;this.pollId=null!==(g=null===(l=this.authWindow)||void 0===l?void 0:l.window)&&void 0!==g&&g.closed?window.setTimeout(()=>{this.pollId=null,this.reject(xe(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(a,sa.get())};a()}}return c.currentPopupAction=null,c})();const ii=new Map;class Ci extends io{constructor(s,a,l=!1){super(s,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],a,void 0,l),this.eventId=null}execute(){var s=()=>super.execute,a=this;return(0,I.Z)(function*(){let l=ii.get(a.auth._key());if(!l){try{const _=(yield function ln(c,s){return cr.apply(this,arguments)}(a.resolver,a.auth))?yield s().call(a):null;l=()=>Promise.resolve(_)}catch(g){l=()=>Promise.reject(g)}ii.set(a.auth._key(),l)}return a.bypassAuthState||ii.set(a.auth._key(),()=>Promise.resolve(null)),l()})()}onAuthEvent(s){var a=()=>super.onAuthEvent,l=this;return(0,I.Z)(function*(){if("signInViaRedirect"===s.type)return a().call(l,s);if("unknown"!==s.type){if(s.eventId){const g=yield l.auth._redirectUserForId(s.eventId);if(g)return l.user=g,a().call(l,s);l.resolve(null)}}else l.resolve(null)})()}onExecution(){return(0,I.Z)(function*(){})()}cleanUp(){}}function cr(){return(cr=(0,I.Z)(function*(c,s){const a=so(s),l=hr(c);if(!(yield l._isAvailable()))return!1;const g="true"===(yield l._get(a));return yield l._remove(a),g})).apply(this,arguments)}function vt(c,s){return lr.apply(this,arguments)}function lr(){return(lr=(0,I.Z)(function*(c,s){return hr(c)._set(so(s),"true")})).apply(this,arguments)}function ht(c,s){ii.set(c._key(),s)}function hr(c){return Pe(c._redirectPersistence)}function so(c){return At("pendingRedirect",c.config.apiKey,c.name)}function d(){return(d=(0,I.Z)(function*(c,s,a){const l=yt(c);He(c,s,Sn);const g=xn(l,a);return yield vt(g,l),g._openRedirect(l,s,"signInViaRedirect")})).apply(this,arguments)}function w(){return(w=(0,I.Z)(function*(c,s,a){const l=(0,k.m9)(c);He(l.auth,s,Sn);const g=xn(l.auth,a);yield vt(g,l.auth);const _=yield ye(l);return g._openRedirect(l.auth,s,"reauthViaRedirect",_)})).apply(this,arguments)}function j(){return(j=(0,I.Z)(function*(c,s,a){const l=(0,k.m9)(c);He(l.auth,s,Sn);const g=xn(l.auth,a);yield rr(!1,l,s.providerId),yield vt(g,l.auth);const _=yield ye(l);return g._openRedirect(l.auth,s,"linkViaRedirect",_)})).apply(this,arguments)}function ue(){return(ue=(0,I.Z)(function*(c,s){return yield yt(c)._initializationPromise,Te(c,s,!1)})).apply(this,arguments)}function Te(c,s){return Ae.apply(this,arguments)}function Ae(){return(Ae=(0,I.Z)(function*(c,s,a=!1){const l=yt(c),g=xn(l,s),C=yield new Ci(l,g,a).execute();return C&&!a&&(delete C.user._redirectEventId,yield l._persistUserIfCurrent(C.user),yield l._setRedirectUser(null,s)),C})).apply(this,arguments)}function ye(c){return dt.apply(this,arguments)}function dt(){return(dt=(0,I.Z)(function*(c){const s=vi(`${c.uid}:::`);return c._redirectEventId=s,yield c.auth._setRedirectUser(c),yield c.auth._persistUserIfCurrent(c),s})).apply(this,arguments)}class Cn{constructor(s){this.auth=s,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(s){this.consumers.add(s),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,s)&&(this.sendToConsumer(this.queuedRedirectEvent,s),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(s){this.consumers.delete(s)}onEvent(s){if(this.hasEventBeenHandled(s))return!1;let a=!1;return this.consumers.forEach(l=>{this.isEventForConsumer(s,l)&&(a=!0,this.sendToConsumer(s,l),this.saveEventToCache(s))}),this.hasHandledPotentialRedirect||!function iu(c){switch(c.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return kn(c);default:return!1}}(s)||(this.hasHandledPotentialRedirect=!0,a||(this.queuedRedirectEvent=s,a=!0)),a}sendToConsumer(s,a){var l;if(s.error&&!kn(s)){const g=(null===(l=s.error.code)||void 0===l?void 0:l.split("auth/")[1])||"internal-error";a.onError(xe(this.auth,g))}else a.onAuthEvent(s)}isEventForConsumer(s,a){const l=null===a.eventId||!!s.eventId&&s.eventId===a.eventId;return a.filter.includes(s.type)&&l}hasEventBeenHandled(s){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Or(s))}saveEventToCache(s){this.cachedEventUids.add(Or(s)),this.lastProcessedEventTime=Date.now()}}function Or(c){return[c.type,c.eventId,c.sessionId,c.tenantId].filter(s=>s).join("-")}function kn({type:c,error:s}){return"unknown"===c&&"auth/no-auth-event"===s?.code}function gs(c){return Zn.apply(this,arguments)}function Zn(){return(Zn=(0,I.Z)(function*(c,s={}){return st(c,"GET","/v1/projects",s)})).apply(this,arguments)}const Dn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oi=/^https?/;function Qu(){return(Qu=(0,I.Z)(function*(c){if(c.config.emulator)return;const{authorizedDomains:s}=yield gs(c);for(const a of s)try{if(Gc(a))return}catch{}Ee(c,"unauthorized-domain")})).apply(this,arguments)}function Gc(c){const s=kt(),{protocol:a,hostname:l}=new URL(s);if(c.startsWith("chrome-extension://")){const C=new URL(c);return""===C.hostname&&""===l?"chrome-extension:"===a&&c.replace("chrome-extension://","")===s.replace("chrome-extension://",""):"chrome-extension:"===a&&C.hostname===l}if(!oi.test(a))return!1;if(Dn.test(c))return l===c;const g=c.replace(/\./g,"\\.");return new RegExp("^(.+\\."+g+"|"+g+")$","i").test(l)}const qc=new Dt(3e4,6e4);function $t(){const c=pt().___jsl;if(c?.H)for(const s of Object.keys(c.H))if(c.H[s].r=c.H[s].r||[],c.H[s].L=c.H[s].L||[],c.H[s].r=[...c.H[s].L],c.CP)for(let a=0;a<c.CP.length;a++)c.CP[a]=null}let Je=null;function ih(c){return Je=Je||function Kc(c){return new Promise((s,a)=>{var l,g,_;function C(){$t(),gapi.load("gapi.iframes",{callback:()=>{s(gapi.iframes.getContext())},ontimeout:()=>{$t(),a(xe(c,"network-request-failed"))},timeout:qc.get()})}if(null!==(g=null===(l=pt().gapi)||void 0===l?void 0:l.iframes)&&void 0!==g&&g.Iframe)s(gapi.iframes.getContext());else{if(null===(_=pt().gapi)||void 0===_||!_.load){const F=Se("iframefcb");return pt()[F]=()=>{gapi.load?C():a(xe(c,"network-request-failed"))},wi(`https://apis.google.com/js/api.js?onload=${F}`).catch(H=>a(H))}C()}}).catch(s=>{throw Je=null,s})}(c),Je}const zc=new Dt(5e3,15e3),aa={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ou=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function au(c){const s=c.config;E(s.authDomain,c,"auth-domain-config-required");const a=s.emulator?Ge(s,"emulator/auth/iframe"):`https://${c.config.authDomain}/__/auth/iframe`,l={apiKey:s.apiKey,appName:c.name,v:se.SDK_VERSION},g=ou.get(c.config.apiHost);g&&(l.eid=g);const _=c._getFrameworks();return _.length&&(l.fw=_.join(",")),`${a}?${(0,k.xO)(l).slice(1)}`}function uu(){return uu=(0,I.Z)(function*(c){const s=yield ih(c),a=pt().gapi;return E(a,c,"internal-error"),s.open({where:document.body,url:au(c),messageHandlersFilter:a.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:aa,dontclear:!0},l=>new Promise(function(){var g=(0,I.Z)(function*(_,C){yield l.restyle({setHideOnLeave:!1});const F=xe(c,"network-request-failed"),H=pt().setTimeout(()=>{C(F)},zc.get());function ie(){pt().clearTimeout(H),_(l)}l.ping(ie).then(ie,()=>{C(F)})});return function(_,C){return g.apply(this,arguments)}}()))}),uu.apply(this,arguments)}const Wt={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Hc{constructor(s){this.window=s,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Di(c,s,a,l,g,_){E(c.config.authDomain,c,"auth-domain-config-required"),E(c.config.apiKey,c,"invalid-api-key");const C={apiKey:c.config.apiKey,appName:c.name,authType:a,redirectUrl:l,v:se.SDK_VERSION,eventId:g};if(s instanceof Sn){s.setDefaultLanguage(c.languageCode),C.providerId=s.providerId||"",(0,k.xb)(s.getCustomParameters())||(C.customParameters=JSON.stringify(s.getCustomParameters()));for(const[H,ie]of Object.entries(_||{}))C[H]=ie}if(s instanceof Bn){const H=s.getScopes().filter(ie=>""!==ie);H.length>0&&(C.scopes=H.join(","))}c.tenantId&&(C.tid=c.tenantId);const F=C;for(const H of Object.keys(F))void 0===F[H]&&delete F[H];return`${function dh({config:c}){return c.emulator?Ge(c,"emulator/auth/handler"):`https://${c.authDomain}/__/auth/handler`}(c)}?${(0,k.xO)(F).slice(1)}`}const cu="webStorageSupport";class Ni extends class Yc{constructor(s){this.factorId=s}_process(s,a,l){switch(a.type){case"enroll":return this._finalizeEnroll(s,a.credential,l);case"signin":return this._finalizeSignIn(s,a.credential);default:return W("unexpected MultiFactorSessionType")}}}{constructor(s){super("phone"),this.credential=s}static _fromCredential(s){return new Ni(s)}_finalizeEnroll(s,a,l){return function Ka(c,s){return st(c,"POST","/v2/accounts/mfaEnrollment:finalize",it(c,s))}(s,{idToken:a,displayName:l,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(s,a){return function Ja(c,s){return st(c,"POST","/v2/accounts/mfaSignIn:finalize",it(c,s))}(s,{mfaPendingCredential:a,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Jc=(()=>{class c{constructor(){}static assertion(a){return Ni._fromCredential(a)}}return c.FACTOR_ID="phone",c})();var lu="@firebase/auth";class Yu{constructor(s){this.auth=s,this.internalListeners=new Map}getUid(){var s;return this.assertAuthConfigured(),(null===(s=this.auth.currentUser)||void 0===s?void 0:s.uid)||null}getToken(s){var a=this;return(0,I.Z)(function*(){return a.assertAuthConfigured(),yield a.auth._initializationPromise,a.auth.currentUser?{accessToken:yield a.auth.currentUser.getIdToken(s)}:null})()}addAuthTokenListener(s){if(this.assertAuthConfigured(),this.internalListeners.has(s))return;const a=this.auth.onIdTokenChanged(l=>{var g;s((null===(g=l)||void 0===g?void 0:g.stsTokenManager.accessToken)||null)});this.internalListeners.set(s,a),this.updateProactiveRefresh()}removeAuthTokenListener(s){this.assertAuthConfigured();const a=this.internalListeners.get(s);!a||(this.internalListeners.delete(s),a(),this.updateProactiveRefresh())}assertAuthConfigured(){E(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function dr(){return window}function ua(){return(ua=(0,I.Z)(function*(c,s,a){var l;const{BuildInfo:g}=dr();q(s.sessionId,"AuthEvent did not contain a session ID");const _=yield pu(s.sessionId),C={};return Br()?C.ibi=g.packageName:Ir()?C.apn=g.packageName:Ee(c,"operation-not-supported-in-this-environment"),g.displayName&&(C.appDisplayName=g.displayName),C.sessionId=_,Di(c,a,s.type,void 0,null!==(l=s.eventId)&&void 0!==l?l:void 0,C)})).apply(this,arguments)}function du(){return(du=(0,I.Z)(function*(c){const{BuildInfo:s}=dr(),a={};Br()?a.iosBundleId=s.packageName:Ir()?a.androidPackageName=s.packageName:Ee(c,"operation-not-supported-in-this-environment"),yield gs(c,a)})).apply(this,arguments)}function fu(){return(fu=(0,I.Z)(function*(c,s,a){const{cordova:l}=dr();let g=()=>{};try{yield new Promise((_,C)=>{let F=null;function H(){var pe;_();const Ft=null===(pe=l.plugins.browsertab)||void 0===pe?void 0:pe.close;"function"==typeof Ft&&Ft(),"function"==typeof a?.close&&a.close()}function ie(){F||(F=window.setTimeout(()=>{C(xe(c,"redirect-cancelled-by-user"))},2e3))}function _e(){"visible"===document?.visibilityState&&ie()}s.addPassiveListener(H),document.addEventListener("resume",ie,!1),Ir()&&document.addEventListener("visibilitychange",_e,!1),g=()=>{s.removePassiveListener(H),document.removeEventListener("resume",ie,!1),document.removeEventListener("visibilitychange",_e,!1),F&&window.clearTimeout(F)}})}finally{g()}})).apply(this,arguments)}function pu(c){return ec.apply(this,arguments)}function ec(){return(ec=(0,I.Z)(function*(c){const s=ph(c),a=yield crypto.subtle.digest("SHA-256",s);return Array.from(new Uint8Array(a)).map(g=>g.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function ph(c){if(q(/[0-9a-zA-Z]+/.test(c),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(c);const s=new ArrayBuffer(c.length),a=new Uint8Array(s);for(let l=0;l<c.length;l++)a[l]=c.charCodeAt(l);return a}!function gn(c){(0,se._registerComponent)(new me.wA("auth",(s,{options:a})=>{const l=s.getProvider("app").getImmediate(),g=s.getProvider("heartbeat"),{apiKey:_,authDomain:C}=l.options;return((F,H)=>{E(_&&!_.includes(":"),"invalid-api-key",{appName:F.name}),E(!C?.includes(":"),"argument-error",{appName:F.name});const ie={apiKey:_,authDomain:C,clientPlatform:c,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hi(c)},_e=new Pt(F,H,ie);return function nt(c,s){const a=s?.persistence||[],l=(Array.isArray(a)?a:[a]).map(Pe);s?.errorMap&&c._updateErrorMap(s.errorMap),c._initializeWithPersistence(l,s?.popupRedirectResolver)}(_e,a),_e})(l,g)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((s,a,l)=>{s.getProvider("auth-internal").initialize()})),(0,se._registerComponent)(new me.wA("auth-internal",s=>{const a=yt(s.getProvider("auth").getImmediate());return new Yu(a)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,se.registerVersion)(lu,"0.20.5",function ao(c){switch(c){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(c)),(0,se.registerVersion)(lu,"0.20.5","esm2017")}("Browser");class uo extends Cn{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(s=>{this.resolveInialized=s})}addPassiveListener(s){this.passiveListeners.add(s)}removePassiveListener(s){this.passiveListeners.delete(s)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(s){return this.resolveInialized(),this.passiveListeners.forEach(a=>a(s)),super.onEvent(s)}initialized(){var s=this;return(0,I.Z)(function*(){yield s.initPromise})()}}function Ri(c){return gu.apply(this,arguments)}function gu(){return(gu=(0,I.Z)(function*(c){const s=yield mu()._get(_s(c));return s&&(yield mu()._remove(_s(c))),s})).apply(this,arguments)}function sl(){const c=[],s="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let a=0;a<20;a++){const l=Math.floor(Math.random()*s.length);c.push(s.charAt(l))}return c.join("")}function mu(){return Pe(Xs)}function _s(c){return At("authEvent",c.config.apiKey,c.name)}function ct(c){if(!c?.includes("?"))return{};const[s,...a]=c.split("?");return(0,k.zd)(a.join("?"))}function al(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:xe("no-auth-event")}}function Nn(){var c;return(null===(c=self?.location)||void 0===c?void 0:c.protocol)||null}function tc(c=(0,k.z$)()){return!("file:"!==Nn()&&"ionic:"!==Nn()&&"capacitor:"!==Nn()||!c.toLowerCase().match(/iphone|ipad|ipod|android/))}function Ct(){try{const c=self.localStorage,s=vi();if(c)return c.setItem(s,"1"),c.removeItem(s),!function _h(c=(0,k.z$)()){return function ho(){return(0,k.w1)()&&11===document?.documentMode}()||function nc(c=(0,k.z$)()){return/Edge\/\d+/.test(c)}(c)}()||(0,k.hl)()}catch{return Ue()&&(0,k.hl)()}return!1}function Ue(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function vu(){return(function cl(){return"http:"===Nn()||"https:"===Nn()}()||(0,k.ru)()||tc())&&!function ll(){return(0,k.b$)()||(0,k.UG)()}()&&Ct()&&!Ue()}function rc(){return tc()&&typeof document<"u"}function ic(){return(ic=(0,I.Z)(function*(){return!!rc()&&new Promise(c=>{const s=setTimeout(()=>{c(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(s),c(!0)})})})).apply(this,arguments)}const yn={LOCAL:"local",NONE:"none",SESSION:"session"},ai=E,sc="persistence";function Iu(c){return vs.apply(this,arguments)}function vs(){return(vs=(0,I.Z)(function*(c){yield c._initializationPromise;const s=hl(),a=At(sc,c.config.apiKey,c.name);s&&s.setItem(a,c._getPersistence())})).apply(this,arguments)}function hl(){var c;try{return(null===(c=function mn(){return typeof window<"u"?window:null}())||void 0===c?void 0:c.sessionStorage)||null}catch{return null}}const De=E;class Pi{constructor(){this.browserResolver=Pe(class Qc{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Gn,this._completeRedirectFn=Te,this._overrideRedirectResult=ht}_openPopup(s,a,l,g){var _=this;return(0,I.Z)(function*(){var C;q(null===(C=_.eventManagers[s._key()])||void 0===C?void 0:C.manager,"_initialize() not called before _openPopup()");const F=Di(s,a,l,kt(),g);return function ch(c,s,a,l=500,g=600){const _=Math.max((window.screen.availHeight-g)/2,0).toString(),C=Math.max((window.screen.availWidth-l)/2,0).toString();let F="";const H=Object.assign(Object.assign({},Wt),{width:l.toString(),height:g.toString(),top:_,left:C}),ie=(0,k.z$)().toLowerCase();a&&(F=li(ie)?"_blank":a),bn(ie)&&(s=s||"http://localhost",H.scrollbars="yes");const _e=Object.entries(H).reduce((Ft,[Wn,ga])=>`${Ft}${Wn}=${ga},`,"");if(function As(c=(0,k.z$)()){var s;return Br(c)&&!(null===(s=window.navigator)||void 0===s||!s.standalone)}(ie)&&"_self"!==F)return function lh(c,s){const a=document.createElement("a");a.href=c,a.target=s;const l=document.createEvent("MouseEvent");l.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),a.dispatchEvent(l)}(s||"",F),new Hc(null);const pe=window.open(s||"",F,_e);E(pe,c,"popup-blocked");try{pe.focus()}catch{}return new Hc(pe)}(s,F,vi())})()}_openRedirect(s,a,l,g){var _=this;return(0,I.Z)(function*(){return yield _._originValidation(s),function Ho(c){pt().location.href=c}(Di(s,a,l,kt(),g)),new Promise(()=>{})})()}_initialize(s){const a=s._key();if(this.eventManagers[a]){const{manager:g,promise:_}=this.eventManagers[a];return g?Promise.resolve(g):(q(_,"If manager is not set, promise should be"),_)}const l=this.initAndGetManager(s);return this.eventManagers[a]={promise:l},l.catch(()=>{delete this.eventManagers[a]}),l}initAndGetManager(s){var a=this;return(0,I.Z)(function*(){const l=yield function Zc(c){return uu.apply(this,arguments)}(s),g=new Cn(s);return l.register("authEvent",_=>(E(_?.authEvent,s,"invalid-auth-event"),{status:g.onEvent(_.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),a.eventManagers[s._key()]={manager:g},a.iframes[s._key()]=l,g})()}_isIframeWebStorageSupported(s,a){this.iframes[s._key()].send(cu,{type:cu},g=>{var _;const C=null===(_=g?.[0])||void 0===_?void 0:_[cu];void 0!==C&&a(!!C),Ee(s,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(s){const a=s._key();return this.originValidationPromises[a]||(this.originValidationPromises[a]=function su(c){return Qu.apply(this,arguments)}(s)),this.originValidationPromises[a]}get _shouldInitProactively(){return To()||Vr()||Br()}}),this.cordovaResolver=Pe(class _u{constructor(){this._redirectPersistence=Gn,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Te,this._overrideRedirectResult=ht}_initialize(s){var a=this;return(0,I.Z)(function*(){const l=s._key();let g=a.eventManagers.get(l);return g||(g=new uo(s),a.eventManagers.set(l,g),a.attachCallbackListeners(s,g)),g})()}_openPopup(s){Ee(s,"operation-not-supported-in-this-environment")}_openRedirect(s,a,l,g){var _=this;return(0,I.Z)(function*(){!function nl(c){var s,a,l,g,_,C,F,H,ie,_e;const pe=dr();E("function"==typeof(null===(s=pe?.universalLinks)||void 0===s?void 0:s.subscribe),c,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),E(typeof(null===(a=pe?.BuildInfo)||void 0===a?void 0:a.packageName)<"u",c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),E("function"==typeof(null===(_=null===(g=null===(l=pe?.cordova)||void 0===l?void 0:l.plugins)||void 0===g?void 0:g.browsertab)||void 0===_?void 0:_.openUrl),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),E("function"==typeof(null===(H=null===(F=null===(C=pe?.cordova)||void 0===C?void 0:C.plugins)||void 0===F?void 0:F.browsertab)||void 0===H?void 0:H.isAvailable),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),E("function"==typeof(null===(_e=null===(ie=pe?.cordova)||void 0===ie?void 0:ie.InAppBrowser)||void 0===_e?void 0:_e.open),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(s);const C=yield _._initialize(s);yield C.initialized(),C.resetRedirect(),function si(){ii.clear()}(),yield _._originValidation(s);const F=function ys(c,s,a=null){return{type:s,eventId:a,urlResponse:null,sessionId:sl(),postBody:null,tenantId:c.tenantId,error:xe(c,"no-auth-event")}}(s,l,g);yield function il(c,s){return mu()._set(_s(c),s)}(s,F);const H=yield function Xu(c,s,a){return ua.apply(this,arguments)}(s,F,a),ie=yield function fh(c){const{cordova:s}=dr();return new Promise(a=>{s.plugins.browsertab.isAvailable(l=>{let g=null;l?s.plugins.browsertab.openUrl(c):g=s.InAppBrowser.open(c,function Oa(c=(0,k.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(c)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(c)}()?"_blank":"_system","location=yes"),a(g)})})}(H);return function tl(c,s,a){return fu.apply(this,arguments)}(s,C,ie)})()}_isIframeWebStorageSupported(s,a){throw new Error("Method not implemented.")}_originValidation(s){const a=s._key();return this.originValidationPromises[a]||(this.originValidationPromises[a]=function el(c){return du.apply(this,arguments)}(s)),this.originValidationPromises[a]}attachCallbackListeners(s,a){const{universalLinks:l,handleOpenURL:g,BuildInfo:_}=dr(),C=setTimeout((0,I.Z)(function*(){yield Ri(s),a.onEvent(al())}),500),F=function(){var _e=(0,I.Z)(function*(pe){clearTimeout(C);const Ft=yield Ri(s);let Wn=null;Ft&&pe?.url&&(Wn=function co(c,s){var a,l;const g=function mh(c){const s=ct(c),a=s.link?decodeURIComponent(s.link):void 0,l=ct(a).link,g=s.deep_link_id?decodeURIComponent(s.deep_link_id):void 0;return ct(g).link||g||l||a||c}(s);if(g.includes("/__/auth/callback")){const _=ct(g),C=_.firebaseError?function gh(c){try{return JSON.parse(c)}catch{return null}}(decodeURIComponent(_.firebaseError)):null,F=null===(l=null===(a=C?.code)||void 0===a?void 0:a.split("auth/"))||void 0===l?void 0:l[1],H=F?xe(F):null;return H?{type:c.type,eventId:c.eventId,tenantId:c.tenantId,error:H,urlResponse:null,sessionId:null,postBody:null}:{type:c.type,eventId:c.eventId,tenantId:c.tenantId,sessionId:c.sessionId,urlResponse:g,postBody:null}}return null}(Ft,pe.url)),a.onEvent(Wn||al())});return function(Ft){return _e.apply(this,arguments)}}();typeof l<"u"&&"function"==typeof l.subscribe&&l.subscribe(null,F);const H=g,ie=`${_.packageName.toLowerCase()}://`;dr().handleOpenURL=function(){var _e=(0,I.Z)(function*(pe){if(pe.toLowerCase().startsWith(ie)&&F({url:pe}),"function"==typeof H)try{H(pe)}catch(Ft){console.error(Ft)}});return function(pe){return _e.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=Gn,this._completeRedirectFn=Te,this._overrideRedirectResult=ht}_initialize(s){var a=this;return(0,I.Z)(function*(){return yield a.selectUnderlyingResolver(),a.assertedUnderlyingResolver._initialize(s)})()}_openPopup(s,a,l,g){var _=this;return(0,I.Z)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._openPopup(s,a,l,g)})()}_openRedirect(s,a,l,g){var _=this;return(0,I.Z)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._openRedirect(s,a,l,g)})()}_isIframeWebStorageSupported(s,a){this.assertedUnderlyingResolver._isIframeWebStorageSupported(s,a)}_originValidation(s){return this.assertedUnderlyingResolver._originValidation(s)}get _shouldInitProactively(){return rc()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return De(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var s=this;return(0,I.Z)(function*(){if(s.underlyingResolver)return;const a=yield function Oi(){return ic.apply(this,arguments)}();s.underlyingResolver=a?s.cordovaResolver:s.browserResolver})()}}function la(c){return c.unwrap()}function da(c){return oc(c)}function oc(c){const{_tokenResponse:s}=c instanceof k.ZR?c.customData:c;if(!s)return null;if(!(c instanceof k.ZR)&&"temporaryProof"in s&&"phoneNumber"in s)return ps.credentialFromResult(c);const a=s.providerId;if(!a||"password"===a)return null;let l;switch(a){case"google.com":l=Oo;break;case"facebook.com":l=Ms;break;case"github.com":l=Po;break;case"twitter.com":l=pi;break;default:const{oauthIdToken:g,oauthAccessToken:_,oauthTokenSecret:C,pendingToken:F,nonce:H}=s;return _||C||g||F?F?a.startsWith("saml.")?tr._create(a,F):at._fromParams({providerId:a,signInMethod:a,pendingToken:F,idToken:g,accessToken:_}):new Tr(a).credential({idToken:g,accessToken:_,rawNonce:H}):null}return c instanceof k.ZR?l.credentialFromError(c):l.credentialFromResult(c)}function hn(c,s){return s.catch(a=>{throw a instanceof k.ZR&&function wu(c,s){var a,l;const g=null===(a=s.customData)||void 0===a?void 0:a._tokenResponse;if("auth/multi-factor-auth-required"===(null===(l=s)||void 0===l?void 0:l.code))s.resolver=new dl(c,function Et(c,s){var a;const l=(0,k.m9)(c),g=s;return E(s.customData.operationType,l,"argument-error"),E(null===(a=g.customData._serverResponse)||void 0===a?void 0:a.mfaPendingCredential,l,"argument-error"),cs._fromError(l,g)}(c,s));else if(g){const _=oc(s),C=s;_&&(C.credential=_,C.tenantId=g.tenantId||void 0,C.email=g.email||void 0,C.phoneNumber=g.phoneNumber||void 0)}}(c,a),a}).then(a=>{const g=a.user;return{operationType:a.operationType,credential:da(a),additionalUserInfo:Ys(a),user:Lr.getOrCreate(g)}})}function Eu(c,s){return ac.apply(this,arguments)}function ac(){return(ac=(0,I.Z)(function*(c,s){const a=yield s;return{verificationId:a.verificationId,confirm:l=>hn(c,a.confirm(l))}})).apply(this,arguments)}class dl{constructor(s,a){this.resolver=a,this.auth=function ha(c){return c.wrapped()}(s)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(s){return hn(la(this.auth),this.resolver.resolveSignIn(s))}}class Lr{constructor(s){this._delegate=s,this.multiFactor=function za(c){const s=(0,k.m9)(c);return _i.has(s)||_i.set(s,Js._fromUser(s)),_i.get(s)}(s)}static getOrCreate(s){return Lr.USER_MAP.has(s)||Lr.USER_MAP.set(s,new Lr(s)),Lr.USER_MAP.get(s)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(s){return this._delegate.getIdTokenResult(s)}getIdToken(s){return this._delegate.getIdToken(s)}linkAndRetrieveDataWithCredential(s){return this.linkWithCredential(s)}linkWithCredential(s){var a=this;return(0,I.Z)(function*(){return hn(a.auth,Us(a._delegate,s))})()}linkWithPhoneNumber(s,a){var l=this;return(0,I.Z)(function*(){return Eu(l.auth,function ra(c,s,a){return no.apply(this,arguments)}(l._delegate,s,a))})()}linkWithPopup(s){var a=this;return(0,I.Z)(function*(){return hn(a.auth,function _t(c,s,a){return xi.apply(this,arguments)}(a._delegate,s,Pi))})()}linkWithRedirect(s){var a=this;return(0,I.Z)(function*(){return yield Iu(yt(a.auth)),function N(c,s,a){return function M(c,s,a){return j.apply(this,arguments)}(c,s,a)}(a._delegate,s,Pi)})()}reauthenticateAndRetrieveDataWithCredential(s){return this.reauthenticateWithCredential(s)}reauthenticateWithCredential(s){var a=this;return(0,I.Z)(function*(){return hn(a.auth,Bs(a._delegate,s))})()}reauthenticateWithPhoneNumber(s,a){return Eu(this.auth,function nu(c,s,a){return Kn.apply(this,arguments)}(this._delegate,s,a))}reauthenticateWithPopup(s){return hn(this.auth,function Si(c,s,a){return oa.apply(this,arguments)}(this._delegate,s,Pi))}reauthenticateWithRedirect(s){var a=this;return(0,I.Z)(function*(){return yield Iu(yt(a.auth)),function p(c,s,a){return function y(c,s,a){return w.apply(this,arguments)}(c,s,a)}(a._delegate,s,Pi)})()}sendEmailVerification(s){return function Go(c,s){return ft.apply(this,arguments)}(this._delegate,s)}unlink(s){var a=this;return(0,I.Z)(function*(){return yield function nr(c,s){return an.apply(this,arguments)}(a._delegate,s),a})()}updateEmail(s){return function ja(c,s){return yi((0,k.m9)(c),s,null)}(this._delegate,s)}updatePassword(s){return function Hs(c,s){return yi((0,k.m9)(c),null,s)}(this._delegate,s)}updatePhoneNumber(s){return function ia(c,s){return cn.apply(this,arguments)}(this._delegate,s)}updateProfile(s){return function zo(c,s){return Ws.apply(this,arguments)}(this._delegate,s)}verifyBeforeUpdateEmail(s,a){return function zs(c,s,a){return Zs.apply(this,arguments)}(this._delegate,s,a)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Lr.USER_MAP=new WeakMap;const fa=E;let fl=(()=>{class c{constructor(a,l){if(this.app=a,l.isInitialized())return this._delegate=l.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:g}=a.options;fa(g,"invalid-api-key",{appName:a.name}),fa(g,"invalid-api-key",{appName:a.name});const _=typeof window<"u"?Pi:void 0;this._delegate=l.initialize({options:{persistence:pa(g,a.name),popupRedirectResolver:_}}),this._delegate._updateErrorMap($e),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Lr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(a){this._delegate.languageCode=a}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(a){this._delegate.tenantId=a}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(a,l){!function Vu(c,s,a){const l=yt(c);E(l._canInitEmulator,l,"emulator-config-failed"),E(/^https?:\/\//.test(s),l,"invalid-emulator-scheme");const g=!!a?.disableWarnings,_=xs(s),{host:C,port:F}=function Ao(c){const s=xs(c),a=/(\/\/)?([^?#/]+)/.exec(c.substr(s.length));if(!a)return{host:"",port:null};const l=a[2].split("@").pop()||"",g=/^(\[[^\]]+\])(:|$)/.exec(l);if(g){const _=g[1];return{host:_,port:Pa(l.substr(_.length+1))}}{const[_,C]=l.split(":");return{host:_,port:Pa(C)}}}(s);l.config.emulator={url:`${_}//${C}${null===F?"":`:${F}`}/`},l.settings.appVerificationDisabledForTesting=!0,l.emulatorConfig=Object.freeze({host:C,port:F,protocol:_.replace(":",""),options:Object.freeze({disableWarnings:g})}),g||function Ma(){function c(){const s=document.createElement("p"),a=s.style;s.innerText="Running in emulator mode. Do not use with production credentials.",a.position="fixed",a.width="100%",a.backgroundColor="#ffffff",a.border=".1em solid #000000",a.color="#b50000",a.bottom="0px",a.left="0px",a.margin="0px",a.zIndex="10000",a.textAlign="center",s.classList.add("firebase-emulator-warning"),document.body.appendChild(s)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",c):c())}()}(this._delegate,a,l)}applyActionCode(a){return function Vo(c,s){return Yi.apply(this,arguments)}(this._delegate,a)}checkActionCode(a){return Ji(this._delegate,a)}confirmPasswordReset(a,l){return function Uo(c,s,a){return qs.apply(this,arguments)}(this._delegate,a,l)}createUserWithEmailAndPassword(a,l){var g=this;return(0,I.Z)(function*(){return hn(g._delegate,function Bo(c,s,a){return ts.apply(this,arguments)}(g._delegate,a,l))})()}fetchProvidersForEmail(a){return this.fetchSignInMethodsForEmail(a)}fetchSignInMethodsForEmail(a){return function Hr(c,s){return Qr.apply(this,arguments)}(this._delegate,a)}isSignInWithEmailLink(a){return function ns(c,s){return"EMAIL_SIGNIN"===er.parseLink(s)?.operation}(0,a)}getRedirectResult(){var a=this;return(0,I.Z)(function*(){fa(vu(),a._delegate,"operation-not-supported-in-this-environment");const l=yield function Q(c,s){return ue.apply(this,arguments)}(a._delegate,Pi);return l?hn(a._delegate,Promise.resolve(l)):{credential:null,user:null}})()}addFrameworkForLogging(a){!function ca(c,s){yt(c)._logFramework(s)}(this._delegate,a)}onAuthStateChanged(a,l,g){const{next:_,error:C,complete:F}=pl(a,l,g);return this._delegate.onAuthStateChanged(_,C,F)}onIdTokenChanged(a,l,g){const{next:_,error:C,complete:F}=pl(a,l,g);return this._delegate.onIdTokenChanged(_,C,F)}sendSignInLinkToEmail(a,l){return function ju(c,s,a){return $o.apply(this,arguments)}(this._delegate,a,l)}sendPasswordResetEmail(a,l){return function Cr(c,s,a){return Gs.apply(this,arguments)}(this._delegate,a,l||void 0)}setPersistence(a){var l=this;return(0,I.Z)(function*(){let g;switch(function Mr(c,s){ai(Object.values(yn).includes(s),c,"invalid-persistence-type"),(0,k.b$)()?ai(s!==yn.SESSION,c,"unsupported-persistence-type"):(0,k.UG)()?ai(s===yn.NONE,c,"unsupported-persistence-type"):Ue()?ai(s===yn.NONE||s===yn.LOCAL&&(0,k.hl)(),c,"unsupported-persistence-type"):ai(s===yn.NONE||Ct(),c,"unsupported-persistence-type")}(l._delegate,a),a){case yn.SESSION:g=Gn;break;case yn.LOCAL:g=(yield Pe(Ii)._isAvailable())?Ii:Xs;break;case yn.NONE:g=Ze;break;default:return Ee("argument-error",{appName:l._delegate.name})}return l._delegate.setPersistence(g)})()}signInAndRetrieveDataWithCredential(a){return this.signInWithCredential(a)}signInAnonymously(){return hn(this._delegate,function br(c){return Wi.apply(this,arguments)}(this._delegate))}signInWithCredential(a){return hn(this._delegate,ut(this._delegate,a))}signInWithCustomToken(a){return hn(this._delegate,function Wr(c,s){return pn.apply(this,arguments)}(this._delegate,a))}signInWithEmailAndPassword(a,l){return hn(this._delegate,function $u(c,s,a){return ut((0,k.m9)(c),Ro.credential(s,a))}(this._delegate,a,l))}signInWithEmailLink(a,l){return hn(this._delegate,function rs(c,s,a){return kr.apply(this,arguments)}(this._delegate,a,l))}signInWithPhoneNumber(a,l){return Eu(this._delegate,function na(c,s,a){return Vt.apply(this,arguments)}(this._delegate,a,l))}signInWithPopup(a){var l=this;return(0,I.Z)(function*(){return fa(vu(),l._delegate,"operation-not-supported-in-this-environment"),hn(l._delegate,function Bt(c,s,a){return Ai.apply(this,arguments)}(l._delegate,a,Pi))})()}signInWithRedirect(a){var l=this;return(0,I.Z)(function*(){return fa(vu(),l._delegate,"operation-not-supported-in-this-environment"),yield Iu(l._delegate),function ru(c,s,a){return function oo(c,s,a){return d.apply(this,arguments)}(c,s,a)}(l._delegate,a,Pi)})()}updateCurrentUser(a){return this._delegate.updateCurrentUser(a)}verifyPasswordResetCode(a){return function es(c,s){return Ks.apply(this,arguments)}(this._delegate,a)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return c.Persistence=yn,c})();function pl(c,s,a){let l=c;"function"!=typeof c&&({next:l,error:s,complete:a}=c);const g=l;return{next:C=>g(C&&Lr.getOrCreate(C)),error:s,complete:a}}function pa(c,s){const a=function vh(c,s){const a=hl();if(!a)return[];const l=At(sc,c,s);switch(a.getItem(l)){case yn.NONE:return[Ze];case yn.LOCAL:return[Ii,Gn];case yn.SESSION:return[Gn];default:return[]}}(c,s);if(typeof self<"u"&&!a.includes(Ii)&&a.push(Ii),typeof window<"u")for(const l of[Xs,Gn])a.includes(l)||a.push(l);return a.includes(Ze)||a.push(Ze),a}class Tu{constructor(){this.providerId="phone",this._delegate=new ps(la(re.Z.auth()))}static credential(s,a){return ps.credential(s,a)}verifyPhoneNumber(s,a){return this._delegate.verifyPhoneNumber(s,a)}unwrap(){return this._delegate}}Tu.PHONE_SIGN_IN_METHOD=ps.PHONE_SIGN_IN_METHOD,Tu.PROVIDER_ID=ps.PROVIDER_ID;const Ih=E;class jt{constructor(s,a,l=re.Z.app()){var g;Ih(null===(g=l.options)||void 0===g?void 0:g.apiKey,"invalid-api-key",{appName:l.name}),this._delegate=new jc(s,a,l.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function gl(c){c.INTERNAL.registerComponent(new me.wA("auth-compat",s=>{const a=s.getProvider("app-compat").getImmediate(),l=s.getProvider("auth");return new fl(a,l)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Ro,FacebookAuthProvider:Ms,GithubAuthProvider:Po,GoogleAuthProvider:Oo,OAuthProvider:Tr,SAMLAuthProvider:zt,PhoneAuthProvider:Tu,PhoneMultiFactorGenerator:Jc,RecaptchaVerifier:jt,TwitterAuthProvider:pi,Auth:fl,AuthCredential:wr,Error:k.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),c.registerVersion("@firebase/auth-compat","0.2.18")}(re.Z)},4408:(Qt,Xe,z)=>{z.d(Xe,{o:()=>ae});var I=z(727);class re extends I.w0{constructor(me,Ie){super()}schedule(me,Ie=0){return this}}const k={setInterval(de,me,...Ie){const{delegate:fe}=k;return fe?.setInterval?fe.setInterval(de,me,...Ie):setInterval(de,me,...Ie)},clearInterval(de){const{delegate:me}=k;return(me?.clearInterval||clearInterval)(de)},delegate:void 0};var se=z(8737);class ae extends re{constructor(me,Ie){super(me,Ie),this.scheduler=me,this.work=Ie,this.pending=!1}schedule(me,Ie=0){if(this.closed)return this;this.state=me;const fe=this.id,V=this.scheduler;return null!=fe&&(this.id=this.recycleAsyncId(V,fe,Ie)),this.pending=!0,this.delay=Ie,this.id=this.id||this.requestAsyncId(V,this.id,Ie),this}requestAsyncId(me,Ie,fe=0){return k.setInterval(me.flush.bind(me,this),fe)}recycleAsyncId(me,Ie,fe=0){if(null!=fe&&this.delay===fe&&!1===this.pending)return Ie;k.clearInterval(Ie)}execute(me,Ie){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const fe=this._execute(me,Ie);if(fe)return fe;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(me,Ie){let V,fe=!1;try{this.work(me)}catch(G){fe=!0,V=G||new Error("Scheduled action threw falsy error")}if(fe)return this.unsubscribe(),V}unsubscribe(){if(!this.closed){const{id:me,scheduler:Ie}=this,{actions:fe}=Ie;this.work=this.state=this.scheduler=null,this.pending=!1,(0,se.P)(fe,this),null!=me&&(this.id=this.recycleAsyncId(Ie,me,null)),this.delay=null,super.unsubscribe()}}}},7565:(Qt,Xe,z)=>{z.d(Xe,{v:()=>k});var I=z(6063);class re{constructor(ae,de=re.now){this.schedulerActionCtor=ae,this.now=de}schedule(ae,de=0,me){return new this.schedulerActionCtor(this,ae).schedule(me,de)}}re.now=I.l.now;class k extends re{constructor(ae,de=re.now){super(ae,de),this.actions=[],this._active=!1,this._scheduled=void 0}flush(ae){const{actions:de}=this;if(this._active)return void de.push(ae);let me;this._active=!0;do{if(me=ae.execute(ae.state,ae.delay))break}while(ae=de.shift());if(this._active=!1,me){for(;ae=de.shift();)ae.unsubscribe();throw me}}}},4986:(Qt,Xe,z)=>{z.d(Xe,{z:()=>k});var I=z(4408);const k=new(z(7565).v)(I.o)},3942:(Qt,Xe,z)=>{z.d(Xe,{Z:()=>$e});var I=z(2090),re=z(4859),k=z(9681),se=z(1877);class ae{constructor(ke,te){this._delegate=ke,this.firebase=te,(0,k._addComponent)(ke,new re.wA("app-compat",()=>this,"PUBLIC")),this.container=ke.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(ke){this._delegate.automaticDataCollectionEnabled=ke}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(ke=>{this._delegate.checkDestroyed(),ke()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,k.deleteApp)(this._delegate)))}_getService(ke,te=k._DEFAULT_ENTRY_NAME){var R;this._delegate.checkDestroyed();const we=this._delegate.container.getProvider(ke);return!we.isInitialized()&&"EXPLICIT"===(null===(R=we.getComponent())||void 0===R?void 0:R.instantiationMode)&&we.initialize(),we.getImmediate({identifier:te})}_removeServiceInstance(ke,te=k._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(ke).clearInstance(te)}_addComponent(ke){(0,k._addComponent)(this._delegate,ke)}_addOrOverwriteComponent(ke){(0,k._addOrOverwriteComponent)(this._delegate,ke)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const me=new I.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),V=function fe(){const ze=function Ie(ze){const ke={},te={__esModule:!0,initializeApp:function Ee(ge,E={}){const W=k.initializeApp(ge,E);if((0,I.r3)(ke,W.name))return ke[W.name];const q=new ze(W,te);return ke[W.name]=q,q},app:we,registerVersion:k.registerVersion,setLogLevel:k.setLogLevel,onLog:k.onLog,apps:null,SDK_VERSION:k.SDK_VERSION,INTERNAL:{registerComponent:function le(ge){const E=ge.name,W=E.replace("-compat","");if(k._registerComponent(ge)&&"PUBLIC"===ge.type){const q=(je=we())=>{if("function"!=typeof je[W])throw me.create("invalid-app-argument",{appName:E});return je[W]()};void 0!==ge.serviceProps&&(0,I.ZB)(q,ge.serviceProps),te[W]=q,ze.prototype[W]=function(...je){return this._getService.bind(this,E).apply(this,ge.multipleInstances?je:[])}}return"PUBLIC"===ge.type?te[W]:null},removeApp:function R(ge){delete ke[ge]},useAsService:function He(ge,E){return"serverAuth"===E?null:E},modularAPIs:k}};function we(ge){if(!(0,I.r3)(ke,ge=ge||k._DEFAULT_ENTRY_NAME))throw me.create("no-app",{appName:ge});return ke[ge]}return te.default=te,Object.defineProperty(te,"apps",{get:function xe(){return Object.keys(ke).map(ge=>ke[ge])}}),we.App=ze,te}(ae);return ze.INTERNAL=Object.assign(Object.assign({},ze.INTERNAL),{createFirebaseNamespace:fe,extendNamespace:function ke(te){(0,I.ZB)(ze,te)},createSubscribe:I.ne,ErrorFactory:I.LL,deepExtend:I.ZB}),ze}(),G=new se.Yd("@firebase/app-compat");if((0,I.jU)()&&void 0!==self.firebase){G.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const ze=self.firebase.SDK_VERSION;ze&&ze.indexOf("LITE")>=0&&G.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const $e=V;!function Le(ze){(0,k.registerVersion)("@firebase/app-compat","0.1.32",ze)}()},9681:(Qt,Xe,z)=>{z.r(Xe),z.d(Xe,{FirebaseError:()=>se.ZR,SDK_VERSION:()=>pr,_DEFAULT_ENTRY_NAME:()=>nn,_addComponent:()=>Nt,_addOrOverwriteComponent:()=>Ui,_apps:()=>Dt,_clearComponents:()=>ci,_components:()=>Ge,_getProvider:()=>it,_registerComponent:()=>fr,_removeServiceInstance:()=>st,deleteApp:()=>gr,getApp:()=>rn,getApps:()=>ot,initializeApp:()=>wt,onLog:()=>Ln,registerVersion:()=>vn,setLogLevel:()=>Fn});var I=z(5861),re=z(4859),k=z(1877),se=z(2090),ae=z(8766);class de{constructor(x){this.container=x}getPlatformInfoString(){return this.container.getProviders().map(A=>{if(function me(b){return"VERSION"===b.getComponent()?.type}(A)){const $=A.getImmediate();return`${$.library}/${$.version}`}return null}).filter(A=>A).join(" ")}}const Ie="@firebase/app",V=new k.Yd("@firebase/app"),nn="[DEFAULT]",rt={[Ie]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Dt=new Map,Ge=new Map;function Nt(b,x){try{b.container.addComponent(x)}catch(A){V.debug(`Component ${x.name} failed to register with FirebaseApp ${b.name}`,A)}}function Ui(b,x){b.container.addOrOverwriteComponent(x)}function fr(b){const x=b.name;if(Ge.has(x))return V.debug(`There were multiple attempts to register component ${x}.`),!1;Ge.set(x,b);for(const A of Dt.values())Nt(A,b);return!0}function it(b,x){const A=b.container.getProvider("heartbeat").getImmediate({optional:!0});return A&&A.triggerHeartbeat(),b.container.getProvider(x)}function st(b,x,A=nn){it(b,x).clearInstance(A)}function ci(){Ge.clear()}const Rt=new se.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Ut{constructor(x,A,$){this._isDeleted=!1,this._options=Object.assign({},x),this._config=Object.assign({},A),this._name=A.name,this._automaticDataCollectionEnabled=A.automaticDataCollectionEnabled,this._container=$,this.container.addComponent(new re.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(x){this.checkDestroyed(),this._automaticDataCollectionEnabled=x}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(x){this._isDeleted=x}checkDestroyed(){if(this.isDeleted)throw Rt.create("app-deleted",{appName:this._name})}}const pr="9.9.3";function wt(b,x={}){"object"!=typeof x&&(x={name:x});const A=Object.assign({name:nn,automaticDataCollectionEnabled:!1},x),$=A.name;if("string"!=typeof $||!$)throw Rt.create("bad-app-name",{appName:String($)});const J=Dt.get($);if(J){if((0,se.vZ)(b,J.options)&&(0,se.vZ)(A,J.config))return J;throw Rt.create("duplicate-app",{appName:$})}const he=new re.H0($);for(const Ze of Ge.values())he.addComponent(Ze);const lt=new Ut(b,A,he);return Dt.set($,lt),lt}function rn(b=nn){const x=Dt.get(b);if(!x)throw Rt.create("no-app",{appName:b});return x}function ot(){return Array.from(Dt.values())}function gr(b){return sn.apply(this,arguments)}function sn(){return(sn=(0,I.Z)(function*(b){const x=b.name;Dt.has(x)&&(Dt.delete(x),yield Promise.all(b.container.getProviders().map(A=>A.delete())),b.isDeleted=!0)})).apply(this,arguments)}function vn(b,x,A){var $;let J=null!==($=rt[b])&&void 0!==$?$:b;A&&(J+=`-${A}`);const he=J.match(/\s|\//),lt=x.match(/\s|\//);if(he||lt){const Ze=[`Unable to register library "${J}" with version "${x}":`];return he&&Ze.push(`library name "${J}" contains illegal characters (whitespace or "/")`),he&&lt&&Ze.push("and"),lt&&Ze.push(`version name "${x}" contains illegal characters (whitespace or "/")`),void V.warn(Ze.join(" "))}fr(new re.wA(`${J}-version`,()=>({library:J,version:x}),"VERSION"))}function Ln(b,x){if(null!==b&&"function"!=typeof b)throw Rt.create("invalid-log-argument");(0,k.Am)(b,x)}function Fn(b){(0,k.Ub)(b)}const Qn="firebase-heartbeat-store";let mr=null;function fn(){return mr||(mr=(0,ae.X3)("firebase-heartbeat-database",1,{upgrade:(b,x)=>{0===x&&b.createObjectStore(Qn)}}).catch(b=>{throw Rt.create("idb-open",{originalErrorMessage:b.message})})),mr}function wn(){return(wn=(0,I.Z)(function*(b){var x;try{return(yield fn()).transaction(Qn).objectStore(Qn).get(En(b))}catch(A){if(A instanceof se.ZR)V.warn(A.message);else{const $=Rt.create("idb-get",{originalErrorMessage:null===(x=A)||void 0===x?void 0:x.message});V.warn($.message)}}})).apply(this,arguments)}function yr(b,x){return Kt.apply(this,arguments)}function Kt(){return(Kt=(0,I.Z)(function*(b,x){var A;try{const J=(yield fn()).transaction(Qn,"readwrite");return yield J.objectStore(Qn).put(x,En(b)),J.done}catch($){if($ instanceof se.ZR)V.warn($.message);else{const J=Rt.create("idb-set",{originalErrorMessage:null===(A=$)||void 0===A?void 0:A.message});V.warn(J.message)}}})).apply(this,arguments)}function En(b){return`${b.name}!${b.options.appId}`}class vr{constructor(x){this.container=x,this._heartbeatsCache=null;const A=this.container.getProvider("app").getImmediate();this._storage=new Vi(A),this._heartbeatsCachePromise=this._storage.read().then($=>(this._heartbeatsCache=$,$))}triggerHeartbeat(){var x=this;return(0,I.Z)(function*(){const $=x.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),J=Tn();if(null===x._heartbeatsCache&&(x._heartbeatsCache=yield x._heartbeatsCachePromise),x._heartbeatsCache.lastSentHeartbeatDate!==J&&!x._heartbeatsCache.heartbeats.some(he=>he.date===J))return x._heartbeatsCache.heartbeats.push({date:J,agent:$}),x._heartbeatsCache.heartbeats=x._heartbeatsCache.heartbeats.filter(he=>{const lt=new Date(he.date).valueOf();return Date.now()-lt<=2592e6}),x._storage.overwrite(x._heartbeatsCache)})()}getHeartbeatsHeader(){var x=this;return(0,I.Z)(function*(){if(null===x._heartbeatsCache&&(yield x._heartbeatsCachePromise),null===x._heartbeatsCache||0===x._heartbeatsCache.heartbeats.length)return"";const A=Tn(),{heartbeatsToSend:$,unsentEntries:J}=function Jn(b,x=1024){const A=[];let $=b.slice();for(const J of b){const he=A.find(lt=>lt.agent===J.agent);if(he){if(he.dates.push(J.date),D(A)>x){he.dates.pop();break}}else if(A.push({agent:J.agent,dates:[J.date]}),D(A)>x){A.pop();break}$=$.slice(1)}return{heartbeatsToSend:A,unsentEntries:$}}(x._heartbeatsCache.heartbeats),he=(0,se.L)(JSON.stringify({version:2,heartbeats:$}));return x._heartbeatsCache.lastSentHeartbeatDate=A,J.length>0?(x._heartbeatsCache.heartbeats=J,yield x._storage.overwrite(x._heartbeatsCache)):(x._heartbeatsCache.heartbeats=[],x._storage.overwrite(x._heartbeatsCache)),he})()}}function Tn(){return(new Date).toISOString().substring(0,10)}class Vi{constructor(x){this.app=x,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,I.Z)(function*(){return!!(0,se.hl)()&&(0,se.eu)().then(()=>!0).catch(()=>!1)})()}read(){var x=this;return(0,I.Z)(function*(){return(yield x._canUseIndexedDBPromise)&&(yield function Ur(b){return wn.apply(this,arguments)}(x.app))||{heartbeats:[]}})()}overwrite(x){var A=this;return(0,I.Z)(function*(){var $;if(yield A._canUseIndexedDBPromise){const he=yield A.read();return yr(A.app,{lastSentHeartbeatDate:null!==($=x.lastSentHeartbeatDate)&&void 0!==$?$:he.lastSentHeartbeatDate,heartbeats:x.heartbeats})}})()}add(x){var A=this;return(0,I.Z)(function*(){var $;if(yield A._canUseIndexedDBPromise){const he=yield A.read();return yr(A.app,{lastSentHeartbeatDate:null!==($=x.lastSentHeartbeatDate)&&void 0!==$?$:he.lastSentHeartbeatDate,heartbeats:[...he.heartbeats,...x.heartbeats]})}})()}}function D(b){return(0,se.L)(JSON.stringify({version:2,heartbeats:b})).length}!function S(b){fr(new re.wA("platform-logger",x=>new de(x),"PRIVATE")),fr(new re.wA("heartbeat",x=>new vr(x),"PRIVATE")),vn(Ie,"0.7.31",b),vn(Ie,"0.7.31","esm2017"),vn("fire-js","")}("")},4859:(Qt,Xe,z)=>{z.d(Xe,{H0:()=>Ie,wA:()=>k});var I=z(5861),re=z(2090);class k{constructor(V,G,ce){this.name=V,this.instanceFactory=G,this.type=ce,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(V){return this.instantiationMode=V,this}setMultipleInstances(V){return this.multipleInstances=V,this}setServiceProps(V){return this.serviceProps=V,this}setInstanceCreatedCallback(V){return this.onInstanceCreated=V,this}}const se="[DEFAULT]";class ae{constructor(V,G){this.name=V,this.container=G,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(V){const G=this.normalizeInstanceIdentifier(V);if(!this.instancesDeferred.has(G)){const ce=new re.BH;if(this.instancesDeferred.set(G,ce),this.isInitialized(G)||this.shouldAutoInitialize())try{const Ce=this.getOrInitializeService({instanceIdentifier:G});Ce&&ce.resolve(Ce)}catch{}}return this.instancesDeferred.get(G).promise}getImmediate(V){var G;const ce=this.normalizeInstanceIdentifier(V?.identifier),Ce=null!==(G=V?.optional)&&void 0!==G&&G;if(!this.isInitialized(ce)&&!this.shouldAutoInitialize()){if(Ce)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:ce})}catch(Le){if(Ce)return null;throw Le}}getComponent(){return this.component}setComponent(V){if(V.name!==this.name)throw Error(`Mismatching Component ${V.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=V,this.shouldAutoInitialize()){if(function me(fe){return"EAGER"===fe.instantiationMode}(V))try{this.getOrInitializeService({instanceIdentifier:se})}catch{}for(const[G,ce]of this.instancesDeferred.entries()){const Ce=this.normalizeInstanceIdentifier(G);try{const Le=this.getOrInitializeService({instanceIdentifier:Ce});ce.resolve(Le)}catch{}}}}clearInstance(V=se){this.instancesDeferred.delete(V),this.instancesOptions.delete(V),this.instances.delete(V)}delete(){var V=this;return(0,I.Z)(function*(){const G=Array.from(V.instances.values());yield Promise.all([...G.filter(ce=>"INTERNAL"in ce).map(ce=>ce.INTERNAL.delete()),...G.filter(ce=>"_delete"in ce).map(ce=>ce._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(V=se){return this.instances.has(V)}getOptions(V=se){return this.instancesOptions.get(V)||{}}initialize(V={}){const{options:G={}}=V,ce=this.normalizeInstanceIdentifier(V.instanceIdentifier);if(this.isInitialized(ce))throw Error(`${this.name}(${ce}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Ce=this.getOrInitializeService({instanceIdentifier:ce,options:G});for(const[Le,$e]of this.instancesDeferred.entries())ce===this.normalizeInstanceIdentifier(Le)&&$e.resolve(Ce);return Ce}onInit(V,G){var ce;const Ce=this.normalizeInstanceIdentifier(G),Le=null!==(ce=this.onInitCallbacks.get(Ce))&&void 0!==ce?ce:new Set;Le.add(V),this.onInitCallbacks.set(Ce,Le);const $e=this.instances.get(Ce);return $e&&V($e,Ce),()=>{Le.delete(V)}}invokeOnInitCallbacks(V,G){const ce=this.onInitCallbacks.get(G);if(ce)for(const Ce of ce)try{Ce(V,G)}catch{}}getOrInitializeService({instanceIdentifier:V,options:G={}}){let ce=this.instances.get(V);if(!ce&&this.component&&(ce=this.component.instanceFactory(this.container,{instanceIdentifier:(fe=V,fe===se?void 0:fe),options:G}),this.instances.set(V,ce),this.instancesOptions.set(V,G),this.invokeOnInitCallbacks(ce,V),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,V,ce)}catch{}var fe;return ce||null}normalizeInstanceIdentifier(V=se){return this.component?this.component.multipleInstances?V:se:V}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Ie{constructor(V){this.name=V,this.providers=new Map}addComponent(V){const G=this.getProvider(V.name);if(G.isComponentSet())throw new Error(`Component ${V.name} has already been registered with ${this.name}`);G.setComponent(V)}addOrOverwriteComponent(V){this.getProvider(V.name).isComponentSet()&&this.providers.delete(V.name),this.addComponent(V)}getProvider(V){if(this.providers.has(V))return this.providers.get(V);const G=new ae(V,this);return this.providers.set(V,G),G}getProviders(){return Array.from(this.providers.values())}}},1877:(Qt,Xe,z)=>{z.d(Xe,{Am:()=>fe,Ub:()=>Ie,Yd:()=>me,in:()=>re});const I=[];var re=(()=>{return(V=re||(re={}))[V.DEBUG=0]="DEBUG",V[V.VERBOSE=1]="VERBOSE",V[V.INFO=2]="INFO",V[V.WARN=3]="WARN",V[V.ERROR=4]="ERROR",V[V.SILENT=5]="SILENT",re;var V})();const k={debug:re.DEBUG,verbose:re.VERBOSE,info:re.INFO,warn:re.WARN,error:re.ERROR,silent:re.SILENT},se=re.INFO,ae={[re.DEBUG]:"log",[re.VERBOSE]:"log",[re.INFO]:"info",[re.WARN]:"warn",[re.ERROR]:"error"},de=(V,G,...ce)=>{if(G<V.logLevel)return;const Ce=(new Date).toISOString(),Le=ae[G];if(!Le)throw new Error(`Attempted to log a message with an invalid logType (value: ${G})`);console[Le](`[${Ce}]  ${V.name}:`,...ce)};class me{constructor(G){this.name=G,this._logLevel=se,this._logHandler=de,this._userLogHandler=null,I.push(this)}get logLevel(){return this._logLevel}set logLevel(G){if(!(G in re))throw new TypeError(`Invalid value "${G}" assigned to \`logLevel\``);this._logLevel=G}setLogLevel(G){this._logLevel="string"==typeof G?k[G]:G}get logHandler(){return this._logHandler}set logHandler(G){if("function"!=typeof G)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=G}get userLogHandler(){return this._userLogHandler}set userLogHandler(G){this._userLogHandler=G}debug(...G){this._userLogHandler&&this._userLogHandler(this,re.DEBUG,...G),this._logHandler(this,re.DEBUG,...G)}log(...G){this._userLogHandler&&this._userLogHandler(this,re.VERBOSE,...G),this._logHandler(this,re.VERBOSE,...G)}info(...G){this._userLogHandler&&this._userLogHandler(this,re.INFO,...G),this._logHandler(this,re.INFO,...G)}warn(...G){this._userLogHandler&&this._userLogHandler(this,re.WARN,...G),this._logHandler(this,re.WARN,...G)}error(...G){this._userLogHandler&&this._userLogHandler(this,re.ERROR,...G),this._logHandler(this,re.ERROR,...G)}}function Ie(V){I.forEach(G=>{G.setLogLevel(V)})}function fe(V,G){for(const ce of I){let Ce=null;G&&G.level&&(Ce=k[G.level]),ce.userLogHandler=null===V?null:(Le,$e,...ze)=>{const ke=ze.map(te=>{if(null==te)return null;if("string"==typeof te)return te;if("number"==typeof te||"boolean"==typeof te)return te.toString();if(te instanceof Error)return te.message;try{return JSON.stringify(te)}catch{return null}}).filter(te=>te).join(" ");$e>=(Ce??Le.logLevel)&&V({level:re[$e].toLowerCase(),message:ke,args:ze,type:Le.name})}}}},8766:(Qt,Xe,z)=>{z.d(Xe,{Lj:()=>Ee,X3:()=>we});var I=z(5861);let k,se;const me=new WeakMap,Ie=new WeakMap,fe=new WeakMap,V=new WeakMap,G=new WeakMap;let Le={get(E,W,q){if(E instanceof IDBTransaction){if("done"===W)return Ie.get(E);if("objectStoreNames"===W)return E.objectStoreNames||fe.get(E);if("store"===W)return q.objectStoreNames[1]?void 0:q.objectStore(q.objectStoreNames[0])}return te(E[W])},set:(E,W,q)=>(E[W]=q,!0),has:(E,W)=>E instanceof IDBTransaction&&("done"===W||"store"===W)||W in E};function ke(E){return"function"==typeof E?function ze(E){return E!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function de(){return se||(se=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(E)?function(...W){return E.apply(R(this),W),te(me.get(this))}:function(...W){return te(E.apply(R(this),W))}:function(W,...q){const je=E.call(R(this),W,...q);return fe.set(je,W.sort?W.sort():[W]),te(je)}}(E):(E instanceof IDBTransaction&&function Ce(E){if(Ie.has(E))return;const W=new Promise((q,je)=>{const Pe=()=>{E.removeEventListener("complete",Ye),E.removeEventListener("error",nt),E.removeEventListener("abort",nt)},Ye=()=>{q(),Pe()},nt=()=>{je(E.error||new DOMException("AbortError","AbortError")),Pe()};E.addEventListener("complete",Ye),E.addEventListener("error",nt),E.addEventListener("abort",nt)});Ie.set(E,W)}(E),((E,W)=>W.some(q=>E instanceof q))(E,function ae(){return k||(k=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(E,Le):E)}function te(E){if(E instanceof IDBRequest)return function ce(E){const W=new Promise((q,je)=>{const Pe=()=>{E.removeEventListener("success",Ye),E.removeEventListener("error",nt)},Ye=()=>{q(te(E.result)),Pe()},nt=()=>{je(E.error),Pe()};E.addEventListener("success",Ye),E.addEventListener("error",nt)});return W.then(q=>{q instanceof IDBCursor&&me.set(q,E)}).catch(()=>{}),G.set(W,E),W}(E);if(V.has(E))return V.get(E);const W=ke(E);return W!==E&&(V.set(E,W),G.set(W,E)),W}const R=E=>G.get(E);function we(E,W,{blocked:q,upgrade:je,blocking:Pe,terminated:Ye}={}){const nt=indexedDB.open(E,W),kt=te(nt);return je&&nt.addEventListener("upgradeneeded",Ot=>{je(te(nt.result),Ot.oldVersion,Ot.newVersion,te(nt.transaction))}),q&&nt.addEventListener("blocked",()=>q()),kt.then(Ot=>{Ye&&Ot.addEventListener("close",()=>Ye()),Pe&&Ot.addEventListener("versionchange",()=>Pe())}).catch(()=>{}),kt}function Ee(E,{blocked:W}={}){const q=indexedDB.deleteDatabase(E);return W&&q.addEventListener("blocked",()=>W()),te(q).then(()=>{})}const xe=["get","getKey","getAll","getAllKeys","count"],le=["put","add","delete","clear"],He=new Map;function ge(E,W){if(!(E instanceof IDBDatabase)||W in E||"string"!=typeof W)return;if(He.get(W))return He.get(W);const q=W.replace(/FromIndex$/,""),je=W!==q,Pe=le.includes(q);if(!(q in(je?IDBIndex:IDBObjectStore).prototype)||!Pe&&!xe.includes(q))return;const Ye=function(){var nt=(0,I.Z)(function*(kt,...Ot){const Mn=this.transaction(kt,Pe?"readwrite":"readonly");let nn=Mn.store;return je&&(nn=nn.index(Ot.shift())),(yield Promise.all([nn[q](...Ot),Pe&&Mn.done]))[0]});return function(Ot){return nt.apply(this,arguments)}}();return He.set(W,Ye),Ye}!function $e(E){Le=E(Le)}(E=>({...E,get:(W,q,je)=>ge(W,q)||E.get(W,q,je),has:(W,q)=>!!ge(W,q)||E.has(W,q)}))}}]);