"use strict";(self.webpackChunkSharaf_Resume=self.webpackChunkSharaf_Resume||[]).push([[699],{8699:(Lt,ze,j)=>{j.d(ze,{ST:()=>RI});var I=j(4650),se=j(4986),C=j(8306),ie=j(8996),oe=j(9646),he=j(5813),fe=j(4482),ye=j(5403);function le(){return(0,fe.e)((n,e)=>{let t,r=!1;n.subscribe((0,ye.x)(e,i=>{const s=t;t=i,r&&e.next([s,i]),r=!0}))})}var B=j(4671);function de(n,e){return n===e}var V,Ce=j(8675),Se=j(4004),nt=j(5026),je=j(9300),Ee=j(2011),re=j(6895),xe=(j(1451),j(3942)),R=j(5861),De=j(9681),Qe=j(4859),Pe=j(1877),Y=j(2090),N=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Z={},Ze=Ze||{},ee=N||self;function Xe(){}function et(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function vt(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var _n="closure_uid_"+(1e9*Math.random()>>>0),hn=0;function pr(n,e,t){return n.call.apply(n.bind,arguments)}function Gt(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function Ge(n,e,t){return(Ge=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?pr:Gt).apply(null,arguments)}function Jt(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function gt(n,e){function t(){}t.prototype=e.prototype,n.Z=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Vb=function(r,i,s){for(var u=Array(arguments.length-2),h=2;h<arguments.length;h++)u[h-2]=arguments[h];return e.prototype[i].apply(r,u)}}function qt(){this.s=this.s,this.o=this.o}var lt={};qt.prototype.s=!1,qt.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var n=function Rt(n){return Object.prototype.hasOwnProperty.call(n,_n)&&n[_n]||(n[_n]=++hn)}(this);delete lt[n]}},qt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Nr=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1},Xt=Array.prototype.forEach?function(n,e,t){Array.prototype.forEach.call(n,e,t)}:function(n,e,t){const r=n.length,i="string"==typeof n?n.split(""):n;for(let s=0;s<r;s++)s in i&&e.call(t,i[s],s,n)};function en(n){return Array.prototype.concat.apply([],arguments)}function tr(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function nr(n){return/^[\s\xa0]*$/.test(n)}var tt,vn=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function it(n,e){return-1!=n.indexOf(e)}function rr(n,e){return n<e?-1:n>e?1:0}e:{var Vn=ee.navigator;if(Vn){var Bn=Vn.userAgent;if(Bn){tt=Bn;break e}}tt=""}function En(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function Tn(n){const e={};for(const t in n)e[t]=n[t];return e}var tn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $n(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let s=0;s<tn.length;s++)t=tn[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function jn(n){return jn[" "](n),n}jn[" "]=Xe;var ir,n,ei=it(tt,"Opera"),nn=it(tt,"Trident")||it(tt,"MSIE"),gr=it(tt,"Edge"),Ot=gr||nn,bn=it(tt,"Gecko")&&!(it(tt.toLowerCase(),"webkit")&&!it(tt,"Edge"))&&!(it(tt,"Trident")||it(tt,"MSIE"))&&!it(tt,"Edge"),ti=it(tt.toLowerCase(),"webkit")&&!it(tt,"Edge");function Or(){var n=ee.document;return n?n.documentMode:void 0}e:{var An="",Sn=(n=tt,bn?/rv:([^\);]+)(\)|;)/.exec(n):gr?/Edge\/([\d\.]+)/.exec(n):nn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):ti?/WebKit\/(\S+)/.exec(n):ei?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(Sn&&(An=Sn?Sn[1]:""),nn){var Pr=Or();if(null!=Pr&&Pr>parseFloat(An)){ir=String(Pr);break e}}ir=An}var k={};var S=ee.document&&nn&&(Or()||parseInt(ir,10))||void 0,G=function(){if(!ee.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{ee.addEventListener("test",Xe,e),ee.removeEventListener("test",Xe,e)}catch{}return n}();function H(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}function pe(n,e){if(H.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(bn){e:{try{jn(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:ht[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&pe.Z.h.call(this)}}H.prototype.h=function(){this.defaultPrevented=!0},gt(pe,H);var ht={2:"touch",3:"pen",4:"mouse"};pe.prototype.h=function(){pe.Z.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Be="closure_listenable_"+(1e6*Math.random()|0),Ut=0;function Me(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ia=i,this.key=++Ut,this.ca=this.fa=!1}function Kt(n){n.ca=!0,n.listener=null,n.proxy=null,n.src=null,n.ia=null}function In(n){this.src=n,this.g={},this.h=0}function Mr(n,e){var t=e.type;if(t in n.g){var s,r=n.g[t],i=Nr(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Kt(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function ni(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.ca&&s.listener==e&&s.capture==!!t&&s.ia==r)return i}return-1}In.prototype.add=function(n,e,t,r,i){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var u=ni(n,e,r,i);return-1<u?(e=n[u],t||(e.fa=!1)):((e=new Me(e,this.src,s,!!r,i)).fa=t,n.push(e)),e};var ys="closure_lm_"+(1e6*Math.random()|0),sr={};function yo(n,e,t,r,i){if(r&&r.once)return Ku(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)yo(n,e[s],t,r,i);return null}return t=_o(t),n&&n[Be]?n.N(e,t,vt(r)?!!r.capture:!!r,i):Pi(n,e,t,!1,r,i)}function Pi(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var u=vt(i)?!!i.capture:!!i,h=ii(n);if(h||(n[ys]=h=new In(n)),(t=h.add(e,t,r,u,s)).proxy)return t;if(r=function ri(){var e=zu;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)G||(i=u),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(Va(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function Ku(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Ku(n,e[s],t,r,i);return null}return t=_o(t),n&&n[Be]?n.O(e,t,vt(r)?!!r.capture:!!r,i):Pi(n,e,t,!0,r,i)}function _s(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)_s(n,e[s],t,r,i);else r=vt(r)?!!r.capture:!!r,t=_o(t),n&&n[Be]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=ni(s=n.g[e],t,r,i))&&(Kt(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=ii(n))&&(e=n.g[e.toString()],n=-1,e&&(n=ni(e,t,r,i)),(t=-1<n?e[n]:null)&&Ua(t))}function Ua(n){if("number"!=typeof n&&n&&!n.ca){var e=n.src;if(e&&e[Be])Mr(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(Va(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=ii(e))?(Mr(t,n),0==t.h&&(t.src=null,e[ys]=null)):Kt(n)}}}function Va(n){return n in sr?sr[n]:sr[n]="on"+n}function zu(n,e){if(n.ca)n=!0;else{e=new pe(e,this);var t=n.listener,r=n.ia||n.src;n.fa&&Ua(n),n=t.call(r,e)}return n}function ii(n){return(n=n[ys])instanceof In?n:null}var vs="__closure_events_fn_"+(1e9*Math.random()>>>0);function _o(n){return"function"==typeof n?n:(n[vs]||(n[vs]=function(e){return n.handleEvent(e)}),n[vs])}function Le(){qt.call(this),this.i=new In(this),this.P=this,this.I=null}function xt(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new H(e,n);else if(e instanceof H)e.target=e.target||n;else{var i=e;$n(e=new H(r,n),i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var u=e.g=t[s];i=Is(u,r,!0,e)&&i}if(i=Is(u=e.g=n,r,!0,e)&&i,i=Is(u,r,!1,e)&&i,t)for(s=0;s<t.length;s++)i=Is(u=e.g=t[s],r,!1,e)&&i}function Is(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var u=e[s];if(u&&!u.ca&&u.capture==t){var h=u.listener,f=u.ia||u.src;u.fa&&Mr(n.i,u),i=!1!==h.call(f,r)&&i}}return i&&!r.defaultPrevented}gt(Le,qt),Le.prototype[Be]=!0,Le.prototype.removeEventListener=function(n,e,t,r){_s(this,n,e,t,r)},Le.prototype.M=function(){if(Le.Z.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Kt(t[r]);delete n.g[e],n.h--}}this.I=null},Le.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},Le.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var si=ee.JSON.stringify;function Ba(){var n=Ts;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var ws,vo=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new oi,n=>n.reset());class oi{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function zt(n){ee.setTimeout(()=>{throw n},0)}function Mi(n,e){ws||function Io(){var n=ee.Promise.resolve(void 0);ws=function(){n.then(wo)}}(),Es||(ws(),Es=!0),Ts.add(n,e)}var Es=!1,Ts=new class $a{constructor(){this.h=this.g=null}add(e,t){const r=vo.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function wo(){for(var n;n=Ba();){try{n.h.call(n.g)}catch(t){zt(t)}var e=vo;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Es=!1}function Li(n,e){Le.call(this),this.h=n||1,this.g=e||ee,this.j=Ge(this.kb,this),this.l=Date.now()}function ai(n){n.da=!1,n.S&&(n.g.clearTimeout(n.S),n.S=null)}function Lr(n,e,t){if("function"==typeof n)t&&(n=Ge(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Ge(n.handleEvent,n)}return 2147483647<Number(e)?-1:ee.setTimeout(n,e||0)}function ja(n){n.g=Lr(()=>{n.g=null,n.i&&(n.i=!1,ja(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}gt(Li,Le),(V=Li.prototype).da=!1,V.S=null,V.kb=function(){if(this.da){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-n):(this.S&&(this.g.clearTimeout(this.S),this.S=null),xt(this,"tick"),this.da&&(ai(this),this.start()))}},V.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},V.M=function(){Li.Z.M.call(this),ai(this),delete this.g};class Eo extends qt{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:ja(this)}M(){super.M(),this.g&&(ee.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Fr(n){qt.call(this),this.h=n,this.g={}}gt(Fr,qt);var To=[];function Zu(n,e,t,r){Array.isArray(t)||(t&&(To[0]=t.toString()),t=To);for(var i=0;i<t.length;i++){var s=yo(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function bo(n){En(n.g,function(e,t){this.g.hasOwnProperty(t)&&Ua(e)},n),n.g={}}function Ao(){this.g=!0}function mr(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function So(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var u=1;u<i.length;u++)i[u]=""}}}return si(t)}catch{return e}}(n,t)+(r?" "+r:"")})}Fr.prototype.M=function(){Fr.Z.M.call(this),bo(this)},Fr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ao.prototype.Aa=function(){this.g=!1},Ao.prototype.info=function(){};var xn={},Gn=null;function ci(){return Gn=Gn||new Le}function Ga(n){H.call(this,xn.Ma,n)}function rn(n){const e=ci();xt(e,new Ga(e,n))}function qa(n,e){H.call(this,xn.STAT_EVENT,n),this.stat=e}function Pt(n){const e=ci();xt(e,new qa(e,n))}function Fi(n,e){H.call(this,xn.Na,n),this.size=e}function dn(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return ee.setTimeout(function(){n()},e)}xn.Ma="serverreachability",gt(Ga,H),xn.STAT_EVENT="statevent",gt(qa,H),xn.Na="timingevent",gt(Fi,H);var bs={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},As={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function xo(){}function Ss(){}xo.prototype.h=null;var Ur,Cn={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function za(){H.call(this,"d")}function Ui(){H.call(this,"c")}function Vi(){}function Vr(n,e,t,r){this.l=n,this.j=e,this.m=t,this.X=r||1,this.V=new Fr(this),this.P=Br,this.W=new Li(n=Ot?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new qn}function qn(){this.i=null,this.g="",this.h=!1}gt(za,H),gt(Ui,H),gt(Vi,xo),Vi.prototype.g=function(){return new XMLHttpRequest},Vi.prototype.i=function(){return{}},Ur=new Vi;var Br=45e3,yr={},li={};function xs(n,e,t){n.K=1,n.v=pi(fn(e)),n.s=t,n.U=!0,Co(n,null)}function Co(n,e){n.F=Date.now(),Vt(n),n.A=fn(n.v);var t=n.A,r=n.X;Array.isArray(r)||(r=[String(r)]),Zi(t.h,"t",r),n.C=0,t=n.l.H,n.h=new qn,n.g=Wo(n.l,t?e:null,!n.s),0<n.O&&(n.L=new Eo(Ge(n.Ia,n,n.g),n.O)),Zu(n.V,n.g,"readystatechange",n.gb),e=n.H?Tn(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ea(n.A,n.u,n.s,e)):(n.u="GET",n.g.ea(n.A,n.u,null,e)),rn(1),function ui(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var u="",h=s.split("&"),f=0;f<h.length;f++){var m=h[f].split("=");if(1<m.length){var v=m[0];m=m[1];var E=v.split("_");u=2<=E.length&&"type"==E[1]?u+(v+"=")+m+"&":u+(v+"=redacted&")}}else u=null;else u=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+u})}(n.j,n.u,n.A,n.m,n.X,n.s)}function Za(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Ba}function hi(n,e,t){let i,r=!0;for(;!n.I&&n.C<t.length;){if(i=di(n,t),i==li){4==e&&(n.o=4,Pt(14),r=!1),mr(n.j,n.m,null,"[Incomplete Response]");break}if(i==yr){n.o=4,Pt(15),mr(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}mr(n.j,n.m,i,null),Cs(n,i)}Za(n)&&i!=li&&i!=yr&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Pt(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.aa&&(n.aa=!0,(e=n.l).g==n&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+t.length),At(e),e.L=!0,Pt(11))):(mr(n.j,n.m,t,"[Invalid Chunked Response]"),bt(n),jr(n))}function di(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?li:(t=Number(e.substring(t,r)),isNaN(t)?yr:(r+=1)+t>e.length?li:(e=e.substr(r,t),n.C=r+t,e))}function Vt(n){n.Y=Date.now()+n.P,ko(n,n.P)}function ko(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=dn(Ge(n.eb,n),e)}function $r(n){n.B&&(ee.clearTimeout(n.B),n.B=null)}function jr(n){0==n.l.G||n.I||Xa(n.l,n)}function bt(n){$r(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,ai(n.W),bo(n.V),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function Cs(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||Hi(t.i,n)))if(t.I=n.N,!n.J&&Hi(t.i,n)&&3==t.G){try{var r=t.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;Ks(t),Ya(t)}gi(t),Pt(18)}}else t.ta=i[1],0<t.ta-t.U&&37500>i[2]&&t.N&&0==t.A&&!t.v&&(t.v=dn(Ge(t.ab,t),6e3));if(1>=Ms(t.i)&&t.ka){try{t.ka()}catch{}t.ka=void 0}}else kn(t,11)}else if((n.J||t.g==n)&&Ks(t),!nr(e))for(i=t.Ca.g.parse(e),e=0;e<i.length;e++){let m=i[e];if(t.U=m[0],m=m[1],2==t.G)if("c"==m[0]){t.J=m[1],t.la=m[2];const v=m[3];null!=v&&(t.ma=v,t.h.info("VER="+t.ma));const E=m[4];null!=E&&(t.za=E,t.h.info("SVER="+t.za));const O=m[5];null!=O&&"number"==typeof O&&0<O&&(t.K=r=1.5*O,t.h.info("backChannelRequestTimeoutMs_="+r)),r=t;const U=n.g;if(U){const $=U.g?U.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($){var s=r.i;!s.g&&(it($,"spdy")||it($,"quic")||it($,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(Ls(s,s.h),s.h=null))}if(r.D){const X=U.g?U.g.getResponseHeader("X-HTTP-Session-Id"):null;X&&(r.sa=X,Ye(r.F,r.D,X))}}t.G=3,t.j&&t.j.xa(),t.$&&(t.O=Date.now()-n.F,t.h.info("Handshake RTT: "+t.O+"ms"));var u=n;if((r=t).oa=Hr(r,r.H?r.la:null,r.W),u.J){Fs(r.i,u);var h=u,f=r.K;f&&h.setTimeout(f),h.B&&($r(h),Vt(h)),r.g=u}else Er(r);0<t.l.length&&Ja(t)}else"stop"!=m[0]&&"close"!=m[0]||kn(t,7);else 3==t.G&&("stop"==m[0]||"close"==m[0]?"stop"==m[0]?kn(t,7):Yu(t):"noop"!=m[0]&&t.j&&t.j.wa(m),t.A=0)}rn(4)}catch{}}function Bi(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(et(n)||"string"==typeof n)Xt(n,e,void 0);else{if(n.T&&"function"==typeof n.T)var t=n.T();else if(n.R&&"function"==typeof n.R)t=void 0;else if(et(n)||"string"==typeof n){t=[];for(var r=n.length,i=0;i<r;i++)t.push(i)}else for(i in t=[],r=0,n)t[r++]=i;r=function Do(n){if(n.R&&"function"==typeof n.R)return n.R();if("string"==typeof n)return n.split("");if(et(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length;for(var s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}}function or(n,e){this.h={},this.g=[],this.i=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var r=0;r<t;r+=2)this.set(arguments[r],arguments[r+1])}else if(n)if(n instanceof or)for(t=n.T(),r=0;r<t.length;r++)this.set(t[r],n.get(t[r]));else for(r in n)this.set(r,n[r])}function ks(n){if(n.i!=n.g.length){for(var e=0,t=0;e<n.g.length;){var r=n.g[e];sn(n.h,r)&&(n.g[t++]=r),e++}n.g.length=t}if(n.i!=n.g.length){var i={};for(t=e=0;e<n.g.length;)sn(i,r=n.g[e])||(n.g[t++]=r,i[r]=1),e++;n.g.length=t}}function sn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}(V=Vr.prototype).setTimeout=function(n){this.P=n},V.gb=function(n){n=n.target;const e=this.L;e&&3==Zn(n)?e.l():this.Ia(n)},V.Ia=function(n){try{if(n==this.g)e:{const v=Zn(this.g);var e=this.g.Da();const E=this.g.ba();if(!(3>v)&&(3!=v||Ot||this.g&&(this.h.h||this.g.ga()||jo(this.g)))){this.I||4!=v||7==e||rn(8==e||0>=E?3:2),$r(this);var t=this.g.ba();this.N=t;t:if(Za(this)){var r=jo(this.g);n="";var i=r.length,s=4==Zn(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){bt(this),jr(this);var u="";break t}this.h.i=new ee.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==t,function $c(n,e,t,r,i,s,u){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+s+" "+u})}(this.j,this.u,this.A,this.m,this.X,v,t),this.i){if(this.$&&!this.J){t:{if(this.g){var h,f=this.g;if((h=f.g?f.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!nr(h)){var m=h;break t}}m=null}if(!(t=m)){this.i=!1,this.o=3,Pt(12),bt(this),jr(this);break e}mr(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Cs(this,t)}this.U?(hi(this,v,u),Ot&&this.i&&3==v&&(Zu(this.V,this.W,"tick",this.fb),this.W.start())):(mr(this.j,this.m,u,null),Cs(this,u)),4==v&&bt(this),this.i&&!this.I&&(4==v?Xa(this.l,this):(this.i=!1,Vt(this)))}else 400==t&&0<u.indexOf("Unknown SID")?(this.o=3,Pt(12)):(this.o=0,Pt(13)),bt(this),jr(this)}}}catch{}},V.fb=function(){if(this.g){var n=Zn(this.g),e=this.g.ga();this.C<e.length&&($r(this),hi(this,n,e),this.i&&4!=n&&Vt(this))}},V.cancel=function(){this.I=!0,bt(this)},V.eb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function Wu(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(rn(3),Pt(17)),bt(this),this.o=2,jr(this)):ko(this,this.Y-n)},(V=or.prototype).R=function(){ks(this);for(var n=[],e=0;e<this.g.length;e++)n.push(this.h[this.g[e]]);return n},V.T=function(){return ks(this),this.g.concat()},V.get=function(n,e){return sn(this.h,n)?this.h[n]:e},V.set=function(n,e){sn(this.h,n)||(this.i++,this.g.push(n)),this.h[n]=e},V.forEach=function(n,e){for(var t=this.T(),r=0;r<t.length;r++){var i=t[r],s=this.get(i);n.call(e,s,i,this)}};var Ds=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Kn(n,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,n instanceof Kn){this.g=void 0!==e?e:n.g,ar(this,n.j),this.s=n.s,_r(this,n.i),ji(this,n.m),this.l=n.l,e=n.h;var t=new ur;t.i=e.i,e.g&&(t.g=new or(e.g),t.h=e.h),fi(this,t),this.o=n.o}else n&&(t=String(n).match(Ds))?(this.g=!!e,ar(this,t[1]||"",!0),this.s=vr(t[2]||""),_r(this,t[3]||"",!0),ji(this,t[4]),this.l=vr(t[5]||"",!0),fi(this,t[6]||"",!0),this.o=vr(t[7]||"")):(this.g=!!e,this.h=new ur(null,this.g))}function fn(n){return new Kn(n)}function ar(n,e,t){n.j=t?vr(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function _r(n,e,t){n.i=t?vr(e,!0):e}function ji(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function fi(n,e,t){e instanceof ur?(n.h=e,function Po(n,e){e&&!n.j&&(zn(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(zi(this,r),Zi(this,i,t))},n)),n.j=e}(n.h,n.g)):(t||(e=Gr(e,Oo)),n.h=new ur(e,n.g))}function Ye(n,e,t){n.h.set(e,t)}function pi(n){return Ye(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function vr(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Gr(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,Ns),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Ns(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Kn.prototype.toString=function(){var n=[],e=this.j;e&&n.push(Gr(e,Gi,!0),":");var t=this.i;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(Gr(e,Gi,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.i&&"/"!=t.charAt(0)&&n.push("/"),n.push(Gr(t,"/"==t.charAt(0)?qi:Ro,!0))),(t=this.h.toString())&&n.push("?",t),(t=this.o)&&n.push("#",Gr(t,Ki)),n.join("")};var Gi=/[#\/\?@]/g,Ro=/[#\?:]/g,qi=/[#\?]/g,Oo=/[#\?@]/g,Ki=/#/g;function ur(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function zn(n){n.g||(n.g=new or,n.h=0,n.i&&function $i(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function zi(n,e){zn(n),e=Ir(n,e),sn(n.g.h,e)&&(n.i=null,n.h-=n.g.get(e).length,sn((n=n.g).h,e)&&(delete n.h[e],n.i--,n.g.length>2*n.i&&ks(n)))}function Rs(n,e){return zn(n),e=Ir(n,e),sn(n.g.h,e)}function Zi(n,e,t){zi(n,e),0<t.length&&(n.i=null,n.g.set(Ir(n,e),tr(t)),n.h+=t.length)}function Ir(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function Wi(n){this.l=n||Os,n=ee.PerformanceNavigationTiming?0<(n=ee.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(ee.g&&ee.g.Ea&&ee.g.Ea()&&ee.g.Ea().Zb),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(V=ur.prototype).add=function(n,e){zn(this),this.i=null,n=Ir(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},V.forEach=function(n,e){zn(this),this.g.forEach(function(t,r){Xt(t,function(i){n.call(e,i,r,this)},this)},this)},V.T=function(){zn(this);for(var n=this.g.R(),e=this.g.T(),t=[],r=0;r<e.length;r++)for(var i=n[r],s=0;s<i.length;s++)t.push(e[r]);return t},V.R=function(n){zn(this);var e=[];if("string"==typeof n)Rs(this,n)&&(e=en(e,this.g.get(Ir(this,n))));else{n=this.g.R();for(var t=0;t<n.length;t++)e=en(e,n[t])}return e},V.set=function(n,e){return zn(this),this.i=null,Rs(this,n=Ir(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},V.get=function(n,e){return n&&0<(n=this.R(n)).length?String(n[0]):e},V.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var n=[],e=this.g.T(),t=0;t<e.length;t++){var r=e[t],i=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var u=i;""!==r[s]&&(u+="="+encodeURIComponent(String(r[s]))),n.push(u)}}return this.i=n.join("&")};var Os=10;function Ps(n){return!!n.h||!!n.g&&n.g.size>=n.j}function Ms(n){return n.h?1:n.g?n.g.size:0}function Hi(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function Ls(n,e){n.g?n.g.add(e):n.h=e}function Fs(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function Wa(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return tr(n.i)}function Lo(){}function Fo(){this.g=new Lo}function Ha(n,e,t){const r=t||"";try{Bi(n,function(i,s){let u=i;vt(i)&&(u=si(i)),e.push(r+s+"="+encodeURIComponent(u))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function wr(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Qi(n){this.l=n.$b||null,this.j=n.ib||!1}function qr(n,e){Le.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=Yi,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Wi.prototype.cancel=function(){if(this.i=Wa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},Lo.prototype.stringify=function(n){return ee.JSON.stringify(n,void 0)},Lo.prototype.parse=function(n){return ee.JSON.parse(n,void 0)},gt(Qi,xo),Qi.prototype.g=function(){return new qr(this.l,this.j)},Qi.prototype.i=function(n){return function(){return n}}({}),gt(qr,Le);var Yi=0;function Us(n){n.j.read().then(n.Sa.bind(n)).catch(n.ha.bind(n))}function Kr(n){n.readyState=4,n.l=null,n.j=null,n.A=null,zr(n)}function zr(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(V=qr.prototype).open=function(n,e){if(this.readyState!=Yi)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,zr(this)},V.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||ee).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},V.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Kr(this)),this.readyState=Yi},V.Va=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,zr(this)),this.g&&(this.readyState=3,zr(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof ee.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Us(this)}else n.text().then(this.Ua.bind(this),this.ha.bind(this))},V.Sa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?Kr(this):zr(this),3==this.readyState&&Us(this)}},V.Ua=function(n){this.g&&(this.response=this.responseText=n,Kr(this))},V.Ta=function(n){this.g&&(this.response=n,Kr(this))},V.ha=function(){this.g&&Kr(this)},V.setRequestHeader=function(n,e){this.v.append(n,e)},V.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},V.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(qr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Uo=ee.JSON.parse;function dt(n){Le.call(this),this.headers=new or,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Vs,this.K=this.L=!1}gt(dt,Le);var Vs="",Vo=/^https?$/i,Bo=["POST","PUT"];function Qu(n){return"content-type"==n.toLowerCase()}function Bs(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,$s(n),js(n)}function $s(n){n.D||(n.D=!0,xt(n,"complete"),xt(n,"error"))}function Ji(n){if(n.h&&typeof Ze<"u"&&(!n.C[1]||4!=Zn(n)||2!=n.ba()))if(n.v&&4==Zn(n))Lr(n.Fa,0,n);else if(xt(n,"readystatechange"),4==Zn(n)){n.h=!1;try{const h=n.ba();e:switch(h){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===h){var i=String(n.H).match(Ds)[1]||null;if(!i&&ee.self&&ee.self.location){var s=ee.self.location.protocol;i=s.substr(0,s.length-1)}r=!Vo.test(i?i.toLowerCase():"")}t=r}if(t)xt(n,"complete"),xt(n,"success");else{n.m=6;try{var u=2<Zn(n)?n.g.statusText:""}catch{u=""}n.j=u+" ["+n.ba()+"]",$s(n)}}finally{js(n)}}}function js(n,e){if(n.g){Zr(n);const t=n.g,r=n.C[0]?Xe:null;n.g=null,n.C=null,e||xt(n,"ready");try{t.onreadystatechange=r}catch{}}}function Zr(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(ee.clearTimeout(n.A),n.A=null)}function Zn(n){return n.g?n.g.readyState:0}function jo(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case Vs:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function qo(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=function Go(n){let e="";return En(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Ye(n,e,t))}function Wr(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function Qa(n){this.za=0,this.l=[],this.h=new Ao,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Wr("failFast",!1,n),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Wr("baseRetryDelayMs",5e3,n),this.$a=Wr("retryDelaySeedMs",1e4,n),this.Ya=Wr("forwardChannelMaxRetries",2,n),this.ra=Wr("forwardChannelRequestTimeoutMs",2e4,n),this.qa=n&&n.xmlHttpFactory||void 0,this.Ba=n&&n.Yb||!1,this.K=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.J="",this.i=new Wi(n&&n.concurrentRequestLimit),this.Ca=new Fo,this.ja=n&&n.fastHandshake||!1,this.Ra=n&&n.Wb||!1,n&&n.Aa&&this.h.Aa(),n&&n.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&n&&n.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!n||!1!==n.Xb}function Yu(n){if(Ko(n),3==n.G){var e=n.V++,t=fn(n.F);Ye(t,"SID",n.J),Ye(t,"RID",e),Ye(t,"TYPE","terminate"),Gs(n,t),(e=new Vr(n,n.h,e,void 0)).K=2,e.v=pi(fn(t)),t=!1,ee.navigator&&ee.navigator.sendBeacon&&(t=ee.navigator.sendBeacon(e.v.toString(),"")),!t&&ee.Image&&((new Image).src=e.v,t=!0),t||(e.g=Wo(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Vt(e)}eu(n)}function Ya(n){n.g&&(At(n),n.g.cancel(),n.g=null)}function Ko(n){Ya(n),n.u&&(ee.clearTimeout(n.u),n.u=null),Ks(n),n.i.cancel(),n.m&&("number"==typeof n.m&&ee.clearTimeout(n.m),n.m=null)}function Ju(n,e){n.l.push(new class{constructor(n,e){this.h=n,this.g=e}}(n.Za++,e)),3==n.G&&Ja(n)}function Ja(n){Ps(n.i)||n.m||(n.m=!0,Mi(n.Ha,n),n.C=0)}function Xu(n,e){var t;t=e?e.m:n.V++;const r=fn(n.F);Ye(r,"SID",n.J),Ye(r,"RID",t),Ye(r,"AID",n.U),Gs(n,r),n.o&&n.s&&qo(r,n.o,n.s),t=new Vr(n,n.h,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.l=e.D.concat(n.l)),e=qs(n,t,1e3),t.setTimeout(Math.round(.5*n.ra)+Math.round(.5*n.ra*Math.random())),Ls(n.i,t),xs(t,r,e)}function Gs(n,e){n.j&&Bi({},function(t,r){Ye(e,r,t)})}function qs(n,e,t){t=Math.min(n.l.length,t);var r=n.j?Ge(n.j.Oa,n.j,n):null;e:{var i=n.l;let s=-1;for(;;){const u=["count="+t];-1==s?0<t?(s=i[0].h,u.push("ofs="+s)):s=0:u.push("ofs="+s);let h=!0;for(let f=0;f<t;f++){let m=i[f].h;const v=i[f].g;if(m-=s,0>m)s=Math.max(0,i[f].h-100),h=!1;else try{Ha(v,u,"req"+m+"_")}catch{r&&r(v)}}if(h){r=u.join("&");break e}}}return n=n.l.splice(0,t),e.D=n,r}function Er(n){n.g||n.u||(n.Y=1,Mi(n.Ga,n),n.A=0)}function gi(n){return!(n.g||n.u||3<=n.A||(n.Y++,n.u=dn(Ge(n.Ga,n),zs(n,n.A)),n.A++,0))}function At(n){null!=n.B&&(ee.clearTimeout(n.B),n.B=null)}function Zo(n){n.g=new Vr(n,n.h,"rpc",n.Y),null===n.o&&(n.g.H=n.s),n.g.O=0;var e=fn(n.oa);Ye(e,"RID","rpc"),Ye(e,"SID",n.J),Ye(e,"CI",n.N?"0":"1"),Ye(e,"AID",n.U),Gs(n,e),Ye(e,"TYPE","xmlhttp"),n.o&&n.s&&qo(e,n.o,n.s),n.K&&n.g.setTimeout(n.K);var t=n.g;n=n.la,t.K=1,t.v=pi(fn(e)),t.s=null,t.U=!0,Co(t,n)}function Ks(n){null!=n.v&&(ee.clearTimeout(n.v),n.v=null)}function Xa(n,e){var t=null;if(n.g==e){Ks(n),At(n),n.g=null;var r=2}else{if(!Hi(n.i,e))return;t=e.D,Fs(n.i,e),r=1}if(n.I=e.N,0!=n.G)if(e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;xt(r=ci(),new Fi(r,t,e,i)),Ja(n)}else Er(n);else if(3==(i=e.o)||0==i&&0<n.I||!(1==r&&function zo(n,e){return!(Ms(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.l=e.D.concat(n.l),0):1==n.G||2==n.G||n.C>=(n.Xa?0:n.Ya)||(n.m=dn(Ge(n.Ha,n,e),zs(n,n.C)),n.C++,0)))}(n,e)||2==r&&gi(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:kn(n,5);break;case 4:kn(n,10);break;case 3:kn(n,6);break;default:kn(n,2)}}function zs(n,e){let t=n.Pa+Math.floor(Math.random()*n.$a);return n.j||(t*=2),t*e}function kn(n,e){if(n.h.info("Error code "+e),2==e){var t=null;n.j&&(t=null);var r=Ge(n.jb,n);t||(t=new Kn("//www.google.com/images/cleardot.gif"),ee.location&&"http"==ee.location.protocol||ar(t,"https"),pi(t)),function Hu(n,e){const t=new Ao;if(ee.Image){const r=new Image;r.onload=Jt(wr,t,r,"TestLoadImage: loaded",!0,e),r.onerror=Jt(wr,t,r,"TestLoadImage: error",!1,e),r.onabort=Jt(wr,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=Jt(wr,t,r,"TestLoadImage: timeout",!1,e),ee.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else Pt(2);n.G=0,n.j&&n.j.va(e),eu(n),Ko(n)}function eu(n){n.G=0,n.I=-1,n.j&&((0!=Wa(n.i).length||0!=n.l.length)&&(n.i.i.length=0,tr(n.l),n.l.length=0),n.j.ua())}function Hr(n,e,t){let r=function It(n){return n instanceof Kn?fn(n):new Kn(n,void 0)}(t);if(""!=r.i)e&&_r(r,e+"."+r.i),ji(r,r.m);else{const i=ee.location;r=function No(n,e,t,r){var i=new Kn(null,void 0);return n&&ar(i,n),e&&_r(i,e),t&&ji(i,t),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,t)}return n.aa&&En(n.aa,function(i,s){Ye(r,s,i)}),t=n.sa,(e=n.D)&&t&&Ye(r,e,t),Ye(r,"VER",n.ma),Gs(n,r),r}function Wo(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new dt(t&&n.Ba&&!n.qa?new Qi({ib:!0}):n.qa)).L=n.H,e}function tu(){}function Zs(){if(nn&&!(10<=Number(S)))throw Error("Environmental error: no available transport.")}function pn(n,e){Le.call(this),this.g=new Qa(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.P=n,(n=e&&e.httpHeadersOverwriteParam)&&!nr(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!nr(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new es(this)}function gn(n){za.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function Xi(){Ui.call(this),this.status=1}function es(n){this.g=n}(V=dt.prototype).ea=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Ur.g(),this.C=function Ka(n){return n.h||(n.h=n.i())}(this.u?this.u:Ur),this.g.onreadystatechange=Ge(this.Fa,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(s){return void Bs(this,s)}n=t||"";const i=new or(this.headers);r&&Bi(r,function(s,u){i.set(u,s)}),r=function Ft(n){e:{var e=Qu;const t=n.length,r="string"==typeof n?n.split(""):n;for(let i=0;i<t;i++)if(i in r&&e.call(void 0,r[i],i,n)){e=i;break e}e=-1}return 0>e?null:"string"==typeof n?n.charAt(e):n[e]}(i.T()),t=ee.FormData&&n instanceof ee.FormData,!(0<=Nr(Bo,e))||r||t||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(s,u){this.g.setRequestHeader(u,s)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Zr(this),0<this.B&&((this.K=function $o(n){return nn&&function b(){return function Rr(n){var e=k;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=vn(String(ir)).split("."),t=vn("9").split("."),r=Math.max(e.length,t.length);for(let u=0;0==n&&u<r;u++){var i=e[u]||"",s=t[u]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==i[0].length&&0==s[0].length)break;n=rr(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||rr(0==i[2].length,0==s[2].length)||rr(i[2],s[2]),i=i[3],s=s[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ge(this.pa,this)):this.A=Lr(this.pa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){Bs(this,s)}},V.pa=function(){typeof Ze<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,xt(this,"timeout"),this.abort(8))},V.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,xt(this,"complete"),xt(this,"abort"),js(this))},V.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),js(this,!0)),dt.Z.M.call(this)},V.Fa=function(){this.s||(this.F||this.v||this.l?Ji(this):this.cb())},V.cb=function(){Ji(this)},V.ba=function(){try{return 2<Zn(this)?this.g.status:-1}catch{return-1}},V.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}},V.Qa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Uo(e)}},V.Da=function(){return this.m},V.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(V=Qa.prototype).ma=8,V.G=1,V.hb=function(n){try{this.h.info("Origin Trials invoked: "+n)}catch{}},V.Ha=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.V=Math.floor(1e5*Math.random()),n=this.V++;const i=new Vr(this,this.h,n,void 0);let s=this.s;if(this.P&&(s?(s=Tn(s),$n(s,this.P)):s=this.P),null===this.o&&(i.H=s),this.ja)e:{for(var e=0,t=0;t<this.l.length;t++){var r=this.l[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.l.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=qs(this,i,e),Ye(t=fn(this.F),"RID",n),Ye(t,"CVER",22),this.D&&Ye(t,"X-HTTP-Session-Id",this.D),Gs(this,t),this.o&&s&&qo(t,this.o,s),Ls(this.i,i),this.Ra&&Ye(t,"TYPE","init"),this.ja?(Ye(t,"$req",e),Ye(t,"SID","null"),i.$=!0,xs(i,t,null)):xs(i,t,e),this.G=2}}else 3==this.G&&(n?Xu(this,n):0==this.l.length||Ps(this.i)||Xu(this))},V.Ga=function(){if(this.u=null,Zo(this),this.$&&!(this.L||null==this.g||0>=this.O)){var n=2*this.O;this.h.info("BP detection timer enabled: "+n),this.B=dn(Ge(this.bb,this),n)}},V.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Pt(10),Ya(this),Zo(this))},V.ab=function(){null!=this.v&&(this.v=null,Ya(this),gi(this),Pt(19))},V.jb=function(n){n?(this.h.info("Successfully pinged google.com"),Pt(2)):(this.h.info("Failed to ping google.com"),Pt(1))},(V=tu.prototype).xa=function(){},V.wa=function(){},V.va=function(){},V.ua=function(){},V.Oa=function(){},Zs.prototype.g=function(n,e){return new pn(n,e)},gt(pn,Le),pn.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;n.Wa&&(n.h.info("Origin Trials enabled."),Mi(Ge(n.hb,n,e))),Pt(0),n.W=e,n.aa=t||{},n.N=n.X,n.F=Hr(n,null,n.W),Ja(n)},pn.prototype.close=function(){Yu(this.g)},pn.prototype.u=function(n){if("string"==typeof n){var e={};e.__data__=n,Ju(this.g,e)}else this.v?((e={}).__data__=si(n),Ju(this.g,e)):Ju(this.g,n)},pn.prototype.M=function(){this.g.j=null,delete this.j,Yu(this.g),delete this.g,pn.Z.M.call(this)},gt(gn,za),gt(Xi,Ui),gt(es,tu),es.prototype.xa=function(){xt(this.g,"a")},es.prototype.wa=function(n){xt(this.g,new gn(n))},es.prototype.va=function(n){xt(this.g,new Xi(n))},es.prototype.ua=function(){xt(this.g,"b")},Zs.prototype.createWebChannel=Zs.prototype.g,pn.prototype.send=pn.prototype.u,pn.prototype.open=pn.prototype.m,pn.prototype.close=pn.prototype.close,bs.NO_ERROR=0,bs.TIMEOUT=8,bs.HTTP_ERROR=6,As.COMPLETE="complete",Ss.EventType=Cn,Cn.OPEN="a",Cn.CLOSE="b",Cn.ERROR="c",Cn.MESSAGE="d",Le.prototype.listen=Le.prototype.N,dt.prototype.listenOnce=dt.prototype.O,dt.prototype.getLastError=dt.prototype.La,dt.prototype.getLastErrorCode=dt.prototype.Da,dt.prototype.getStatus=dt.prototype.ba,dt.prototype.getResponseJson=dt.prototype.Qa,dt.prototype.getResponseText=dt.prototype.ga,dt.prototype.send=dt.prototype.ea;var Tr=Z.createWebChannelTransport=function(){return new Zs},nu=Z.getStatEventTarget=function(){return ci()},Ho=Z.ErrorCode=bs,ts=Z.EventType=As,Qo=Z.Event=xn,wt=Z.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Yo=Z.FetchXmlHttpFactory=Qi,Qr=Z.WebChannel=Ss,Jo=Z.XhrIo=dt;const Ws="@firebase/firestore";class Ct{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ct.UNAUTHENTICATED=new Ct(null),Ct.GOOGLE_CREDENTIALS=new Ct("google-credentials-uid"),Ct.FIRST_PARTY=new Ct("first-party-uid"),Ct.MOCK_USER=new Ct("mock-user");let mi="9.9.2";const Dn=new Pe.Yd("@firebase/firestore");function Xo(){return Dn.logLevel}function W(n,...e){if(Dn.logLevel<=Pe.in.DEBUG){const t=e.map(ns);Dn.debug(`Firestore (${mi}): ${n}`,...t)}}function Je(n,...e){if(Dn.logLevel<=Pe.in.ERROR){const t=e.map(ns);Dn.error(`Firestore (${mi}): ${n}`,...t)}}function Wn(n,...e){if(Dn.logLevel<=Pe.in.WARN){const t=e.map(ns);Dn.warn(`Firestore (${mi}): ${n}`,...t)}}function ns(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function ae(n="Unexpected state"){const e=`FIRESTORE (${mi}) INTERNAL ASSERTION FAILED: `+n;throw Je(e),new Error(e)}function Ie(n,e){n||ae()}function te(n,e){return n}const L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class K extends Y.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class St{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class ru{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iu{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ct.UNAUTHENTICATED))}shutdown(){}}class _i{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class ta{constructor(e){this.t=e,this.currentUser=Ct.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const s=m=>this.i!==i?(i=this.i,t(m)):Promise.resolve();let u=new St;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new St,e.enqueueRetryable(()=>s(this.currentUser))};const h=()=>{const m=u;e.enqueueRetryable((0,R.Z)(function*(){yield m.promise,yield s(r.currentUser)}))},f=m=>{W("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(m=>f(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new St)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ie("string"==typeof r.accessToken),new ru(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Ie(null===e||"string"==typeof e),new Ct(e)}}class ec{constructor(e,t,r){this.type="FirstParty",this.user=Ct.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const i=e.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class cr{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new ec(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(Ct.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rs{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class su{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,t){const r=s=>{null!=s.error&&W("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const u=s.token!==this.p;return this.p=s.token,W("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{W("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.g.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.g.getImmediate({optional:!0});s?i(s):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ie("string"==typeof t.token),this.p=t.token,new rs(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function na(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class ra{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=na(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function _e(n,e){return n<e?-1:n>e?1:0}function Nn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function tc(n){return n+"\0"}class st{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new K(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new K(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new K(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return st.fromMillis(Date.now())}static fromDate(e){return st.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new st(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?_e(this.nanoseconds,e.nanoseconds):_e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class be{constructor(e){this.timestamp=e}static fromTimestamp(e){return new be(e)}static min(){return new be(new st(0,0))}static max(){return new be(new st(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class vi{constructor(e,t,r){void 0===t?t=0:t>e.length&&ae(),void 0===r?r=e.length-t:r>e.length-t&&ae(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===vi.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof vi?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),u=t.get(i);if(s<u)return-1;if(s>u)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ue extends vi{construct(e,t,r){return new Ue(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new K(L.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new Ue(t)}static emptyPath(){return new Ue([])}}const nc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ot extends vi{construct(e,t,r){return new ot(e,t,r)}static isValidIdentifier(e){return nc.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ot.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ot(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(0===r.length)throw new K(L.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let u=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new K(L.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if("\\"!==f&&"."!==f&&"`"!==f)throw new K(L.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,i+=2}else"`"===h?(u=!u,i++):"."!==h||u?(r+=h,i++):(s(),i++)}if(s(),u)throw new K(L.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ot(t)}static emptyPath(){return new ot([])}}class ne{constructor(e){this.path=e}static fromPath(e){return new ne(Ue.fromString(e))}static fromName(e){return new ne(Ue.fromString(e).popFirst(5))}static empty(){return new ne(Ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ue.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ue.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ne(new Ue(e.slice()))}}class ia{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function sa(n){return n.fields.find(e=>2===e.kind)}function Ii(n){return n.fields.filter(e=>2!==e.kind)}ia.UNKNOWN_ID=-1;class Qs{constructor(e,t){this.fieldPath=e,this.kind=t}}class wi{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new wi(0,Zt.min())}}function is(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=be.fromTimestamp(1e9===r?new st(t+1,0):new st(t,r));return new Zt(i,ne.empty(),e)}function au(n){return new Zt(n.readTime,n.key,-1)}class Zt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Zt(be.min(),ne.empty(),-1)}static max(){return new Zt(be.max(),ne.empty(),-1)}}function oa(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=ne.comparator(n.documentKey,e.documentKey),0!==t?t:_e(n.largestBatchId,e.largestBatchId))}const Ys="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ss{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Hn(n){return uu.apply(this,arguments)}function uu(){return uu=(0,R.Z)(function*(n){if(n.code!==L.FAILED_PRECONDITION||n.message!==Ys)throw n;W("LocalStore","Unexpectedly lost primary lease")}),uu.apply(this,arguments)}class P{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new P((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof P?t:P.resolve(t)}catch(t){return P.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):P.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):P.reject(t)}static resolve(e){return new P((t,r)=>{t(e)})}static reject(e){return new P((t,r)=>{r(e)})}static waitFor(e){return new P((t,r)=>{let i=0,s=0,u=!1;e.forEach(h=>{++i,h.next(()=>{++s,u&&s===i&&t()},f=>r(f))}),u=!0,s===i&&t()})}static or(e){let t=P.resolve(!1);for(const r of e)t=t.next(i=>i?P.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new P((r,i)=>{const s=e.length,u=new Array(s);let h=0;for(let f=0;f<s;f++){const m=f;t(e[m]).next(v=>{u[m]=v,++h,h===s&&r(u)},v=>i(v))}})}static doWhile(e,t){return new P((r,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):r()};s()})}}class br{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.T=new St,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{t.error?this.T.reject(new os(e,t.error)):this.T.resolve()},this.transaction.onerror=r=>{const i=us(r.target.error);this.T.reject(new os(e,i))}}static open(e,t,r,i){try{return new br(t,e.transaction(i,r))}catch(s){throw new os(t,s)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(W("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new ua(t)}}class Mt{constructor(e,t,r){this.name=e,this.version=t,this.P=r,12.2===Mt.v((0,Y.z$)())&&Je("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return W("SimpleDb","Removing database:",e),Rn(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!(0,Y.hl)())return!1;if(Mt.S())return!0;const e=(0,Y.z$)(),t=Mt.v(e),r=0<t&&t<10,i=Mt.D(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static S(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.C)}static N(e,t){return e.store(t)}static v(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static D(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}k(e){var t=this;return(0,R.Z)(function*(){return t.db||(W("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=u=>{r(u.target.result)},s.onblocked=()=>{i(new os(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=u=>{const h=u.target.error;i("VersionError"===h.name?new K(L.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new K(L.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new os(e,h))},s.onupgradeneeded=u=>{W("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',u.oldVersion),t.P.M(u.target.result,s.transaction,u.oldVersion,t.version).next(()=>{W("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.O&&(t.db.onversionchange=r=>t.O(r)),t.db})()}F(e){this.O=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var s=this;return(0,R.Z)(function*(){const u="readonly"===t;let h=0;for(;;){++h;try{s.db=yield s.k(e);const f=br.open(s.db,e,u?"readonly":"readwrite",r),m=i(f).next(v=>(f.R(),v)).catch(v=>(f.abort(v),P.reject(v))).toPromise();return m.catch(()=>{}),yield f.A,m}catch(f){const m=f,v="FirebaseError"!==m.name&&h<3;if(W("SimpleDb","Transaction failed with error:",m.message,"Retrying:",v),s.close(),!v)return Promise.reject(m)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class aa{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return Rn(this.$.delete())}}class os extends K{constructor(e,t){super(L.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Qn(n){return"IndexedDbTransactionError"===n.name}class ua{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(W("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(W("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Rn(r)}add(e){return W("SimpleDb","ADD",this.store.name,e,e),Rn(this.store.add(e))}get(e){return Rn(this.store.get(e)).next(t=>(void 0===t&&(t=null),W("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return W("SimpleDb","DELETE",this.store.name,e),Rn(this.store.delete(e))}count(){return W("SimpleDb","COUNT",this.store.name),Rn(this.store.count())}K(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.G(i,(u,h)=>{s.push(h)}).next(()=>s)}{const i=this.store.getAll(r.range);return new P((s,u)=>{i.onerror=h=>{u(h.target.error)},i.onsuccess=h=>{s(h.target.result)}})}}j(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new P((i,s)=>{r.onerror=u=>{s(u.target.error)},r.onsuccess=u=>{i(u.target.result)}})}W(e,t){W("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const i=this.cursor(r);return this.G(i,(s,u,h)=>h.delete())}J(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Y(e){const t=this.cursor({});return new P((r,i)=>{t.onerror=s=>{const u=us(s.target.error);i(u)},t.onsuccess=s=>{const u=s.target.result;u?e(u.primaryKey,u.value).next(h=>{h?u.continue():r()}):r()}})}G(e,t){const r=[];return new P((i,s)=>{e.onerror=u=>{s(u.target.error)},e.onsuccess=u=>{const h=u.target.result;if(!h)return void i();const f=new aa(h),m=t(h.primaryKey,h.value,f);if(m instanceof P){const v=m.catch(E=>(f.done(),P.reject(E)));r.push(v)}f.isDone?i():null===f.U?h.continue():h.continue(f.U)}}).next(()=>P.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Rn(n){return new P((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=us(r.target.error);t(i)}})}let as=!1;function us(n){const e=Mt.v((0,Y.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new K("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return as||(as=!0,setTimeout(()=>{throw r},0)),r}}return n}class ca{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.Z(15)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}Z(e){var t=this;W("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,R.Z)(function*(){t.task=null;try{W("IndexBackiller",`Documents written: ${yield t.X.tt()}`)}catch(r){Qn(r)?W("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Hn(r)}yield t.Z(1)}))}}class cs{constructor(e,t){this.localStore=e,this.persistence=t}tt(e=50){var t=this;return(0,R.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.et(r,e))})()}et(e,t){const r=new Set;let i=t,s=!0;return P.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(u=>{if(null!==u&&!r.has(u))return W("IndexBackiller",`Processing collection: ${u}`),this.nt(e,u,i).next(h=>{i-=h,r.add(u)});s=!1})).next(()=>t-i)}nt(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const u=s.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next(()=>this.st(i,s)).next(h=>(W("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>u.size)}))}st(e,t){let r=e;return t.changes.forEach((i,s)=>{const u=au(s);oa(u,r)>0&&(r=u)}),new Zt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class mn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.it(r),this.rt=r=>t.writeSequenceNumber(r))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}function la(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ei(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Js(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}mn.ot=-1;class at{constructor(e,t){this.comparator=e,this.root=t||pt.EMPTY}insert(e,t){return new at(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pt.BLACK,null,null))}remove(e){return new at(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new lr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new lr(this.root,e,this.comparator,!1)}getReverseIterator(){return new lr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new lr(this.root,e,this.comparator,!0)}}class lr{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pt{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??pt.RED,this.left=i??pt.EMPTY,this.right=s??pt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new pt(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return pt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return pt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ae();const e=this.left.check();if(e!==this.right.check())throw ae();return e+(this.isRed()?0:1)}}pt.EMPTY=null,pt.RED=!0,pt.BLACK=!1,pt.EMPTY=new class{constructor(){this.size=0}get key(){throw ae()}get value(){throw ae()}get color(){throw ae()}get left(){throw ae()}get right(){throw ae()}copy(n,e,t,r,i){return this}insert(n,e,t){return new pt(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class We{constructor(e){this.comparator=e,this.data=new at(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new cu(this.data.getIterator())}getIteratorFrom(e){return new cu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof We)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new We(this.comparator);return t.data=e,t}}class cu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function on(n){return n.hasNext()?n.getNext():void 0}class Wt{constructor(e){this.fields=e,e.sort(ot.comparator)}static empty(){return new Wt([])}unionWith(e){let t=new We(ot.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Wt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Nn(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class kt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new kt(t)}static fromUint8Array(e){const t=function(r){let i="";for(let s=0;s<r.length;++s)i+=String.fromCharCode(r[s]);return i}(e);return new kt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return _e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}kt.EMPTY_BYTE_STRING=new kt("");const lu=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yn(n){if(Ie(!!n),"string"==typeof n){let e=0;const t=lu.exec(n);if(Ie(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ft(n.seconds),nanos:ft(n.nanos)}}function ft(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Yr(n){return"string"==typeof n?kt.fromBase64String(n):kt.fromUint8Array(n)}function hu(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function d(n){const e=n.mapValue.fields.__previous_value__;return hu(e)?d(e):e}function p(n){const e=Yn(n.mapValue.fields.__local_write_time__.timestampValue);return new st(e.seconds,e.nanos)}class y{constructor(e,t,r,i,s,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.useFetchStreams=f}}class w{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new w("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof w&&e.projectId===this.projectId&&e.database===this.database}}function D(n){return null==n}function M(n){return 0===n&&1/n==-1/0}function q(n){return"number"==typeof n&&Number.isInteger(n)&&!M(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const J={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ge={nullValue:"NULL_VALUE"};function we(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?hu(n)?4:du(n)?9007199254740991:10:ae()}function Te(n,e){if(n===e)return!0;const t=we(n);if(t!==we(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return p(n).isEqual(p(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const s=Yn(r.timestampValue),u=Yn(i.timestampValue);return s.seconds===u.seconds&&s.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,Yr(n.bytesValue).isEqual(Yr(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return ft(r.geoPointValue.latitude)===ft(i.geoPointValue.latitude)&&ft(r.geoPointValue.longitude)===ft(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return ft(r.integerValue)===ft(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const s=ft(r.doubleValue),u=ft(i.doubleValue);return s===u?M(s)===M(u):isNaN(s)&&isNaN(u)}return!1}(n,e);case 9:return Nn(n.arrayValue.values||[],e.arrayValue.values||[],Te);case 10:return function(r,i){const s=r.mapValue.fields||{},u=i.mapValue.fields||{};if(la(s)!==la(u))return!1;for(const h in s)if(s.hasOwnProperty(h)&&(void 0===u[h]||!Te(s[h],u[h])))return!1;return!0}(n,e);default:return ae()}var i}function me(n,e){return void 0!==(n.values||[]).find(t=>Te(t,e))}function rt(n,e){if(n===e)return 0;const t=we(n),r=we(e);if(t!==r)return _e(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return _e(n.booleanValue,e.booleanValue);case 2:return function(i,s){const u=ft(i.integerValue||i.doubleValue),h=ft(s.integerValue||s.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return an(n.timestampValue,e.timestampValue);case 4:return an(p(n),p(e));case 5:return _e(n.stringValue,e.stringValue);case 6:return function(i,s){const u=Yr(i),h=Yr(s);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(i,s){const u=i.split("/"),h=s.split("/");for(let f=0;f<u.length&&f<h.length;f++){const m=_e(u[f],h[f]);if(0!==m)return m}return _e(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,s){const u=_e(ft(i.latitude),ft(s.latitude));return 0!==u?u:_e(ft(i.longitude),ft(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,s){const u=i.values||[],h=s.values||[];for(let f=0;f<u.length&&f<h.length;++f){const m=rt(u[f],h[f]);if(m)return m}return _e(u.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,s){if(i===J.mapValue&&s===J.mapValue)return 0;if(i===J.mapValue)return 1;if(s===J.mapValue)return-1;const u=i.fields||{},h=Object.keys(u),f=s.fields||{},m=Object.keys(f);h.sort(),m.sort();for(let v=0;v<h.length&&v<m.length;++v){const E=_e(h[v],m[v]);if(0!==E)return E;const O=rt(u[h[v]],f[m[v]]);if(0!==O)return O}return _e(h.length,m.length)}(n.mapValue,e.mapValue);default:throw ae()}}function an(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return _e(n,e);const t=Yn(n),r=Yn(e),i=_e(t.seconds,r.seconds);return 0!==i?i:_e(t.nanos,r.nanos)}function Jn(n){return Ar(n)}function Ar(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=Yn(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Yr(n.bytesValue).toBase64():"referenceValue"in n?ne.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",s=!0;for(const u of r.values||[])s?s=!1:i+=",",i+=Ar(u);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let s="{",u=!0;for(const h of i)u?u=!1:s+=",",s+=`${h}:${Ar(r.fields[h])}`;return s+"}"}(n.mapValue):ae();var e}function yn(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ha(n){return!!n&&"integerValue"in n}function Sr(n){return!!n&&"arrayValue"in n}function xr(n){return!!n&&"nullValue"in n}function Cr(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function dr(n){return!!n&&"mapValue"in n}function Ti(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ei(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ti(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ti(n.arrayValue.values[t]);return e}return Object.assign({},n)}function du(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function nh(n){return"nullValue"in n?ge:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?yn(w.empty(),ne.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:ae()}function rh(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?yn(w.empty(),ne.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?J:ae()}function rc(n,e){const t=rt(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Gc(n,e){const t=rt(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Dt{constructor(e){this.value=e}static empty(){return new Dt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!dr(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ti(t)}setAll(e){let t=ot.emptyPath(),r={},i=[];e.forEach((u,h)=>{if(!t.isImmediateParentOf(h)){const f=this.getFieldsMap(t);this.applyChanges(f,r,i),r={},i=[],t=h.popLast()}u?r[h.lastSegment()]=Ti(u):i.push(h.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());dr(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Te(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];dr(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Ei(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Dt(Ti(this.value))}}function qc(n){const e=[];return Ei(n.fields,(t,r)=>{const i=new ot([t]);if(dr(r)){const s=qc(r.mapValue).fields;if(0===s.length)e.push(i);else for(const u of s)e.push(i.child(u))}else e.push(i)}),new Wt(e)}class ut{constructor(e,t,r,i,s,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.data=s,this.documentState=u}static newInvalidDocument(e){return new ut(e,0,be.min(),be.min(),Dt.empty(),0)}static newFoundDocument(e,t,r){return new ut(e,1,t,be.min(),r,0)}static newNoDocument(e,t){return new ut(e,2,t,be.min(),Dt.empty(),0)}static newUnknownDocument(e,t){return new ut(e,3,t,be.min(),Dt.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ut&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ut(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ih{constructor(e,t=null,r=[],i=[],s=null,u=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=u,this.endAt=h,this.ut=null}}function Kc(n,e=null,t=[],r=[],i=null,s=null,u=null){return new ih(n,e,t,r,i,s,u)}function ls(n){const e=te(n);if(null===e.ut){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>{return(i=r).field.canonicalString()+i.op.toString()+Jn(i.value);var i}).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),D(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Jn(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Jn(r)).join(",")),e.ut=t}return e.ut}function da(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<n.orderBy.length;i++)if(!hh(n.orderBy[i],e.orderBy[i]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let i=0;i<n.filters.length;i++)if((t=n.filters[i]).op!==(r=e.filters[i]).op||!t.field.isEqual(r.field)||!Te(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Qc(n.startAt,e.startAt)&&Qc(n.endAt,e.endAt)}function fu(n){return ne.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function Xs(n,e){return n.filters.filter(t=>t instanceof Ht&&t.field.isEqual(e))}function zc(n,e,t){let r=ge,i=!0;for(const s of Xs(n,e)){let u=ge,h=!0;switch(s.op){case"<":case"<=":u=nh(s.value);break;case"==":case"in":case">=":u=s.value;break;case">":u=s.value,h=!1;break;case"!=":case"not-in":u=ge}rc({value:r,inclusive:i},{value:u,inclusive:h})<0&&(r=u,i=h)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const u=t.position[s];rc({value:r,inclusive:i},{value:u,inclusive:t.inclusive})<0&&(r=u,i=t.inclusive);break}return{value:r,inclusive:i}}function Zc(n,e,t){let r=J,i=!0;for(const s of Xs(n,e)){let u=J,h=!0;switch(s.op){case">=":case">":u=rh(s.value),h=!1;break;case"==":case"in":case"<=":u=s.value;break;case"<":u=s.value,h=!1;break;case"!=":case"not-in":u=J}Gc({value:r,inclusive:i},{value:u,inclusive:h})>0&&(r=u,i=h)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const u=t.position[s];Gc({value:r,inclusive:i},{value:u,inclusive:t.inclusive})>0&&(r=u,i=t.inclusive);break}return{value:r,inclusive:i}}class Ht extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new oh(e,t,r):"array-contains"===t?new uh(e,r):"in"===t?new ch(e,r):"not-in"===t?new lh(e,r):"array-contains-any"===t?new ic(e,r):new Ht(e,t,r)}static ct(e,t,r){return"in"===t?new ah(e,r):new Wc(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(rt(t,this.value)):null!==t&&we(this.value)===we(t)&&this.at(rt(t,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ae()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class oh extends Ht{constructor(e,t,r){super(e,t,r),this.key=ne.fromName(r.referenceValue)}matches(e){const t=ne.comparator(e.key,this.key);return this.at(t)}}class ah extends Ht{constructor(e,t){super(e,"in",t),this.keys=Hc(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Wc extends Ht{constructor(e,t){super(e,"not-in",t),this.keys=Hc(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Hc(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>ne.fromName(r.referenceValue))}class uh extends Ht{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Sr(t)&&me(t.arrayValue,this.value)}}class ch extends Ht{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&me(this.value.arrayValue,t)}}class lh extends Ht{constructor(e,t){super(e,"not-in",t)}matches(e){if(me(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!me(this.value.arrayValue,t)}}class ic extends Ht{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Sr(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>me(this.value.arrayValue,r))}}class bi{constructor(e,t){this.position=e,this.inclusive=t}}class Ai{constructor(e,t="asc"){this.field=e,this.dir=t}}function hh(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function sc(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],u=n.position[i];if(r=s.field.isKeyField()?ne.comparator(ne.fromName(u.referenceValue),t.key):rt(u,t.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Qc(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Te(n.position[t],e.position[t]))return!1;return!0}class fr{constructor(e,t=null,r=[],i=[],s=null,u="F",h=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=u,this.startAt=h,this.endAt=f,this.lt=null,this.ft=null}}function Yc(n,e,t,r,i,s,u,h){return new fr(n,e,t,r,i,s,u,h)}function hs(n){return new fr(n)}function oc(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function ac(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function uc(n){for(const e of n.filters)if(e.ht())return e.field;return null}function cc(n){return null!==n.collectionGroup}function fa(n){const e=te(n);if(null===e.lt){e.lt=[];const t=uc(e),r=ac(e);if(null!==t&&null===r)t.isKeyField()||e.lt.push(new Ai(t)),e.lt.push(new Ai(ot.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.lt.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new Ai(ot.keyField(),s))}}}return e.lt}function Nt(n){const e=te(n);if(!e.ft)if("F"===e.limitType)e.ft=Kc(e.path,e.collectionGroup,fa(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of fa(e))t.push(new Ai(s.field,"desc"===s.dir?"asc":"desc"));const r=e.endAt?new bi(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new bi(e.startAt.position,e.startAt.inclusive):null;e.ft=Kc(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.ft}function pu(n,e,t){return new fr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function pa(n,e){return da(Nt(n),Nt(e))&&n.limitType===e.limitType}function gu(n){return`${ls(Nt(n))}|lt:${n.limitType}`}function lc(n){return`Query(target=${function sh(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${Jn(r.value)}`;var r}).join(", ")}]`),D(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(r=t).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>Jn(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>Jn(t)).join(",")),`Target(${e})`}(Nt(n))}; limitType=${n.limitType})`}function ga(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):ne.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of t.explicitOrderBy)if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,s,u){const h=sc(i,s,u);return i.inclusive?h<=0:h<0}(t.startAt,fa(t),r)||t.endAt&&!function(i,s,u){const h=sc(i,s,u);return i.inclusive?h>=0:h>0}(t.endAt,fa(t),r)));var t,r}function Jc(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Xc(n){return(e,t)=>{let r=!1;for(const i of fa(n)){const s=hc(i,e,t);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function hc(n,e,t){const r=n.field.isKeyField()?ne.comparator(e.key,t.key):function(i,s,u){const h=s.data.field(i),f=u.data.field(i);return null!==h&&null!==f?rt(h,f):ae()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ae()}}function el(n,e){if(n.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:M(e)?"-0":e}}function tl(n){return{integerValue:""+n}}function mu(n,e){return q(e)?tl(e):el(n,e)}class yu{constructor(){this._=void 0}}function dh(n,e,t){return n instanceof eo?function(r,i){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(s.fields.__previous_value__=i),{mapValue:s}}(t,e):n instanceof Si?_u(n,e):n instanceof ds?rl(n,e):function(r,i){const s=nl(r,i),u=vu(s)+vu(r._t);return ha(s)&&ha(r._t)?tl(u):el(r.wt,u)}(n,e)}function fh(n,e,t){return n instanceof Si?_u(n,e):n instanceof ds?rl(n,e):t}function nl(n,e){return n instanceof xi?ha(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class eo extends yu{}class Si extends yu{constructor(e){super(),this.elements=e}}function _u(n,e){const t=il(e);for(const r of n.elements)t.some(i=>Te(i,r))||t.push(r);return{arrayValue:{values:t}}}class ds extends yu{constructor(e){super(),this.elements=e}}function rl(n,e){let t=il(e);for(const r of n.elements)t=t.filter(i=>!Te(i,r));return{arrayValue:{values:t}}}class xi extends yu{constructor(e,t){super(),this.wt=e,this._t=t}}function vu(n){return ft(n.integerValue||n.doubleValue)}function il(n){return Sr(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class ma{constructor(e,t){this.field=e,this.transform=t}}class ph{constructor(e,t){this.version=e,this.transformResults=t}}class mt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new mt}static exists(e){return new mt(void 0,e)}static updateTime(e){return new mt(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wu(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class ya{}function sl(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new ro(n.key,mt.none()):new no(n.key,n.data,mt.none());{const t=n.data,r=Dt.empty();let i=new We(ot.comparator);for(let s of e.fields)if(!i.has(s)){let u=t.field(s);null===u&&s.length>1&&(s=s.popLast(),u=t.field(s)),null===u?r.delete(s):r.set(s,u),i=i.add(s)}return new kr(n.key,r,new Wt(i.toArray()),mt.none())}}function gh(n,e,t){n instanceof no?function(r,i,s){const u=r.value.clone(),h=al(r.fieldTransforms,i,s.transformResults);u.setAll(h),i.convertToFoundDocument(s.version,u).setHasCommittedMutations()}(n,e,t):n instanceof kr?function(r,i,s){if(!wu(r.precondition,i))return void i.convertToUnknownDocument(s.version);const u=al(r.fieldTransforms,i,s.transformResults),h=i.data;h.setAll(ol(r)),h.setAll(u),i.convertToFoundDocument(s.version,h).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function _a(n,e,t,r){return n instanceof no?function(i,s,u,h){if(!wu(i.precondition,s))return u;const f=i.value.clone(),m=ul(i.fieldTransforms,h,s);return f.setAll(m),s.convertToFoundDocument(s.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof kr?function(i,s,u,h){if(!wu(i.precondition,s))return u;const f=ul(i.fieldTransforms,h,s),m=s.data;return m.setAll(ol(i)),m.setAll(f),s.convertToFoundDocument(s.version,m).setHasLocalMutations(),null===u?null:u.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(v=>v.field))}(n,e,t,r):(u=t,wu(n.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):u);var s,u}function mh(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=nl(r.transform,i||null);null!=s&&(null===t&&(t=Dt.empty()),t.set(r.field,s))}return t||null}function to(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&Nn(t,r,(i,s)=>function Iu(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof Si&&r instanceof Si||t instanceof ds&&r instanceof ds?Nn(t.elements,r.elements,Te):t instanceof xi&&r instanceof xi?Te(t._t,r._t):t instanceof eo&&r instanceof eo);var t,r}(i,s))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class no extends ya{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class kr extends ya{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function ol(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function al(n,e,t){const r=new Map;Ie(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],u=s.transform,h=e.data.field(s.field);r.set(s.field,fh(u,h,t[i]))}return r}function ul(n,e,t){const r=new Map;for(const i of n){const s=i.transform,u=t.data.field(i.field);r.set(i.field,dh(s,u,e))}return r}class ro extends ya{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Eu extends ya{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class dc{constructor(e){this.count=e}}var Et,$e;function cl(n){switch(n){default:return ae();case L.CANCELLED:case L.UNKNOWN:case L.DEADLINE_EXCEEDED:case L.RESOURCE_EXHAUSTED:case L.INTERNAL:case L.UNAVAILABLE:case L.UNAUTHENTICATED:return!1;case L.INVALID_ARGUMENT:case L.NOT_FOUND:case L.ALREADY_EXISTS:case L.PERMISSION_DENIED:case L.FAILED_PRECONDITION:case L.ABORTED:case L.OUT_OF_RANGE:case L.UNIMPLEMENTED:case L.DATA_LOSS:return!0}}function Tu(n){if(void 0===n)return Je("GRPC error has no .code"),L.UNKNOWN;switch(n){case Et.OK:return L.OK;case Et.CANCELLED:return L.CANCELLED;case Et.UNKNOWN:return L.UNKNOWN;case Et.DEADLINE_EXCEEDED:return L.DEADLINE_EXCEEDED;case Et.RESOURCE_EXHAUSTED:return L.RESOURCE_EXHAUSTED;case Et.INTERNAL:return L.INTERNAL;case Et.UNAVAILABLE:return L.UNAVAILABLE;case Et.UNAUTHENTICATED:return L.UNAUTHENTICATED;case Et.INVALID_ARGUMENT:return L.INVALID_ARGUMENT;case Et.NOT_FOUND:return L.NOT_FOUND;case Et.ALREADY_EXISTS:return L.ALREADY_EXISTS;case Et.PERMISSION_DENIED:return L.PERMISSION_DENIED;case Et.FAILED_PRECONDITION:return L.FAILED_PRECONDITION;case Et.ABORTED:return L.ABORTED;case Et.OUT_OF_RANGE:return L.OUT_OF_RANGE;case Et.UNIMPLEMENTED:return L.UNIMPLEMENTED;case Et.DATA_LOSS:return L.DATA_LOSS;default:return ae()}}($e=Et||(Et={}))[$e.OK=0]="OK",$e[$e.CANCELLED=1]="CANCELLED",$e[$e.UNKNOWN=2]="UNKNOWN",$e[$e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$e[$e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$e[$e.NOT_FOUND=5]="NOT_FOUND",$e[$e.ALREADY_EXISTS=6]="ALREADY_EXISTS",$e[$e.PERMISSION_DENIED=7]="PERMISSION_DENIED",$e[$e.UNAUTHENTICATED=16]="UNAUTHENTICATED",$e[$e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$e[$e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$e[$e.ABORTED=10]="ABORTED",$e[$e.OUT_OF_RANGE=11]="OUT_OF_RANGE",$e[$e.UNIMPLEMENTED=12]="UNIMPLEMENTED",$e[$e.INTERNAL=13]="INTERNAL",$e[$e.UNAVAILABLE=14]="UNAVAILABLE",$e[$e.DATA_LOSS=15]="DATA_LOSS";class Ci{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ei(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return Js(this.inner)}size(){return this.innerSize}}const On=new at(ne.comparator);function Bt(){return On}const fc=new at(ne.comparator);function va(...n){let e=fc;for(const t of n)e=e.insert(t.key,t);return e}function bu(n){let e=fc;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Xn(){return io()}function ll(){return io()}function io(){return new Ci(n=>n.toString(),(n,e)=>n.isEqual(e))}const yh=new at(ne.comparator),ki=new We(ne.comparator);function Ne(...n){let e=ki;for(const t of n)e=e.add(t);return e}const _h=new We(_e);function Au(){return _h}class Ia{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t){const r=new Map;return r.set(e,so.createSynthesizedTargetChangeForCurrentChange(e,t)),new Ia(be.min(),r,Au(),Bt(),Ne())}}class so{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t){return new so(kt.EMPTY_BYTE_STRING,t,Ne(),Ne(),Ne())}}class Qt{constructor(e,t,r,i){this.gt=e,this.removedTargetIds=t,this.key=r,this.yt=i}}class Su{constructor(e,t){this.targetId=e,this.It=t}}class xu{constructor(e,t,r=kt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class hl{constructor(){this.Tt=0,this.Et=pc(),this.At=kt.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return 0!==this.Tt}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=Ne(),t=Ne(),r=Ne();return this.Et.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ae()}}),new so(this.At,this.Rt,e,t,r)}Dt(){this.bt=!1,this.Et=pc()}Ct(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Mt(){this.bt=!0,this.Rt=!0}}class Jr{constructor(e){this.Ot=e,this.Ft=new Map,this.$t=Bt(),this.Bt=oo(),this.Lt=new We(_e)}Ut(e){for(const t of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(t,e.yt):this.Kt(t,e.key,e.yt);for(const t of e.removedTargetIds)this.Kt(t,e.key,e.yt)}Gt(e){this.forEachTarget(e,t=>{const r=this.Qt(t);switch(e.state){case 0:this.jt(t)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||this.removeTarget(t);break;case 3:this.jt(t)&&(r.Mt(),r.Vt(e.resumeToken));break;case 4:this.jt(t)&&(this.Wt(t),r.Vt(e.resumeToken));break;default:ae()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach((r,i)=>{this.jt(i)&&t(i)})}zt(e){const t=e.targetId,r=e.It.count,i=this.Ht(t);if(i){const s=i.target;if(fu(s))if(0===r){const u=new ne(s.path);this.Kt(t,u,ut.newNoDocument(u,be.min()))}else Ie(1===r);else this.Jt(t)!==r&&(this.Wt(t),this.Lt=this.Lt.add(t))}}Yt(e){const t=new Map;this.Ft.forEach((s,u)=>{const h=this.Ht(u);if(h){if(s.current&&fu(h.target)){const f=new ne(h.target.path);null!==this.$t.get(f)||this.Xt(u,f)||this.Kt(u,f,ut.newNoDocument(f,e))}s.vt&&(t.set(u,s.St()),s.Dt())}});let r=Ne();this.Bt.forEach((s,u)=>{let h=!0;u.forEachWhile(f=>{const m=this.Ht(f);return!m||2===m.purpose||(h=!1,!1)}),h&&(r=r.add(s))}),this.$t.forEach((s,u)=>u.setReadTime(e));const i=new Ia(e,t,this.Lt,this.$t,r);return this.$t=Bt(),this.Bt=oo(),this.Lt=new We(_e),i}qt(e,t){if(!this.jt(e))return;const r=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,r),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}Kt(e,t,r){if(!this.jt(e))return;const i=this.Qt(e);this.Xt(e,t)?i.Ct(t,1):i.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),r&&(this.$t=this.$t.insert(t,r))}removeTarget(e){this.Ft.delete(e)}Jt(e){const t=this.Qt(e).St();return this.Ot.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let t=this.Ft.get(e);return t||(t=new hl,this.Ft.set(e,t)),t}Zt(e){let t=this.Bt.get(e);return t||(t=new We(_e),this.Bt=this.Bt.insert(e,t)),t}jt(e){const t=null!==this.Ht(e);return t||W("WatchChangeAggregator","Detected inactive target",e),t}Ht(e){const t=this.Ft.get(e);return t&&t.Pt?null:this.Ot.te(e)}Wt(e){this.Ft.set(e,new hl),this.Ot.getRemoteKeysForTarget(e).forEach(t=>{this.Kt(e,t,null)})}Xt(e,t){return this.Ot.getRemoteKeysForTarget(e).has(t)}}function oo(){return new at(ne.comparator)}function pc(){return new at(ne.comparator)}const dl={asc:"ASCENDING",desc:"DESCENDING"},vh={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class gc{constructor(e,t){this.databaseId=e,this.dt=t}}function wa(n,e){return n.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fl(n,e){return n.dt?e.toBase64():e.toUint8Array()}function Ih(n,e){return wa(n,e.toTimestamp())}function $t(n){return Ie(!!n),be.fromTimestamp(function(e){const t=Yn(e);return new st(t.seconds,t.nanos)}(n))}function c(n,e){return(t=n,new Ue(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function o(n){const e=Ue.fromString(n);return Ie(Cf(e)),e}function a(n,e){return c(n.databaseId,e.path)}function l(n,e){const t=o(e);if(t.get(1)!==n.databaseId.projectId)throw new K(L.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new K(L.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ne(F(t))}function g(n,e){return c(n.databaseId,e)}function _(n){const e=o(n);return 4===e.length?Ue.emptyPath():F(e)}function x(n){return new Ue(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function F(n){return Ie(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function Q(n,e,t){return{name:a(n,e),fields:t.value.mapValue.fields}}function ue(n,e,t){const r=l(n,e.name),i=$t(e.updateTime),s=new Dt({mapValue:{fields:e.fields}}),u=ut.newFoundDocument(r,i,s);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function yt(n,e){let t;if(e instanceof no)t={update:Q(n,e.key,e.value)};else if(e instanceof ro)t={delete:a(n,e.key)};else if(e instanceof kr)t={update:Q(n,e.key,e.data),updateMask:Eh(e.fieldMask)};else{if(!(e instanceof Eu))return ae();t={verify:a(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,s){const u=s.transform;if(u instanceof eo)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Si)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof ds)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof xi)return{fieldPath:s.field.canonicalString(),increment:u._t};throw ae()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:Ih(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:ae()),t;var i}function Pn(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?mt.updateTime($t(i.updateTime)):void 0!==i.exists?mt.exists(i.exists):mt.none():mt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,u){let h=null;"setToServerValue"in u?(Ie("REQUEST_TIME"===u.setToServerValue),h=new eo):"appendMissingElements"in u?h=new Si(u.appendMissingElements.values||[]):"removeAllFromArray"in u?h=new ds(u.removeAllFromArray.values||[]):"increment"in u?h=new xi(s,u.increment):ae();const f=ot.fromServerFormat(u.fieldPath);return new ma(f,h)}(n,i)):[];var i;if(e.update){const i=l(n,e.update.name),s=new Dt({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=new Wt((e.updateMask.fieldPaths||[]).map(m=>ot.fromServerFormat(m)));return new kr(i,s,u,t,r)}return new no(i,s,t,r)}if(e.delete){const i=l(n,e.delete);return new ro(i,t)}if(e.verify){const i=l(n,e.verify);return new Eu(i,t)}return ae()}function mc(n,e){return{documents:[g(n,e.path)]}}function ku(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=g(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=g(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(f){if(0===f.length)return;const m=f.map(v=>function(E){if("=="===E.op){if(Cr(E.value))return{unaryFilter:{field:Di(E.field),op:"IS_NAN"}};if(xr(E.value))return{unaryFilter:{field:Di(E.field),op:"IS_NULL"}}}else if("!="===E.op){if(Cr(E.value))return{unaryFilter:{field:Di(E.field),op:"IS_NOT_NAN"}};if(xr(E.value))return{unaryFilter:{field:Di(E.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Di(E.field),op:ml(E.op),value:E.value}}}(v));return 1===m.length?m[0]:{compositeFilter:{op:"AND",filters:m}}}(e.filters);i&&(t.structuredQuery.where=i);const s=function(f){if(0!==f.length)return f.map(m=>{return{field:Di((v=m).field),direction:gl(v.dir)};var v})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const u=(m=e.limit,n.dt||D(m)?m:{value:m});var m,h,f;return null!==u&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(t.structuredQuery.endAt={before:!(f=e.endAt).inclusive,values:f.position}),t}function yc(n){let e=_(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ie(1===r);const v=t.from[0];v.allDescendants?i=v.collectionId:e=e.child(v.collectionId)}let s=[];t.where&&(s=Du(t.where));let u=[];t.orderBy&&(u=t.orderBy.map(v=>{return new Ai(fs((E=v).field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction));var E}));let h=null;t.limit&&(h=function(v){let E;return E="object"==typeof v?v.value:v,D(E)?null:E}(t.limit));let f=null;var v;t.startAt&&(f=new bi((v=t.startAt).values||[],!!v.before));let m=null;return t.endAt&&(m=function(v){return new bi(v.values||[],!v.before)}(t.endAt)),Yc(e,i,u,s,h,"F",f,m)}function Du(n){return n?void 0!==n.unaryFilter?[_c(n)]:void 0!==n.fieldFilter?[wh(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>Du(e)).reduce((e,t)=>e.concat(t)):ae():[]}function gl(n){return dl[n]}function ml(n){return vh[n]}function Di(n){return{fieldPath:n.canonicalString()}}function fs(n){return ot.fromServerFormat(n.fieldPath)}function wh(n){return Ht.create(fs(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ae()}}(n.fieldFilter.op),n.fieldFilter.value)}function _c(n){switch(n.unaryFilter.op){case"IS_NAN":const e=fs(n.unaryFilter.field);return Ht.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=fs(n.unaryFilter.field);return Ht.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=fs(n.unaryFilter.field);return Ht.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=fs(n.unaryFilter.field);return Ht.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ae()}}function Eh(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Cf(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function Mn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=kf(e)),e=_m(n.get(t),e);return kf(e)}function _m(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function kf(n){return n+"\x01\x01"}function Ni(n){const e=n.length;if(Ie(e>=2),2===e)return Ie("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Ue.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const u=n.indexOf("\x01",s);switch((u<0||u>t)&&ae(),n.charAt(u+1)){case"\x01":const h=n.substring(s,u);let f;0===i.length?f=h:(i+=h,f=i,i=""),r.push(f);break;case"\x10":i+=n.substring(s,u),i+="\0";break;case"\x11":i+=n.substring(s,u+1);break;default:ae()}s=u+2}return new Ue(r)}const Df=["userId","batchId"];function yl(n,e){return[n,Mn(e)]}function Nf(n,e,t){return[n,Mn(e),t]}const vm={},Im=["prefixPath","collectionGroup","readTime","documentId"],wm=["prefixPath","collectionGroup","documentId"],Em=["collectionGroup","readTime","prefixPath","documentId"],Tm=["canonicalId","targetId"],bm=["targetId","path"],Am=["path","targetId"],Sm=["collectionId","parent"],xm=["indexId","uid"],Cm=["uid","sequenceNumber"],km=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Dm=["indexId","uid","orderedDocumentKey"],Nm=["userId","collectionPath","documentId"],Rm=["userId","collectionPath","largestBatchId"],Om=["userId","collectionGroup","largestBatchId"],Rf=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Pm=[...Rf,"documentOverlays"],Of=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Pf=Of,Mm=[...Pf,"indexConfiguration","indexState","indexEntries"];class Th extends ss{constructor(e,t){super(),this.ee=e,this.currentSequenceNumber=t}}function un(n,e){const t=te(n);return Mt.N(t.ee,e)}class bh{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&gh(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=_a(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=_a(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=ll();return this.mutations.forEach(i=>{const s=e.get(i.key),u=s.overlayedDocument;let h=this.applyToLocalView(u,s.mutatedFields);h=t.has(i.key)?null:h;const f=sl(u,h);null!==f&&r.set(i.key,f),u.isValidDocument()||u.convertToNoDocument(be.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ne())}isEqual(e){return this.batchId===e.batchId&&Nn(this.mutations,e.mutations,(t,r)=>to(t,r))&&Nn(this.baseMutations,e.baseMutations,(t,r)=>to(t,r))}}class Ah{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ie(e.mutations.length===r.length);let i=yh;const s=e.mutations;for(let u=0;u<s.length;u++)i=i.insert(s[u].key,r[u].version);return new Ah(e,t,r,i)}}class Sh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class ao{constructor(e,t,r,i,s=be.min(),u=be.min(),h=kt.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h}withSequenceNumber(e){return new ao(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new ao(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Mf{constructor(e){this.ne=e}}function Lf(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:_l(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:a(i=n.ne,(s=e).key),fields:s.data.value.mapValue.fields,updateTime:wa(i,s.version.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ea(e.version)};else{if(!e.isUnknownDocument())return ae();r.unknownDocument={path:t.path.toArray(),version:Ea(e.version)}}var i,s;return r}function _l(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ea(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ta(n){const e=new st(n.seconds,n.nanoseconds);return be.fromTimestamp(e)}function ba(n,e){const t=(e.baseMutations||[]).map(s=>Pn(n.ne,s));for(let s=0;s<e.mutations.length-1;++s){const u=e.mutations[s];s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(u.updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s)}const r=e.mutations.map(s=>Pn(n.ne,s)),i=st.fromMillis(e.localWriteTimeMs);return new bh(e.batchId,i,t,r)}function vc(n){const e=Ta(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Ta(n.lastLimboFreeSnapshotVersion):be.min();let r;var i;return void 0!==n.query.documents?(Ie(1===(i=n.query).documents.length),r=Nt(hs(_(i.documents[0])))):r=Nt(yc(n.query)),new ao(r,n.targetId,0,n.lastListenSequenceNumber,e,t,kt.fromBase64String(n.resumeToken))}function Ff(n,e){const t=Ea(e.snapshotVersion),r=Ea(e.lastLimboFreeSnapshotVersion);let i;i=fu(e.target)?mc(n.ne,e.target):ku(n.ne,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ls(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function xh(n){const e=yc({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?pu(e,e.limit,"L"):e}function Ch(n,e){return new Sh(e.largestBatchId,Pn(n.ne,e.overlayMutation))}function Uf(n,e){const t=e.path.lastSegment();return[n,Mn(e.path.popLast()),t]}function Vf(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Ea(r.readTime),documentKey:Mn(r.documentKey.path),largestBatchId:r.largestBatchId}}class Fm{getBundleMetadata(e,t){return Bf(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:Ta(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return Bf(e).put({bundleId:(r=t).id,createTime:Ea($t(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return $f(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:xh(i.bundledQuery),readTime:Ta(i.readTime)};var i})}saveNamedQuery(e,t){return $f(e).put({name:(r=t).name,readTime:Ea($t(r.readTime)),bundledQuery:r.bundledQuery});var r}}function Bf(n){return un(n,"bundles")}function $f(n){return un(n,"namedQueries")}class vl{constructor(e,t){this.wt=e,this.userId=t}static se(e,t){return new vl(e,t.uid||"")}getOverlay(e,t){return Ic(e).get(Uf(this.userId,t)).next(r=>r?Ch(this.wt,r):null)}getOverlays(e,t){const r=Xn();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,u)=>{const h=new Sh(t,u);i.push(this.ie(e,h))}),P.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(u=>i.add(Mn(u.getCollectionPath())));const s=[];return i.forEach(u=>{const h=IDBKeyRange.bound([this.userId,u,r],[this.userId,u,r+1],!1,!0);s.push(Ic(e).W("collectionPathOverlayIndex",h))}),P.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Xn(),s=Mn(t),u=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Ic(e).K("collectionPathOverlayIndex",u).next(h=>{for(const f of h){const m=Ch(this.wt,f);i.set(m.getKey(),m)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Xn();let u;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ic(e).J({index:"collectionGroupOverlayIndex",range:h},(f,m,v)=>{const E=Ch(this.wt,m);s.size()<i||E.largestBatchId===u?(s.set(E.getKey(),E),u=E.largestBatchId):v.done()}).next(()=>s)}ie(e,t){return Ic(e).put(function(r,i,s){const[u,h,f]=Uf(i,s.mutation.key);return{userId:i,collectionPath:h,documentId:f,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:yt(r.ne,s.mutation)}}(this.wt,this.userId,t))}}function Ic(n){return un(n,"documentOverlays")}class Aa{constructor(){}re(e,t){this.oe(e,t),t.ue()}oe(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(ft(e.integerValue));else if("doubleValue"in e){const r=ft(e.doubleValue);isNaN(r)?this.ce(t,13):(this.ce(t,15),M(r)?t.ae(0):t.ae(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he(`${r.seconds||""}`),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(Yr(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.ce(t,45),t.ae(r.latitude||0),t.ae(r.longitude||0)}else"mapValue"in e?du(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):ae()}le(e,t){this.ce(t,25),this.ge(e,t)}ge(e,t){t.he(e)}we(e,t){const r=e.fields||{};this.ce(t,55);for(const i of Object.keys(r))this.le(i,t),this.oe(r[i],t)}me(e,t){const r=e.values||[];this.ce(t,50);for(const i of r)this.oe(i,t)}_e(e,t){this.ce(t,37),ne.fromName(e).path.forEach(r=>{this.ce(t,60),this.ge(r,t)})}ce(e,t){e.ae(t)}fe(e){e.ae(2)}}function Um(n){if(0===n)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function jf(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const s=Um(255&t[i]);if(r+=s,8!==s)break}return r}(n);return Math.ceil(e/8)}Aa.ye=new Aa;class Vm{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ie(r.value),r=t.next();this.Te()}Ee(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ae(r.value),r=t.next();this.Re()}be(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ie(r);else if(r<2048)this.Ie(960|r>>>6),this.Ie(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ie(480|r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r);else{const i=t.codePointAt(0);this.Ie(240|i>>>18),this.Ie(128|63&i>>>12),this.Ie(128|63&i>>>6),this.Ie(128|63&i)}}this.Te()}Pe(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const i=t.codePointAt(0);this.Ae(240|i>>>18),this.Ae(128|63&i>>>12),this.Ae(128|63&i>>>6),this.Ae(128|63&i)}}this.Re()}ve(e){const t=this.Ve(e),r=jf(t);this.Se(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}De(e){const t=this.Ve(e),r=jf(t);this.Se(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Me(){return this.buffer.slice(0,this.position)}Ve(e){const t=function(i){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,i,!1),new Uint8Array(s.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ie(e){const t=255&e;0===t?(this.xe(0),this.xe(255)):255===t?(this.xe(255),this.xe(0)):this.xe(t)}Ae(e){const t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Bm{constructor(e){this.Oe=e}de(e){this.Oe.pe(e)}he(e){this.Oe.be(e)}ae(e){this.Oe.ve(e)}ue(){this.Oe.Ce()}}class $m{constructor(e){this.Oe=e}de(e){this.Oe.Ee(e)}he(e){this.Oe.Pe(e)}ae(e){this.Oe.De(e)}ue(){this.Oe.Ne()}}class wc{constructor(){this.Oe=new Vm,this.Fe=new Bm(this.Oe),this.$e=new $m(this.Oe)}seed(e){this.Oe.seed(e)}Be(e){return 0===e?this.Fe:this.$e}Me(){return this.Oe.Me()}reset(){this.Oe.reset()}}class Sa{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Le(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Sa(this.indexId,this.documentKey,this.arrayValue,r)}}function xa(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=Gf(n.arrayValue,e.arrayValue),0!==t?t:(t=Gf(n.directionalValue,e.directionalValue),0!==t?t:ne.comparator(n.documentKey,e.documentKey)))}function Gf(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class jm{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const t of e.filters){const r=t;r.ht()?this.Ke=r:this.qe.push(r)}}Ge(e){const t=sa(e);if(void 0!==t&&!this.Qe(t))return!1;const r=Ii(e);let i=0,s=0;for(;i<r.length&&this.Qe(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.Ke){const u=r[i];if(!this.je(this.Ke,u)||!this.We(this.Ue[s++],u))return!1;++i}for(;i<r.length;++i){const u=r[i];if(s>=this.Ue.length||!this.We(this.Ue[s++],u))return!1}return!0}Qe(e){for(const t of this.qe)if(this.je(t,e))return!0;return!1}je(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}We(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class Gm{constructor(){this.ze=new kh}addToCollectionParentIndex(e,t){return this.ze.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.ze.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(Zt.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(Zt.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}}class kh{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new We(Ue.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new We(Ue.comparator)).toArray()}}const Il=new Uint8Array(0);class qm{constructor(e,t){this.user=e,this.databaseId=t,this.He=new kh,this.Je=new Ci(r=>ls(r),(r,i)=>da(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.He.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.He.add(t)});const s={collectionId:r,parent:Mn(i)};return qf(e).put(s)}return P.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[tc(t),""],!1,!0);return qf(e).K(i).next(s=>{for(const u of s){if(u.collectionId!==t)break;r.push(Ni(u.parent))}return r})}addFieldIndex(e,t){const r=wl(e),i={indexId:(u=t).indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])};var u;delete i.indexId;const s=r.add(i);if(t.indexState){const u=Tc(e);return s.next(h=>{u.put(Vf(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=wl(e),i=Tc(e),s=Ec(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=Ec(e);let i=!0;const s=new Map;return P.forEach(this.Ye(t),u=>this.Xe(e,u).next(h=>{i&&(i=!!h),s.set(u,h)})).next(()=>{if(i){let u=Ne();const h=[];return P.forEach(s,(f,m)=>{var v;W("IndexedDbIndexManager",`Using index ${v=f,`id=${v.indexId}|cg=${v.collectionGroup}|f=${v.fields.map(Ke=>`${Ke.fieldPath}:${Ke.kind}`).join(",")}`} to execute ${ls(t)}`);const E=function(Ke,Re){const Oe=sa(Re);if(void 0===Oe)return null;for(const Ve of Xs(Ke,Oe.fieldPath))switch(Ve.op){case"array-contains-any":return Ve.value.arrayValue.values||[];case"array-contains":return[Ve.value]}return null}(m,f),O=function(Ke,Re){const Oe=new Map;for(const Ve of Ii(Re))for(const Yt of Xs(Ke,Ve.fieldPath))switch(Yt.op){case"==":case"in":Oe.set(Ve.fieldPath.canonicalString(),Yt.value);break;case"not-in":case"!=":return Oe.set(Ve.fieldPath.canonicalString(),Yt.value),Array.from(Oe.values())}return null}(m,f),U=function(Ke,Re){const Oe=[];let Ve=!0;for(const Yt of Ii(Re)){const Bc=0===Yt.kind?zc(Ke,Yt.fieldPath,Ke.startAt):Zc(Ke,Yt.fieldPath,Ke.startAt);Oe.push(Bc.value),Ve&&(Ve=Bc.inclusive)}return new bi(Oe,Ve)}(m,f),$=function(Ke,Re){const Oe=[];let Ve=!0;for(const Yt of Ii(Re)){const Bc=0===Yt.kind?Zc(Ke,Yt.fieldPath,Ke.endAt):zc(Ke,Yt.fieldPath,Ke.endAt);Oe.push(Bc.value),Ve&&(Ve=Bc.inclusive)}return new bi(Oe,Ve)}(m,f),X=this.Ze(f,m,U),ce=this.Ze(f,m,$),Fe=this.tn(f,m,O),He=this.en(f.indexId,E,X,U.inclusive,ce,$.inclusive,Fe);return P.forEach(He,Ke=>r.j(Ke,t.limit).next(Re=>{Re.forEach(Oe=>{const Ve=ne.fromSegments(Oe.documentKey);u.has(Ve)||(u=u.add(Ve),h.push(Ve))})}))}).next(()=>h)}return P.resolve(null)})}Ye(e){let t=this.Je.get(e);return t||(t=[e],this.Je.set(e,t),t)}en(e,t,r,i,s,u,h){const f=(null!=t?t.length:1)*Math.max(r.length,s.length),m=f/(null!=t?t.length:1),v=[];for(let E=0;E<f;++E){const O=t?this.nn(t[E/m]):Il,U=this.sn(e,O,r[E%m],i),$=this.rn(e,O,s[E%m],u),X=h.map(ce=>this.sn(e,O,ce,!0));v.push(...this.createRange(U,$,X))}return v}sn(e,t,r,i){const s=new Sa(e,ne.empty(),t,r);return i?s:s.Le()}rn(e,t,r,i){const s=new Sa(e,ne.empty(),t,r);return i?s.Le():s}Xe(e,t){const r=new jm(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let u=null;for(const h of s)r.Ge(h)&&(!u||h.fields.length>u.fields.length)&&(u=h);return u})}getIndexType(e,t){let r=2;return P.forEach(this.Ye(t),i=>this.Xe(e,i).next(s=>{s?0!==r&&s.fields.length<function(u){let h=new We(ot.comparator),f=!1;for(const m of u.filters){const v=m;v.field.isKeyField()||("array-contains"===v.op||"array-contains-any"===v.op?f=!0:h=h.add(v.field))}for(const m of u.orderBy)m.field.isKeyField()||(h=h.add(m.field));return h.size+(f?1:0)}(i)&&(r=1):r=0})).next(()=>r)}on(e,t){const r=new wc;for(const i of Ii(e)){const s=t.data.field(i.fieldPath);if(null==s)return null;const u=r.Be(i.kind);Aa.ye.re(s,u)}return r.Me()}nn(e){const t=new wc;return Aa.ye.re(e,t.Be(0)),t.Me()}un(e,t){const r=new wc;return Aa.ye.re(yn(this.databaseId,t),r.Be(function(i){const s=Ii(i);return 0===s.length?0:s[s.length-1].kind}(e))),r.Me()}tn(e,t,r){if(null===r)return[];let i=[];i.push(new wc);let s=0;for(const u of Ii(e)){const h=r[s++];for(const f of i)if(this.cn(t,u.fieldPath)&&Sr(h))i=this.an(i,u,h);else{const m=f.Be(u.kind);Aa.ye.re(h,m)}}return this.hn(i)}Ze(e,t,r){return this.tn(e,t,r.position)}hn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Me();return t}an(e,t,r){const i=[...e],s=[];for(const u of r.arrayValue.values||[])for(const h of i){const f=new wc;f.seed(h.Me()),Aa.ye.re(u,f.Be(t.kind)),s.push(f)}return s}cn(e,t){return!!e.filters.find(r=>r instanceof Ht&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=wl(e),i=Tc(e);return(t?r.K("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.K()).next(s=>{const u=[];return P.forEach(s,h=>i.get([h.indexId,this.uid]).next(f=>{u.push(function(m,v){const E=v?new wi(v.sequenceNumber,new Zt(Ta(v.readTime),new ne(Ni(v.documentKey)),v.largestBatchId)):wi.empty(),O=m.fields.map(([U,$])=>new Qs(ot.fromServerFormat(U),$));return new ia(m.indexId,m.collectionGroup,O,E)}(h,f))})).next(()=>u)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:_e(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=wl(e),s=Tc(e);return this.ln(e).next(u=>i.K("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>P.forEach(h,f=>s.put(Vf(f.indexId,this.user,u,r)))))}updateIndexEntries(e,t){const r=new Map;return P.forEach(t,(i,s)=>{const u=r.get(i.collectionGroup);return(u?P.resolve(u):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),P.forEach(h,f=>this.fn(e,i,f).next(m=>{const v=this.dn(s,f);return m.isEqual(v)?P.resolve():this._n(e,s,f,m,v)}))))})}wn(e,t,r,i){return Ec(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.un(r,t.key),documentKey:t.key.path.toArray()})}mn(e,t,r,i){return Ec(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.un(r,t.key),t.key.path.toArray()])}fn(e,t,r){const i=Ec(e);let s=new We(xa);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.un(r,t)])},(u,h)=>{s=s.add(new Sa(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>s)}dn(e,t){let r=new We(xa);const i=this.on(t,e);if(null==i)return r;const s=sa(t);if(null!=s){const u=e.data.field(s.fieldPath);if(Sr(u))for(const h of u.arrayValue.values||[])r=r.add(new Sa(t.indexId,e.key,this.nn(h),i))}else r=r.add(new Sa(t.indexId,e.key,Il,i));return r}_n(e,t,r,i,s){W("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const u=[];return function(h,f,m,v,E){const O=h.getIterator(),U=f.getIterator();let $=on(O),X=on(U);for(;$||X;){let ce=!1,Fe=!1;if($&&X){const He=m($,X);He<0?Fe=!0:He>0&&(ce=!0)}else null!=$?Fe=!0:ce=!0;ce?(v(X),X=on(U)):Fe?(E($),$=on(O)):($=on(O),X=on(U))}}(i,s,xa,h=>{u.push(this.wn(e,t,r,h))},h=>{u.push(this.mn(e,t,r,h))}),P.waitFor(u)}ln(e){let t=1;return Tc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((u,h)=>xa(u,h)).filter((u,h,f)=>!h||0!==xa(u,f[h-1]));const i=[];i.push(e);for(const u of r){const h=xa(u,e),f=xa(u,t);if(0===h)i[0]=e.Le();else if(h>0&&f<0)i.push(u),i.push(u.Le());else if(f>0)break}i.push(t);const s=[];for(let u=0;u<i.length;u+=2)s.push(IDBKeyRange.bound([i[u].indexId,this.uid,i[u].arrayValue,i[u].directionalValue,Il,[]],[i[u+1].indexId,this.uid,i[u+1].arrayValue,i[u+1].directionalValue,Il,[]]));return s}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Kf)}getMinOffset(e,t){return P.mapArray(this.Ye(t),r=>this.Xe(e,r).next(i=>i||ae())).next(Kf)}}function qf(n){return un(n,"collectionParents")}function Ec(n){return un(n,"indexEntries")}function wl(n){return un(n,"indexConfiguration")}function Tc(n){return un(n,"indexState")}function Kf(n){Ie(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;oa(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Zt(e.readTime,e.documentKey,t)}const zf={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class er{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new er(e,er.DEFAULT_COLLECTION_PERCENTILE,er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Zf(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],u=IDBKeyRange.only(t.batchId);let h=0;const f=r.J({range:u},(v,E,O)=>(h++,O.delete()));s.push(f.next(()=>{Ie(1===h)}));const m=[];for(const v of t.mutations){const E=Nf(e,v.key.path,t.batchId);s.push(i.delete(E)),m.push(v.key)}return P.waitFor(s).next(()=>m)}function El(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ae();e=n.noDocument}return JSON.stringify(e).length}er.DEFAULT_COLLECTION_PERCENTILE=10,er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,er.DEFAULT=new er(41943040,er.DEFAULT_COLLECTION_PERCENTILE,er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),er.DISABLED=new er(-1,0,0);class Tl{constructor(e,t,r,i){this.userId=e,this.wt=t,this.indexManager=r,this.referenceDelegate=i,this.gn={}}static se(e,t,r,i){Ie(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new Tl(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return uo(e).J({index:"userMutationsIndex",range:r},(i,s,u)=>{t=!1,u.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Nu(e),u=uo(e);return u.add({}).next(h=>{Ie("number"==typeof h);const f=new bh(h,t,r,i),m=function(O,U,$){const X=$.baseMutations.map(Fe=>yt(O.ne,Fe)),ce=$.mutations.map(Fe=>yt(O.ne,Fe));return{userId:U,batchId:$.batchId,localWriteTimeMs:$.localWriteTime.toMillis(),baseMutations:X,mutations:ce}}(this.wt,this.userId,f),v=[];let E=new We((O,U)=>_e(O.canonicalString(),U.canonicalString()));for(const O of i){const U=Nf(this.userId,O.key.path,h);E=E.add(O.key.path.popLast()),v.push(u.put(m)),v.push(s.put(U,vm))}return E.forEach(O=>{v.push(this.indexManager.addToCollectionParentIndex(e,O))}),e.addOnCommittedListener(()=>{this.gn[h]=f.keys()}),P.waitFor(v).next(()=>f)})}lookupMutationBatch(e,t){return uo(e).get(t).next(r=>r?(Ie(r.userId===this.userId),ba(this.wt,r)):null)}yn(e,t){return this.gn[t]?P.resolve(this.gn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.gn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return uo(e).J({index:"userMutationsIndex",range:i},(u,h,f)=>{h.userId===this.userId&&(Ie(h.batchId>=r),s=ba(this.wt,h)),f.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return uo(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,u)=>{r=s.batchId,u.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return uo(e).K("userMutationsIndex",t).next(r=>r.map(i=>ba(this.wt,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=yl(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Nu(e).J({range:i},(u,h,f)=>{const[m,v,E]=u,O=Ni(v);if(m===this.userId&&t.path.isEqual(O))return uo(e).get(E).next(U=>{if(!U)throw ae();Ie(U.userId===this.userId),s.push(ba(this.wt,U))});f.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new We(_e);const i=[];return t.forEach(s=>{const u=yl(this.userId,s.path),h=IDBKeyRange.lowerBound(u),f=Nu(e).J({range:h},(m,v,E)=>{const[O,U,$]=m,X=Ni(U);O===this.userId&&s.path.isEqual(X)?r=r.add($):E.done()});i.push(f)}),P.waitFor(i).next(()=>this.pn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=yl(this.userId,r),u=IDBKeyRange.lowerBound(s);let h=new We(_e);return Nu(e).J({range:u},(f,m,v)=>{const[E,O,U]=f,$=Ni(O);E===this.userId&&r.isPrefixOf($)?$.length===i&&(h=h.add(U)):v.done()}).next(()=>this.pn(e,h))}pn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(uo(e).get(s).next(u=>{if(null===u)throw ae();Ie(u.userId===this.userId),r.push(ba(this.wt,u))}))}),P.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return Zf(e.ee,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.In(t.batchId)}),P.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return P.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Nu(e).J({range:r},(s,u,h)=>{if(s[0]===this.userId){const f=Ni(s[1]);i.push(f)}else h.done()}).next(()=>{Ie(0===i.length)})})}containsKey(e,t){return Wf(e,this.userId,t)}Tn(e){return Hf(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Wf(n,e,t){const r=yl(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let u=!1;return Nu(n).J({range:s,H:!0},(h,f,m)=>{const[v,E,O]=h;v===e&&E===i&&(u=!0),m.done()}).next(()=>u)}function uo(n){return un(n,"mutations")}function Nu(n){return un(n,"documentMutations")}function Hf(n){return un(n,"mutationQueues")}class Ca{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new Ca(0)}static Rn(){return new Ca(-1)}}class Km{constructor(e,t){this.referenceDelegate=e,this.wt=t}allocateTargetId(e){return this.bn(e).next(t=>{const r=new Ca(t.highestTargetId);return t.highestTargetId=r.next(),this.Pn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(t=>be.fromTimestamp(new st(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Pn(e,i)))}addTargetData(e,t){return this.vn(e,t).next(()=>this.bn(e).next(r=>(r.targetCount+=1,this.Vn(t,r),this.Pn(e,r))))}updateTargetData(e,t){return this.vn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Ru(e).delete(t.targetId)).next(()=>this.bn(e)).next(r=>(Ie(r.targetCount>0),r.targetCount-=1,this.Pn(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Ru(e).J((u,h)=>{const f=vc(h);f.sequenceNumber<=t&&null===r.get(f.targetId)&&(i++,s.push(this.removeTargetData(e,f)))}).next(()=>P.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Ru(e).J((r,i)=>{const s=vc(i);t(s)})}bn(e){return Qf(e).get("targetGlobalKey").next(t=>(Ie(null!==t),t))}Pn(e,t){return Qf(e).put("targetGlobalKey",t)}vn(e,t){return Ru(e).put(Ff(this.wt,t))}Vn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=ls(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Ru(e).J({range:i,index:"queryTargetsIndex"},(u,h,f)=>{const m=vc(h);da(t,m.target)&&(s=m,f.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=co(e);return t.forEach(u=>{const h=Mn(u.path);i.push(s.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,u))}),P.waitFor(i)}removeMatchingKeys(e,t,r){const i=co(e);return P.forEach(t,s=>{const u=Mn(s.path);return P.waitFor([i.delete([r,u]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=co(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=co(e);let s=Ne();return i.J({range:r,H:!0},(u,h,f)=>{const m=Ni(u[1]),v=new ne(m);s=s.add(v)}).next(()=>s)}containsKey(e,t){const r=Mn(t.path),i=IDBKeyRange.bound([r],[tc(r)],!1,!0);let s=0;return co(e).J({index:"documentTargetsIndex",H:!0,range:i},([u,h],f,m)=>{0!==u&&(s++,m.done())}).next(()=>s>0)}te(e,t){return Ru(e).get(t).next(r=>r?vc(r):null)}}function Ru(n){return un(n,"targets")}function Qf(n){return un(n,"targetGlobal")}function co(n){return un(n,"targetDocuments")}function Yf([n,e],[t,r]){const i=_e(n,t);return 0===i?_e(e,r):i}class zm{constructor(e){this.Sn=e,this.buffer=new We(Yf),this.Dn=0}Cn(){return++this.Dn}xn(e){const t=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Yf(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Zm{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Nn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return null!==this.Nn}kn(e){var t=this;W("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,R.Z)(function*(){t.Nn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){Qn(r)?W("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Hn(r)}yield t.kn(3e5)}))}}class Wm{constructor(e,t){this.Mn=e,this.params=t}calculateTargetCount(e,t){return this.Mn.On(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return P.resolve(mn.ot);const r=new zm(t);return this.Mn.forEachTarget(e,i=>r.xn(i.sequenceNumber)).next(()=>this.Mn.Fn(e,i=>r.xn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Mn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Mn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(zf)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),zf):this.$n(e,t))}getCacheSize(e){return this.Mn.getCacheSize(e)}$n(e,t){let r,i,s,u,h,f,m;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(E=>(E>this.params.maximumSequenceNumbersToCollect?(W("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),i=this.params.maximumSequenceNumbersToCollect):i=E,u=Date.now(),this.nthSequenceNumber(e,i))).next(E=>(r=E,h=Date.now(),this.removeTargets(e,r,t))).next(E=>(s=E,f=Date.now(),this.removeOrphanedDocuments(e,r))).next(E=>(m=Date.now(),Xo()<=Pe.in.DEBUG&&W("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${u-v}ms\n\tDetermined least recently used ${i} in `+(h-u)+`ms\n\tRemoved ${s} targets in `+(f-h)+`ms\n\tRemoved ${E} documents in `+(m-f)+`ms\nTotal Duration: ${m-v}ms`),P.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:E})))}}class Hm{constructor(e,t){this.db=e,this.garbageCollector=new Wm(this,t)}On(e){const t=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Bn(e){let t=0;return this.Fn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Fn(e,t){return this.Ln(e,(r,i)=>t(i))}addReference(e,t,r){return bl(e,r)}removeReference(e,t,r){return bl(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return bl(e,t)}Un(e,t){return function(r,i){let s=!1;return Hf(r).Y(u=>Wf(r,u,i).next(h=>(h&&(s=!0),P.resolve(!h)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Ln(e,(u,h)=>{if(h<=t){const f=this.Un(e,u).next(m=>{if(!m)return s++,r.getEntry(e,u).next(()=>(r.removeEntry(u,be.min()),co(e).delete([0,Mn(u.path)])))});i.push(f)}}).next(()=>P.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return bl(e,t)}Ln(e,t){const r=co(e);let i,s=mn.ot;return r.J({index:"documentTargetsIndex"},([u,h],{path:f,sequenceNumber:m})=>{0===u?(s!==mn.ot&&t(new ne(Ni(i)),s),s=m,i=f):s=mn.ot}).next(()=>{s!==mn.ot&&t(new ne(Ni(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function bl(n,e){return co(n).put((r=n.currentSequenceNumber,{targetId:0,path:Mn(e.path),sequenceNumber:r}));var r}class Jf{constructor(){this.changes=new Ci(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ut.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Qm{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ka(e).put(r)}removeEntry(e,t,r){return ka(e).delete(function(i,s){const u=i.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],_l(s),u[u.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.qn(e,r)))}getEntry(e,t){let r=ut.newInvalidDocument(t);return ka(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(bc(t))},(i,s)=>{r=this.Kn(t,s)}).next(()=>r)}Gn(e,t){let r={size:0,document:ut.newInvalidDocument(t)};return ka(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(bc(t))},(i,s)=>{r={document:this.Kn(t,s),size:El(s)}}).next(()=>r)}getEntries(e,t){let r=Bt();return this.Qn(e,t,(i,s)=>{const u=this.Kn(i,s);r=r.insert(i,u)}).next(()=>r)}jn(e,t){let r=Bt(),i=new at(ne.comparator);return this.Qn(e,t,(s,u)=>{const h=this.Kn(s,u);r=r.insert(s,h),i=i.insert(s,El(u))}).next(()=>({documents:r,Wn:i}))}Qn(e,t,r){if(t.isEmpty())return P.resolve();let i=new We(np);t.forEach(f=>i=i.add(f));const s=IDBKeyRange.bound(bc(i.first()),bc(i.last())),u=i.getIterator();let h=u.getNext();return ka(e).J({index:"documentKeyIndex",range:s},(f,m,v)=>{const E=ne.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;h&&np(h,E)<0;)r(h,null),h=u.getNext();h&&h.isEqual(E)&&(r(h,m),h=u.hasNext()?u.getNext():null),h?v.q(bc(h)):v.done()}).next(()=>{for(;h;)r(h,null),h=u.hasNext()?u.getNext():null})}getAllFromCollection(e,t,r){const i=[t.popLast().toArray(),t.lastSegment(),_l(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],s=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ka(e).K(IDBKeyRange.bound(i,s,!0)).next(u=>{let h=Bt();for(const f of u){const m=this.Kn(ne.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);h=h.insert(m.key,m)}return h})}getAllFromCollectionGroup(e,t,r,i){let s=Bt();const u=tp(t,r),h=tp(t,Zt.max());return ka(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(u,h,!0)},(f,m,v)=>{const E=this.Kn(ne.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);s=s.insert(E.key,E),s.size===i&&v.done()}).next(()=>s)}newChangeBuffer(e){return new Ym(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return ep(e).get("remoteDocumentGlobalKey").next(t=>(Ie(!!t),t))}qn(e,t){return ep(e).put("remoteDocumentGlobalKey",t)}Kn(e,t){if(t){const r=function Lm(n,e){let t;if(e.document)t=ue(n.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ne.fromSegments(e.noDocument.path),i=Ta(e.noDocument.readTime);t=ut.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ae();{const r=ne.fromSegments(e.unknownDocument.path),i=Ta(e.unknownDocument.version);t=ut.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new st(r[0],r[1]);return be.fromTimestamp(i)}(e.readTime)),t}(this.wt,t);if(!r.isNoDocument()||!r.version.isEqual(be.min()))return r}return ut.newInvalidDocument(e)}}function Xf(n){return new Qm(n)}class Ym extends Jf{constructor(e,t){super(),this.zn=e,this.trackRemovals=t,this.Hn=new Ci(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new We((s,u)=>_e(s.canonicalString(),u.canonicalString()));return this.changes.forEach((s,u)=>{const h=this.Hn.get(s);if(t.push(this.zn.removeEntry(e,s,h.readTime)),u.isValidDocument()){const f=Lf(this.zn.wt,u);i=i.add(s.path.popLast()),r+=El(f)-h.size,t.push(this.zn.addEntry(e,s,f))}else if(r-=h.size,this.trackRemovals){const f=Lf(this.zn.wt,u.convertToNoDocument(be.min()));t.push(this.zn.addEntry(e,s,f))}}),i.forEach(s=>{t.push(this.zn.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.zn.updateMetadata(e,r)),P.waitFor(t)}getFromCache(e,t){return this.zn.Gn(e,t).next(r=>(this.Hn.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.zn.jn(e,t).next(({documents:r,Wn:i})=>(i.forEach((s,u)=>{this.Hn.set(s,{size:u,readTime:r.get(s).readTime})}),r))}}function ep(n){return un(n,"remoteDocumentGlobal")}function ka(n){return un(n,"remoteDocumentsV14")}function bc(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function tp(n,e){const t=e.documentKey.path.toArray();return[n,_l(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function np(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=_e(t[s],r[s]),i)return i;return i=_e(t.length,r.length),i||(i=_e(t[t.length-2],r[r.length-2]),i||_e(t[t.length-1],r[r.length-1]))}class Jm{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class rp{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.getBaseDocument(e,t,r))).next(i=>(null!==r&&_a(r.mutation,i,Wt.empty(),st.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ne()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ne()){const i=Xn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let u=va();return s.forEach((h,f)=>{u=u.insert(h,f.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){const r=Xn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ne()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((u,h)=>{t.set(u,h)})})}computeViews(e,t,r,i){let s=Bt();const u=io(),h=io();return t.forEach((f,m)=>{const v=r.get(m.key);i.has(m.key)&&(void 0===v||v.mutation instanceof kr)?s=s.insert(m.key,m):void 0!==v&&(u.set(m.key,v.mutation.getFieldMask()),_a(v.mutation,m,v.mutation.getFieldMask(),st.now()))}),this.recalculateAndSaveOverlays(e,s).next(f=>(f.forEach((m,v)=>u.set(m,v)),t.forEach((m,v)=>{var E;return h.set(m,new Jm(v,null!==(E=u.get(m))&&void 0!==E?E:null))}),h))}recalculateAndSaveOverlays(e,t){const r=io();let i=new at((u,h)=>u-h),s=Ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(const h of u)h.keys().forEach(f=>{const m=t.get(f);if(null===m)return;let v=r.get(f)||Wt.empty();v=h.applyToLocalView(m,v),r.set(f,v);const E=(i.get(h.batchId)||Ne()).add(f);i=i.insert(h.batchId,E)})}).next(()=>{const u=[],h=i.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),m=f.key,v=f.value,E=ll();v.forEach(O=>{if(!s.has(O)){const U=sl(t.get(O),r.get(O));null!==U&&E.set(O,U),s=s.add(O)}}),u.push(this.documentOverlayCache.saveOverlays(e,m,E))}return P.waitFor(u)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return ne.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):cc(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const u=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):P.resolve(Xn());let h=-1,f=s;return u.next(m=>P.forEach(m,(v,E)=>(h<E.largestBatchId&&(h=E.largestBatchId),s.get(v)?P.resolve():this.getBaseDocument(e,v,E).next(O=>{f=f.insert(v,O)}))).next(()=>this.populateOverlays(e,m,s)).next(()=>this.computeViews(e,f,m,Ne())).next(v=>({batchId:h,changes:bu(v)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ne(t)).next(r=>{let i=va();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let s=va();return this.indexManager.getCollectionParents(e,i).next(u=>P.forEach(u,h=>{const f=(m=t,v=h.child(i),new fr(v,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt));var m,v;return this.getDocumentsMatchingCollectionQuery(e,f,r).next(m=>{m.forEach((v,E)=>{s=s.insert(v,E)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.remoteDocumentCache.getAllFromCollection(e,t.path,r).next(s=>(i=s,this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId))).next(s=>{s.forEach((h,f)=>{const m=f.getKey();null===i.get(m)&&(i=i.insert(m,ut.newInvalidDocument(m)))});let u=va();return i.forEach((h,f)=>{const m=s.get(h);void 0!==m&&_a(m.mutation,f,Wt.empty(),st.now()),ga(t,f)&&(u=u.insert(h,f))}),u})}getBaseDocument(e,t,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(e,t):P.resolve(ut.newInvalidDocument(t))}}class Xm{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,t){return P.resolve(this.Jn.get(t))}saveBundleMetadata(e,t){var r;return this.Jn.set(t.id,{id:(r=t).id,version:r.version,createTime:$t(r.createTime)}),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Yn.get(t))}saveNamedQuery(e,t){return this.Yn.set(t.name,{name:(r=t).name,query:xh(r.bundledQuery),readTime:$t(r.readTime)}),P.resolve();var r}}class ey{constructor(){this.overlays=new at(ne.comparator),this.Xn=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Xn();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ie(e,t,s)}),P.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Xn.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Xn.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){const i=Xn(),s=t.length+1,u=new ne(t.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const f=h.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===s&&f.largestBatchId>r&&i.set(f.getKey(),f)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new at((m,v)=>m-v);const u=this.overlays.getIterator();for(;u.hasNext();){const m=u.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let v=s.get(m.largestBatchId);null===v&&(v=Xn(),s=s.insert(m.largestBatchId,v)),v.set(m.getKey(),m)}}const h=Xn(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((m,v)=>h.set(m,v)),!(h.size()>=i)););return P.resolve(h)}ie(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const u=this.Xn.get(i.largestBatchId).delete(r.key);this.Xn.set(i.largestBatchId,u)}this.overlays=this.overlays.insert(r.key,new Sh(t,r));let s=this.Xn.get(t);void 0===s&&(s=Ne(),this.Xn.set(t,s)),this.Xn.set(t,s.add(r.key))}}class Dh{constructor(){this.Zn=new We(cn.ts),this.es=new We(cn.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const r=new cn(e,t);this.Zn=this.Zn.add(r),this.es=this.es.add(r)}ss(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.rs(new cn(e,t))}os(e,t){e.forEach(r=>this.removeReference(r,t))}us(e){const t=new ne(new Ue([])),r=new cn(t,e),i=new cn(t,e+1),s=[];return this.es.forEachInRange([r,i],u=>{this.rs(u),s.push(u.key)}),s}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new ne(new Ue([])),r=new cn(t,e),i=new cn(t,e+1);let s=Ne();return this.es.forEachInRange([r,i],u=>{s=s.add(u.key)}),s}containsKey(e){const t=new cn(e,0),r=this.Zn.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class cn{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return ne.comparator(e.key,t.key)||_e(e.ls,t.ls)}static ns(e,t){return _e(e.ls,t.ls)||ne.comparator(e.key,t.key)}}class ty{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.fs=1,this.ds=new We(cn.ts)}checkEmpty(e){return P.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const s=this.fs;this.fs++;const u=new bh(s,t,r,i);this.mutationQueue.push(u);for(const h of i)this.ds=this.ds.add(new cn(h.key,s)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return P.resolve(u)}lookupMutationBatch(e,t){return P.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.ws(t+1),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(0===this.mutationQueue.length?-1:this.fs-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new cn(t,0),i=new cn(t,Number.POSITIVE_INFINITY),s=[];return this.ds.forEachInRange([r,i],u=>{const h=this._s(u.ls);s.push(h)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new We(_e);return t.forEach(i=>{const s=new cn(i,0),u=new cn(i,Number.POSITIVE_INFINITY);this.ds.forEachInRange([s,u],h=>{r=r.add(h.ls)})}),P.resolve(this.gs(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;ne.isDocumentKey(s)||(s=s.child(""));const u=new cn(new ne(s),0);let h=new We(_e);return this.ds.forEachWhile(f=>{const m=f.key.path;return!!r.isPrefixOf(m)&&(m.length===i&&(h=h.add(f.ls)),!0)},u),P.resolve(this.gs(h))}gs(e){const t=[];return e.forEach(r=>{const i=this._s(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){Ie(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();let r=this.ds;return P.forEach(t.mutations,i=>{const s=new cn(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.ds=r})}In(e){}containsKey(e,t){const r=new cn(t,0),i=this.ds.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return P.resolve()}ys(e,t){return this.ws(e)}ws(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}_s(e){const t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ny{constructor(e){this.ps=e,this.docs=new at(ne.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,u=this.ps(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:u}),this.size+=u-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():ut.newInvalidDocument(t))}getEntries(e,t){let r=Bt();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ut.newInvalidDocument(i))}),P.resolve(r)}getAllFromCollection(e,t,r){let i=Bt();const s=new ne(t.child("")),u=this.docs.getIteratorFrom(s);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!t.isPrefixOf(h.path))break;h.path.length>t.length+1||oa(au(f),r)<=0||(i=i.insert(f.key,f.mutableCopy()))}return P.resolve(i)}getAllFromCollectionGroup(e,t,r,i){ae()}Is(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new ry(this)}getSize(e){return P.resolve(this.size)}}class ry extends Jf{constructor(e){super(),this.zn=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.zn.addEntry(e,i)):this.zn.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.zn.getEntry(e,t)}getAllFromCache(e,t){return this.zn.getEntries(e,t)}}class iy{constructor(e){this.persistence=e,this.Ts=new Ci(t=>ls(t),da),this.lastRemoteSnapshotVersion=be.min(),this.highestTargetId=0,this.Es=0,this.As=new Dh,this.targetCount=0,this.Rs=Ca.An()}forEachTarget(e,t){return this.Ts.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Es&&(this.Es=t),P.resolve()}vn(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new Ca(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,t){return this.vn(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.vn(t),P.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Ts.forEach((u,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.Ts.delete(u),s.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),P.waitFor(s).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){const r=this.Ts.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.As.ss(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.As.os(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(u=>{s.push(i.markPotentiallyOrphaned(e,u))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.As.us(t),P.resolve()}getMatchingKeysForTargetId(e,t){const r=this.As.hs(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.As.containsKey(t))}}class ip{constructor(e,t){this.bs={},this.overlays={},this.Ps=new mn(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new iy(this),this.indexManager=new Gm,this.remoteDocumentCache=new ny(r=>this.referenceDelegate.Ss(r)),this.wt=new Mf(t),this.Ds=new Xm(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ey,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.bs[e.toKey()];return r||(r=new ty(t,this.referenceDelegate),this.bs[e.toKey()]=r),r}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,t,r){W("MemoryPersistence","Starting transaction:",e);const i=new sy(this.Ps.next());return this.referenceDelegate.Cs(),r(i).next(s=>this.referenceDelegate.xs(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ns(e,t){return P.or(Object.values(this.bs).map(r=>()=>r.containsKey(e,t)))}}class sy extends ss{constructor(e){super(),this.currentSequenceNumber=e}}class Al{constructor(e){this.persistence=e,this.ks=new Dh,this.Ms=null}static Os(e){return new Al(e)}get Fs(){if(this.Ms)return this.Ms;throw ae()}addReference(e,t,r){return this.ks.addReference(r,t),this.Fs.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.ks.removeReference(r,t),this.Fs.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.Fs.add(t.toString()),P.resolve()}removeTarget(e,t){this.ks.us(t.targetId).forEach(i=>this.Fs.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Fs.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Cs(){this.Ms=new Set}xs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Fs,r=>{const i=ne.fromPath(r);return this.$s(e,i).next(s=>{s||t.removeEntry(i,be.min())})}).next(()=>(this.Ms=null,t.apply(e)))}updateLimboDocument(e,t){return this.$s(e,t).next(r=>{r?this.Fs.delete(t.toString()):this.Fs.add(t.toString())})}Ss(e){return 0}$s(e,t){return P.or([()=>P.resolve(this.ks.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ns(e,t)])}}class oy{constructor(e){this.wt=e}M(e,t,r,i){const s=new br("createOrUpgrade",t);var h;r<1&&i>=1&&(e.createObjectStore("owner"),(h=e).createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Df,{unique:!0}),h.createObjectStore("documentMutations"),sp(e),function(h){h.createObjectStore("remoteDocuments")}(e));let u=P.resolve();return r<3&&i>=3&&(0!==r&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),sp(e)),u=u.next(()=>function(h){const f=h.store("targetGlobal"),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:be.min().toTimestamp(),targetCount:0};return f.put("targetGlobalKey",m)}(s))),r<4&&i>=4&&(0!==r&&(u=u.next(()=>function(h,f){return f.store("mutations").K().next(m=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Df,{unique:!0});const v=f.store("mutations"),E=m.map(O=>v.put(O));return P.waitFor(E)})}(e,s))),u=u.next(()=>{!function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(u=u.next(()=>this.Bs(s))),r<6&&i>=6&&(u=u.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(s)))),r<7&&i>=7&&(u=u.next(()=>this.Us(s))),r<8&&i>=8&&(u=u.next(()=>this.qs(e,s))),r<9&&i>=9&&(u=u.next(()=>{!function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(u=u.next(()=>this.Ks(s))),r<11&&i>=11&&(u=u.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(u=u.next(()=>{!function(h){const f=h.createObjectStore("documentOverlays",{keyPath:Nm});f.createIndex("collectionPathOverlayIndex",Rm,{unique:!1}),f.createIndex("collectionGroupOverlayIndex",Om,{unique:!1})}(e)})),r<13&&i>=13&&(u=u.next(()=>function(h){const f=h.createObjectStore("remoteDocumentsV14",{keyPath:Im});f.createIndex("documentKeyIndex",wm),f.createIndex("collectionGroupIndex",Em)}(e)).next(()=>this.Gs(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(u=u.next(()=>this.Qs(e,s))),r<15&&i>=15&&(u=u.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:xm}).createIndex("sequenceNumberIndex",Cm,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:km}).createIndex("documentKeyIndex",Dm,{unique:!1})}(e))),u}Ls(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=El(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Bs(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.K().next(i=>P.forEach(i,s=>{const u=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.K("userMutationsIndex",u).next(h=>P.forEach(h,f=>{Ie(f.userId===s.userId);const m=ba(this.wt,f);return Zf(e,s.userId,m).next(()=>{})}))}))}Us(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((u,h)=>{const f=new Ue(u),m=[0,Mn(f)];s.push(t.get(m).next(v=>v?P.resolve():t.put({targetId:0,path:Mn(f),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>P.waitFor(s))})}qs(e,t){e.createObjectStore("collectionParents",{keyPath:Sm});const r=t.store("collectionParents"),i=new kh,s=u=>{if(i.add(u)){const h=u.lastSegment(),f=u.popLast();return r.put({collectionId:h,parent:Mn(f)})}};return t.store("remoteDocuments").J({H:!0},(u,h)=>{const f=new Ue(u);return s(f.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([u,h,f],m)=>{const v=Ni(h);return s(v.popLast())}))}Ks(e){const t=e.store("targets");return t.J((r,i)=>{const s=vc(i),u=Ff(this.wt,s);return t.put(u)})}Gs(e,t){const r=t.store("remoteDocuments"),i=[];return r.J((s,u)=>{const h=t.store("remoteDocumentsV14"),f=(m=u,m.document?new ne(Ue.fromString(m.document.name).popFirst(5)):m.noDocument?ne.fromSegments(m.noDocument.path):m.unknownDocument?ne.fromSegments(m.unknownDocument.path):ae()).path.toArray();var m;const v={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};i.push(h.put(v))}).next(()=>P.waitFor(i))}Qs(e,t){const r=t.store("mutations"),i=Xf(this.wt),s=new ip(Al.Os,this.wt.ne);return r.K().next(u=>{const h=new Map;return u.forEach(f=>{var m;let v=null!==(m=h.get(f.userId))&&void 0!==m?m:Ne();ba(this.wt,f).keys().forEach(E=>v=v.add(E)),h.set(f.userId,v)}),P.forEach(h,(f,m)=>{const v=new Ct(m),E=vl.se(this.wt,v),O=s.getIndexManager(v),U=Tl.se(v,this.wt,O,s.referenceDelegate);return new rp(i,U,E,O).recalculateAndSaveOverlaysForDocumentKeys(new Th(t,mn.ot),f).next()})})}}function sp(n){n.createObjectStore("targetDocuments",{keyPath:bm}).createIndex("documentTargetsIndex",Am,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Tm,{unique:!0}),n.createObjectStore("targetGlobal")}const Nh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Rh{constructor(e,t,r,i,s,u,h,f,m,v,E=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.js=s,this.window=u,this.document=h,this.Ws=m,this.zs=v,this.Hs=E,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=O=>Promise.resolve(),!Rh.V())throw new K(L.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Hm(this,i),this.ei=t+"main",this.wt=new Mf(f),this.ni=new Mt(this.ei,this.Hs,new oy(this.wt)),this.Vs=new Km(this.referenceDelegate,this.wt),this.remoteDocumentCache=Xf(this.wt),this.Ds=new Fm,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,!1===v&&Je("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new K(L.FAILED_PRECONDITION,Nh);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new mn(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){var t=this;return this.ti=function(){var r=(0,R.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(function(){var t=(0,R.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget((0,R.Z)(function*(){t.started&&(yield t.ii())})))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Sl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(t=>{t||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(t=>this.isPrimary&&!t?this.li(e).next(()=>!1):!!t&&this.fi(e).next(()=>!0))).catch(e=>{if(Qn(e))return W("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return W("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return Ac(e).get("owner").next(t=>P.resolve(this.di(t)))}_i(e){return Sl(e).delete(this.clientId)}wi(){var e=this;return(0,R.Z)(function*(){if(e.isPrimary&&!e.mi(e.Zs,18e5)){e.Zs=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=un(r,"clientMetadata");return i.K().next(s=>{const u=e.gi(s,18e5),h=s.filter(f=>-1===u.indexOf(f));return P.forEach(h,f=>i.delete(f.clientId)).next(()=>h)})}).catch(()=>[]);if(e.si)for(const r of t)e.si.removeItem(e.yi(r.clientId))}})()}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?P.resolve(!0):Ac(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)){if(this.di(t)&&this.networkEnabled)return!0;if(!this.di(t)){if(!t.allowTabSynchronization)throw new K(L.FAILED_PRECONDITION,Nh);return!1}}return!(!this.networkEnabled||!this.inForeground)||Sl(e).K().next(r=>void 0===this.gi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const u=!this.inForeground&&i.inForeground,h=this.networkEnabled===i.networkEnabled;if(!this.networkEnabled&&i.networkEnabled||u&&h)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&W("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,R.Z)(function*(){e.vs=!1,e.Ii(),e.Xs&&(e.Xs.cancel(),e.Xs=null),e.Ti(),e.Ei(),yield e.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new Th(t,mn.ot);return e.li(r).next(()=>e._i(r))}),e.ni.close(),e.Ai()})()}gi(e,t){return e.filter(r=>this.mi(r.updateTimeMs,t)&&!this.pi(r.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>Sl(e).K().next(t=>this.gi(t,18e5).map(r=>r.clientId)))}get started(){return this.vs}getMutationQueue(e,t){return Tl.se(e,this.wt,t,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new qm(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return vl.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,t,r){W("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",s=15===(u=this.Hs)?Mm:14===u?Pf:13===u?Of:12===u?Pm:11===u?Rf:void ae();var u;let h;return this.ni.runTransaction(e,i,s,f=>(h=new Th(f,this.Ps?this.Ps.next():mn.ot),"readwrite-primary"===t?this.ai(h).next(m=>!!m||this.hi(h)).next(m=>{if(!m)throw Je(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new K(L.FAILED_PRECONDITION,Ys);return r(h)}).next(m=>this.fi(h).next(()=>m)):this.bi(h).next(()=>r(h)))).then(f=>(h.raiseOnCommittedEvent(),f))}bi(e){return Ac(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)&&!this.di(t)&&!(this.zs||this.allowTabSynchronization&&t.allowTabSynchronization))throw new K(L.FAILED_PRECONDITION,Nh)})}fi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ac(e).put("owner",t)}static V(){return Mt.V()}li(e){const t=Ac(e);return t.get("owner").next(r=>this.di(r)?(W("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):P.resolve())}mi(e,t){const r=Date.now();return!(e<r-t||e>r&&(Je(`Detected an update time that is in the future: ${e} > ${r}`),1))}ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground="visible"===this.document.visibilityState)}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Js=()=>{this.Ii(),(0,Y.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var t;try{const r=null!==(null===(t=this.si)||void 0===t?void 0:t.getItem(this.yi(e)));return W("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Je("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){Je("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch{}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ac(n){return un(n,"owner")}function Sl(n){return un(n,"clientMetadata")}function Oh(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Ph{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Pi=r,this.vi=i}static Vi(e,t){let r=Ne(),i=Ne();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Ph(e,t.fromCache,r,i)}}class op{constructor(){this.Si=!1}initialize(e,t){this.Di=e,this.indexManager=t,this.Si=!0}getDocumentsMatchingQuery(e,t,r,i){return this.Ci(e,t).next(s=>s||this.xi(e,t,i,r)).next(s=>s||this.Ni(e,t))}Ci(e,t){if(oc(t))return P.resolve(null);let r=Nt(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=pu(t,null,"F"),r=Nt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const u=Ne(...s);return this.Di.getDocuments(e,u).next(h=>this.indexManager.getMinOffset(e,r).next(f=>{const m=this.ki(t,h);return this.Mi(t,m,u,f.readTime)?this.Ci(e,pu(t,null,"F")):this.Oi(e,m,t,f)}))})))}xi(e,t,r,i){return oc(t)||i.isEqual(be.min())?this.Ni(e,t):this.Di.getDocuments(e,r).next(s=>{const u=this.ki(t,s);return this.Mi(t,u,r,i)?this.Ni(e,t):(Xo()<=Pe.in.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),lc(t)),this.Oi(e,u,t,is(i,-1)))})}ki(e,t){let r=new We(Xc(e));return t.forEach((i,s)=>{ga(e,s)&&(r=r.add(s))}),r}Mi(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ni(e,t){return Xo()<=Pe.in.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",lc(t)),this.Di.getDocumentsMatchingQuery(e,t,Zt.min())}Oi(e,t,r,i){return this.Di.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(u=>{s=s.insert(u.key,u)}),s))}}class ay{constructor(e,t,r,i){this.persistence=e,this.Fi=t,this.wt=i,this.$i=new at(_e),this.Bi=new Ci(s=>ls(s),da),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(r)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new rp(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.$i))}}function ap(n,e,t,r){return new ay(n,e,t,r)}function up(n,e){return Mh.apply(this,arguments)}function Mh(){return Mh=(0,R.Z)(function*(n,e){const t=te(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.qi(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const u=[],h=[];let f=Ne();for(const m of i){u.push(m.batchId);for(const v of m.mutations)f=f.add(v.key)}for(const m of s){h.push(m.batchId);for(const v of m.mutations)f=f.add(v.key)}return t.localDocuments.getDocuments(r,f).next(m=>({Ki:m,removedBatchIds:u,addedBatchIds:h}))})})}),Mh.apply(this,arguments)}function uy(n,e){const t=te(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.Ui.newChangeBuffer({trackRemovals:!0});return function(u,h,f,m){const v=f.batch,E=v.keys();let O=P.resolve();return E.forEach(U=>{O=O.next(()=>m.getEntry(h,U)).next($=>{const X=f.docVersions.get(U);Ie(null!==X),$.version.compareTo(X)<0&&(v.applyToRemoteDocument($,f),$.isValidDocument()&&($.setReadTime(f.commitVersion),m.addEntry($)))})}),O.next(()=>u.mutationQueue.removeMutationBatch(h,v))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=Ne();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(h=h.add(u.batch.mutations[f].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function cp(n){const e=te(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Vs.getLastRemoteSnapshotVersion(t))}function cy(n,e){const t=te(n),r=e.snapshotVersion;let i=t.$i;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const u=t.Ui.newChangeBuffer({trackRemovals:!0});i=t.$i;const h=[];e.targetChanges.forEach((v,E)=>{const O=i.get(E);if(!O)return;h.push(t.Vs.removeMatchingKeys(s,v.removedDocuments,E).next(()=>t.Vs.addMatchingKeys(s,v.addedDocuments,E)));let U=O.withSequenceNumber(s.currentSequenceNumber);var $,X,ce;e.targetMismatches.has(E)?U=U.withResumeToken(kt.EMPTY_BYTE_STRING,be.min()).withLastLimboFreeSnapshotVersion(be.min()):v.resumeToken.approximateByteSize()>0&&(U=U.withResumeToken(v.resumeToken,r)),i=i.insert(E,U),X=U,ce=v,(0===($=O).resumeToken.approximateByteSize()||X.snapshotVersion.toMicroseconds()-$.snapshotVersion.toMicroseconds()>=3e8||ce.addedDocuments.size+ce.modifiedDocuments.size+ce.removedDocuments.size>0)&&h.push(t.Vs.updateTargetData(s,U))});let f=Bt(),m=Ne();if(e.documentUpdates.forEach(v=>{e.resolvedLimboDocuments.has(v)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(s,v))}),h.push(lp(s,u,e.documentUpdates).next(v=>{f=v.Gi,m=v.Qi})),!r.isEqual(be.min())){const v=t.Vs.getLastRemoteSnapshotVersion(s).next(E=>t.Vs.setTargetsMetadata(s,s.currentSequenceNumber,r));h.push(v)}return P.waitFor(h).next(()=>u.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,f,m)).next(()=>f)}).then(s=>(t.$i=i,s))}function lp(n,e,t){let r=Ne(),i=Ne();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let u=Bt();return t.forEach((h,f)=>{const m=s.get(h);f.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(h)),f.isNoDocument()&&f.version.isEqual(be.min())?(e.removeEntry(h,f.readTime),u=u.insert(h,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||0===f.version.compareTo(m.version)&&m.hasPendingWrites?(e.addEntry(f),u=u.insert(h,f)):W("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",f.version)}),{Gi:u,Qi:i}})}function ly(n,e){const t=te(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ou(n,e){const t=te(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Vs.getTargetData(r,e).next(s=>s?(i=s,P.resolve(i)):t.Vs.allocateTargetId(r).next(u=>(i=new ao(e,u,0,r.currentSequenceNumber),t.Vs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.$i.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.$i=t.$i.insert(r.targetId,r),t.Bi.set(e,r.targetId)),r})}function Pu(n,e,t){return Lh.apply(this,arguments)}function Lh(){return Lh=(0,R.Z)(function*(n,e,t){const r=te(n),i=r.$i.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,u=>r.persistence.referenceDelegate.removeTarget(u,i)))}catch(u){if(!Qn(u))throw u;W("LocalStore",`Failed to update sequence numbers for target ${e}: ${u}`)}r.$i=r.$i.remove(e),r.Bi.delete(i.target)}),Lh.apply(this,arguments)}function xl(n,e,t){const r=te(n);let i=be.min(),s=Ne();return r.persistence.runTransaction("Execute query","readonly",u=>function(h,f,m){const v=te(h),E=v.Bi.get(m);return void 0!==E?P.resolve(v.$i.get(E)):v.Vs.getTargetData(f,m)}(r,u,Nt(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(u,h.targetId).next(f=>{s=f})}).next(()=>r.Fi.getDocumentsMatchingQuery(u,e,t?i:be.min(),t?s:Ne())).next(h=>(fp(r,Jc(e),h),{documents:h,ji:s})))}function hp(n,e){const t=te(n),r=te(t.Vs),i=t.$i.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.te(s,e).next(u=>u?u.target:null))}function dp(n,e){const t=te(n),r=t.Li.get(e)||be.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Ui.getAllFromCollectionGroup(i,e,is(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(fp(t,e,i),i))}function fp(n,e,t){let r=be.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Li.set(e,r)}function Fh(){return Fh=(0,R.Z)(function*(n,e,t,r){const i=te(n);let s=Ne(),u=Bt();for(const m of t){const v=e.Wi(m.metadata.name);m.document&&(s=s.add(v));const E=e.zi(m);E.setReadTime(e.Hi(m.metadata.readTime)),u=u.insert(v,E)}const h=i.Ui.newChangeBuffer({trackRemovals:!0}),f=yield Ou(i,(m=r,Nt(hs(Ue.fromString(`__bundle__/docs/${m}`)))));var m;return i.persistence.runTransaction("Apply bundle documents","readwrite",m=>lp(m,h,u).next(v=>(h.apply(m),v)).next(v=>i.Vs.removeMatchingKeysForTargetId(m,f.targetId).next(()=>i.Vs.addMatchingKeys(m,s,f.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(m,v.Gi,v.Qi)).next(()=>v.Gi)))}),Fh.apply(this,arguments)}function dy(n,e){return Uh.apply(this,arguments)}function Uh(){return Uh=(0,R.Z)(function*(n,e,t=Ne()){const r=yield Ou(n,Nt(xh(e.bundledQuery))),i=te(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const u=$t(e.readTime);if(r.snapshotVersion.compareTo(u)>=0)return i.Ds.saveNamedQuery(s,e);const h=r.withResumeToken(kt.EMPTY_BYTE_STRING,u);return i.$i=i.$i.insert(h.targetId,h),i.Vs.updateTargetData(s,h).next(()=>i.Vs.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Vs.addMatchingKeys(s,t,r.targetId)).next(()=>i.Ds.saveNamedQuery(s,e))})}),Uh.apply(this,arguments)}function pp(n,e){return`firestore_clients_${n}_${e}`}function gp(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Vh(n,e){return`firestore_targets_${n}_${e}`}class Cl{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ji(e,t,r){const i=JSON.parse(r);let s,u="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return u&&i.error&&(u="string"==typeof i.error.message&&"string"==typeof i.error.code,u&&(s=new K(i.error.code,i.error.message))),u?new Cl(e,t,i.state,s):(Je("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Sc{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ji(e,t){const r=JSON.parse(t);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new K(r.error.code,r.error.message))),s?new Sc(e,r.state,i):(Je("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class kl{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ji(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=Au();for(let u=0;i&&u<r.activeTargetIds.length;++u)i=q(r.activeTargetIds[u]),s=s.add(r.activeTargetIds[u]);return i?new kl(e,s):(Je("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Bh{constructor(e,t){this.clientId=e,this.onlineState=t}static Ji(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Bh(t.clientId,t.onlineState):(Je("SharedClientState",`Failed to parse online state: ${e}`),null)}}class $h{constructor(){this.activeTargetIds=Au()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class jh{constructor(e,t,r,i,s){this.window=e,this.js=t,this.persistenceKey=r,this.tr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new at(_e),this.started=!1,this.ir=[];const u=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.rr=pp(this.persistenceKey,this.tr),this.ur=`firestore_sequence_number_${this.persistenceKey}`,this.sr=this.sr.insert(this.tr,new $h),this.cr=new RegExp(`^firestore_clients_${u}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${u}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${u}_(\\d+)$`),this.lr=`firestore_online_state_${this.persistenceKey}`,this.dr=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,R.Z)(function*(){const t=yield e.syncEngine.Ri();for(const i of t){if(i===e.tr)continue;const s=e.getItem(pp(e.persistenceKey,i));if(s){const u=kl.Ji(i,s);u&&(e.sr=e.sr.insert(u.clientId,u))}}e._r();const r=e.storage.getItem(e.lr);if(r){const i=e.wr(r);i&&e.mr(i)}for(const i of e.ir)e.nr(i);e.ir=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let t=!1;return this.sr.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,t,r){this.yr(e,t,r),this.pr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Vh(this.persistenceKey,e));if(r){const i=Sc.Ji(e,r);i&&(t=i.state)}}return this.Ir.Xi(e),this._r(),t}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Vh(this.persistenceKey,e))}updateQueryState(e,t,r){this.Tr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.pr(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return W("SharedClientState","READ",e,t),t}setItem(e,t){W("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){W("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(W("SharedClientState","EVENT",r.key,r.newValue),r.key===this.rr)return void Je("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable((0,R.Z)(function*(){if(t.started){if(null!==r.key)if(t.cr.test(r.key)){if(null==r.newValue){const i=t.Rr(r.key);return t.br(i,null)}{const i=t.Pr(r.key,r.newValue);if(i)return t.br(i.clientId,i)}}else if(t.ar.test(r.key)){if(null!==r.newValue){const i=t.vr(r.key,r.newValue);if(i)return t.Vr(i)}}else if(t.hr.test(r.key)){if(null!==r.newValue){const i=t.Sr(r.key,r.newValue);if(i)return t.Dr(i)}}else if(r.key===t.lr){if(null!==r.newValue){const i=t.wr(r.newValue);if(i)return t.mr(i)}}else if(r.key===t.ur){const i=function(s){let u=mn.ot;if(null!=s)try{const h=JSON.parse(s);Ie("number"==typeof h),u=h}catch(h){Je("SharedClientState","Failed to read sequence number from WebStorage",h)}return u}(r.newValue);i!==mn.ot&&t.sequenceNumberHandler(i)}else if(r.key===t.dr){const i=t.Cr(r.newValue);yield Promise.all(i.map(s=>t.syncEngine.Nr(s)))}}else t.ir.push(r)}))}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,t,r){const i=new Cl(this.currentUser,e,t,r),s=gp(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Yi())}pr(e){const t=gp(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Er(e){this.storage.setItem(this.lr,JSON.stringify({clientId:this.tr,onlineState:e}))}Tr(e,t,r){const i=Vh(this.persistenceKey,e),s=new Sc(e,t,r);this.setItem(i,s.Yi())}Ar(e){const t=JSON.stringify(Array.from(e));this.setItem(this.dr,t)}Rr(e){const t=this.cr.exec(e);return t?t[1]:null}Pr(e,t){const r=this.Rr(e);return kl.Ji(r,t)}vr(e,t){const r=this.ar.exec(e),i=Number(r[1]);return Cl.Ji(new Ct(void 0!==r[2]?r[2]:null),i,t)}Sr(e,t){const r=this.hr.exec(e),i=Number(r[1]);return Sc.Ji(i,t)}wr(e){return Bh.Ji(e)}Cr(e){return JSON.parse(e)}Vr(e){var t=this;return(0,R.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.kr(e.batchId,e.state,e.error);W("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Dr(e){return this.syncEngine.Mr(e.targetId,e.state,e.error)}br(e,t){const r=t?this.sr.insert(e,t):this.sr.remove(e),i=this.gr(this.sr),s=this.gr(r),u=[],h=[];return s.forEach(f=>{i.has(f)||u.push(f)}),i.forEach(f=>{s.has(f)||h.push(f)}),this.syncEngine.Or(u,h).then(()=>{this.sr=r})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let t=Au();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class mp{constructor(){this.Fr=new $h,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,t,r){this.$r[e]=t}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new $h,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class fy{Br(e){}shutdown(){}}class yp{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){W("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){W("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const py={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class gy{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}class my extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.so=(e.ssl?"https":"http")+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,t,r,i,s){const u=this.oo(e,t);W("RestConnection","Sending: ",u,r);const h={};return this.uo(h,i,s),this.co(e,u,h,r).then(f=>(W("RestConnection","Received: ",f),f),f=>{throw Wn("RestConnection",`${e} failed with error: `,f,"url: ",u,"request:",r),f})}ao(e,t,r,i,s,u){return this.ro(e,t,r,i,s)}uo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+mi,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}oo(e,t){return`${this.so}/v1/${t}:${py[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,t,r,i){return new Promise((s,u)=>{const h=new Jo;h.listenOnce(ts.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Ho.NO_ERROR:const m=h.getResponseJson();W("Connection","XHR received:",JSON.stringify(m)),s(m);break;case Ho.TIMEOUT:W("Connection",'RPC "'+e+'" timed out'),u(new K(L.DEADLINE_EXCEEDED,"Request time out"));break;case Ho.HTTP_ERROR:const v=h.getStatus();if(W("Connection",'RPC "'+e+'" failed with status:',v,"response text:",h.getResponseText()),v>0){const E=h.getResponseJson().error;if(E&&E.status&&E.message){const O=function(U){const $=U.toLowerCase().replace(/_/g,"-");return Object.values(L).indexOf($)>=0?$:L.UNKNOWN}(E.status);u(new K(O,E.message))}else u(new K(L.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new K(L.UNAVAILABLE,"Connection failed."));break;default:ae()}}finally{W("Connection",'RPC "'+e+'" completed.')}});const f=JSON.stringify(i);h.send(t,"POST",f,r,15)})}ho(e,t,r){const i=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Tr(),u=nu(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(h.xmlHttpFactory=new Yo({})),this.uo(h.initMessageHeaders,t,r),(0,Y.uI)()||(0,Y.b$)()||(0,Y.d)()||(0,Y.w1)()||(0,Y.Mn)()||(0,Y.ru)()||(h.httpHeadersOverwriteParam="$httpHeaders");const f=i.join("");W("Connection","Creating WebChannel: "+f,h);const m=s.createWebChannel(f,h);let v=!1,E=!1;const O=new gy({jr:$=>{E?W("Connection","Not sending because WebChannel is closed:",$):(v||(W("Connection","Opening WebChannel transport."),m.open(),v=!0),W("Connection","WebChannel sending:",$),m.send($))},Wr:()=>m.close()}),U=($,X,ce)=>{$.listen(X,Fe=>{try{ce(Fe)}catch(He){setTimeout(()=>{throw He},0)}})};return U(m,Qr.EventType.OPEN,()=>{E||W("Connection","WebChannel transport opened.")}),U(m,Qr.EventType.CLOSE,()=>{E||(E=!0,W("Connection","WebChannel transport closed"),O.eo())}),U(m,Qr.EventType.ERROR,$=>{E||(E=!0,Wn("Connection","WebChannel transport errored:",$),O.eo(new K(L.UNAVAILABLE,"The operation could not be completed")))}),U(m,Qr.EventType.MESSAGE,$=>{var X;if(!E){const ce=$.data[0];Ie(!!ce);const Fe=ce,He=Fe.error||(null===(X=Fe[0])||void 0===X?void 0:X.error);if(He){W("Connection","WebChannel received error:",He);const Ke=He.status;let Re=function(Ve){const Yt=Et[Ve];if(void 0!==Yt)return Tu(Yt)}(Ke),Oe=He.message;void 0===Re&&(Re=L.INTERNAL,Oe="Unknown error status: "+Ke+" with message "+He.message),E=!0,O.eo(new K(Re,Oe)),m.close()}else W("Connection","WebChannel received:",ce),O.no(ce)}}),U(u,Qo.STAT_EVENT,$=>{$.stat===wt.PROXY?W("Connection","Detected buffering proxy"):$.stat===wt.NOPROXY&&W("Connection","Detected no buffering proxy")}),setTimeout(()=>{O.Zr()},0),O}}function _p(){return typeof window<"u"?window:null}function Dl(){return typeof document<"u"?document:null}function xc(n){return new gc(n,!0)}class Gh{constructor(e,t,r=1e3,i=1.5,s=6e4){this.js=e,this.timerId=t,this.lo=r,this.fo=i,this._o=s,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const t=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,t-r);i>0&&W("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.wo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,i,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}cancel(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}class vp{constructor(e,t,r,i,s,u,h,f){this.js=e,this.Ao=r,this.Ro=i,this.bo=s,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new Gh(e,t)}Do(){return 1===this.state||5===this.state||this.Co()}Co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.xo()}stop(){var e=this;return(0,R.Z)(function*(){e.Do()&&(yield e.close(0))})()}No(){this.state=0,this.So.reset()}ko(){this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Mo()))}Oo(e){this.Fo(),this.stream.send(e)}Mo(){var e=this;return(0,R.Z)(function*(){if(e.Co())return e.close(0)})()}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}close(e,t){var r=this;return(0,R.Z)(function*(){r.Fo(),r.$o(),r.So.cancel(),r.Po++,4!==e?r.So.reset():t&&t.code===L.RESOURCE_EXHAUSTED?(Je(t.toString()),Je("Using maximum backoff delay to prevent overloading the backend."),r.So.po()):t&&t.code===L.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Bo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Jr(t)})()}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),t=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Po===t&&this.Uo(r,i)},r=>{e(()=>{const i=new K(L.UNKNOWN,"Fetching auth token failed: "+r.message);return this.qo(i)})})}Uo(e,t){const r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(()=>{r(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(i=>{r(()=>this.qo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}xo(){var e=this;this.state=5,this.So.Io((0,R.Z)(function*(){e.state=0,e.start()}))}qo(e){return W("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return t=>{this.js.enqueueAndForget(()=>this.Po===e?t():(W("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class yy extends vp{constructor(e,t,r,i,s,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,u),this.wt=s}Ko(e,t){return this.bo.ho("Listen",e,t)}onMessage(e){this.So.reset();const t=function ve(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(f=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===f?1:"REMOVE"===f?2:"CURRENT"===f?3:"RESET"===f?4:ae(),i=e.targetChange.targetIds||[],s=function(f,m){return f.dt?(Ie(void 0===m||"string"==typeof m),kt.fromBase64String(m||"")):(Ie(void 0===m||m instanceof Uint8Array),kt.fromUint8Array(m||new Uint8Array))}(n,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&function(f){const m=void 0===f.code?L.UNKNOWN:Tu(f.code);return new K(m,f.message||"")}(u);t=new xu(r,i,s,h||null)}else if("documentChange"in e){const r=e.documentChange,i=l(n,r.document.name),s=$t(r.document.updateTime),u=new Dt({mapValue:{fields:r.document.fields}}),h=ut.newFoundDocument(i,s,u);t=new Qt(r.targetIds||[],r.removedTargetIds||[],h.key,h)}else if("documentDelete"in e){const r=e.documentDelete,i=l(n,r.document),s=r.readTime?$t(r.readTime):be.min(),u=ut.newNoDocument(i,s);t=new Qt([],r.removedTargetIds||[],u.key,u)}else if("documentRemove"in e){const r=e.documentRemove,i=l(n,r.document);t=new Qt([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return ae();{const r=e.filter,s=new dc(r.count||0);t=new Su(r.targetId,s)}}var f;return t}(this.wt,e),r=function(i){if(!("targetChange"in i))return be.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?be.min():s.readTime?$t(s.readTime):be.min()}(e);return this.listener.Go(t,r)}Qo(e){const t={};t.database=x(this.wt),t.addTarget=function(i,s){let u;const h=s.target;return u=fu(h)?{documents:mc(i,h)}:{query:ku(i,h)},u.targetId=s.targetId,s.resumeToken.approximateByteSize()>0?u.resumeToken=fl(i,s.resumeToken):s.snapshotVersion.compareTo(be.min())>0&&(u.readTime=wa(i,s.snapshotVersion.toTimestamp())),u}(this.wt,e);const r=function pl(n,e){const t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ae()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Oo(t)}jo(e){const t={};t.database=x(this.wt),t.removeTarget=e,this.Oo(t)}}class _y extends vp{constructor(e,t,r,i,s,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,u),this.wt=s,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,t){return this.bo.ho("Write",e,t)}onMessage(e){if(Ie(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const t=function Cu(n,e){return n&&n.length>0?(Ie(void 0!==e),n.map(t=>function(r,i){let s=$t(r.updateTime?r.updateTime:i);return s.isEqual(be.min())&&(s=$t(i)),new ph(s,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=$t(e.commitTime);return this.listener.Jo(r,t)}return Ie(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=x(this.wt),this.Oo(e)}Ho(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>yt(this.wt,r))};this.Oo(t)}}class vy extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.bo=r,this.wt=i,this.Zo=!1}tu(){if(this.Zo)throw new K(L.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,t,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.bo.ro(e,t,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new K(L.UNKNOWN,i.toString())})}ao(e,t,r,i){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,u])=>this.bo.ao(e,t,r,s,u,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new K(L.UNKNOWN,s.toString())})}terminate(){this.Zo=!0}}class Iy{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(Je(t),this.su=!1):W("OnlineStateTracker",t)}cu(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}class wy{constructor(e,t,r,i,s){var u=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=s,this.du.Br(h=>{r.enqueueAndForget((0,R.Z)(function*(){var f;lo(u)&&(W("RemoteStore","Restarting streams for network reachability change."),yield(f=(0,R.Z)(function*(m){const v=te(m);v.lu.add(4),yield Mu(v),v._u.set("Unknown"),v.lu.delete(4),yield Cc(v)}),function(m){return f.apply(this,arguments)})(u))}))}),this._u=new Iy(r,i)}}function Cc(n){return qh.apply(this,arguments)}function qh(){return qh=(0,R.Z)(function*(n){if(lo(n))for(const e of n.fu)yield e(!0)}),qh.apply(this,arguments)}function Mu(n){return Kh.apply(this,arguments)}function Kh(){return Kh=(0,R.Z)(function*(n){for(const e of n.fu)yield e(!1)}),Kh.apply(this,arguments)}function Nl(n,e){const t=te(n);t.hu.has(e.targetId)||(t.hu.set(e.targetId,e),Wh(t)?Zh(t):Fu(t).Co()&&zh(t,e))}function kc(n,e){const t=te(n),r=Fu(t);t.hu.delete(e),r.Co()&&Ip(t,e),0===t.hu.size&&(r.Co()?r.ko():lo(t)&&t._u.set("Unknown"))}function zh(n,e){n.wu.Nt(e.targetId),Fu(n).Qo(e)}function Ip(n,e){n.wu.Nt(e),Fu(n).jo(e)}function Zh(n){n.wu=new Jr({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),te:e=>n.hu.get(e)||null}),Fu(n).start(),n._u.iu()}function Wh(n){return lo(n)&&!Fu(n).Do()&&n.hu.size>0}function lo(n){return 0===te(n).lu.size}function wp(n){n.wu=void 0}function Ey(n){return Hh.apply(this,arguments)}function Hh(){return Hh=(0,R.Z)(function*(n){n.hu.forEach((e,t)=>{zh(n,e)})}),Hh.apply(this,arguments)}function Ty(n,e){return Qh.apply(this,arguments)}function Qh(){return Qh=(0,R.Z)(function*(n,e){wp(n),Wh(n)?(n._u.uu(e),Zh(n)):n._u.set("Unknown")}),Qh.apply(this,arguments)}function by(n,e,t){return Yh.apply(this,arguments)}function Yh(){return Yh=(0,R.Z)(function*(n,e,t){if(n._u.set("Online"),e instanceof xu&&2===e.state&&e.cause)try{yield(r=(0,R.Z)(function*(i,s){const u=s.cause;for(const h of s.targetIds)i.hu.has(h)&&(yield i.remoteSyncer.rejectListen(h,u),i.hu.delete(h),i.wu.removeTarget(h))}),function(i,s){return r.apply(this,arguments)})(n,e)}catch(r){W("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Rl(n,r)}else if(e instanceof Qt?n.wu.Ut(e):e instanceof Su?n.wu.zt(e):n.wu.Gt(e),!t.isEqual(be.min()))try{const r=yield cp(n.localStore);t.compareTo(r)>=0&&(yield function(i,s){const u=i.wu.Yt(s);return u.targetChanges.forEach((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const m=i.hu.get(f);m&&i.hu.set(f,m.withResumeToken(h.resumeToken,s))}}),u.targetMismatches.forEach(h=>{const f=i.hu.get(h);if(!f)return;i.hu.set(h,f.withResumeToken(kt.EMPTY_BYTE_STRING,f.snapshotVersion)),Ip(i,h);const m=new ao(f.target,h,1,f.sequenceNumber);zh(i,m)}),i.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){W("RemoteStore","Failed to raise snapshot:",r),yield Rl(n,r)}var r}),Yh.apply(this,arguments)}function Rl(n,e,t){return Jh.apply(this,arguments)}function Jh(){return Jh=(0,R.Z)(function*(n,e,t){if(!Qn(e))throw e;n.lu.add(1),yield Mu(n),n._u.set("Offline"),t||(t=()=>cp(n.localStore)),n.asyncQueue.enqueueRetryable((0,R.Z)(function*(){W("RemoteStore","Retrying IndexedDB access"),yield t(),n.lu.delete(1),yield Cc(n)}))}),Jh.apply(this,arguments)}function Ep(n,e){return e().catch(t=>Rl(n,t,e))}function Lu(n){return Xh.apply(this,arguments)}function Xh(){return Xh=(0,R.Z)(function*(n){const e=te(n),t=ho(e);let r=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;Ay(e);)try{const i=yield ly(e.localStore,r);if(null===i){0===e.au.length&&t.ko();break}r=i.batchId,Sy(e,i)}catch(i){yield Rl(e,i)}Tp(e)&&bp(e)}),Xh.apply(this,arguments)}function Ay(n){return lo(n)&&n.au.length<10}function Sy(n,e){n.au.push(e);const t=ho(n);t.Co()&&t.zo&&t.Ho(e.mutations)}function Tp(n){return lo(n)&&!ho(n).Do()&&n.au.length>0}function bp(n){ho(n).start()}function xy(n){return ed.apply(this,arguments)}function ed(){return ed=(0,R.Z)(function*(n){ho(n).Xo()}),ed.apply(this,arguments)}function Cy(n){return td.apply(this,arguments)}function td(){return td=(0,R.Z)(function*(n){const e=ho(n);for(const t of n.au)e.Ho(t.mutations)}),td.apply(this,arguments)}function ky(n,e,t){return nd.apply(this,arguments)}function nd(){return nd=(0,R.Z)(function*(n,e,t){const r=n.au.shift(),i=Ah.from(r,e,t);yield Ep(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Lu(n)}),nd.apply(this,arguments)}function Dy(n,e){return rd.apply(this,arguments)}function rd(){return rd=(0,R.Z)(function*(n,e){var t;e&&ho(n).zo&&(yield(t=(0,R.Z)(function*(r,i){if(cl(s=i.code)&&s!==L.ABORTED){const u=r.au.shift();ho(r).No(),yield Ep(r,()=>r.remoteSyncer.rejectFailedWrite(u.batchId,i)),yield Lu(r)}var s}),function(r,i){return t.apply(this,arguments)})(n,e)),Tp(n)&&bp(n)}),rd.apply(this,arguments)}function Ap(n,e){return id.apply(this,arguments)}function id(){return id=(0,R.Z)(function*(n,e){const t=te(n);t.asyncQueue.verifyOperationInProgress(),W("RemoteStore","RemoteStore received new credentials");const r=lo(t);t.lu.add(3),yield Mu(t),r&&t._u.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.lu.delete(3),yield Cc(t)}),id.apply(this,arguments)}function sd(n,e){return od.apply(this,arguments)}function od(){return od=(0,R.Z)(function*(n,e){const t=te(n);e?(t.lu.delete(2),yield Cc(t)):e||(t.lu.add(2),yield Mu(t),t._u.set("Unknown"))}),od.apply(this,arguments)}function Fu(n){return n.mu||(n.mu=function(e,t,r){const i=te(e);return i.tu(),new yy(t,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)}(n.datastore,n.asyncQueue,{zr:Ey.bind(null,n),Jr:Ty.bind(null,n),Go:by.bind(null,n)}),n.fu.push(function(){var e=(0,R.Z)(function*(t){t?(n.mu.No(),Wh(n)?Zh(n):n._u.set("Unknown")):(yield n.mu.stop(),wp(n))});return function(t){return e.apply(this,arguments)}}())),n.mu}function ho(n){return n.gu||(n.gu=function(e,t,r){const i=te(e);return i.tu(),new _y(t,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)}(n.datastore,n.asyncQueue,{zr:xy.bind(null,n),Jr:Dy.bind(null,n),Yo:Cy.bind(null,n),Jo:ky.bind(null,n)}),n.fu.push(function(){var e=(0,R.Z)(function*(t){t?(n.gu.No(),yield Lu(n)):(yield n.gu.stop(),n.au.length>0&&(W("RemoteStore",`Stopping write stream with ${n.au.length} pending writes`),n.au=[]))});return function(t){return e.apply(this,arguments)}}())),n.gu}class ad{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new St,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}static createAndSchedule(e,t,r,i,s){const u=Date.now()+r,h=new ad(e,t,u,i,s);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new K(L.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Uu(n,e){if(Je("AsyncQueue",`${e}: ${n}`),Qn(n))return new K(L.UNAVAILABLE,`${e}: ${n}`);throw n}class Vu{constructor(e){this.comparator=e?(t,r)=>e(t,r)||ne.comparator(t.key,r.key):(t,r)=>ne.comparator(t.key,r.key),this.keyedMap=va(),this.sortedSet=new at(this.comparator)}static emptySet(e){return new Vu(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Vu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Vu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Sp{constructor(){this.yu=new at(ne.comparator)}track(e){const t=e.doc.key,r=this.yu.get(t);r?0!==e.type&&3===r.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==r.type?this.yu=this.yu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.yu=this.yu.remove(t):1===e.type&&2===r.type?this.yu=this.yu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):ae():this.yu=this.yu.insert(t,e)}pu(){const e=[];return this.yu.inorderTraversal((t,r)=>{e.push(r)}),e}}class Bu{constructor(e,t,r,i,s,u,h,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=f}static fromInitialDocuments(e,t,r,i){const s=[];return t.forEach(u=>{s.push({type:0,doc:u})}),new Bu(e,t,Vu.emptySet(t),s,r,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Ny{constructor(){this.Iu=void 0,this.listeners=[]}}class Ry{constructor(){this.queries=new Ci(e=>gu(e),pa),this.onlineState="Unknown",this.Tu=new Set}}function ud(n,e){return cd.apply(this,arguments)}function cd(){return cd=(0,R.Z)(function*(n,e){const t=te(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new Ny),i)try{s.Iu=yield t.onListen(r)}catch(u){const h=Uu(u,`Initialization of query '${lc(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,s),s.listeners.push(e),e.Eu(t.onlineState),s.Iu&&e.Au(s.Iu)&&dd(t)}),cd.apply(this,arguments)}function ld(n,e){return hd.apply(this,arguments)}function hd(){return hd=(0,R.Z)(function*(n,e){const t=te(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const u=s.listeners.indexOf(e);u>=0&&(s.listeners.splice(u,1),i=0===s.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),hd.apply(this,arguments)}function Oy(n,e){const t=te(n);let r=!1;for(const i of e){const u=t.queries.get(i.query);if(u){for(const h of u.listeners)h.Au(i)&&(r=!0);u.Iu=i}}r&&dd(t)}function Py(n,e,t){const r=te(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function dd(n){n.Tu.forEach(e=>{e.next()})}class fd{constructor(e,t,r){this.query=e,this.Ru=t,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}Au(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Bu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),t=!0):this.Vu(e,this.onlineState)&&(this.Su(e),t=!0),this.Pu=e,t}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}Vu(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}vu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Su(e){e=Bu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}class My{constructor(e,t){this.payload=e,this.byteLength=t}Cu(){return"metadata"in this.payload}}class xp{constructor(e){this.wt=e}Wi(e){return l(this.wt,e)}zi(e){return e.metadata.exists?ue(this.wt,e.document,!1):ut.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return $t(e)}}class Ly{constructor(e,t,r){this.xu=e,this.localStore=t,this.wt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Cp(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;const r=Ue.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ku(e){const t=new Map,r=new xp(this.wt);for(const i of e)if(i.metadata.queries){const s=r.Wi(i.metadata.name);for(const u of i.metadata.queries){const h=(t.get(u)||Ne()).add(s);t.set(u,h)}}return t}complete(){var e=this;return(0,R.Z)(function*(){const t=yield function hy(n,e,t,r){return Fh.apply(this,arguments)}(e.localStore,new xp(e.wt),e.documents,e.xu.id),r=e.ku(e.documents);for(const i of e.queries)yield dy(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Mu:e.collectionGroups,Ou:t}})()}}function Cp(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class kp{constructor(e){this.key=e}}class Dp{constructor(e){this.key=e}}class Np{constructor(e,t){this.query=e,this.Fu=t,this.$u=null,this.current=!1,this.Bu=Ne(),this.mutatedKeys=Ne(),this.Lu=Xc(e),this.Uu=new Vu(this.Lu)}get qu(){return this.Fu}Ku(e,t){const r=t?t.Gu:new Sp,i=t?t.Uu:this.Uu;let s=t?t.mutatedKeys:this.mutatedKeys,u=i,h=!1;const f="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,m="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((v,E)=>{const O=i.get(v),U=ga(this.query,E)?E:null,$=!!O&&this.mutatedKeys.has(O.key),X=!!U&&(U.hasLocalMutations||this.mutatedKeys.has(U.key)&&U.hasCommittedMutations);let ce=!1;O&&U?O.data.isEqual(U.data)?$!==X&&(r.track({type:3,doc:U}),ce=!0):this.Qu(O,U)||(r.track({type:2,doc:U}),ce=!0,(f&&this.Lu(U,f)>0||m&&this.Lu(U,m)<0)&&(h=!0)):!O&&U?(r.track({type:0,doc:U}),ce=!0):O&&!U&&(r.track({type:1,doc:O}),ce=!0,(f||m)&&(h=!0)),ce&&(U?(u=u.add(U),s=X?s.add(v):s.delete(v)):(u=u.delete(v),s=s.delete(v)))}),null!==this.query.limit)for(;u.size>this.query.limit;){const v="F"===this.query.limitType?u.last():u.first();u=u.delete(v.key),s=s.delete(v.key),r.track({type:1,doc:v})}return{Uu:u,Gu:r,Mi:h,mutatedKeys:s}}Qu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const s=e.Gu.pu();s.sort((m,v)=>function(E,O){const U=$=>{switch($){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae()}};return U(E)-U(O)}(m.type,v.type)||this.Lu(m.doc,v.doc)),this.ju(r);const u=t?this.Wu():[],h=0===this.Bu.size&&this.current?1:0,f=h!==this.$u;return this.$u=h,0!==s.length||f?{snapshot:new Bu(this.query,e.Uu,i,s,e.mutatedKeys,0===h,f,!1),zu:u}:{zu:u}}Eu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new Sp,mutatedKeys:this.mutatedKeys,Mi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(t=>this.Fu=this.Fu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Fu=this.Fu.delete(t)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=Ne(),this.Uu.forEach(r=>{this.Hu(r.key)&&(this.Bu=this.Bu.add(r.key))});const t=[];return e.forEach(r=>{this.Bu.has(r)||t.push(new Dp(r))}),this.Bu.forEach(r=>{e.has(r)||t.push(new kp(r))}),t}Ju(e){this.Fu=e.ji,this.Bu=Ne();const t=this.Ku(e.documents);return this.applyChanges(t,!0)}Yu(){return Bu.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}class Fy{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Uy{constructor(e){this.key=e,this.Xu=!1}}class Vy{constructor(e,t,r,i,s,u){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=u,this.Zu={},this.tc=new Ci(h=>gu(h),pa),this.ec=new Map,this.nc=new Set,this.sc=new at(ne.comparator),this.ic=new Map,this.rc=new Dh,this.oc={},this.uc=new Map,this.cc=Ca.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return!0===this.ac}}function By(n,e){return pd.apply(this,arguments)}function pd(){return pd=(0,R.Z)(function*(n,e){const t=Fd(n);let r,i;const s=t.tc.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.Yu();else{const u=yield Ou(t.localStore,Nt(e));t.isPrimaryClient&&Nl(t.remoteStore,u);const h=t.sharedClientState.addLocalQueryTarget(u.targetId);r=u.targetId,i=yield gd(t,e,r,"current"===h)}return i}),pd.apply(this,arguments)}function gd(n,e,t,r){return md.apply(this,arguments)}function md(){return md=(0,R.Z)(function*(n,e,t,r){n.hc=(v,E,O)=>{return(U=(0,R.Z)(function*($,X,ce,Fe){let He=X.view.Ku(ce);He.Mi&&(He=yield xl($.localStore,X.query,!1).then(({documents:Oe})=>X.view.Ku(Oe,He)));const Ke=Fe&&Fe.targetChanges.get(X.targetId),Re=X.view.applyChanges(He,$.isPrimaryClient,Ke);return Sd($,X.targetId,Re.zu),Re.snapshot}),function($,X,ce,Fe){return U.apply(this,arguments)})(n,v,E,O);var U};const i=yield xl(n.localStore,e,!0),s=new Np(e,i.ji),u=s.Ku(i.documents),h=so.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState),f=s.applyChanges(u,n.isPrimaryClient,h);Sd(n,t,f.zu);const m=new Fy(e,t,s);return n.tc.set(e,m),n.ec.has(t)?n.ec.get(t).push(e):n.ec.set(t,[e]),f.snapshot}),md.apply(this,arguments)}function $y(n,e){return yd.apply(this,arguments)}function yd(){return yd=(0,R.Z)(function*(n,e){const t=te(n),r=t.tc.get(e),i=t.ec.get(r.targetId);if(i.length>1)return t.ec.set(r.targetId,i.filter(s=>!pa(s,e))),void t.tc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Pu(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),kc(t.remoteStore,r.targetId),$u(t,r.targetId)}).catch(Hn))):($u(t,r.targetId),yield Pu(t.localStore,r.targetId,!0))}),yd.apply(this,arguments)}function _d(){return _d=(0,R.Z)(function*(n,e,t){const r=Ud(n);try{const i=yield function(s,u){const h=te(s),f=st.now(),m=u.reduce((O,U)=>O.add(U.key),Ne());let v,E;return h.persistence.runTransaction("Locally write mutations","readwrite",O=>{let U=Bt(),$=Ne();return h.Ui.getEntries(O,m).next(X=>{U=X,U.forEach((ce,Fe)=>{Fe.isValidDocument()||($=$.add(ce))})}).next(()=>h.localDocuments.getOverlayedDocuments(O,U)).next(X=>{v=X;const ce=[];for(const Fe of u){const He=mh(Fe,v.get(Fe.key).overlayedDocument);null!=He&&ce.push(new kr(Fe.key,He,qc(He.value.mapValue),mt.exists(!0)))}return h.mutationQueue.addMutationBatch(O,f,ce,u)}).next(X=>{E=X;const ce=X.applyToLocalDocumentSet(v,$);return h.documentOverlayCache.saveOverlays(O,X.batchId,ce)})}).then(()=>({batchId:E.batchId,changes:bu(v)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,u,h){let f=s.oc[s.currentUser.toKey()];f||(f=new at(_e)),f=f.insert(u,h),s.oc[s.currentUser.toKey()]=f}(r,i.batchId,t),yield ps(r,i.changes),yield Lu(r.remoteStore)}catch(i){const s=Uu(i,"Failed to persist write");t.reject(s)}}),_d.apply(this,arguments)}function Rp(n,e){return vd.apply(this,arguments)}function vd(){return vd=(0,R.Z)(function*(n,e){const t=te(n);try{const r=yield cy(t.localStore,e);e.targetChanges.forEach((i,s)=>{const u=t.ic.get(s);u&&(Ie(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?u.Xu=!0:i.modifiedDocuments.size>0?Ie(u.Xu):i.removedDocuments.size>0&&(Ie(u.Xu),u.Xu=!1))}),yield ps(t,r,e)}catch(r){yield Hn(r)}}),vd.apply(this,arguments)}function Op(n,e,t){const r=te(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.tc.forEach((s,u)=>{const h=u.view.Eu(e);h.snapshot&&i.push(h.snapshot)}),function(s,u){const h=te(s);h.onlineState=u;let f=!1;h.queries.forEach((m,v)=>{for(const E of v.listeners)E.Eu(u)&&(f=!0)}),f&&dd(h)}(r.eventManager,e),i.length&&r.Zu.Go(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Gy(n,e,t){return Id.apply(this,arguments)}function Id(){return Id=(0,R.Z)(function*(n,e,t){const r=te(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ic.get(e),s=i&&i.key;if(s){let u=new at(ne.comparator);u=u.insert(s,ut.newNoDocument(s,be.min()));const h=Ne().add(s),f=new Ia(be.min(),new Map,new We(_e),u,h);yield Rp(r,f),r.sc=r.sc.remove(s),r.ic.delete(e),xd(r)}else yield Pu(r.localStore,e,!1).then(()=>$u(r,e,t)).catch(Hn)}),Id.apply(this,arguments)}function qy(n,e){return wd.apply(this,arguments)}function wd(){return wd=(0,R.Z)(function*(n,e){const t=te(n),r=e.batch.batchId;try{const i=yield uy(t.localStore,e);Ad(t,r,null),bd(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ps(t,i)}catch(i){yield Hn(i)}}),wd.apply(this,arguments)}function Ky(n,e,t){return Ed.apply(this,arguments)}function Ed(){return Ed=(0,R.Z)(function*(n,e,t){const r=te(n);try{const i=yield function(s,u){const h=te(s);return h.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let m;return h.mutationQueue.lookupMutationBatch(f,u).next(v=>(Ie(null!==v),m=v.keys(),h.mutationQueue.removeMutationBatch(f,v))).next(()=>h.mutationQueue.performConsistencyCheck(f)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(f,m,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m)).next(()=>h.localDocuments.getDocuments(f,m))})}(r.localStore,e);Ad(r,e,t),bd(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ps(r,i)}catch(i){yield Hn(i)}}),Ed.apply(this,arguments)}function Td(){return Td=(0,R.Z)(function*(n,e){const t=te(n);lo(t.remoteStore)||W("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(s){const u=te(s);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>u.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(-1===r)return void e.resolve();const i=t.uc.get(r)||[];i.push(e),t.uc.set(r,i)}catch(r){const i=Uu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),Td.apply(this,arguments)}function bd(n,e){(n.uc.get(e)||[]).forEach(t=>{t.resolve()}),n.uc.delete(e)}function Ad(n,e,t){const r=te(n);let i=r.oc[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.oc[r.currentUser.toKey()]=i}}function $u(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.ec.get(e))n.tc.delete(r),t&&n.Zu.lc(r,t);n.ec.delete(e),n.isPrimaryClient&&n.rc.us(e).forEach(r=>{n.rc.containsKey(r)||Pp(n,r)})}function Pp(n,e){n.nc.delete(e.path.canonicalString());const t=n.sc.get(e);null!==t&&(kc(n.remoteStore,t),n.sc=n.sc.remove(e),n.ic.delete(t),xd(n))}function Sd(n,e,t){for(const r of t)r instanceof kp?(n.rc.addReference(r.key,e),Zy(n,r)):r instanceof Dp?(W("SyncEngine","Document no longer in limbo: "+r.key),n.rc.removeReference(r.key,e),n.rc.containsKey(r.key)||Pp(n,r.key)):ae()}function Zy(n,e){const t=e.key,r=t.path.canonicalString();n.sc.get(t)||n.nc.has(r)||(W("SyncEngine","New document in limbo: "+t),n.nc.add(r),xd(n))}function xd(n){for(;n.nc.size>0&&n.sc.size<n.maxConcurrentLimboResolutions;){const e=n.nc.values().next().value;n.nc.delete(e);const t=new ne(Ue.fromString(e)),r=n.cc.next();n.ic.set(r,new Uy(t)),n.sc=n.sc.insert(t,r),Nl(n.remoteStore,new ao(Nt(hs(t.path)),r,2,mn.ot))}}function ps(n,e,t){return Cd.apply(this,arguments)}function Cd(){return Cd=(0,R.Z)(function*(n,e,t){const r=te(n),i=[],s=[],u=[];var h;r.tc.isEmpty()||(r.tc.forEach((h,f)=>{u.push(r.hc(f,e,t).then(m=>{if(m){r.isPrimaryClient&&r.sharedClientState.updateQueryState(f.targetId,m.fromCache?"not-current":"current"),i.push(m);const v=Ph.Vi(f.targetId,m);s.push(v)}}))}),yield Promise.all(u),r.Zu.Go(i),yield(h=(0,R.Z)(function*(f,m){const v=te(f);try{yield v.persistence.runTransaction("notifyLocalViewChanges","readwrite",E=>P.forEach(m,O=>P.forEach(O.Pi,U=>v.persistence.referenceDelegate.addReference(E,O.targetId,U)).next(()=>P.forEach(O.vi,U=>v.persistence.referenceDelegate.removeReference(E,O.targetId,U)))))}catch(E){if(!Qn(E))throw E;W("LocalStore","Failed to update sequence numbers: "+E)}for(const E of m){const O=E.targetId;if(!E.fromCache){const U=v.$i.get(O),X=U.withLastLimboFreeSnapshotVersion(U.snapshotVersion);v.$i=v.$i.insert(O,X)}}}),function(f,m){return h.apply(this,arguments)})(r.localStore,s))}),Cd.apply(this,arguments)}function Wy(n,e){return kd.apply(this,arguments)}function kd(){return kd=(0,R.Z)(function*(n,e){const t=te(n);if(!t.currentUser.isEqual(e)){W("SyncEngine","User change. New user:",e.toKey());const r=yield up(t.localStore,e);t.currentUser=e,(i=t).uc.forEach(u=>{u.forEach(h=>{h.reject(new K(L.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.uc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ps(t,r.Ki)}var i}),kd.apply(this,arguments)}function Hy(n,e){const t=te(n),r=t.ic.get(e);if(r&&r.Xu)return Ne().add(r.key);{let i=Ne();const s=t.ec.get(e);if(!s)return i;for(const u of s){const h=t.tc.get(u);i=i.unionWith(h.view.qu)}return i}}function Qy(n,e){return Dd.apply(this,arguments)}function Dd(){return Dd=(0,R.Z)(function*(n,e){const t=te(n),r=yield xl(t.localStore,e.query,!0),i=e.view.Ju(r);return t.isPrimaryClient&&Sd(t,e.targetId,i.zu),i}),Dd.apply(this,arguments)}function Yy(n,e){return Nd.apply(this,arguments)}function Nd(){return Nd=(0,R.Z)(function*(n,e){const t=te(n);return dp(t.localStore,e).then(r=>ps(t,r))}),Nd.apply(this,arguments)}function Jy(n,e,t,r){return Rd.apply(this,arguments)}function Rd(){return Rd=(0,R.Z)(function*(n,e,t,r){const i=te(n),s=yield function(u,h){const f=te(u),m=te(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",v=>m.yn(v,h).next(E=>E?f.localDocuments.getDocuments(v,E):P.resolve(null)))}(i.localStore,e);var h;null!==s?("pending"===t?yield Lu(i.remoteStore):"acknowledged"===t||"rejected"===t?(Ad(i,e,r||null),bd(i,e),h=e,te(te(i.localStore).mutationQueue).In(h)):ae(),yield ps(i,s)):W("SyncEngine","Cannot apply mutation batch with id: "+e)}),Rd.apply(this,arguments)}function Od(){return Od=(0,R.Z)(function*(n,e){const t=te(n);if(Fd(t),Ud(t),!0===e&&!0!==t.ac){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield Mp(t,r.toArray());t.ac=!0,yield sd(t.remoteStore,!0);for(const s of i)Nl(t.remoteStore,s)}else if(!1===e&&!1!==t.ac){const r=[];let i=Promise.resolve();t.ec.forEach((s,u)=>{t.sharedClientState.isLocalQueryTarget(u)?r.push(u):i=i.then(()=>($u(t,u),Pu(t.localStore,u,!0))),kc(t.remoteStore,u)}),yield i,yield Mp(t,r),function(s){const u=te(s);u.ic.forEach((h,f)=>{kc(u.remoteStore,f)}),u.rc.cs(),u.ic=new Map,u.sc=new at(ne.comparator)}(t),t.ac=!1,yield sd(t.remoteStore,!1)}}),Od.apply(this,arguments)}function Mp(n,e,t){return Pd.apply(this,arguments)}function Pd(){return Pd=(0,R.Z)(function*(n,e,t){const r=te(n),i=[],s=[];for(const u of e){let h;const f=r.ec.get(u);if(f&&0!==f.length){h=yield Ou(r.localStore,Nt(f[0]));for(const m of f){const v=r.tc.get(m),E=yield Qy(r,v);E.snapshot&&s.push(E.snapshot)}}else{const m=yield hp(r.localStore,u);h=yield Ou(r.localStore,m),yield gd(r,Lp(m),u,!1)}i.push(h)}return r.Zu.Go(s),i}),Pd.apply(this,arguments)}function Lp(n){return Yc(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function e_(n){const e=te(n);return te(te(e.localStore).persistence).Ri()}function t_(n,e,t,r){return Md.apply(this,arguments)}function Md(){return Md=(0,R.Z)(function*(n,e,t,r){const i=te(n);if(i.ac)return void W("SyncEngine","Ignoring unexpected query state notification.");const s=i.ec.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const u=yield dp(i.localStore,Jc(s[0])),h=Ia.createSynthesizedRemoteEventForCurrentChange(e,"current"===t);yield ps(i,u,h);break}case"rejected":yield Pu(i.localStore,e,!0),$u(i,e,r);break;default:ae()}}),Md.apply(this,arguments)}function n_(n,e,t){return Ld.apply(this,arguments)}function Ld(){return Ld=(0,R.Z)(function*(n,e,t){const r=Fd(n);if(r.ac){for(const i of e){if(r.ec.has(i)){W("SyncEngine","Adding an already active target "+i);continue}const s=yield hp(r.localStore,i),u=yield Ou(r.localStore,s);yield gd(r,Lp(s),u.targetId,!1),Nl(r.remoteStore,u)}for(const i of t)r.ec.has(i)&&(yield Pu(r.localStore,i,!1).then(()=>{kc(r.remoteStore,i),$u(r,i)}).catch(Hn))}}),Ld.apply(this,arguments)}function Fd(n){const e=te(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Hy.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Gy.bind(null,e),e.Zu.Go=Oy.bind(null,e.eventManager),e.Zu.lc=Py.bind(null,e.eventManager),e}function Ud(n){const e=te(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qy.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ky.bind(null,e),e}class Fp{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,R.Z)(function*(){t.wt=xc(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),yield t.persistence.start(),t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore)})()}mc(e,t){return null}gc(e,t){return null}wc(e){return ap(this.persistence,new op,e.initialUser,this.wt)}_c(e){return new ip(Al.Os,this.wt)}dc(e){return new mp}terminate(){var e=this;return(0,R.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Up extends Fp{constructor(e,t,r){super(),this.yc=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,R.Z)(function*(){yield t().call(r,e),yield r.yc.initialize(r,e),yield Ud(r.yc.syncEngine),yield Lu(r.yc.remoteStore),yield r.persistence.ci(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}wc(e){return ap(this.persistence,new op,e.initialUser,this.wt)}mc(e,t){return new Zm(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}gc(e,t){const r=new cs(t,this.persistence);return new ca(e.asyncQueue,r)}_c(e){const t=Oh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?er.withCacheSize(this.cacheSizeBytes):er.DEFAULT;return new Rh(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,_p(),Dl(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new mp}}class i_ extends Up{constructor(e,t){super(e,t,!1),this.yc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,R.Z)(function*(){yield t().call(r,e);const i=r.yc.syncEngine;r.sharedClientState instanceof jh&&(r.sharedClientState.syncEngine={kr:Jy.bind(null,i),Mr:t_.bind(null,i),Or:n_.bind(null,i),Ri:e_.bind(null,i),Nr:Yy.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.ci(function(){var s=(0,R.Z)(function*(u){yield function Xy(n,e){return Od.apply(this,arguments)}(r.yc.syncEngine,u),r.gcScheduler&&(u&&!r.gcScheduler.started?r.gcScheduler.start():u||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(u&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():u||r.indexBackfillerScheduler.stop())});return function(u){return s.apply(this,arguments)}}())})()}dc(e){const t=_p();if(!jh.V(t))throw new K(L.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Oh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new jh(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Vd{initialize(e,t){var r=this;return(0,R.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>Op(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=Wy.bind(null,r.syncEngine),yield sd(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new Ry}createDatastore(e){const t=xc(e.databaseInfo.databaseId),r=new my(e.databaseInfo);return new vy(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,s=h=>Op(this.syncEngine,h,0),u=yp.V()?new yp:new fy,new wy(t,r,i,s,u);var t,r,i,s,u}createSyncEngine(e,t){return function(r,i,s,u,h,f,m){const v=new Vy(r,i,s,u,h,f);return m&&(v.ac=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,R.Z)(function*(t){const r=te(t);W("RemoteStore","RemoteStore shutting down."),r.lu.add(5),yield Mu(r),r.du.shutdown(),r._u.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function Vp(n,e=10240){let t=0;return{read:()=>(0,R.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,R.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class Ol{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):Je("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class s_{constructor(e,t){this.Ec=e,this.wt=t,this.metadata=new St,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(r=>{r&&r.Cu()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.payload)}`))},r=>this.metadata.reject(r))}close(){return this.Ec.cancel()}getMetadata(){var e=this;return(0,R.Z)(function*(){return e.metadata.promise})()}fc(){var e=this;return(0,R.Z)(function*(){return yield e.getMetadata(),e.Rc()})()}Rc(){var e=this;return(0,R.Z)(function*(){const t=yield e.bc();if(null===t)return null;const r=e.Ac.decode(t),i=Number(r);isNaN(i)&&e.Pc(`length string (${r}) is not valid number`);const s=yield e.vc(i);return new My(JSON.parse(s),t.length+i)})()}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}bc(){var e=this;return(0,R.Z)(function*(){for(;e.Vc()<0&&!(yield e.Sc()););if(0===e.buffer.length)return null;const t=e.Vc();t<0&&e.Pc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}vc(e){var t=this;return(0,R.Z)(function*(){for(;t.buffer.length<e;)(yield t.Sc())&&t.Pc("Reached the end of bundle when more is expected.");const r=t.Ac.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}Sc(){var e=this;return(0,R.Z)(function*(){const t=yield e.Ec.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class o_{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,R.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new K(L.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,R.Z)(function*(s,u){const h=te(s),f=x(h.wt)+"/documents",m={documents:u.map(U=>a(h.wt,U))},v=yield h.ao("BatchGetDocuments",f,m,u.length),E=new Map;v.forEach(U=>{const $=function Ae(n,e){return"found"in e?function(t,r){Ie(!!r.found);const i=l(t,r.found.name),s=$t(r.found.updateTime),u=new Dt({mapValue:{fields:r.found.fields}});return ut.newFoundDocument(i,s,u)}(n,e):"missing"in e?function(t,r){Ie(!!r.missing),Ie(!!r.readTime);const i=l(t,r.missing),s=$t(r.readTime);return ut.newNoDocument(i,s)}(n,e):ae()}(h.wt,U);E.set($.key.toString(),$)});const O=[];return u.forEach(U=>{const $=E.get(U.toString());Ie(!!$),O.push($)}),O}),function(s,u){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ro(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,R.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const s=ne.fromPath(i);e.mutations.push(new Eu(s,e.precondition(s)))}),yield(r=(0,R.Z)(function*(i,s){const u=te(i),h=x(u.wt)+"/documents",f={writes:s.map(m=>yt(u.wt,m))};yield u.ro("Commit",h,f)}),function(i,s){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ae();t=be.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new K(L.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?mt.updateTime(t):mt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(be.min()))throw new K(L.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return mt.updateTime(t)}return mt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class a_{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Dc=r.maxAttempts,this.So=new Gh(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){var e=this;this.So.Io((0,R.Z)(function*(){const t=new o_(e.datastore),r=e.xc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.Nc(s)}))}).catch(i=>{e.Nc(i)})}))}xc(e){try{const t=this.updateFunction(e);return!D(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!cl(t)}return!1}}class u_{constructor(e,t,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ct.UNAUTHENTICATED,this.clientId=ra.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var u=(0,R.Z)(function*(h){W("FirestoreClient","Received user=",h.uid),yield s.authCredentialListener(h),s.user=h});return function(h){return u.apply(this,arguments)}}()),this.appCheckCredentials.start(r,u=>(W("FirestoreClient","Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}getConfiguration(){var e=this;return(0,R.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new K(L.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new St;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,R.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=Uu(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function Bp(n,e){return Bd.apply(this,arguments)}function Bd(){return Bd=(0,R.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),W("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,R.Z)(function*(s){r.isEqual(s)||(yield up(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),Bd.apply(this,arguments)}function $p(n,e){return $d.apply(this,arguments)}function $d(){return $d=(0,R.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield jd(n);W("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>Ap(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>Ap(e.remoteStore,s)),n.onlineComponents=e}),$d.apply(this,arguments)}function jd(n){return Gd.apply(this,arguments)}function Gd(){return Gd=(0,R.Z)(function*(n){return n.offlineComponents||(W("FirestoreClient","Using default OfflineComponentProvider"),yield Bp(n,new Fp)),n.offlineComponents}),Gd.apply(this,arguments)}function Pl(n){return qd.apply(this,arguments)}function qd(){return qd=(0,R.Z)(function*(n){return n.onlineComponents||(W("FirestoreClient","Using default OnlineComponentProvider"),yield $p(n,new Vd)),n.onlineComponents}),qd.apply(this,arguments)}function jp(n){return jd(n).then(e=>e.persistence)}function Ml(n){return jd(n).then(e=>e.localStore)}function Gp(n){return Pl(n).then(e=>e.remoteStore)}function Kd(n){return Pl(n).then(e=>e.syncEngine)}function ju(n){return zd.apply(this,arguments)}function zd(){return zd=(0,R.Z)(function*(n){const e=yield Pl(n),t=e.eventManager;return t.onListen=By.bind(null,e.syncEngine),t.onUnlisten=$y.bind(null,e.syncEngine),t}),zd.apply(this,arguments)}function qp(n,e,t={}){const r=new St;return n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return function(i,s,u,h,f){const m=new Ol({next:E=>{s.enqueueAndForget(()=>ld(i,v));const O=E.docs.has(u);!O&&E.fromCache?f.reject(new K(L.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&E.fromCache&&h&&"server"===h.source?f.reject(new K(L.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(E)},error:E=>f.reject(E)}),v=new fd(hs(u.path),m,{includeMetadataChanges:!0,Du:!0});return ud(i,v)}(yield ju(n),n.asyncQueue,e,t,r)})),r.promise}function Kp(n,e,t={}){const r=new St;return n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return function(i,s,u,h,f){const m=new Ol({next:E=>{s.enqueueAndForget(()=>ld(i,v)),E.fromCache&&"server"===h.source?f.reject(new K(L.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(E)},error:E=>f.reject(E)}),v=new fd(u,m,{includeMetadataChanges:!0,Du:!0});return ud(i,v)}(yield ju(n),n.asyncQueue,e,t,r)})),r.promise}const zp=new Map;function Zd(n,e,t){if(!t)throw new K(L.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Zp(n,e,t,r){if(!0===e&&!0===r)throw new K(L.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Wp(n){if(!ne.isDocumentKey(n))throw new K(L.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Hp(n){if(ne.isDocumentKey(n))throw new K(L.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ll(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":ae()}function qe(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new K(L.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ll(n);throw new K(L.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Qp(n,e){if(e<=0)throw new K(L.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class Yp{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new K(L.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new K(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,Zp("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Dc{constructor(e,t,r){this._authCredentials=t,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yp({}),this._settingsFrozen=!1,e instanceof w?this._databaseId=e:(this._app=e,this._databaseId=function(i){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new K(L.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new w(i.options.projectId)}(e))}get app(){if(!this._app)throw new K(L.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new K(L.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yp(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new iu;switch(t.type){case"gapi":const r=t.client;return Ie(!("object"!=typeof r||null===r||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new cr(r,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new K(L.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=zp.get(e);t&&(W("ComponentProvider","Removing Datastore"),zp.delete(e),t.terminate())}(this),Promise.resolve()}}class _t{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ri(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _t(this.firestore,e,this._key)}}class wn{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new wn(this.firestore,e,this._query)}}class Ri extends wn{constructor(e,t,r){super(e,t,hs(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _t(this.firestore,null,new ne(e))}withConverter(e){return new Ri(this.firestore,e,this._path)}}function Jp(n,e,...t){if(n=(0,Y.m9)(n),Zd("collection","path",e),n instanceof Dc){const r=Ue.fromString(e,...t);return Hp(r),new Ri(n,null,r)}{if(!(n instanceof _t||n instanceof Ri))throw new K(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ue.fromString(e,...t));return Hp(r),new Ri(n.firestore,null,r)}}function Fl(n,e,...t){if(n=(0,Y.m9)(n),1===arguments.length&&(e=ra.I()),Zd("doc","path",e),n instanceof Dc){const r=Ue.fromString(e,...t);return Wp(r),new _t(n,null,new ne(r))}{if(!(n instanceof _t||n instanceof Ri))throw new K(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ue.fromString(e,...t));return Wp(r),new _t(n.firestore,n instanceof Ri?n.converter:null,new ne(r))}}function Xp(n,e){return n=(0,Y.m9)(n),e=(0,Y.m9)(e),(n instanceof _t||n instanceof Ri)&&(e instanceof _t||e instanceof Ri)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function eg(n,e){return n=(0,Y.m9)(n),e=(0,Y.m9)(e),n instanceof wn&&e instanceof wn&&n.firestore===e.firestore&&pa(n._query,e._query)&&n.converter===e.converter}class v_{constructor(){this.Mc=Promise.resolve(),this.Oc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new Gh(this,"async_queue_retry"),this.Kc=()=>{const t=Dl();t&&W("AsyncQueue","Visibility state changed to "+t.visibilityState),this.So.Eo()};const e=Dl();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const t=Dl();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const t=new St;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Oc.push(e),this.jc()))}jc(){var e=this;return(0,R.Z)(function*(){if(0!==e.Oc.length){try{yield e.Oc[0](),e.Oc.shift(),e.So.reset()}catch(t){if(!Qn(t))throw t;W("AsyncQueue","Operation failed with retryable error: "+t)}e.Oc.length>0&&e.So.Io(()=>e.jc())}})()}Qc(e){const t=this.Mc.then(()=>(this.Lc=!0,e().catch(r=>{throw this.Bc=r,this.Lc=!1,Je("INTERNAL UNHANDLED ERROR: ",function(s){let u=s.message||"";return s.stack&&(u=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),u}(r)),r}).then(r=>(this.Lc=!1,r))));return this.Mc=t,t}enqueueAfterDelay(e,t,r){this.Gc(),this.qc.indexOf(e)>-1&&(t=0);const i=ad.createAndSchedule(this,e,t,r,s=>this.Wc(s));return this.$c.push(i),i}Gc(){this.Bc&&ae()}verifyOperationInProgress(){}zc(){var e=this;return(0,R.Z)(function*(){let t;do{t=e.Mc,yield t}while(t!==e.Mc)})()}Hc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}function Wd(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class I_{constructor(){this._progressObserver={},this._taskCompletionResolver=new St,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Tt extends Dc{constructor(e,t,r){super(e,t,r),this.type="firestore",this._queue=new v_,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||tg(this),this._firestoreClient.terminate()}}function jt(n){return n._firestoreClient||tg(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function tg(n){var e;const t=n._freezeSettings(),r=(s=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new y(n._databaseId,s,n._persistenceKey,(h=t).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,h.useFetchStreams));var s,h;n._firestoreClient=new u_(n._authCredentials,n._appCheckCredentials,n._queue,r)}function ng(n,e,t){const r=new St;return n.asyncQueue.enqueue((0,R.Z)(function*(){try{yield Bp(n,t),yield $p(n,e),r.resolve()}catch(i){const s=i;if(!("FirebaseError"===(u=s).name?u.code===L.FAILED_PRECONDITION||u.code===L.UNIMPLEMENTED:!(typeof DOMException<"u"&&u instanceof DOMException)||22===u.code||20===u.code||11===u.code))throw s;Wn("Error enabling offline persistence. Falling back to persistence disabled: "+s),r.reject(s)}var u})).then(()=>r.promise)}function rg(n){if(n._initialized||n._terminated)throw new K(L.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class gs{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new K(L.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ot(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Oi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Oi(kt.fromBase64String(e))}catch(t){throw new K(L.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Oi(kt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Da{constructor(e){this._methodName=e}}class Ul{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new K(L.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new K(L.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return _e(this._lat,e._lat)||_e(this._long,e._long)}}const D_=/^__.*__$/;class N_{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new kr(e,this.data,this.fieldMask,t,this.fieldTransforms):new no(e,this.data,t,this.fieldTransforms)}}class ig{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new kr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function sg(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae()}}class Vl{constructor(e,t,r,i,s,u){this.settings=e,this.databaseId=t,this.wt=r,this.ignoreUndefinedProperties=i,void 0===s&&this.Xc(),this.fieldTransforms=s||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new Vl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ta({path:r,na:!1});return i.sa(e),i}ia(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ta({path:r,na:!1});return i.Xc(),i}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return jl(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(sg(this.Zc)&&D_.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class R_{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.wt=r||xc(e)}aa(e,t,r,i=!1){return new Vl({Zc:e,methodName:t,ca:r,path:ot.emptyPath(),na:!1,ua:i},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function Na(n){const e=n._freezeSettings(),t=xc(n._databaseId);return new R_(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Bl(n,e,t,r,i,s={}){const u=n.aa(s.merge||s.mergeFields?2:0,e,t,i);Jd("Data must be an object, but it was:",u,r);const h=ug(r,u);let f,m;if(s.merge)f=new Wt(u.fieldMask),m=u.fieldTransforms;else if(s.mergeFields){const v=[];for(const E of s.mergeFields){const O=Xd(e,E,t);if(!u.contains(O))throw new K(L.INVALID_ARGUMENT,`Field '${O}' is specified in your field mask but missing from your input data.`);lg(v,O)||v.push(O)}f=new Wt(v),m=u.fieldTransforms.filter(E=>f.covers(E.field))}else f=null,m=u.fieldTransforms;return new N_(new Dt(h),f,m)}class Nc extends Da{_toFieldTransform(e){if(2!==e.Zc)throw e.oa(1===e.Zc?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Nc}}function og(n,e,t){return new Vl({Zc:3,ca:e.settings.ca,methodName:n._methodName,na:t},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class Hd extends Da{_toFieldTransform(e){return new ma(e.path,new eo)}isEqual(e){return e instanceof Hd}}class O_ extends Da{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=og(this,e,!0),r=this.ha.map(s=>Ra(s,t)),i=new Si(r);return new ma(e.path,i)}isEqual(e){return this===e}}class P_ extends Da{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=og(this,e,!0),r=this.ha.map(s=>Ra(s,t)),i=new ds(r);return new ma(e.path,i)}isEqual(e){return this===e}}class M_ extends Da{constructor(e,t){super(e),this.la=t}_toFieldTransform(e){const t=new xi(e.wt,mu(e.wt,this.la));return new ma(e.path,t)}isEqual(e){return this===e}}function Qd(n,e,t,r){const i=n.aa(1,e,t);Jd("Data must be an object, but it was:",i,r);const s=[],u=Dt.empty();Ei(r,(f,m)=>{const v=$l(e,f,t);m=(0,Y.m9)(m);const E=i.ia(v);if(m instanceof Nc)s.push(v);else{const O=Ra(m,E);null!=O&&(s.push(v),u.set(v,O))}});const h=new Wt(s);return new ig(u,h,i.fieldTransforms)}function Yd(n,e,t,r,i,s){const u=n.aa(1,e,t),h=[Xd(e,r,t)],f=[i];if(s.length%2!=0)throw new K(L.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let O=0;O<s.length;O+=2)h.push(Xd(e,s[O])),f.push(s[O+1]);const m=[],v=Dt.empty();for(let O=h.length-1;O>=0;--O)if(!lg(m,h[O])){const U=h[O];let $=f[O];$=(0,Y.m9)($);const X=u.ia(U);if($ instanceof Nc)m.push(U);else{const ce=Ra($,X);null!=ce&&(m.push(U),v.set(U,ce))}}const E=new Wt(m);return new ig(v,E,u.fieldTransforms)}function ag(n,e,t,r=!1){return Ra(t,n.aa(r?4:3,e))}function Ra(n,e){if(cg(n=(0,Y.m9)(n)))return Jd("Unsupported field value:",e,n),ug(n,e);if(n instanceof Da)return function(t,r){if(!sg(r.Zc))throw r.oa(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.oa(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.na&&4!==e.Zc)throw e.oa("Nested arrays are not supported");return function(t,r){const i=[];let s=0;for(const u of t){let h=Ra(u,r.ra(s));null==h&&(h={nullValue:"NULL_VALUE"}),i.push(h),s++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,Y.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return mu(r.wt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=st.fromDate(t);return{timestampValue:wa(r.wt,i)}}if(t instanceof st){const i=new st(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:wa(r.wt,i)}}if(t instanceof Ul)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Oi)return{bytesValue:fl(r.wt,t._byteString)};if(t instanceof _t){const i=r.databaseId,s=t.firestore._databaseId;if(!s.isEqual(i))throw r.oa(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:c(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.oa(`Unsupported field value: ${Ll(t)}`)}(n,e)}function ug(n,e){const t={};return Js(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ei(n,(r,i)=>{const s=Ra(i,e.ea(r));null!=s&&(t[r]=s)}),{mapValue:{fields:t}}}function cg(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof st||n instanceof Ul||n instanceof Oi||n instanceof _t||n instanceof Da)}function Jd(n,e,t){if(!cg(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=Ll(t);throw e.oa("an object"===r?n+" a custom object":n+" "+r)}var r}function Xd(n,e,t){if((e=(0,Y.m9)(e))instanceof gs)return e._internalPath;if("string"==typeof e)return $l(n,e);throw jl("Field path arguments must be of type string or ",n,!1,void 0,t)}const L_=new RegExp("[~\\*/\\[\\]]");function $l(n,e,t){if(e.search(L_)>=0)throw jl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new gs(...e.split("."))._internalPath}catch{throw jl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function jl(n,e,t,r,i){const s=r&&!r.isEmpty(),u=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(s||u)&&(f+=" (found",s&&(f+=` in field ${r}`),u&&(f+=` in document ${i}`),f+=")"),new K(L.INVALID_ARGUMENT,h+n+f)}function lg(n,e){return n.some(t=>t.isEqual(e))}class Rc{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new _t(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new F_(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Gl("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class F_ extends Rc{data(){return super.data()}}function Gl(n,e){return"string"==typeof e?$l(n,e):e instanceof gs?e._internalPath:e._delegate._internalPath}class Oa{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ms extends Rc{constructor(e,t,r,i,s,u){super(e,t,r,i,u),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Oc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Gl("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Oc extends ms{data(e={}){return super.data(e)}}class fo{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Oa(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Oc(this._firestore,this._userDataWriter,r.key,r,new Oa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new K(L.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(u=>({type:"added",doc:new Oc(r._firestore,r._userDataWriter,u.doc.key,u.doc,new Oa(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:s++}))}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(u=>i||3!==u.type).map(u=>{const h=new Oc(r._firestore,r._userDataWriter,u.doc.key,u.doc,new Oa(r._snapshot.mutatedKeys.has(u.doc.key),r._snapshot.fromCache),r.query.converter);let f=-1,m=-1;return 0!==u.type&&(f=s.indexOf(u.doc.key),s=s.delete(u.doc.key)),1!==u.type&&(s=s.add(u.doc),m=s.indexOf(u.doc.key)),{type:U_(u.type),doc:h,oldIndex:f,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function U_(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae()}}function hg(n,e){return n instanceof ms&&e instanceof ms?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof fo&&e instanceof fo&&n._firestore===e._firestore&&eg(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function dg(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new K(L.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Pc{}function po(n,...e){for(const t of e)n=t._apply(n);return n}class V_ extends Pc{constructor(e,t,r){super(),this.fa=e,this.da=t,this._a=r,this.type="where"}_apply(e){const t=Na(e.firestore),r=function(i,s,u,h,f,m,v){let E;if(f.isKeyField()){if("array-contains"===m||"array-contains-any"===m)throw new K(L.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if("in"===m||"not-in"===m){_g(v,m);const U=[];for(const $ of v)U.push(yg(h,i,$));E={arrayValue:{values:U}}}else E=yg(h,i,v)}else"in"!==m&&"not-in"!==m&&"array-contains-any"!==m||_g(v,m),E=ag(u,"where",v,"in"===m||"not-in"===m);const O=Ht.create(f,m,E);return function(U,$){if($.ht()){const ce=uc(U);if(null!==ce&&!ce.isEqual($.field))throw new K(L.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${ce.toString()}' and '${$.field.toString()}'`);const Fe=ac(U);null!==Fe&&vg(0,$.field,Fe)}const X=function(ce,Fe){for(const He of ce.filters)if(Fe.indexOf(He.op)>=0)return He.op;return null}(U,function(ce){switch(ce){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}($.op));if(null!==X)throw new K(L.INVALID_ARGUMENT,X===$.op?`Invalid query. You cannot use more than one '${$.op.toString()}' filter.`:`Invalid query. You cannot use '${$.op.toString()}' filters with '${X.toString()}' filters.`)}(i,O),O}(e._query,0,t,e.firestore._databaseId,this.fa,this.da,this._a);return new wn(e.firestore,e.converter,function(i,s){const u=i.filters.concat([s]);return new fr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),u,i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}class $_ extends Pc{constructor(e,t){super(),this.fa=e,this.wa=t,this.type="orderBy"}_apply(e){const t=function(r,i,s){if(null!==r.startAt)throw new K(L.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new K(L.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const u=new Ai(i,s);return function(h,f){if(null===ac(h)){const m=uc(h);null!==m&&vg(0,m,f.field)}}(r,u),u}(e._query,this.fa,this.wa);return new wn(e.firestore,e.converter,function(r,i){const s=r.explicitOrderBy.concat([i]);return new fr(r.path,r.collectionGroup,s,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class fg extends Pc{constructor(e,t,r){super(),this.type=e,this.ma=t,this.ga=r}_apply(e){return new wn(e.firestore,e.converter,pu(e._query,this.ma,this.ga))}}class pg extends Pc{constructor(e,t,r){super(),this.type=e,this.ya=t,this.pa=r}_apply(e){const t=mg(e,this.type,this.ya,this.pa);return new wn(e.firestore,e.converter,(i=t,new fr((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class gg extends Pc{constructor(e,t,r){super(),this.type=e,this.ya=t,this.pa=r}_apply(e){const t=mg(e,this.type,this.ya,this.pa);return new wn(e.firestore,e.converter,(i=t,new fr((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function mg(n,e,t,r){if(t[0]=(0,Y.m9)(t[0]),t[0]instanceof Rc)return function(i,s,u,h,f){if(!h)throw new K(L.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);const m=[];for(const v of fa(i))if(v.field.isKeyField())m.push(yn(s,h.key));else{const E=h.data.field(v.field);if(hu(E))throw new K(L.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+v.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===E){const O=v.field.canonicalString();throw new K(L.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${O}' (used as the orderBy) does not exist.`)}m.push(E)}return new bi(m,f)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Na(n.firestore);return function(s,u,h,f,m,v){const E=s.explicitOrderBy;if(m.length>E.length)throw new K(L.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const O=[];for(let U=0;U<m.length;U++){const $=m[U];if(E[U].field.isKeyField()){if("string"!=typeof $)throw new K(L.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof $}`);if(!cc(s)&&-1!==$.indexOf("/"))throw new K(L.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${$}' contains a slash.`);const X=s.path.child(Ue.fromString($));if(!ne.isDocumentKey(X))throw new K(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${X}' is not because it contains an odd number of segments.`);const ce=new ne(X);O.push(yn(u,ce))}else{const X=ag(h,f,$);O.push(X)}}return new bi(O,v)}(n._query,n.firestore._databaseId,i,e,t,r)}}function yg(n,e,t){if("string"==typeof(t=(0,Y.m9)(t))){if(""===t)throw new K(L.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cc(e)&&-1!==t.indexOf("/"))throw new K(L.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ue.fromString(t));if(!ne.isDocumentKey(r))throw new K(L.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yn(n,new ne(r))}if(t instanceof _t)return yn(n,t._key);throw new K(L.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ll(t)}.`)}function _g(n,e){if(!Array.isArray(n)||0===n.length)throw new K(L.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new K(L.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function vg(n,e,t){if(!t.isEqual(e))throw new K(L.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}const H_={maxAttempts:5};class ef{convertValue(e,t="none"){switch(we(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ft(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ae()}}convertObject(e,t){const r={};return Ei(e.fields,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new Ul(ft(e.latitude),ft(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=d(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(p(e));default:return null}}convertTimestamp(e){const t=Yn(e);return new st(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ue.fromString(e);Ie(Cf(r));const i=new w(r.get(1),r.get(3)),s=new ne(r.popFirst(5));return i.isEqual(t)||Je(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function ql(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Q_ extends ef{constructor(e){super(),this.firestore=e}convertBytes(e){return new Oi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _t(this.firestore,null,t)}}class Ig{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Na(e)}set(e,t,r){this._verifyNotCommitted();const i=go(e,this._firestore),s=ql(i.converter,t,r),u=Bl(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(u.toMutation(i._key,mt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=go(e,this._firestore);let u;return u="string"==typeof(t=(0,Y.m9)(t))||t instanceof gs?Yd(this._dataReader,"WriteBatch.update",s._key,t,r,i):Qd(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(u.toMutation(s._key,mt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=go(e,this._firestore);return this._mutations=this._mutations.concat(new ro(t._key,mt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new K(L.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function go(n,e){if((n=(0,Y.m9)(n)).firestore!==e)throw new K(L.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class Pa extends ef{constructor(e){super(),this.firestore=e}convertBytes(e){return new Oi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _t(this.firestore,null,t)}}function wg(n,e,t){n=qe(n,_t);const r=qe(n.firestore,Tt),i=ql(n.converter,e,t);return Gu(r,[Bl(Na(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,mt.none())])}function Eg(n,e,t,...r){n=qe(n,_t);const i=qe(n.firestore,Tt),s=Na(i);let u;return u="string"==typeof(e=(0,Y.m9)(e))||e instanceof gs?Yd(s,"updateDoc",n._key,e,t,r):Qd(s,"updateDoc",n._key,e),Gu(i,[u.toMutation(n._key,mt.exists(!0))])}function Tg(n,...e){var t,r,i;n=(0,Y.m9)(n);let s={includeMetadataChanges:!1},u=0;"object"!=typeof e[u]||Wd(e[u])||(s=e[u],u++);const h={includeMetadataChanges:s.includeMetadataChanges};if(Wd(e[u])){const E=e[u];e[u]=null===(t=E.next)||void 0===t?void 0:t.bind(E),e[u+1]=null===(r=E.error)||void 0===r?void 0:r.bind(E),e[u+2]=null===(i=E.complete)||void 0===i?void 0:i.bind(E)}let f,m,v;if(n instanceof _t)m=qe(n.firestore,Tt),v=hs(n._key.path),f={next:E=>{e[u]&&e[u](tf(m,n,E))},error:e[u+1],complete:e[u+2]};else{const E=qe(n,wn);m=qe(E.firestore,Tt),v=E._query;const O=new Pa(m);f={next:U=>{e[u]&&e[u](new fo(m,O,E,U))},error:e[u+1],complete:e[u+2]},dg(n._query)}return function(E,O,U,$){const X=new Ol($),ce=new fd(O,X,U);return E.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return ud(yield ju(E),ce)})),()=>{X.Tc(),E.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return ld(yield ju(E),ce)}))}}(jt(m),v,h,f)}function Gu(n,e){return function(t,r){const i=new St;return t.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return function jy(n,e,t){return _d.apply(this,arguments)}(yield Kd(t),r,i)})),i.promise}(jt(n),e)}function tf(n,e,t){const r=t.docs.get(e._key),i=new Pa(n);return new ms(n,i,e._key,r,new Oa(t.hasPendingWrites,t.fromCache),e.converter)}class ov extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Na(e)}get(e){const t=go(e,this._firestore),r=new Q_(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return ae();const s=i[0];if(s.isFoundDocument())return new Rc(this._firestore,r,s.key,s,t.converter);if(s.isNoDocument())return new Rc(this._firestore,r,t._key,null,t.converter);throw ae()})}set(e,t,r){const i=go(e,this._firestore),s=ql(i.converter,t,r),u=Bl(this._dataReader,"Transaction.set",i._key,s,null!==i.converter,r);return this._transaction.set(i._key,u),this}update(e,t,r,...i){const s=go(e,this._firestore);let u;return u="string"==typeof(t=(0,Y.m9)(t))||t instanceof gs?Yd(this._dataReader,"Transaction.update",s._key,t,r,i):Qd(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,u),this}delete(e){const t=go(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=go(e,this._firestore),r=new Pa(this._firestore);return super.get(e).then(i=>new ms(this._firestore,r,t._key,i._document,new Oa(!1,!1),t.converter))}}function nf(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new K("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function Ag(){if(typeof Uint8Array>"u")throw new K("unimplemented","Uint8Arrays are not available in this environment.")}function Sg(){if(!function hr(){return typeof atob<"u"}())throw new K("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){mi=De.SDK_VERSION,(0,De._registerComponent)(new Qe.wA("firestore",(t,{options:r})=>{const i=t.getProvider("app").getImmediate(),s=new Tt(i,new ta(t.getProvider("auth-internal")),new su(t.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),s._setSettings(r),s},"PUBLIC")),(0,De.registerVersion)(Ws,"3.4.14",n),(0,De.registerVersion)(Ws,"3.4.14","esm2017")}();class Mc{constructor(e){this._delegate=e}static fromBase64String(e){return Sg(),new Mc(Oi.fromBase64String(e))}static fromUint8Array(e){return Ag(),new Mc(Oi.fromUint8Array(e))}toBase64(){return Sg(),this._delegate.toBase64()}toUint8Array(){return Ag(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function rf(n){return function gv(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class mv{enableIndexedDbPersistence(e,t){return function E_(n,e){rg(n=qe(n,Tt));const t=jt(n),r=n._freezeSettings(),i=new Vd;return ng(t,i,new Up(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function T_(n){rg(n=qe(n,Tt));const e=jt(n),t=n._freezeSettings(),r=new Vd;return ng(e,r,new i_(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function b_(n){if(n._initialized&&!n._terminated)throw new K(L.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new St;return n._queue.enqueueAndForgetEvenWhileRestricted((0,R.Z)(function*(){try{yield(t=(0,R.Z)(function*(r){if(!Mt.V())return Promise.resolve();const i=r+"main";yield Mt.delete(i)}),function(r){return t.apply(this,arguments)})(Oh(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class xg{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof w||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Wn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function y_(n,e,t,r={}){var i;const s=(n=qe(n,Dc))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==e&&Wn("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let u,h;if("string"==typeof r.mockUserToken)u=r.mockUserToken,h=Ct.MOCK_USER;else{u=(0,Y.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new K(L.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Ct(f)}n._authCredentials=new _i(new ru(u,h))}}(this._delegate,e,t,r)}enableNetwork(){return function S_(n){return function c_(n){return n.asyncQueue.enqueue((0,R.Z)(function*(){const e=yield jp(n),t=yield Gp(n);return e.setNetworkEnabled(!0),function(r){const i=te(r);return i.lu.delete(0),Cc(i)}(t)}))}(jt(n=qe(n,Tt)))}(this._delegate)}disableNetwork(){return function x_(n){return function l_(n){return n.asyncQueue.enqueue((0,R.Z)(function*(){const e=yield jp(n),t=yield Gp(n);return e.setNetworkEnabled(!1),(r=(0,R.Z)(function*(i){const s=te(i);s.lu.add(0),yield Mu(s),s._u.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(jt(n=qe(n,Tt)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Zp("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function A_(n){return function(e){const t=new St;return e.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return function zy(n,e){return Td.apply(this,arguments)}(yield Kd(e),t)})),t.promise}(jt(n=qe(n,Tt)))}(this._delegate)}onSnapshotsInSync(e){return function sv(n,e){return function f_(n,e){const t=new Ol(e);return n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return r=yield ju(n),i=t,te(r).Tu.add(i),void i.next();var r,i})),()=>{t.Tc(),n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return r=yield ju(n),i=t,void te(r).Tu.delete(i);var r,i}))}}(jt(n=qe(n,Tt)),Wd(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new K("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new qu(this,Jp(this._delegate,e))}catch(t){throw Ln(t,"collection()","Firestore.collection()")}}doc(e){try{return new Dr(this,Fl(this._delegate,e))}catch(t){throw Ln(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Fn(this,function __(n,e){if(n=qe(n,Dc),Zd("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new K(L.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new wn(n,null,(t=e,new fr(Ue.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Ln(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function av(n,e,t){n=qe(n,Tt);const r=Object.assign(Object.assign({},H_),t);return function(i){if(i.maxAttempts<1)throw new K(L.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function p_(n,e,t){const r=new St;return n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){const i=yield(s=n,Pl(s).then(u=>u.datastore));var s;new a_(n.asyncQueue,i,t,e,r).run()})),r.promise}(jt(n),i=>e(new ov(n,i)),r)}(this._delegate,t=>e(new Cg(this,t)))}batch(){return jt(this._delegate),new kg(new Ig(this._delegate,e=>Gu(this._delegate,e)))}loadBundle(e){return function C_(n,e){const t=jt(n=qe(n,Tt)),r=new I_;return function g_(n,e,t,r){const i=function(s,u){let h;return h="string"==typeof s?(new TextEncoder).encode(s):s,f=function(f,m){if(f instanceof Uint8Array)return Vp(f,m);if(f instanceof ArrayBuffer)return Vp(new Uint8Array(f),m);if(f instanceof ReadableStream)return f.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),new s_(f,u);var f}(t,xc(e));n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){!function r_(n,e,t){const r=te(n);var i;(i=(0,R.Z)(function*(s,u,h){try{const f=yield u.getMetadata();if(yield function(O,U){const $=te(O),X=$t(U.createTime);return $.persistence.runTransaction("hasNewerBundle","readonly",ce=>$.Ds.getBundleMetadata(ce,U.id)).then(ce=>!!ce&&ce.createTime.compareTo(X)>=0)}(s.localStore,f))return yield u.close(),h._completeWith({taskState:"Success",documentsLoaded:(O=f).totalDocuments,bytesLoaded:O.totalBytes,totalDocuments:O.totalDocuments,totalBytes:O.totalBytes}),Promise.resolve(new Set);h._updateProgress(Cp(f));const m=new Ly(f,s.localStore,u.wt);let v=yield u.fc();for(;v;){const O=yield m.Nu(v);O&&h._updateProgress(O),v=yield u.fc()}const E=yield m.complete();return yield ps(s,E.Ou,void 0),yield function(O,U){const $=te(O);return $.persistence.runTransaction("Save bundle","readwrite",X=>$.Ds.saveBundleMetadata(X,U))}(s.localStore,f),h._completeWith(E.progress),Promise.resolve(E.Mu)}catch(f){return Wn("SyncEngine",`Loading bundle failed with ${f}`),h._failWith(f),Promise.resolve(new Set)}var O}),function(s,u,h){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield Kd(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function k_(n,e){return function m_(n,e){return n.asyncQueue.enqueue((0,R.Z)(function*(){return function(t,r){const i=te(t);return i.persistence.runTransaction("Get named query","readonly",s=>i.Ds.getNamedQuery(s,r))}(yield Ml(n),e)}))}(jt(n=qe(n,Tt)),e).then(t=>t?new wn(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Fn(this,t):null)}}class Kl extends ef{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mc(new Oi(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Dr.forKey(t,this.firestore,null)}}class Cg{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Kl(e)}get(e){const t=La(e);return this._delegate.get(t).then(r=>new Lc(this._firestore,new ms(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=La(e);return r?(nf("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=La(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=La(e);return this._delegate.delete(t),this}}class kg{constructor(e){this._delegate=e}set(e,t,r){const i=La(e);return r?(nf("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=La(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=La(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Ma{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new Oc(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Fc(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Ma.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new Ma(e,new Kl(e),t),i.set(t,s)),s}}Ma.INSTANCES=new WeakMap;class Dr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Kl(e)}static forPath(e,t,r){if(e.length%2!=0)throw new K("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Dr(t,new _t(t._delegate,r,new ne(e)))}static forKey(e,t,r){return new Dr(t,new _t(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new qu(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new qu(this.firestore,Jp(this._delegate,e))}catch(t){throw Ln(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,Y.m9)(e))instanceof _t&&Xp(this._delegate,e)}set(e,t){t=nf("DocumentReference.set",t);try{return t?wg(this._delegate,e,t):wg(this._delegate,e)}catch(r){throw Ln(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?Eg(this._delegate,e):Eg(this._delegate,e,t,...r)}catch(i){throw Ln(i,"updateDoc()","DocumentReference.update()")}}delete(){return function rv(n){return Gu(qe(n.firestore,Tt),[new ro(n._key,mt.none())])}(this._delegate)}onSnapshot(...e){const t=Dg(e),r=Ng(e,i=>new Lc(this.firestore,new ms(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Tg(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function J_(n){n=qe(n,_t);const e=qe(n.firestore,Tt),t=jt(e),r=new Pa(e);return function h_(n,e){const t=new St;return n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return(r=(0,R.Z)(function*(i,s,u){try{const h=yield function(f,m){const v=te(f);return v.persistence.runTransaction("read document","readonly",E=>v.localDocuments.getDocument(E,m))}(i,s);h.isFoundDocument()?u.resolve(h):h.isNoDocument()?u.resolve(null):u.reject(new K(L.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const f=Uu(h,`Failed to get document '${s} from cache`);u.reject(f)}}),function(i,s,u){return r.apply(this,arguments)})(yield Ml(n),e,t);var r})),t.promise}(t,n._key).then(i=>new ms(e,r,n._key,i,new Oa(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function X_(n){n=qe(n,_t);const e=qe(n.firestore,Tt);return qp(jt(e),n._key,{source:"server"}).then(t=>tf(e,n,t))}(this._delegate):function Y_(n){n=qe(n,_t);const e=qe(n.firestore,Tt);return qp(jt(e),n._key).then(t=>tf(e,n,t))}(this._delegate),t.then(r=>new Lc(this.firestore,new ms(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Dr(this.firestore,this._delegate.withConverter(e?Ma.getInstance(this.firestore,e):null))}}function Ln(n,e,t){return n.message=n.message.replace(e,t),n}function Dg(n){for(const e of n)if("object"==typeof e&&!rf(e))return e;return{}}function Ng(n,e){var t,r;let i;return i=rf(n[0])?n[0]:rf(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class Lc{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Dr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return hg(this._delegate,e._delegate)}}class Fc extends Lc{data(e){const t=this._delegate.data(e);return function ea(n,e){n||ae()}(void 0!==t),t}}class Fn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Kl(e)}where(e,t,r){try{return new Fn(this.firestore,po(this._delegate,function B_(n,e,t){const r=e,i=Gl("where",n);return new V_(i,r,t)}(e,t,r)))}catch(i){throw Ln(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Fn(this.firestore,po(this._delegate,function j_(n,e="asc"){const t=e,r=Gl("orderBy",n);return new $_(r,t)}(e,t)))}catch(r){throw Ln(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Fn(this.firestore,po(this._delegate,function G_(n){return Qp("limit",n),new fg("limit",n,"F")}(e)))}catch(t){throw Ln(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Fn(this.firestore,po(this._delegate,function q_(n){return Qp("limitToLast",n),new fg("limitToLast",n,"L")}(e)))}catch(t){throw Ln(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Fn(this.firestore,po(this._delegate,function K_(...n){return new pg("startAt",n,!0)}(...e)))}catch(t){throw Ln(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Fn(this.firestore,po(this._delegate,function z_(...n){return new pg("startAfter",n,!1)}(...e)))}catch(t){throw Ln(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Fn(this.firestore,po(this._delegate,function Z_(...n){return new gg("endBefore",n,!1)}(...e)))}catch(t){throw Ln(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Fn(this.firestore,po(this._delegate,function W_(...n){return new gg("endAt",n,!0)}(...e)))}catch(t){throw Ln(t,"endAt()","Query.endAt()")}}isEqual(e){return eg(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function tv(n){n=qe(n,wn);const e=qe(n.firestore,Tt),t=jt(e),r=new Pa(e);return function d_(n,e){const t=new St;return n.asyncQueue.enqueueAndForget((0,R.Z)(function*(){return(r=(0,R.Z)(function*(i,s,u){try{const h=yield xl(i,s,!0),f=new Np(s,h.ji),m=f.Ku(h.documents),v=f.applyChanges(m,!1);u.resolve(v.snapshot)}catch(h){const f=Uu(h,`Failed to execute query '${s} against cache`);u.reject(f)}}),function(i,s,u){return r.apply(this,arguments)})(yield Ml(n),e,t);var r})),t.promise}(t,n._query).then(i=>new fo(e,r,n,i))}(this._delegate):"server"===e?.source?function nv(n){n=qe(n,wn);const e=qe(n.firestore,Tt),t=jt(e),r=new Pa(e);return Kp(t,n._query,{source:"server"}).then(i=>new fo(e,r,n,i))}(this._delegate):function ev(n){n=qe(n,wn);const e=qe(n.firestore,Tt),t=jt(e),r=new Pa(e);return dg(n._query),Kp(t,n._query).then(i=>new fo(e,r,n,i))}(this._delegate),t.then(r=>new sf(this.firestore,new fo(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=Dg(e),r=Ng(e,i=>new sf(this.firestore,new fo(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Tg(this._delegate,t,r)}withConverter(e){return new Fn(this.firestore,this._delegate.withConverter(e?Ma.getInstance(this.firestore,e):null))}}class _v{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Fc(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class sf{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Fn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Fc(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new _v(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Fc(this._firestore,r))})}isEqual(e){return hg(this._delegate,e._delegate)}}class qu extends Fn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Dr(this.firestore,e):null}doc(e){try{return new Dr(this.firestore,void 0===e?Fl(this._delegate):Fl(this._delegate,e))}catch(t){throw Ln(t,"doc()","CollectionReference.doc()")}}add(e){return function iv(n,e){const t=qe(n.firestore,Tt),r=Fl(n),i=ql(n.converter,e);return Gu(t,[Bl(Na(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,mt.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Dr(this.firestore,t))}isEqual(e){return Xp(this._delegate,e._delegate)}withConverter(e){return new qu(this.firestore,this._delegate.withConverter(e?Ma.getInstance(this.firestore,e):null))}}function La(n){return qe(n,_t)}class of{constructor(...e){this._delegate=new gs(...e)}static documentId(){return new of(ot.keyField().canonicalString())}isEqual(e){return(e=(0,Y.m9)(e))instanceof gs&&this._delegate._internalPath.isEqual(e._internalPath)}}class Fa{constructor(e){this._delegate=e}static serverTimestamp(){const e=function cv(){return new Hd("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Fa(e)}static delete(){const e=function uv(){return new Nc("deleteField")}();return e._methodName="FieldValue.delete",new Fa(e)}static arrayUnion(...e){const t=function lv(...n){return new O_("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Fa(t)}static arrayRemove(...e){const t=function hv(...n){return new P_("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Fa(t)}static increment(e){const t=function dv(n){return new M_("increment",n)}(e);return t._methodName="FieldValue.increment",new Fa(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const vv={Firestore:xg,GeoPoint:Ul,Timestamp:st,Blob:Mc,Transaction:Cg,WriteBatch:kg,DocumentReference:Dr,DocumentSnapshot:Lc,Query:Fn,QueryDocumentSnapshot:Fc,QuerySnapshot:sf,CollectionReference:qu,FieldPath:of,FieldValue:Fa,setLogLevel:function yv(n){!function yi(n){Dn.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function wv(n){(function Iv(n,e){n.INTERNAL.registerComponent(new Qe.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},vv)))})(n,(e,t)=>new xg(e,t,new mv)),n.registerVersion("@firebase/firestore-compat","0.1.23")}(xe.Z);var Rg=j(7579),Ev=j(6451),zl=j(5363),mo=j(3900),Tv=j(6063);class bv extends Rg.x{constructor(e=1/0,t=1/0,r=Tv.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:u}=this;t||(r.push(e),!i&&r.push(s.now()+u)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let u=0;u<s.length&&!e.closed;u+=r?1:2)e.next(s[u]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){const u=t.now();let h=0;for(let f=1;f<r.length&&r[f]<=u;f+=2)h=f;h&&r.splice(0,h+1)}}}var Av=j(3099);function Og(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=n??1/0,(0,Av.B)({connector:()=>new bv(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}var Sv=j(590),xv=j(576);function Pg(n,e){return(0,xv.m)(e)?(0,mo.w)(()=>n,e):(0,mo.w)(()=>n)}var af=j(9468);j(5867);const Lg=new Map,Rv={activated:!1,tokenObservers:[]},Ov={initialized:!1,enabled:!1};function ln(n){return Lg.get(n)||Rv}function Xr(n,e){Lg.set(n,e)}function Wl(){return Ov}class Uv{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,R.Z)(function*(){t.stop();try{t.pending=new Y.BH,yield function Vv(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new Y.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Un=new Y.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function Ug(n){if(!ln(n).activated)throw Un.create("use-before-activation",{appName:n.name})}function hf(n,e){return df.apply(this,arguments)}function df(){return df=(0,R.Z)(function*({url:n,body:e},t){var r,i;const s={"Content-Type":"application/json"},u=t.getImmediate({optional:!0});if(u){const U=yield u.getHeartbeatsHeader();U&&(s["X-Firebase-Client"]=U)}const h={method:"POST",body:JSON.stringify(e),headers:s};let f,m;try{f=yield fetch(n,h)}catch(U){throw Un.create("fetch-network-error",{originalErrorMessage:null===(r=U)||void 0===r?void 0:r.message})}if(200!==f.status)throw Un.create("fetch-status-error",{httpStatus:f.status});try{m=yield f.json()}catch(U){throw Un.create("fetch-parse-error",{originalErrorMessage:null===(i=U)||void 0===i?void 0:i.message})}const v=m.ttl.match(/^([\d.]+)(s)$/);if(!v||!v[2]||isNaN(Number(v[1])))throw Un.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${m.ttl}`});const E=1e3*Number(v[1]),O=Date.now();return{token:m.token,expireTimeMillis:O+E,issuedAtTimeMillis:O}}),df.apply(this,arguments)}function Gv(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:e}}}const Uc="firebase-app-check-store";let Yl=null;function Bg(){return Yl||(Yl=new Promise((n,e)=>{var t;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=i=>{n(i.target.result)},r.onerror=i=>{var s;e(Un.create("storage-open",{originalErrorMessage:null===(s=i.target.error)||void 0===s?void 0:s.message}))},r.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(Uc,{keyPath:"compositeKey"})}}catch(r){e(Un.create("storage-open",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message}))}}),Yl)}function ff(){return ff=(0,R.Z)(function*(n,e){const r=(yield Bg()).transaction(Uc,"readwrite"),s=r.objectStore(Uc).put({compositeKey:n,value:e});return new Promise((u,h)=>{s.onsuccess=f=>{u()},r.onerror=f=>{var m;h(Un.create("storage-set",{originalErrorMessage:null===(m=f.target.error)||void 0===m?void 0:m.message}))}})}),ff.apply(this,arguments)}const Vc=new Pe.Yd("@firebase/app-check");function qg(n,e){return(0,Y.hl)()?function Zv(n,e){return function $g(n,e){return ff.apply(this,arguments)}(function Gg(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{Vc.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Kg(){return Wl().enabled}function zg(){return yf.apply(this,arguments)}function yf(){return yf=(0,R.Z)(function*(){const n=Wl();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),yf.apply(this,arguments)}const Xv={error:"UNKNOWN_ERROR"};function eI(n){return Y.US.encodeString(JSON.stringify(n),!1)}function Jl(n){return _f.apply(this,arguments)}function _f(){return _f=(0,R.Z)(function*(n,e=!1){const t=n.app;Ug(t);const r=ln(t);let s,i=r.token;if(!i){const f=yield r.cachedTokenPromise;f&&Xl(f)&&(i=f)}if(!e&&i&&Xl(i))return{token:i.token};let h,u=!1;if(Kg()){r.exchangeTokenPromise||(r.exchangeTokenPromise=hf(Gv(t,yield zg()),n.heartbeatServiceProvider).then(m=>(r.exchangeTokenPromise=void 0,m)),u=!0);const f=yield r.exchangeTokenPromise;return yield qg(t,f),Xr(t,Object.assign(Object.assign({},r),{token:f})),{token:f.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(f=>(r.exchangeTokenPromise=void 0,f)),u=!0),i=yield r.exchangeTokenPromise}catch(f){"appCheck/throttled"===f.code?Vc.warn(f.message):Vc.error(f),s=f}return i?(h={token:i.token},Xr(t,Object.assign(Object.assign({},r),{token:i})),yield qg(t,i)):h=nI(s),u&&Wg(t,h),h}),_f.apply(this,arguments)}function If(n,e){const t=ln(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),Xr(n,Object.assign(Object.assign({},t),{tokenObservers:r}))}function Zg(n){const{app:e}=n,t=ln(e);let r=t.tokenRefresher;r||(r=function tI(n){const{app:e}=n;return new Uv((0,R.Z)(function*(){let r;if(r=ln(e).token?yield Jl(n,!0):yield Jl(n),r.error)throw r.error}),()=>!0,()=>{const t=ln(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),Xr(e,Object.assign(Object.assign({},t),{tokenRefresher:r}))),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Wg(n,e){const t=ln(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch{}}function Xl(n){return n.expireTimeMillis-Date.now()>0}function nI(n){return{token:eI(Xv),error:n}}class rI{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=ln(this.app);for(const t of e)If(this.app,t.next);return Promise.resolve()}}const nm="app-check-internal";!function yI(){(0,De._registerComponent)(new Qe.wA("app-check",n=>function iI(n,e){return new rI(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(nm).initialize()})),(0,De._registerComponent)(new Qe.wA(nm,n=>function sI(n){return{getToken:e=>Jl(n,e),addTokenListener:e=>function vf(n,e,t,r){const{app:i}=n,s=ln(i),u={next:t,error:r,type:e};if(Xr(i,Object.assign(Object.assign({},s),{tokenObservers:[...s.tokenObservers,u]})),s.token&&Xl(s.token)){const h=s.token;Promise.resolve().then(()=>{t({token:h.token}),Zg(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Zg(n))}(n,"INTERNAL",e),removeTokenListener:e=>If(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,De.registerVersion)("@firebase/app-check","0.5.12")}();class bf{constructor(){return(0,he.vb)("app-check")}}typeof window<"u"&&window,j(127);const im=new I.OlP("angularfire2.auth.use-emulator"),sm=new I.OlP("angularfire2.auth.settings"),om=new I.OlP("angularfire2.auth.tenant-id"),am=new I.OlP("angularfire2.auth.langugage-code"),um=new I.OlP("angularfire2.auth.use-device-language"),cm=new I.OlP("angularfire.auth.persistence"),lm=(n,e,t,r,i,s,u,h)=>(0,Ee.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const f=e.runOutsideAngular(()=>n.auth());if(t&&f.useEmulator(...t),r&&(f.tenantId=r),f.languageCode=i,s&&f.useDeviceLanguage(),u)for(const[m,v]of Object.entries(u))f.settings[m]=v;return h&&f.setPersistence(h),f},[t,r,i,s,u,h]);let hm=(()=>{class n{constructor(t,r,i,s,u,h,f,m,v,E,O,U){const $=new Rg.x,X=(0,oe.of)(void 0).pipe((0,zl.Q)(u.outsideAngular),(0,mo.w)(()=>s.runOutsideAngular(()=>Promise.resolve().then(j.bind(j,1451)))),(0,Se.U)(()=>(0,Ee.on)(t,s,r)),(0,Se.U)(ce=>lm(ce,s,h,m,v,E,f,O)),Og({bufferSize:1,refCount:!1}));if((0,re.PM)(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,oe.of)(null);else{X.pipe((0,Sv.P)()).subscribe();const Fe=X.pipe((0,mo.w)(Re=>Re.getRedirectResult().then(Oe=>Oe,()=>null)),he.iC,Og({bufferSize:1,refCount:!1})),He=X.pipe((0,mo.w)(Re=>new C.y(Oe=>({unsubscribe:s.runOutsideAngular(()=>Re.onAuthStateChanged(Ve=>Oe.next(Ve),Ve=>Oe.error(Ve),()=>Oe.complete()))})))),Ke=X.pipe((0,mo.w)(Re=>new C.y(Oe=>({unsubscribe:s.runOutsideAngular(()=>Re.onIdTokenChanged(Ve=>Oe.next(Ve),Ve=>Oe.error(Ve),()=>Oe.complete()))}))));this.authState=Fe.pipe(Pg(He),(0,af.R)(u.outsideAngular),(0,zl.Q)(u.insideAngular)),this.user=Fe.pipe(Pg(Ke),(0,af.R)(u.outsideAngular),(0,zl.Q)(u.insideAngular)),this.idToken=this.user.pipe((0,mo.w)(Re=>Re?(0,ie.D)(Re.getIdToken()):(0,oe.of)(null))),this.idTokenResult=this.user.pipe((0,mo.w)(Re=>Re?(0,ie.D)(Re.getIdTokenResult()):(0,oe.of)(null))),this.credential=(0,Ev.T)(Fe,$,this.authState.pipe((0,je.h)(Re=>!Re))).pipe((0,Se.U)(Re=>Re?.user?Re:null),(0,af.R)(u.outsideAngular),(0,zl.Q)(u.insideAngular))}return(0,Ee.pX)(this,X,s,{spy:{apply:(ce,Fe,He)=>{(ce.startsWith("signIn")||ce.startsWith("createUser"))&&He.then(Ke=>$.next(Ke))}}})}}return n.\u0275fac=function(t){return new(t||n)(I.LFG(Ee.Dh),I.LFG(Ee.xv,8),I.LFG(I.Lbi),I.LFG(I.R0b),I.LFG(he.HU),I.LFG(im,8),I.LFG(sm,8),I.LFG(om,8),I.LFG(am,8),I.LFG(um,8),I.LFG(cm,8),I.LFG(bf,8))},n.\u0275prov=I.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})();function dm(n,e){return function TI(n,e=se.z){return new C.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function Sf(n,e){return dm(n,e).pipe((0,Se.U)(t=>({payload:t,type:"query"})))}function th(n,e){return Sf(n,e).pipe((0,Ce.O)(void 0),le(),(0,Se.U)(([t,r])=>{const i=r.payload.docChanges(),s=i.map(u=>({type:u.type,payload:u}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((u,h)=>{const f=i.find(v=>v.doc.ref.isEqual(u.ref)),m=t?.payload.docs.find(v=>v.ref.isEqual(u.ref));f&&JSON.stringify(f.doc.metadata)===JSON.stringify(u.metadata)||!f&&m&&JSON.stringify(m.metadata)===JSON.stringify(u.metadata)||s.push({type:"modified",payload:{oldIndex:h,newIndex:h,type:"modified",doc:u}})}),s}))}function fm(n,e,t){return th(n,t).pipe((0,nt.R)((r,i)=>function AI(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function SI(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return xf(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return xf(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return xf(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(s=>s.payload),e),[]),function z(n,e=B.y){return n=n??de,(0,fe.e)((t,r)=>{let i,s=!0;t.subscribe((0,ye.x)(r,u=>{const h=e(u);(s||!n(i,h))&&(s=!1,i=h,r.next(u))}))})}(),(0,Se.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function xf(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function pm(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class gm{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=th(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,Se.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe((0,Ce.O)(void 0),le(),(0,je.h)(([r,i])=>i.length>0||!r),(0,Se.U)(([r,i])=>i),he.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,nt.R)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=pm(e);return fm(this.query,t,this.afs.schedulers.outsideAngular).pipe(he.iC)}valueChanges(e={}){return Sf(this.query,this.afs.schedulers.outsideAngular).pipe((0,Se.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),he.iC)}get(e){return(0,ie.D)(this.query.get(e)).pipe(he.iC)}add(e){return this.ref.add(e)}doc(e){return new mm(this.ref.doc(e),this.afs)}}class mm{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:s}=ym(r,t);return new gm(i,s,this.afs)}snapshotChanges(){return function bI(n,e){return dm(n,e).pipe((0,Ce.O)(void 0),le(),(0,Se.U)(([t,r])=>r.exists?t?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(he.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,Se.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,ie.D)(this.ref.get(e)).pipe(he.iC)}}class xI{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?th(this.query,this.afs.schedulers.outsideAngular).pipe((0,Se.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),(0,je.h)(t=>t.length>0),he.iC):th(this.query,this.afs.schedulers.outsideAngular).pipe(he.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,nt.R)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=pm(e);return fm(this.query,t,this.afs.schedulers.outsideAngular).pipe(he.iC)}valueChanges(e={}){return Sf(this.query,this.afs.schedulers.outsideAngular).pipe((0,Se.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),he.iC)}get(e){return(0,ie.D)(this.query.get(e)).pipe(he.iC)}}const CI=new I.OlP("angularfire2.enableFirestorePersistence"),kI=new I.OlP("angularfire2.firestore.persistenceSettings"),DI=new I.OlP("angularfire2.firestore.settings"),NI=new I.OlP("angularfire2.firestore.use-emulator");function ym(n,e=(t=>t)){return{query:e(n),ref:n}}let RI=(()=>{class n{constructor(t,r,i,s,u,h,f,m,v,E,O,U,$,X,ce,Fe,He){this.schedulers=f;const Ke=(0,Ee.on)(t,h,r),Re=v;E&&lm(Ke,h,O,$,X,ce,U,Fe),[this.firestore,this.persistenceEnabled$]=(0,Ee.cc)(`${Ke.name}.firestore`,"AngularFirestore",Ke.name,()=>{const Oe=h.runOutsideAngular(()=>Ke.firestore());if(s&&Oe.settings(s),Re&&Oe.useEmulator(...Re),i&&!(0,re.PM)(u)){const Ve=()=>{try{return(0,ie.D)(Oe.enablePersistence(m||void 0).then(()=>!0,()=>!1))}catch(Yt){return typeof console<"u"&&console.warn(Yt),(0,oe.of)(!1)}};return[Oe,h.runOutsideAngular(Ve)]}return[Oe,(0,oe.of)(!1)]},[s,Re,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:u}=ym(i,r),h=this.schedulers.ngZone.run(()=>s);return new gm(h,u,this)}collectionGroup(t,r){const i=r||(u=>u),s=this.firestore.collectionGroup(t);return new xI(i(s),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new mm(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(I.LFG(Ee.Dh),I.LFG(Ee.xv,8),I.LFG(CI,8),I.LFG(DI,8),I.LFG(I.Lbi),I.LFG(I.R0b),I.LFG(he.HU),I.LFG(kI,8),I.LFG(NI,8),I.LFG(hm,8),I.LFG(im,8),I.LFG(sm,8),I.LFG(om,8),I.LFG(am,8),I.LFG(um,8),I.LFG(cm,8),I.LFG(bf,8))},n.\u0275prov=I.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})()},2011:(Lt,ze,j)=>{j.d(ze,{Dh:()=>ye,GT:()=>he,cc:()=>Se,hO:()=>Ce,on:()=>B,pX:()=>oe,xv:()=>le});var I=j(4650),se=j(127),C=j(5813);Lt=j.hmd(Lt);const ie=["ngOnDestroy"],oe=(re,ke,xe,R={})=>new Proxy(re,{get:(De,Qe)=>xe.runOutsideAngular(()=>{var Pe;if(re[Qe])return!(null===(Pe=R?.spy)||void 0===Pe)&&Pe.get&&R.spy.get(Qe,re[Qe]),re[Qe];if(ie.indexOf(Qe)>-1)return()=>{};const Y=ke.toPromise().then(N=>{const Z=N&&N[Qe];return"function"==typeof Z?Z.bind(N):Z&&Z.then?Z.then(V=>xe.run(()=>V)):xe.run(()=>Z)});return new Proxy(()=>{},{get:(N,Z)=>Y[Z],apply:(N,Z,V)=>Y.then(Ze=>{var ee;const Xe=Ze&&Ze(...V);return!(null===(ee=R?.spy)||void 0===ee)&&ee.apply&&R.spy.apply(Qe,V,Xe),Xe})})})}),he=(re,ke)=>{ke.forEach(xe=>{Object.getOwnPropertyNames(xe.prototype||xe).forEach(R=>{Object.defineProperty(re.prototype,R,Object.getOwnPropertyDescriptor(xe.prototype||xe,R))})})};class fe{constructor(ke){return ke}}const ye=new I.OlP("angularfire2.app.options"),le=new I.OlP("angularfire2.app.name");function B(re,ke,xe){const De="object"==typeof xe&&xe||{};De.name=De.name||"string"==typeof xe&&xe||"[DEFAULT]";const Pe=se.Z.apps.filter(Y=>Y&&Y.name===De.name)[0]||ke.runOutsideAngular(()=>se.Z.initializeApp(re,De));try{JSON.stringify(re)!==JSON.stringify(Pe.options)&&z("error",`${Pe.name} Firebase App already initialized with different options${Lt.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new fe(Pe)}const z=(re,...ke)=>{(0,I.X6Q)()&&typeof console<"u"&&console[re](...ke)},de={provide:fe,useFactory:B,deps:[ye,I.R0b,[new I.FiY,le]]};let Ce=(()=>{class re{constructor(xe){se.Z.registerVersion("angularfire",C.q4.full,"core"),se.Z.registerVersion("angularfire",C.q4.full,"app-compat"),se.Z.registerVersion("angular",I.q4F.full,xe.toString())}static initializeApp(xe,R){return{ngModule:re,providers:[{provide:ye,useValue:xe},{provide:le,useValue:R}]}}}return re.\u0275fac=function(xe){return new(xe||re)(I.LFG(I.Lbi))},re.\u0275mod=I.oAB({type:re}),re.\u0275inj=I.cJS({providers:[de]}),re})();function Se(re,ke,xe,R,De){const[,Qe,Pe]=globalThis.\u0275AngularfireInstanceCache.find(Y=>Y[0]===re)||[];if(Qe)return function nt(re,ke){try{return re.toString()===ke.toString()}catch{return re===ke}}(De,Pe)||(Ee("error",`${ke} was already initialized on the ${xe} Firebase App with different settings.${je?" You may need to reload as Firebase is not HMR aware.":""}`),Ee("warn",{is:De,was:Pe})),Qe;{const Y=R();return globalThis.\u0275AngularfireInstanceCache.push([re,Y,De]),Y}}const je=!!Lt.hot,Ee=(re,...ke)=>{(0,I.X6Q)()&&typeof console<"u"&&console[re](...ke)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},5813:(Lt,ze,j)=>{j.d(ze,{q4:()=>os,iC:()=>Yn,HU:()=>cu,vb:()=>at,JM:()=>Js});var I=j(4650),se=j(5867),C=j(5861),ie=j(9681),oe=j(2090),he=j(4859),fe=j(1877),ye=j(8766);const le="@firebase/installations",B="0.5.12",de=`w:${B}`,Ce="FIS_v2",ke=new oe.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function xe(d){return d instanceof oe.ZR&&d.code.includes("request-failed")}function R({projectId:d}){return`https://firebaseinstallations.googleapis.com/v1/projects/${d}/installations`}function De(d){return{token:d.token,requestStatus:2,expiresIn:Ze(d.expiresIn),creationTime:Date.now()}}function Qe(d,p){return Pe.apply(this,arguments)}function Pe(){return(Pe=(0,C.Z)(function*(d,p){const w=(yield p.json()).error;return ke.create("request-failed",{requestName:d,serverCode:w.code,serverMessage:w.message,serverStatus:w.status})})).apply(this,arguments)}function Y({apiKey:d}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":d})}function N(d,{refreshToken:p}){const y=Y(d);return y.append("Authorization",function ee(d){return`${Ce} ${d}`}(p)),y}function Z(d){return V.apply(this,arguments)}function V(){return(V=(0,C.Z)(function*(d){const p=yield d();return p.status>=500&&p.status<600?d():p})).apply(this,arguments)}function Ze(d){return Number(d.replace("s","000"))}function Xe(d,p){return et.apply(this,arguments)}function et(){return(et=(0,C.Z)(function*({appConfig:d,heartbeatServiceProvider:p},{fid:y}){const w=R(d),D=Y(d),M=p.getImmediate({optional:!0});if(M){const we=yield M.getHeartbeatsHeader();we&&D.append("x-firebase-client",we)}const J={method:"POST",headers:D,body:JSON.stringify({fid:y,authVersion:Ce,appId:d.appId,sdkVersion:de})},ge=yield Z(()=>fetch(w,J));if(ge.ok){const we=yield ge.json();return{fid:we.fid||y,registrationStatus:2,refreshToken:we.refreshToken,authToken:De(we.authToken)}}throw yield Qe("Create Installation",ge)})).apply(this,arguments)}function vt(d){return new Promise(p=>{setTimeout(p,d)})}const _n=/^[cdef][\w-]{21}$/;function pr(){try{const d=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(d),d[0]=112+d[0]%16;const y=function Gt(d){return function Rt(d){return btoa(String.fromCharCode(...d)).replace(/\+/g,"-").replace(/\//g,"_")}(d).substr(0,22)}(d);return _n.test(y)?y:""}catch{return""}}function Ge(d){return`${d.appName}!${d.appId}`}const Jt=new Map;function gt(d,p){const y=Ge(d);lt(y,p),function Nr(d,p){const y=function Ft(){return!Xt&&"BroadcastChannel"in self&&(Xt=new BroadcastChannel("[Firebase] FID Change"),Xt.onmessage=d=>{lt(d.data.key,d.data.fid)}),Xt}();y&&y.postMessage({key:d,fid:p}),function en(){0===Jt.size&&Xt&&(Xt.close(),Xt=null)}()}(y,p)}function lt(d,p){const y=Jt.get(d);if(y)for(const w of y)w(p)}let Xt=null;const vn="firebase-installations-store";let it=null;function rr(){return it||(it=(0,ye.X3)("firebase-installations-database",1,{upgrade:(d,p)=>{0===p&&d.createObjectStore(vn)}})),it}function tt(d,p){return Vn.apply(this,arguments)}function Vn(){return(Vn=(0,C.Z)(function*(d,p){const y=Ge(d),D=(yield rr()).transaction(vn,"readwrite"),M=D.objectStore(vn),q=yield M.get(y);return yield M.put(p,y),yield D.done,(!q||q.fid!==p.fid)&&gt(d,p.fid),p})).apply(this,arguments)}function Bn(d){return En.apply(this,arguments)}function En(){return(En=(0,C.Z)(function*(d){const p=Ge(d),w=(yield rr()).transaction(vn,"readwrite");yield w.objectStore(vn).delete(p),yield w.done})).apply(this,arguments)}function Tn(d,p){return tn.apply(this,arguments)}function tn(){return(tn=(0,C.Z)(function*(d,p){const y=Ge(d),D=(yield rr()).transaction(vn,"readwrite"),M=D.objectStore(vn),q=yield M.get(y),J=p(q);return void 0===J?yield M.delete(y):yield M.put(J,y),yield D.done,J&&(!q||q.fid!==J.fid)&&gt(d,J.fid),J})).apply(this,arguments)}function $n(d){return jn.apply(this,arguments)}function jn(){return(jn=(0,C.Z)(function*(d){let p;const y=yield Tn(d.appConfig,w=>{const D=Rr(w),M=ei(d,D);return p=M.registrationPromise,M.installationEntry});return""===y.fid?{installationEntry:yield p}:{installationEntry:y,registrationPromise:p}})).apply(this,arguments)}function Rr(d){return Or(d||{fid:pr(),registrationStatus:0})}function ei(d,p){if(0===p.registrationStatus){if(!navigator.onLine)return{installationEntry:p,registrationPromise:Promise.reject(ke.create("app-offline"))};const y={fid:p.fid,registrationStatus:1,registrationTime:Date.now()},w=function nn(d,p){return gr.apply(this,arguments)}(d,y);return{installationEntry:y,registrationPromise:w}}return 1===p.registrationStatus?{installationEntry:p,registrationPromise:Ot(d)}:{installationEntry:p}}function gr(){return(gr=(0,C.Z)(function*(d,p){try{const y=yield Xe(d,p);return tt(d.appConfig,y)}catch(y){throw xe(y)&&409===y.customData.serverCode?yield Bn(d.appConfig):yield tt(d.appConfig,{fid:p.fid,registrationStatus:0}),y}})).apply(this,arguments)}function Ot(d){return bn.apply(this,arguments)}function bn(){return(bn=(0,C.Z)(function*(d){let p=yield ti(d.appConfig);for(;1===p.registrationStatus;)yield vt(100),p=yield ti(d.appConfig);if(0===p.registrationStatus){const{installationEntry:y,registrationPromise:w}=yield $n(d);return w||y}return p})).apply(this,arguments)}function ti(d){return Tn(d,p=>{if(!p)throw ke.create("installation-not-found");return Or(p)})}function Or(d){return function ir(d){return 1===d.registrationStatus&&d.registrationTime+1e4<Date.now()}(d)?{fid:d.fid,registrationStatus:0}:d}function An(d,p){return Sn.apply(this,arguments)}function Sn(){return(Sn=(0,C.Z)(function*({appConfig:d,heartbeatServiceProvider:p},y){const w=Pr(d,y),D=N(d,y),M=p.getImmediate({optional:!0});if(M){const we=yield M.getHeartbeatsHeader();we&&D.append("x-firebase-client",we)}const J={method:"POST",headers:D,body:JSON.stringify({installation:{sdkVersion:de,appId:d.appId}})},ge=yield Z(()=>fetch(w,J));if(ge.ok)return De(yield ge.json());throw yield Qe("Generate Auth Token",ge)})).apply(this,arguments)}function Pr(d,{fid:p}){return`${R(d)}/${p}/authTokens:generate`}function k(d){return b.apply(this,arguments)}function b(){return(b=(0,C.Z)(function*(d,p=!1){let y;const w=yield Tn(d.appConfig,M=>{if(!pe(M))throw ke.create("not-registered");const q=M.authToken;if(!p&&ht(q))return M;if(1===q.requestStatus)return y=T(d,p),M;{if(!navigator.onLine)throw ke.create("app-offline");const J=Ut(M);return y=G(d,J),J}});return y?yield y:w.authToken})).apply(this,arguments)}function T(d,p){return A.apply(this,arguments)}function A(){return(A=(0,C.Z)(function*(d,p){let y=yield S(d.appConfig);for(;1===y.authToken.requestStatus;)yield vt(100),y=yield S(d.appConfig);const w=y.authToken;return 0===w.requestStatus?k(d,p):w})).apply(this,arguments)}function S(d){return Tn(d,p=>{if(!pe(p))throw ke.create("not-registered");return function Me(d){return 1===d.requestStatus&&d.requestTime+1e4<Date.now()}(p.authToken)?Object.assign(Object.assign({},p),{authToken:{requestStatus:0}}):p})}function G(d,p){return H.apply(this,arguments)}function H(){return(H=(0,C.Z)(function*(d,p){try{const y=yield An(d,p),w=Object.assign(Object.assign({},p),{authToken:y});return yield tt(d.appConfig,w),y}catch(y){if(!xe(y)||401!==y.customData.serverCode&&404!==y.customData.serverCode){const w=Object.assign(Object.assign({},p),{authToken:{requestStatus:0}});yield tt(d.appConfig,w)}else yield Bn(d.appConfig);throw y}})).apply(this,arguments)}function pe(d){return void 0!==d&&2===d.registrationStatus}function ht(d){return 2===d.requestStatus&&!function Be(d){const p=Date.now();return p<d.creationTime||d.creationTime+d.expiresIn<p+36e5}(d)}function Ut(d){const p={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},d),{authToken:p})}function In(){return(In=(0,C.Z)(function*(d){const p=d,{installationEntry:y,registrationPromise:w}=yield $n(p);return w?w.catch(console.error):k(p).catch(console.error),y.fid})).apply(this,arguments)}function ni(){return(ni=(0,C.Z)(function*(d,p=!1){const y=d;return yield ys(y),(yield k(y,p)).token})).apply(this,arguments)}function ys(d){return sr.apply(this,arguments)}function sr(){return(sr=(0,C.Z)(function*(d){const{registrationPromise:p}=yield $n(d);p&&(yield p)})).apply(this,arguments)}function ii(d){return ke.create("missing-app-config-values",{valueName:d})}const vs="installations",Le=d=>{const p=d.getProvider("app").getImmediate(),y=function zu(d){if(!d||!d.options)throw ii("App Configuration");if(!d.name)throw ii("App Name");const p=["projectId","apiKey","appId"];for(const y of p)if(!d.options[y])throw ii(y);return{appName:d.name,projectId:d.options.projectId,apiKey:d.options.apiKey,appId:d.options.appId}}(p);return{app:p,appConfig:y,heartbeatServiceProvider:(0,ie._getProvider)(p,"heartbeat"),_delete:()=>Promise.resolve()}},xt=d=>{const p=d.getProvider("app").getImmediate(),y=(0,ie._getProvider)(p,vs).getImmediate();return{getId:()=>function Kt(d){return In.apply(this,arguments)}(y),getToken:D=>function Mr(d){return ni.apply(this,arguments)}(y,D)}};(function Is(){(0,ie._registerComponent)(new he.wA(vs,Le,"PUBLIC")),(0,ie._registerComponent)(new he.wA("installations-internal",xt,"PRIVATE"))})(),(0,ie.registerVersion)(le,B),(0,ie.registerVersion)(le,B,"esm2017");const si="@firebase/remote-config",zt=new oe.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Wu{constructor(p,y,w,D){this.client=p,this.storage=y,this.storageCache=w,this.logger=D}isCachedDataFresh(p,y){if(!y)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const w=Date.now()-y,D=w<=p;return this.logger.debug(`Config fetch cache check. Cache age millis: ${w}. Cache max age millis (minimumFetchIntervalMillis setting): ${p}. Is cache hit: ${D}.`),D}fetch(p){var y=this;return(0,C.Z)(function*(){const[w,D]=yield Promise.all([y.storage.getLastSuccessfulFetchTimestampMillis(),y.storage.getLastSuccessfulFetchResponse()]);if(D&&y.isCachedDataFresh(p.cacheMaxAgeMillis,w))return D;p.eTag=D&&D.eTag;const M=yield y.client.fetch(p),q=[y.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===M.status&&q.push(y.storage.setLastSuccessfulFetchResponse(M)),yield Promise.all(q),M})()}}function So(d=navigator){return d.languages&&d.languages[0]||d.language}class xn{constructor(p,y,w,D,M,q){this.firebaseInstallations=p,this.sdkVersion=y,this.namespace=w,this.projectId=D,this.apiKey=M,this.appId=q}fetch(p){var y=this;return(0,C.Z)(function*(){var w,D,M;const[q,J]=yield Promise.all([y.firebaseInstallations.getId(),y.firebaseInstallations.getToken()]),we=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${y.projectId}/namespaces/${y.namespace}:fetch?key=${y.apiKey}`,Te={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":p.eTag||"*"},me={sdk_version:y.sdkVersion,app_instance_id:q,app_instance_id_token:J,app_id:y.appId,language_code:So()},rt={method:"POST",headers:Te,body:JSON.stringify(me)},an=fetch(we,rt),Jn=new Promise((Cr,dr)=>{p.signal.addEventListener(()=>{const Ti=new Error("The operation was aborted.");Ti.name="AbortError",dr(Ti)})});let Ar;try{yield Promise.race([an,Jn]),Ar=yield an}catch(Cr){let dr="fetch-client-network";throw"AbortError"===(null===(w=Cr)||void 0===w?void 0:w.name)&&(dr="fetch-timeout"),zt.create(dr,{originalErrorMessage:null===(D=Cr)||void 0===D?void 0:D.message})}let yn=Ar.status;const ha=Ar.headers.get("ETag")||void 0;let Sr,xr;if(200===Ar.status){let Cr;try{Cr=yield Ar.json()}catch(dr){throw zt.create("fetch-client-parse",{originalErrorMessage:null===(M=dr)||void 0===M?void 0:M.message})}Sr=Cr.entries,xr=Cr.state}if("INSTANCE_STATE_UNSPECIFIED"===xr?yn=500:"NO_CHANGE"===xr?yn=304:("NO_TEMPLATE"===xr||"EMPTY_CONFIG"===xr)&&(Sr={}),304!==yn&&200!==yn)throw zt.create("fetch-status",{httpStatus:yn});return{status:yn,eTag:ha,config:Sr}})()}}class Ga{constructor(p,y){this.client=p,this.storage=y}fetch(p){var y=this;return(0,C.Z)(function*(){const w=(yield y.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return y.attemptFetch(p,w)})()}attemptFetch(p,{throttleEndTimeMillis:y,backoffCount:w}){var D=this;return(0,C.Z)(function*(){yield function Gn(d,p){return new Promise((y,w)=>{const D=Math.max(p-Date.now(),0),M=setTimeout(y,D);d.addEventListener(()=>{clearTimeout(M),w(zt.create("fetch-throttle",{throttleEndTimeMillis:p}))})})}(p.signal,y);try{const M=yield D.client.fetch(p);return yield D.storage.deleteThrottleMetadata(),M}catch(M){if(!function ci(d){if(!(d instanceof oe.ZR&&d.customData))return!1;const p=Number(d.customData.httpStatus);return 429===p||500===p||503===p||504===p}(M))throw M;const q={throttleEndTimeMillis:Date.now()+(0,oe.$s)(w),backoffCount:w+1};return yield D.storage.setThrottleMetadata(q),D.attemptFetch(p,q)}})()}}class Pt{constructor(p,y,w,D,M){this.app=p,this._client=y,this._storageCache=w,this._storage=D,this._logger=M,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Fi(d,p){var y;const w=d.target.error||void 0;return zt.create(p,{originalErrorMessage:w&&(null===(y=w)||void 0===y?void 0:y.message)})}const dn="app_namespace_store";class Ka{constructor(p,y,w,D=function xo(){return new Promise((d,p)=>{var y;try{const w=indexedDB.open("firebase_remote_config",1);w.onerror=D=>{p(Fi(D,"storage-open"))},w.onsuccess=D=>{d(D.target.result)},w.onupgradeneeded=D=>{0===D.oldVersion&&D.target.result.createObjectStore(dn,{keyPath:"compositeKey"})}}catch(w){p(zt.create("storage-open",{originalErrorMessage:null===(y=w)||void 0===y?void 0:y.message}))}})}()){this.appId=p,this.appName=y,this.namespace=w,this.openDbPromise=D}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(p){return this.set("last_fetch_status",p)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(p){return this.set("last_successful_fetch_timestamp_millis",p)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(p){return this.set("last_successful_fetch_response",p)}getActiveConfig(){return this.get("active_config")}setActiveConfig(p){return this.set("active_config",p)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(p){return this.set("active_config_etag",p)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(p){return this.set("throttle_metadata",p)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(p){var y=this;return(0,C.Z)(function*(){const w=yield y.openDbPromise;return new Promise((D,M)=>{var q;const ge=w.transaction([dn],"readonly").objectStore(dn),we=y.createCompositeKey(p);try{const Te=ge.get(we);Te.onerror=me=>{M(Fi(me,"storage-get"))},Te.onsuccess=me=>{const rt=me.target.result;D(rt?rt.value:void 0)}}catch(Te){M(zt.create("storage-get",{originalErrorMessage:null===(q=Te)||void 0===q?void 0:q.message}))}})})()}set(p,y){var w=this;return(0,C.Z)(function*(){const D=yield w.openDbPromise;return new Promise((M,q)=>{var J;const we=D.transaction([dn],"readwrite").objectStore(dn),Te=w.createCompositeKey(p);try{const me=we.put({compositeKey:Te,value:y});me.onerror=rt=>{q(Fi(rt,"storage-set"))},me.onsuccess=()=>{M()}}catch(me){q(zt.create("storage-set",{originalErrorMessage:null===(J=me)||void 0===J?void 0:J.message}))}})})()}delete(p){var y=this;return(0,C.Z)(function*(){const w=yield y.openDbPromise;return new Promise((D,M)=>{var q;const ge=w.transaction([dn],"readwrite").objectStore(dn),we=y.createCompositeKey(p);try{const Te=ge.delete(we);Te.onerror=me=>{M(Fi(me,"storage-delete"))},Te.onsuccess=()=>{D()}}catch(Te){M(zt.create("storage-delete",{originalErrorMessage:null===(q=Te)||void 0===q?void 0:q.message}))}})})()}createCompositeKey(p){return[this.appId,this.appName,this.namespace,p].join()}}class Ss{constructor(p){this.storage=p}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var p=this;return(0,C.Z)(function*(){const y=p.storage.getLastFetchStatus(),w=p.storage.getLastSuccessfulFetchTimestampMillis(),D=p.storage.getActiveConfig(),M=yield y;M&&(p.lastFetchStatus=M);const q=yield w;q&&(p.lastSuccessfulFetchTimestampMillis=q);const J=yield D;J&&(p.activeConfig=J)})()}setLastFetchStatus(p){return this.lastFetchStatus=p,this.storage.setLastFetchStatus(p)}setLastSuccessfulFetchTimestampMillis(p){return this.lastSuccessfulFetchTimestampMillis=p,this.storage.setLastSuccessfulFetchTimestampMillis(p)}setActiveConfig(p){return this.activeConfig=p,this.storage.setActiveConfig(p)}}function Ur(){return Vi.apply(this,arguments)}function Vi(){return(Vi=(0,C.Z)(function*(){if(!(0,oe.hl)())return!1;try{return yield(0,oe.eu)()}catch{return!1}})).apply(this,arguments)}!function Cn(){(0,ie._registerComponent)(new he.wA("remote-config",function d(p,{instanceIdentifier:y}){const w=p.getProvider("app").getImmediate(),D=p.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw zt.create("registration-window");if(!(0,oe.hl)())throw zt.create("indexed-db-unavailable");const{projectId:M,apiKey:q,appId:J}=w.options;if(!M)throw zt.create("registration-project-id");if(!q)throw zt.create("registration-api-key");if(!J)throw zt.create("registration-app-id");const ge=new Ka(J,w.name,y=y||"firebase"),we=new Ss(ge),Te=new fe.Yd(si);Te.logLevel=fe.in.ERROR;const me=new xn(D,ie.SDK_VERSION,y,M,q,J),rt=new Ga(me,ge),an=new Wu(rt,ge,we,Te),Jn=new Pt(w,an,we,ge,Te);return function ja(d){const p=(0,oe.m9)(d);p._initializePromise||(p._initializePromise=p._storageCache.loadFromStorage().then(()=>{p._isInitializationComplete=!0}))}(Jn),Jn},"PUBLIC").setMultipleInstances(!0)),(0,ie.registerVersion)(si,"0.3.11"),(0,ie.registerVersion)(si,"0.3.11","esm2017")}();const Vr="/firebase-messaging-sw.js",qn="/firebase-cloud-messaging-push-scope",Br="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",li="google.c.a.c_id",xs="google.c.a.c_l",Co="google.c.a.ts",Za="google.c.a.e";var di=(()=>{return(d=di||(di={})).PUSH_RECEIVED="push-received",d.NOTIFICATION_CLICKED="notification-clicked",di;var d})();function Vt(d){const p=new Uint8Array(d);return btoa(String.fromCharCode(...p)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ko(d){const y=(d+"=".repeat((4-d.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),w=atob(y),D=new Uint8Array(w.length);for(let M=0;M<w.length;++M)D[M]=w.charCodeAt(M);return D}const $r="fcm_token_details_db",bt="fcm_token_object_Store";function Cs(d){return Do.apply(this,arguments)}function Do(){return Do=(0,C.Z)(function*(d){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(M=>M.name).includes($r))return null;let p=null;return(yield(0,ye.X3)($r,5,{upgrade:(w=(0,C.Z)(function*(D,M,q,J){var ge;if(M<2||!D.objectStoreNames.contains(bt))return;const we=J.objectStore(bt),Te=yield we.index("fcmSenderId").get(d);if(yield we.clear(),Te)if(2===M){const me=Te;if(!me.auth||!me.p256dh||!me.endpoint)return;p={token:me.fcmToken,createTime:null!==(ge=me.createTime)&&void 0!==ge?ge:Date.now(),subscriptionOptions:{auth:me.auth,p256dh:me.p256dh,endpoint:me.endpoint,swScope:me.swScope,vapidKey:"string"==typeof me.vapidKey?me.vapidKey:Vt(me.vapidKey)}}}else if(3===M){const me=Te;p={token:me.fcmToken,createTime:me.createTime,subscriptionOptions:{auth:Vt(me.auth),p256dh:Vt(me.p256dh),endpoint:me.endpoint,swScope:me.swScope,vapidKey:Vt(me.vapidKey)}}}else if(4===M){const me=Te;p={token:me.fcmToken,createTime:me.createTime,subscriptionOptions:{auth:Vt(me.auth),p256dh:Vt(me.p256dh),endpoint:me.endpoint,swScope:me.swScope,vapidKey:Vt(me.vapidKey)}}}}),function(M,q,J,ge){return w.apply(this,arguments)})})).close(),yield(0,ye.Lj)($r),yield(0,ye.Lj)("fcm_vapid_details_db"),yield(0,ye.Lj)("undefined"),Bi(p)?p:null;var w}),Do.apply(this,arguments)}function Bi(d){if(!d||!d.subscriptionOptions)return!1;const{subscriptionOptions:p}=d;return"number"==typeof d.createTime&&d.createTime>0&&"string"==typeof d.token&&d.token.length>0&&"string"==typeof p.auth&&p.auth.length>0&&"string"==typeof p.p256dh&&p.p256dh.length>0&&"string"==typeof p.endpoint&&p.endpoint.length>0&&"string"==typeof p.swScope&&p.swScope.length>0&&"string"==typeof p.vapidKey&&p.vapidKey.length>0}const sn="firebase-messaging-store";let Ds=null;function $i(){return Ds||(Ds=(0,ye.X3)("firebase-messaging-database",1,{upgrade:(d,p)=>{0===p&&d.createObjectStore(sn)}})),Ds}function Kn(d){return fn.apply(this,arguments)}function fn(){return(fn=(0,C.Z)(function*(d){const p=Ye(d),w=yield(yield $i()).transaction(sn).objectStore(sn).get(p);if(w)return w;{const D=yield Cs(d.appConfig.senderId);if(D)return yield ar(d,D),D}})).apply(this,arguments)}function ar(d,p){return _r.apply(this,arguments)}function _r(){return(_r=(0,C.Z)(function*(d,p){const y=Ye(d),D=(yield $i()).transaction(sn,"readwrite");return yield D.objectStore(sn).put(p,y),yield D.done,p})).apply(this,arguments)}function ji(d){return fi.apply(this,arguments)}function fi(){return(fi=(0,C.Z)(function*(d){const p=Ye(d),w=(yield $i()).transaction(sn,"readwrite");yield w.objectStore(sn).delete(p),yield w.done})).apply(this,arguments)}function Ye({appConfig:d}){return d.appId}const It=new oe.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function No(d,p){return vr.apply(this,arguments)}function vr(){return(vr=(0,C.Z)(function*(d,p){var y;const w=yield Oo(d),D=ur(p),M={method:"POST",headers:w,body:JSON.stringify(D)};let q;try{q=yield(yield fetch(qi(d.appConfig),M)).json()}catch(J){throw It.create("token-subscribe-failed",{errorInfo:null===(y=J)||void 0===y?void 0:y.toString()})}if(q.error)throw It.create("token-subscribe-failed",{errorInfo:q.error.message});if(!q.token)throw It.create("token-subscribe-no-token");return q.token})).apply(this,arguments)}function Gr(d,p){return Ns.apply(this,arguments)}function Ns(){return(Ns=(0,C.Z)(function*(d,p){var y;const w=yield Oo(d),D=ur(p.subscriptionOptions),M={method:"PATCH",headers:w,body:JSON.stringify(D)};let q;try{q=yield(yield fetch(`${qi(d.appConfig)}/${p.token}`,M)).json()}catch(J){throw It.create("token-update-failed",{errorInfo:null===(y=J)||void 0===y?void 0:y.toString()})}if(q.error)throw It.create("token-update-failed",{errorInfo:q.error.message});if(!q.token)throw It.create("token-update-no-token");return q.token})).apply(this,arguments)}function Gi(d,p){return Ro.apply(this,arguments)}function Ro(){return(Ro=(0,C.Z)(function*(d,p){var y;const D={method:"DELETE",headers:yield Oo(d)};try{const q=yield(yield fetch(`${qi(d.appConfig)}/${p}`,D)).json();if(q.error)throw It.create("token-unsubscribe-failed",{errorInfo:q.error.message})}catch(M){throw It.create("token-unsubscribe-failed",{errorInfo:null===(y=M)||void 0===y?void 0:y.toString()})}})).apply(this,arguments)}function qi({projectId:d}){return`https://fcmregistrations.googleapis.com/v1/projects/${d}/registrations`}function Oo(d){return Ki.apply(this,arguments)}function Ki(){return(Ki=(0,C.Z)(function*({appConfig:d,installations:p}){const y=yield p.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":d.apiKey,"x-goog-firebase-installations-auth":`FIS ${y}`})})).apply(this,arguments)}function ur({p256dh:d,auth:p,endpoint:y,vapidKey:w}){const D={web:{endpoint:y,auth:p,p256dh:d}};return w!==Br&&(D.web.applicationPubKey=w),D}const zn=6048e5;function zi(d){return Rs.apply(this,arguments)}function Rs(){return(Rs=(0,C.Z)(function*(d){const p=yield Ps(d.swRegistration,d.vapidKey),y={vapidKey:d.vapidKey,swScope:d.swRegistration.scope,endpoint:p.endpoint,auth:Vt(p.getKey("auth")),p256dh:Vt(p.getKey("p256dh"))},w=yield Kn(d.firebaseDependencies);if(w){if(Hi(w.subscriptionOptions,y))return Date.now()>=w.createTime+zn?Po(d,{token:w.token,createTime:Date.now(),subscriptionOptions:y}):w.token;try{yield Gi(d.firebaseDependencies,w.token)}catch(D){console.warn(D)}return Wi(d.firebaseDependencies,y)}return Wi(d.firebaseDependencies,y)})).apply(this,arguments)}function Zi(d){return Ir.apply(this,arguments)}function Ir(){return(Ir=(0,C.Z)(function*(d){const p=yield Kn(d.firebaseDependencies);p&&(yield Gi(d.firebaseDependencies,p.token),yield ji(d.firebaseDependencies));const y=yield d.swRegistration.pushManager.getSubscription();return!y||y.unsubscribe()})).apply(this,arguments)}function Po(d,p){return Mo.apply(this,arguments)}function Mo(){return(Mo=(0,C.Z)(function*(d,p){try{const y=yield Gr(d.firebaseDependencies,p),w=Object.assign(Object.assign({},p),{token:y,createTime:Date.now()});return yield ar(d.firebaseDependencies,w),y}catch(y){throw yield Zi(d),y}})).apply(this,arguments)}function Wi(d,p){return Os.apply(this,arguments)}function Os(){return(Os=(0,C.Z)(function*(d,p){const w={token:yield No(d,p),createTime:Date.now(),subscriptionOptions:p};return yield ar(d,w),w.token})).apply(this,arguments)}function Ps(d,p){return Ms.apply(this,arguments)}function Ms(){return(Ms=(0,C.Z)(function*(d,p){return(yield d.pushManager.getSubscription())||d.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:ko(p)})})).apply(this,arguments)}function Hi(d,p){return p.vapidKey===d.vapidKey&&p.endpoint===d.endpoint&&p.auth===d.auth&&p.p256dh===d.p256dh}function Ls(d){const p={from:d.from,collapseKey:d.collapse_key,messageId:d.fcmMessageId};return function Fs(d,p){if(!p.notification)return;d.notification={};const y=p.notification.title;y&&(d.notification.title=y);const w=p.notification.body;w&&(d.notification.body=w);const D=p.notification.image;D&&(d.notification.image=D)}(p,d),function Wa(d,p){!p.data||(d.data=p.data)}(p,d),function Lo(d,p){var y,w,D,M,q;if(!(p.fcmOptions||null!==(y=p.notification)&&void 0!==y&&y.click_action))return;d.fcmOptions={};const J=null!==(D=null===(w=p.fcmOptions)||void 0===w?void 0:w.link)&&void 0!==D?D:null===(M=p.notification)||void 0===M?void 0:M.click_action;J&&(d.fcmOptions.link=J);const ge=null===(q=p.fcmOptions)||void 0===q?void 0:q.analytics_label;ge&&(d.fcmOptions.analyticsLabel=ge)}(p,d),p}function Fo(d){return"object"==typeof d&&!!d&&li in d}function Ha(d,p){const y=[];for(let w=0;w<d.length;w++)y.push(d.charAt(w)),w<p.length&&y.push(p.charAt(w));return y.join("")}function wr(d){return It.create("missing-app-config-values",{valueName:d})}Ha("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Ha("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Qi{constructor(p,y,w){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const D=function Hu(d){if(!d||!d.options)throw wr("App Configuration Object");if(!d.name)throw wr("App Name");const p=["projectId","apiKey","appId","messagingSenderId"],{options:y}=d;for(const w of p)if(!y[w])throw wr(w);return{appName:d.name,projectId:y.projectId,apiKey:y.apiKey,appId:y.appId,senderId:y.messagingSenderId}}(p);this.firebaseDependencies={app:p,appConfig:D,installations:y,analyticsProvider:w}}_delete(){return Promise.resolve()}}function qr(d){return Yi.apply(this,arguments)}function Yi(){return(Yi=(0,C.Z)(function*(d){var p;try{d.swRegistration=yield navigator.serviceWorker.register(Vr,{scope:qn}),d.swRegistration.update().catch(()=>{})}catch(y){throw It.create("failed-service-worker-registration",{browserErrorMessage:null===(p=y)||void 0===p?void 0:p.message})}})).apply(this,arguments)}function Us(d,p){return Kr.apply(this,arguments)}function Kr(){return(Kr=(0,C.Z)(function*(d,p){if(!p&&!d.swRegistration&&(yield qr(d)),p||!d.swRegistration){if(!(p instanceof ServiceWorkerRegistration))throw It.create("invalid-sw-registration");d.swRegistration=p}})).apply(this,arguments)}function zr(d,p){return Uo.apply(this,arguments)}function Uo(){return(Uo=(0,C.Z)(function*(d,p){p?d.vapidKey=p:d.vapidKey||(d.vapidKey=Br)})).apply(this,arguments)}function Vs(){return(Vs=(0,C.Z)(function*(d,p){if(!navigator)throw It.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw It.create("permission-blocked");return yield zr(d,p?.vapidKey),yield Us(d,p?.serviceWorkerRegistration),zi(d)})).apply(this,arguments)}function Vo(d,p,y){return Bo.apply(this,arguments)}function Bo(){return(Bo=(0,C.Z)(function*(d,p,y){const w=$o(p);(yield d.firebaseDependencies.analyticsProvider.get()).logEvent(w,{message_id:y[li],message_name:y[xs],message_time:y[Co],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function $o(d){switch(d){case di.NOTIFICATION_CLICKED:return"notification_open";case di.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Bs(){return(Bs=(0,C.Z)(function*(d,p){const y=p.data;if(!y.isFirebaseMessaging)return;d.onMessageHandler&&y.messageType===di.PUSH_RECEIVED&&("function"==typeof d.onMessageHandler?d.onMessageHandler(Ls(y)):d.onMessageHandler.next(Ls(y)));const w=y.data;Fo(w)&&"1"===w[Za]&&(yield Vo(d,y.messageType,w))})).apply(this,arguments)}const $s="@firebase/messaging",js=d=>{const p=new Qi(d.getProvider("app").getImmediate(),d.getProvider("installations-internal").getImmediate(),d.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",y=>function Qu(d,p){return Bs.apply(this,arguments)}(p,y)),p},Zr=d=>{const p=d.getProvider("messaging").getImmediate();return{getToken:w=>function dt(d,p){return Vs.apply(this,arguments)}(p,w)}};function jo(){return Go.apply(this,arguments)}function Go(){return(Go=(0,C.Z)(function*(){try{yield(0,oe.eu)()}catch{return!1}return typeof window<"u"&&(0,oe.hl)()&&(0,oe.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function Zn(){(0,ie._registerComponent)(new he.wA("messaging",js,"PUBLIC")),(0,ie._registerComponent)(new he.wA("messaging-internal",Zr,"PRIVATE")),(0,ie.registerVersion)($s,"0.9.16"),(0,ie.registerVersion)($s,"0.9.16","esm2017")}();const zo="analytics",Xu="firebase_id",Er="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",gi="https://www.googletagmanager.com/gtag/js",At=new fe.Yd("@firebase/analytics");function Zo(d){return Promise.all(d.map(p=>p.catch(y=>y)))}function Ks(d,p){const y=document.createElement("script");y.src=`${gi}?l=${d}&id=${p}`,y.async=!0,document.head.appendChild(y)}function zs(d,p,y,w,D,M){return kn.apply(this,arguments)}function kn(){return(kn=(0,C.Z)(function*(d,p,y,w,D,M){const q=w[D];try{if(q)yield p[q];else{const ge=(yield Zo(y)).find(we=>we.measurementId===D);ge&&(yield p[ge.appId])}}catch(J){At.error(J)}d("config",D,M)})).apply(this,arguments)}function eu(d,p,y,w,D){return Hr.apply(this,arguments)}function Hr(){return(Hr=(0,C.Z)(function*(d,p,y,w,D){try{let M=[];if(D&&D.send_to){let q=D.send_to;Array.isArray(q)||(q=[q]);const J=yield Zo(y);for(const ge of q){const we=J.find(me=>me.measurementId===ge),Te=we&&p[we.appId];if(!Te){M=[];break}M.push(Te)}}0===M.length&&(M=Object.values(p)),yield Promise.all(M),d("event",w,D||{})}catch(M){At.error(M)}})).apply(this,arguments)}function Zs(){const d=window.document.getElementsByTagName("script");for(const p of Object.values(d))if(p.src&&p.src.includes(gi))return p;return null}const gn=new oe.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),nu=new class Tr{constructor(p={},y=1e3){this.throttleMetadata=p,this.intervalMillis=y}getThrottleMetadata(p){return this.throttleMetadata[p]}setThrottleMetadata(p,y){this.throttleMetadata[p]=y}deleteThrottleMetadata(p){delete this.throttleMetadata[p]}};function Ho(d){return new Headers({Accept:"application/json","x-goog-api-key":d})}function ts(d){return Qo.apply(this,arguments)}function Qo(){return(Qo=(0,C.Z)(function*(d){var p;const{appId:y,apiKey:w}=d,D={method:"GET",headers:Ho(w)},M=Er.replace("{app-id}",y),q=yield fetch(M,D);if(200!==q.status&&304!==q.status){let J="";try{const ge=yield q.json();null!==(p=ge.error)&&void 0!==p&&p.message&&(J=ge.error.message)}catch{}throw gn.create("config-fetch-failed",{httpStatus:q.status,responseMessage:J})}return q.json()})).apply(this,arguments)}function wt(d){return Yo.apply(this,arguments)}function Yo(){return(Yo=(0,C.Z)(function*(d,p=nu,y){const{appId:w,apiKey:D,measurementId:M}=d.options;if(!w)throw gn.create("no-app-id");if(!D){if(M)return{measurementId:M,appId:w};throw gn.create("no-api-key")}const q=p.getThrottleMetadata(w)||{backoffCount:0,throttleEndTimeMillis:Date.now()},J=new mi;return setTimeout((0,C.Z)(function*(){J.abort()}),void 0!==y?y:6e4),Qr({appId:w,apiKey:D,measurementId:M},q,J,p)})).apply(this,arguments)}function Qr(d,p,y){return Jo.apply(this,arguments)}function Jo(){return(Jo=(0,C.Z)(function*(d,{throttleEndTimeMillis:p,backoffCount:y},w,D=nu){var M,q;const{appId:J,measurementId:ge}=d;try{yield Ws(w,p)}catch(we){if(ge)return At.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${ge} provided in the "measurementId" field in the local Firebase config. [${null===(M=we)||void 0===M?void 0:M.message}]`),{appId:J,measurementId:ge};throw we}try{const we=yield ts(d);return D.deleteThrottleMetadata(J),we}catch(we){const Te=we;if(!Ct(Te)){if(D.deleteThrottleMetadata(J),ge)return At.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${ge} provided in the "measurementId" field in the local Firebase config. [${Te?.message}]`),{appId:J,measurementId:ge};throw we}const me=503===Number(null===(q=Te?.customData)||void 0===q?void 0:q.httpStatus)?(0,oe.$s)(y,D.intervalMillis,30):(0,oe.$s)(y,D.intervalMillis),rt={throttleEndTimeMillis:Date.now()+me,backoffCount:y+1};return D.setThrottleMetadata(J,rt),At.debug(`Calling attemptFetch again in ${me} millis`),Qr(d,rt,w,D)}})).apply(this,arguments)}function Ws(d,p){return new Promise((y,w)=>{const D=Math.max(p-Date.now(),0),M=setTimeout(y,D);d.addEventListener(()=>{clearTimeout(M),w(gn.create("fetch-throttle",{throttleEndTimeMillis:p}))})})}function Ct(d){if(!(d instanceof oe.ZR&&d.customData))return!1;const p=Number(d.customData.httpStatus);return 429===p||500===p||503===p||504===p}class mi{constructor(){this.listeners=[]}addEventListener(p){this.listeners.push(p)}abort(){this.listeners.forEach(p=>p())}}let Dn,L;function yi(){return(yi=(0,C.Z)(function*(d,p,y,w,D){if(D&&D.global)d("event",y,w);else{const M=yield p;d("event",y,Object.assign(Object.assign({},w),{send_to:M}))}})).apply(this,arguments)}function K(d){L=d}function St(d){Dn=d}function ru(){return iu.apply(this,arguments)}function iu(){return(iu=(0,C.Z)(function*(){var d;if(!(0,oe.hl)())return At.warn(gn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,oe.eu)()}catch(p){return At.warn(gn.create("indexeddb-unavailable",{errorInfo:null===(d=p)||void 0===d?void 0:d.toString()}).message),!1}return!0})).apply(this,arguments)}function ta(){return(ta=(0,C.Z)(function*(d,p,y,w,D,M,q){var J;const ge=wt(d);ge.then(an=>{y[an.measurementId]=an.appId,d.options.measurementId&&an.measurementId!==d.options.measurementId&&At.warn(`The measurement ID in the local Firebase config (${d.options.measurementId}) does not match the measurement ID fetched from the server (${an.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(an=>At.error(an)),p.push(ge);const we=ru().then(an=>{if(an)return w.getId()}),[Te,me]=yield Promise.all([ge,we]);Zs()||Ks(M,Te.measurementId),L&&(D("consent","default",L),K(void 0)),D("js",new Date);const rt=null!==(J=q?.config)&&void 0!==J?J:{};return rt.origin="firebase",rt.update=!0,null!=me&&(rt[Xu]=me),D("config",Te.measurementId,rt),Dn&&(D("set",Dn),St(void 0)),Te.measurementId})).apply(this,arguments)}class ec{constructor(p){this.app=p}_delete(){return delete cr[this.app.options.appId],Promise.resolve()}}let cr={},rs=[];const su={};let ra,_e,Hs="dataLayer",Nn=!1;function be(d,p,y){!function st(){const d=[];if((0,oe.ru)()&&d.push("This is a browser extension environment."),(0,oe.zI)()||d.push("Cookies are not available."),d.length>0){const p=d.map((w,D)=>`(${D+1}) ${w}`).join(" "),y=gn.create("invalid-analytics-context",{errorInfo:p});At.warn(y.message)}}();const w=d.options.appId;if(!w)throw gn.create("no-app-id");if(!d.options.apiKey){if(!d.options.measurementId)throw gn.create("no-api-key");At.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${d.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=cr[w])throw gn.create("already-exists",{id:w});if(!Nn){!function Xa(d){let p=[];Array.isArray(window[d])?p=window[d]:window[d]=p}(Hs);const{wrappedGtag:M,gtagCore:q}=function tu(d,p,y,w,D){let M=function(...q){window[w].push(arguments)};return window[D]&&"function"==typeof window[D]&&(M=window[D]),window[D]=function Wo(d,p,y,w){function M(){return(M=(0,C.Z)(function*(q,J,ge){try{"event"===q?yield eu(d,p,y,J,ge):"config"===q?yield zs(d,p,y,w,J,ge):"consent"===q?d("consent","update",ge):d("set",J)}catch(we){At.error(we)}})).apply(this,arguments)}return function D(q,J,ge){return M.apply(this,arguments)}}(M,d,p,y),{gtagCore:M,wrappedGtag:window[D]}}(cr,rs,su,Hs,"gtag");_e=M,ra=q,Nn=!0}return cr[w]=function _i(d,p,y,w,D,M,q){return ta.apply(this,arguments)}(d,rs,su,p,ra,Hs,y),new ec(d)}function nc(){return ot.apply(this,arguments)}function ot(){return(ot=(0,C.Z)(function*(){if((0,oe.ru)()||!(0,oe.zI)()||!(0,oe.hl)())return!1;try{return yield(0,oe.eu)()}catch{return!1}})).apply(this,arguments)}const wi="@firebase/analytics";!function au(){(0,ie._registerComponent)(new he.wA(zo,(p,{options:y})=>be(p.getProvider("app").getImmediate(),p.getProvider("installations-internal").getImmediate(),y),"PUBLIC")),(0,ie._registerComponent)(new he.wA("analytics-internal",function d(p){try{const y=p.getProvider(zo).getImmediate();return{logEvent:(w,D,M)=>function Qs(d,p,y,w){d=(0,oe.m9)(d),function Xo(d,p,y,w,D){return yi.apply(this,arguments)}(_e,cr[d.app.options.appId],p,y,w).catch(D=>At.error(D))}(y,w,D,M)}}catch(y){throw gn.create("interop-component-reg-failed",{reason:y})}},"PRIVATE")),(0,ie.registerVersion)(wi,"0.8.0"),(0,ie.registerVersion)(wi,"0.8.0","esm2017")}();var Zt=j(4408),Ys=j(7565);const Hn=new class ss extends Ys.v{}(class oa extends Zt.o{constructor(p,y){super(p,y),this.scheduler=p,this.work=y}schedule(p,y=0){return y>0?super.schedule(p,y):(this.delay=y,this.state=p,this.scheduler.flush(this),this)}execute(p,y){return y>0||this.closed?super.execute(p,y):this._execute(p,y)}requestAsyncId(p,y,w=0){return null!=w&&w>0||null==w&&this.delay>0?super.requestAsyncId(p,y,w):p.flush(this)}});var P=j(4986),br=j(8505),Mt=j(9468),aa=j(5363);const os=new I.GfV("7.4.1"),Qn="__angularfire_symbol__analyticsIsSupportedValue",ua="__angularfire_symbol__analyticsIsSupported",Rn="__angularfire_symbol__remoteConfigIsSupportedValue",as="__angularfire_symbol__remoteConfigIsSupported",us="__angularfire_symbol__messagingIsSupportedValue",ca="__angularfire_symbol__messagingIsSupported";function Js(d,p,y){if(p){if(1===p.length)return p[0];const M=p.filter(q=>q.app===y);if(1===M.length)return M[0]}return y.container.getProvider(d).getImmediate({optional:!0})}globalThis[ua]||(globalThis[ua]=nc().then(d=>globalThis[Qn]=d).catch(()=>globalThis[Qn]=!1)),globalThis[ca]||(globalThis[ca]=jo().then(d=>globalThis[us]=d).catch(()=>globalThis[us]=!1)),globalThis[as]||(globalThis[as]=Ur().then(d=>globalThis[Rn]=d).catch(()=>globalThis[Rn]=!1));const at=(d,p)=>{const y=p?[p]:(0,se.C6)(),w=[];return y.forEach(D=>{D.container.getProvider(d).instances.forEach(q=>{w.includes(q)||w.push(q)})}),w};function lr(){}class pt{constructor(p,y=Hn){this.zone=p,this.delegate=y}now(){return this.delegate.now()}schedule(p,y,w){const D=this.zone;return this.delegate.schedule(function(q){D.runGuarded(()=>{p.apply(this,[q])})},y,w)}}class We{constructor(p){this.zone=p,this.task=null}call(p,y){const w=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",lr,{},lr,lr)),y.pipe((0,br.b)({next:w,complete:w,error:w})).subscribe(p).add(w)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let cu=(()=>{class d{constructor(y){this.ngZone=y,this.outsideAngular=y.runOutsideAngular(()=>new pt(Zone.current)),this.insideAngular=y.run(()=>new pt(Zone.current,P.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return d.\u0275fac=function(y){return new(y||d)(I.LFG(I.R0b))},d.\u0275prov=I.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();function on(){const d=globalThis.\u0275AngularFireScheduler;if(!d)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return d}function Yn(d){return on(),function ft(d){return function(y){return(y=y.lift(new We(d.ngZone))).pipe((0,Mt.R)(d.outsideAngular),(0,aa.Q)(d.insideAngular))}}(on())(d)}},2090:(Lt,ze,j)=>{j.d(ze,{$s:()=>ir,BH:()=>Ce,G6:()=>Y,L:()=>ye,LL:()=>et,Mn:()=>Qe,Sg:()=>Se,UG:()=>Ee,US:()=>he,ZB:()=>z,ZR:()=>Xe,b$:()=>xe,d:()=>R,eu:()=>Z,hl:()=>N,jU:()=>re,m9:()=>Pr,ne:()=>rr,pd:()=>vn,r3:()=>qt,ru:()=>ke,tV:()=>le,uI:()=>je,vZ:()=>Xt,w1:()=>De,xO:()=>tr,xb:()=>lt,z$:()=>nt,zI:()=>V,zd:()=>nr});const ie=function(k){const b=[];let T=0;for(let A=0;A<k.length;A++){let S=k.charCodeAt(A);S<128?b[T++]=S:S<2048?(b[T++]=S>>6|192,b[T++]=63&S|128):55296==(64512&S)&&A+1<k.length&&56320==(64512&k.charCodeAt(A+1))?(S=65536+((1023&S)<<10)+(1023&k.charCodeAt(++A)),b[T++]=S>>18|240,b[T++]=S>>12&63|128,b[T++]=S>>6&63|128,b[T++]=63&S|128):(b[T++]=S>>12|224,b[T++]=S>>6&63|128,b[T++]=63&S|128)}return b},he={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(k,b){if(!Array.isArray(k))throw Error("encodeByteArray takes an array as a parameter");this.init_();const T=b?this.byteToCharMapWebSafe_:this.byteToCharMap_,A=[];for(let S=0;S<k.length;S+=3){const G=k[S],H=S+1<k.length,pe=H?k[S+1]:0,ht=S+2<k.length,Be=ht?k[S+2]:0;let Kt=(15&pe)<<2|Be>>6,In=63&Be;ht||(In=64,H||(Kt=64)),A.push(T[G>>2],T[(3&G)<<4|pe>>4],T[Kt],T[In])}return A.join("")},encodeString(k,b){return this.HAS_NATIVE_SUPPORT&&!b?btoa(k):this.encodeByteArray(ie(k),b)},decodeString(k,b){return this.HAS_NATIVE_SUPPORT&&!b?atob(k):function(k){const b=[];let T=0,A=0;for(;T<k.length;){const S=k[T++];if(S<128)b[A++]=String.fromCharCode(S);else if(S>191&&S<224){const G=k[T++];b[A++]=String.fromCharCode((31&S)<<6|63&G)}else if(S>239&&S<365){const ht=((7&S)<<18|(63&k[T++])<<12|(63&k[T++])<<6|63&k[T++])-65536;b[A++]=String.fromCharCode(55296+(ht>>10)),b[A++]=String.fromCharCode(56320+(1023&ht))}else{const G=k[T++],H=k[T++];b[A++]=String.fromCharCode((15&S)<<12|(63&G)<<6|63&H)}}return b.join("")}(this.decodeStringToByteArray(k,b))},decodeStringToByteArray(k,b){this.init_();const T=b?this.charToByteMapWebSafe_:this.charToByteMap_,A=[];for(let S=0;S<k.length;){const G=T[k.charAt(S++)],pe=S<k.length?T[k.charAt(S)]:0;++S;const Be=S<k.length?T[k.charAt(S)]:64;++S;const Me=S<k.length?T[k.charAt(S)]:64;if(++S,null==G||null==pe||null==Be||null==Me)throw Error();A.push(G<<2|pe>>4),64!==Be&&(A.push(pe<<4&240|Be>>2),64!==Me&&A.push(Be<<6&192|Me))}return A},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let k=0;k<this.ENCODED_VALS.length;k++)this.byteToCharMap_[k]=this.ENCODED_VALS.charAt(k),this.charToByteMap_[this.byteToCharMap_[k]]=k,this.byteToCharMapWebSafe_[k]=this.ENCODED_VALS_WEBSAFE.charAt(k),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[k]]=k,k>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(k)]=k,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(k)]=k)}}},ye=function(k){return function(k){const b=ie(k);return he.encodeByteArray(b,!0)}(k).replace(/\./g,"")},le=function(k){try{return he.decodeString(k,!0)}catch(b){console.error("base64Decode failed: ",b)}return null};function z(k,b){if(!(b instanceof Object))return b;switch(b.constructor){case Date:return new Date(b.getTime());case Object:void 0===k&&(k={});break;case Array:k=[];break;default:return b}for(const T in b)!b.hasOwnProperty(T)||!de(T)||(k[T]=z(k[T],b[T]));return k}function de(k){return"__proto__"!==k}class Ce{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((b,T)=>{this.resolve=b,this.reject=T})}wrapCallback(b){return(T,A)=>{T?this.reject(T):this.resolve(A),"function"==typeof b&&(this.promise.catch(()=>{}),1===b.length?b(T):b(T,A))}}}function Se(k,b){if(k.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const A=b||"demo-project",S=k.iat||0,G=k.sub||k.user_id;if(!G)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const H=Object.assign({iss:`https://securetoken.google.com/${A}`,aud:A,iat:S,exp:S+3600,auth_time:S,sub:G,user_id:G,firebase:{sign_in_provider:"custom",identities:{}}},k);return[ye(JSON.stringify({alg:"none",type:"JWT"})),ye(JSON.stringify(H)),""].join(".")}function nt(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function je(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(nt())}function Ee(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function re(){return"object"==typeof self&&self.self===self}function ke(){const k="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof k&&void 0!==k.id}function xe(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function R(){return nt().indexOf("Electron/")>=0}function De(){const k=nt();return k.indexOf("MSIE ")>=0||k.indexOf("Trident/")>=0}function Qe(){return nt().indexOf("MSAppHost/")>=0}function Y(){return!Ee()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function N(){return"object"==typeof indexedDB}function Z(){return new Promise((k,b)=>{try{let T=!0;const A="validate-browser-context-for-indexeddb-analytics-module",S=self.indexedDB.open(A);S.onsuccess=()=>{S.result.close(),T||self.indexedDB.deleteDatabase(A),k(!0)},S.onupgradeneeded=()=>{T=!1},S.onerror=()=>{var G;b((null===(G=S.error)||void 0===G?void 0:G.message)||"")}}catch(T){b(T)}})}function V(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class Xe extends Error{constructor(b,T,A){super(T),this.code=b,this.customData=A,this.name="FirebaseError",Object.setPrototypeOf(this,Xe.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,et.prototype.create)}}class et{constructor(b,T,A){this.service=b,this.serviceName=T,this.errors=A}create(b,...T){const A=T[0]||{},S=`${this.service}/${b}`,G=this.errors[b],H=G?function vt(k,b){return k.replace(Rt,(T,A)=>{const S=b[A];return null!=S?String(S):`<${A}?>`})}(G,A):"Error";return new Xe(S,`${this.serviceName}: ${H} (${S}).`,A)}}const Rt=/\{\$([^}]+)}/g;function qt(k,b){return Object.prototype.hasOwnProperty.call(k,b)}function lt(k){for(const b in k)if(Object.prototype.hasOwnProperty.call(k,b))return!1;return!0}function Xt(k,b){if(k===b)return!0;const T=Object.keys(k),A=Object.keys(b);for(const S of T){if(!A.includes(S))return!1;const G=k[S],H=b[S];if(Ft(G)&&Ft(H)){if(!Xt(G,H))return!1}else if(G!==H)return!1}for(const S of A)if(!T.includes(S))return!1;return!0}function Ft(k){return null!==k&&"object"==typeof k}function tr(k){const b=[];for(const[T,A]of Object.entries(k))Array.isArray(A)?A.forEach(S=>{b.push(encodeURIComponent(T)+"="+encodeURIComponent(S))}):b.push(encodeURIComponent(T)+"="+encodeURIComponent(A));return b.length?"&"+b.join("&"):""}function nr(k){const b={};return k.replace(/^\?/,"").split("&").forEach(A=>{if(A){const[S,G]=A.split("=");b[decodeURIComponent(S)]=decodeURIComponent(G)}}),b}function vn(k){const b=k.indexOf("?");if(!b)return"";const T=k.indexOf("#",b);return k.substring(b,T>0?T:void 0)}function rr(k,b){const T=new tt(k,b);return T.subscribe.bind(T)}class tt{constructor(b,T){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=T,this.task.then(()=>{b(this)}).catch(A=>{this.error(A)})}next(b){this.forEachObserver(T=>{T.next(b)})}error(b){this.forEachObserver(T=>{T.error(b)}),this.close(b)}complete(){this.forEachObserver(b=>{b.complete()}),this.close()}subscribe(b,T,A){let S;if(void 0===b&&void 0===T&&void 0===A)throw new Error("Missing Observer.");S=function Bn(k,b){if("object"!=typeof k||null===k)return!1;for(const T of b)if(T in k&&"function"==typeof k[T])return!0;return!1}(b,["next","error","complete"])?b:{next:b,error:T,complete:A},void 0===S.next&&(S.next=En),void 0===S.error&&(S.error=En),void 0===S.complete&&(S.complete=En);const G=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?S.error(this.finalError):S.complete()}catch{}}),this.observers.push(S),G}unsubscribeOne(b){void 0===this.observers||void 0===this.observers[b]||(delete this.observers[b],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(b){if(!this.finalized)for(let T=0;T<this.observers.length;T++)this.sendOne(T,b)}sendOne(b,T){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[b])try{T(this.observers[b])}catch(A){typeof console<"u"&&console.error&&console.error(A)}})}close(b){this.finalized||(this.finalized=!0,void 0!==b&&(this.finalError=b),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function En(){}function ir(k,b=1e3,T=2){const A=b*Math.pow(T,k),S=Math.round(.5*A*(Math.random()-.5)*2);return Math.min(144e5,A+S)}function Pr(k){return k&&k._delegate?k._delegate:k}},5867:(Lt,ze,j)=>{j.d(ze,{C6:()=>I.getApps,Mq:()=>I.getApp});var I=j(9681);(0,I.registerVersion)("firebase","9.9.3","app")},127:(Lt,ze,j)=>{j.d(ze,{Z:()=>I.Z});var I=j(3942);I.Z.registerVersion("firebase","9.9.3","app-compat")},1451:(Lt,ze,j)=>{j.r(ze);var I=j(5861),se=j(3942),C=j(2090),ie=j(9681),oe=j(655),he=j(1877),fe=j(4859);const nt=function Ce(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},je=function Se(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Ee=new C.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),ke=new he.Yd("@firebase/auth");function xe(c,...o){ke.logLevel<=he.in.ERROR&&ke.error(`Auth (${ie.SDK_VERSION}): ${c}`,...o)}function R(c,...o){throw Y(c,...o)}function De(c,...o){return Y(c,...o)}function Qe(c,o,a){const l=Object.assign(Object.assign({},je()),{[o]:a});return new C.LL("auth","Firebase",l).create(o,{appName:c.name})}function Pe(c,o,a){if(!(o instanceof a))throw a.name!==o.constructor.name&&R(c,"argument-error"),Qe(c,"argument-error",`Type of ${o.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Y(c,...o){if("string"!=typeof c){const a=o[0],l=[...o.slice(1)];return l[0]&&(l[0].appName=c.name),c._errorFactory.create(a,...l)}return Ee.create(c,...o)}function N(c,o,...a){if(!c)throw Y(o,...a)}function Z(c){const o="INTERNAL ASSERTION FAILED: "+c;throw xe(o),new Error(o)}function V(c,o){c||Z(o)}const Ze=new Map;function ee(c){V(c instanceof Function,"Expected a class definition");let o=Ze.get(c);return o?(V(o instanceof c,"Instance stored in cache mismatched with class"),o):(o=new c,Ze.set(c,o),o)}function vt(){var c;return typeof self<"u"&&(null===(c=self.location)||void 0===c?void 0:c.href)||""}function Rt(){return"http:"===_n()||"https:"===_n()}function _n(){var c;return typeof self<"u"&&(null===(c=self.location)||void 0===c?void 0:c.protocol)||null}class Gt{constructor(o,a){this.shortDelay=o,this.longDelay=a,V(a>o,"Short delay should be less than long delay!"),this.isMobile=(0,C.uI)()||(0,C.b$)()}get(){return function hn(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Rt()||(0,C.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ge(c,o){V(c.emulator,"Emulator should always be set here");const{url:a}=c.emulator;return o?`${a}${o.startsWith("/")?o.slice(1):o}`:a}class Jt{static initialize(o,a,l){this.fetchImpl=o,a&&(this.headersImpl=a),l&&(this.responseImpl=l)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void Z("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void Z("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void Z("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const gt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},qt=new Gt(3e4,6e4);function ct(c,o){return c.tenantId&&!o.tenantId?Object.assign(Object.assign({},o),{tenantId:c.tenantId}):o}function lt(c,o,a,l){return Nr.apply(this,arguments)}function Nr(){return(Nr=(0,I.Z)(function*(c,o,a,l,g={}){return Xt(c,g,(0,I.Z)(function*(){let _={},x={};l&&("GET"===o?x=l:_={body:JSON.stringify(l)});const F=(0,C.xO)(Object.assign({key:c.config.apiKey},x)).slice(1),Q=yield c._getAdditionalHeaders();return Q["Content-Type"]="application/json",c.languageCode&&(Q["X-Firebase-Locale"]=c.languageCode),Jt.fetch()(nr(c,c.config.apiHost,a,F),Object.assign({method:o,headers:Q,referrerPolicy:"no-referrer"},_))}))})).apply(this,arguments)}function Xt(c,o,a){return Ft.apply(this,arguments)}function Ft(){return(Ft=(0,I.Z)(function*(c,o,a){c._canInitEmulator=!1;const l=Object.assign(Object.assign({},gt),o);try{const g=new vn(c),_=yield Promise.race([a(),g.promise]);g.clearNetworkTimeout();const x=yield _.json();if("needConfirmation"in x)throw it(c,"account-exists-with-different-credential",x);if(_.ok&&!("errorMessage"in x))return x;{const F=_.ok?x.errorMessage:x.error.message,[Q,ue]=F.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===Q)throw it(c,"credential-already-in-use",x);if("EMAIL_EXISTS"===Q)throw it(c,"email-already-in-use",x);if("USER_DISABLED"===Q)throw it(c,"user-disabled",x);const Ae=l[Q]||Q.toLowerCase().replace(/[_\s]+/g,"-");if(ue)throw Qe(c,Ae,ue);R(c,Ae)}}catch(g){if(g instanceof C.ZR)throw g;R(c,"network-request-failed")}})).apply(this,arguments)}function en(c,o,a,l){return tr.apply(this,arguments)}function tr(){return(tr=(0,I.Z)(function*(c,o,a,l,g={}){const _=yield lt(c,o,a,l,g);return"mfaPendingCredential"in _&&R(c,"multi-factor-auth-required",{_serverResponse:_}),_})).apply(this,arguments)}function nr(c,o,a,l){const g=`${o}${a}?${l}`;return c.config.emulator?Ge(c.config,g):`${c.config.apiScheme}://${g}`}class vn{constructor(o){this.auth=o,this.timer=null,this.promise=new Promise((a,l)=>{this.timer=setTimeout(()=>l(De(this.auth,"network-request-failed")),qt.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function it(c,o,a){const l={appName:c.name};a.email&&(l.email=a.email),a.phoneNumber&&(l.phoneNumber=a.phoneNumber);const g=De(c,o,l);return g.customData._tokenResponse=a,g}function tt(){return(tt=(0,I.Z)(function*(c,o){return lt(c,"POST","/v1/accounts:delete",o)})).apply(this,arguments)}function Vn(c,o){return Bn.apply(this,arguments)}function Bn(){return(Bn=(0,I.Z)(function*(c,o){return lt(c,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function En(c,o){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,I.Z)(function*(c,o){return lt(c,"POST","/v1/accounts:lookup",o)})).apply(this,arguments)}function tn(c){if(c)try{const o=new Date(Number(c));if(!isNaN(o.getTime()))return o.toUTCString()}catch{}}function Rr(){return(Rr=(0,I.Z)(function*(c,o=!1){const a=(0,C.m9)(c),l=yield a.getIdToken(o),g=nn(l);N(g&&g.exp&&g.auth_time&&g.iat,a.auth,"internal-error");const _="object"==typeof g.firebase?g.firebase:void 0,x=_?.sign_in_provider;return{claims:g,token:l,authTime:tn(ei(g.auth_time)),issuedAtTime:tn(ei(g.iat)),expirationTime:tn(ei(g.exp)),signInProvider:x||null,signInSecondFactor:_?.sign_in_second_factor||null}})).apply(this,arguments)}function ei(c){return 1e3*Number(c)}function nn(c){var o;const[a,l,g]=c.split(".");if(void 0===a||void 0===l||void 0===g)return xe("JWT malformed, contained fewer than 3 sections"),null;try{const _=(0,C.tV)(l);return _?JSON.parse(_):(xe("Failed to decode base64 JWT payload"),null)}catch(_){return xe("Caught error parsing JWT payload as JSON",null===(o=_)||void 0===o?void 0:o.toString()),null}}function Ot(c,o){return bn.apply(this,arguments)}function bn(){return(bn=(0,I.Z)(function*(c,o,a=!1){if(a)return o;try{return yield o}catch(l){throw l instanceof C.ZR&&ti(l)&&c.auth.currentUser===c&&(yield c.auth.signOut()),l}})).apply(this,arguments)}function ti({code:c}){return"auth/user-disabled"===c||"auth/user-token-expired"===c}class Or{constructor(o){this.user=o,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(o){var a;if(o){const l=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),l}{this.errorBackoff=3e4;const g=(null!==(a=this.user.stsTokenManager.expirationTime)&&void 0!==a?a:0)-Date.now()-3e5;return Math.max(0,g)}}schedule(o=!1){var a=this;if(!this.isRunning)return;const l=this.getInterval(o);this.timerId=setTimeout((0,I.Z)(function*(){yield a.iteration()}),l)}iteration(){var o=this;return(0,I.Z)(function*(){var a;try{yield o.user.getIdToken(!0)}catch(l){return void("auth/network-request-failed"===(null===(a=l)||void 0===a?void 0:a.code)&&o.schedule(!0))}o.schedule()})()}}class ir{constructor(o,a){this.createdAt=o,this.lastLoginAt=a,this._initializeTime()}_initializeTime(){this.lastSignInTime=tn(this.lastLoginAt),this.creationTime=tn(this.createdAt)}_copy(o){this.createdAt=o.createdAt,this.lastLoginAt=o.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function An(c){return Sn.apply(this,arguments)}function Sn(){return(Sn=(0,I.Z)(function*(c){var o;const a=c.auth,l=yield c.getIdToken(),g=yield Ot(c,En(a,{idToken:l}));N(g?.users.length,a,"internal-error");const _=g.users[0];c._notifyReloadListener(_);const x=null!==(o=_.providerUserInfo)&&void 0!==o&&o.length?T(_.providerUserInfo):[],F=b(c.providerData,x),Ae=!!c.isAnonymous&&!(c.email&&_.passwordHash||F?.length),ve={uid:_.localId,displayName:_.displayName||null,photoURL:_.photoUrl||null,email:_.email||null,emailVerified:_.emailVerified||!1,phoneNumber:_.phoneNumber||null,tenantId:_.tenantId||null,providerData:F,metadata:new ir(_.createdAt,_.lastLoginAt),isAnonymous:Ae};Object.assign(c,ve)})).apply(this,arguments)}function k(){return(k=(0,I.Z)(function*(c){const o=(0,C.m9)(c);yield An(o),yield o.auth._persistUserIfCurrent(o),o.auth._notifyListenersIfCurrent(o)})).apply(this,arguments)}function b(c,o){return[...c.filter(l=>!o.some(g=>g.providerId===l.providerId)),...o]}function T(c){return c.map(o=>{var{providerId:a}=o,l=(0,oe._T)(o,["providerId"]);return{providerId:a,uid:l.rawId||"",displayName:l.displayName||null,email:l.email||null,phoneNumber:l.phoneNumber||null,photoURL:l.photoUrl||null}})}function S(){return(S=(0,I.Z)(function*(c,o){const a=yield Xt(c,{},(0,I.Z)(function*(){const l=(0,C.xO)({grant_type:"refresh_token",refresh_token:o}).slice(1),{tokenApiHost:g,apiKey:_}=c.config,x=nr(c,g,"/v1/token",`key=${_}`),F=yield c._getAdditionalHeaders();return F["Content-Type"]="application/x-www-form-urlencoded",Jt.fetch()(x,{method:"POST",headers:F,body:l})}));return{accessToken:a.access_token,expiresIn:a.expires_in,refreshToken:a.refresh_token}})).apply(this,arguments)}class G{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(o){N(o.idToken,"internal-error"),N(typeof o.idToken<"u","internal-error"),N(typeof o.refreshToken<"u","internal-error");const a="expiresIn"in o&&typeof o.expiresIn<"u"?Number(o.expiresIn):function gr(c){const o=nn(c);return N(o,"internal-error"),N(typeof o.exp<"u","internal-error"),N(typeof o.iat<"u","internal-error"),Number(o.exp)-Number(o.iat)}(o.idToken);this.updateTokensAndExpiration(o.idToken,o.refreshToken,a)}getToken(o,a=!1){var l=this;return(0,I.Z)(function*(){return N(!l.accessToken||l.refreshToken,o,"user-token-expired"),a||!l.accessToken||l.isExpired?l.refreshToken?(yield l.refresh(o,l.refreshToken),l.accessToken):null:l.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(o,a){var l=this;return(0,I.Z)(function*(){const{accessToken:g,refreshToken:_,expiresIn:x}=yield function A(c,o){return S.apply(this,arguments)}(o,a);l.updateTokensAndExpiration(g,_,Number(x))})()}updateTokensAndExpiration(o,a,l){this.refreshToken=a||null,this.accessToken=o||null,this.expirationTime=Date.now()+1e3*l}static fromJSON(o,a){const{refreshToken:l,accessToken:g,expirationTime:_}=a,x=new G;return l&&(N("string"==typeof l,"internal-error",{appName:o}),x.refreshToken=l),g&&(N("string"==typeof g,"internal-error",{appName:o}),x.accessToken=g),_&&(N("number"==typeof _,"internal-error",{appName:o}),x.expirationTime=_),x}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(o){this.accessToken=o.accessToken,this.refreshToken=o.refreshToken,this.expirationTime=o.expirationTime}_clone(){return Object.assign(new G,this.toJSON())}_performRefresh(){return Z("not implemented")}}function H(c,o){N("string"==typeof c||typeof c>"u","internal-error",{appName:o})}class pe{constructor(o){var{uid:a,auth:l,stsTokenManager:g}=o,_=(0,oe._T)(o,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Or(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=a,this.auth=l,this.stsTokenManager=g,this.accessToken=g.accessToken,this.displayName=_.displayName||null,this.email=_.email||null,this.emailVerified=_.emailVerified||!1,this.phoneNumber=_.phoneNumber||null,this.photoURL=_.photoURL||null,this.isAnonymous=_.isAnonymous||!1,this.tenantId=_.tenantId||null,this.providerData=_.providerData?[..._.providerData]:[],this.metadata=new ir(_.createdAt||void 0,_.lastLoginAt||void 0)}getIdToken(o){var a=this;return(0,I.Z)(function*(){const l=yield Ot(a,a.stsTokenManager.getToken(a.auth,o));return N(l,a.auth,"internal-error"),a.accessToken!==l&&(a.accessToken=l,yield a.auth._persistUserIfCurrent(a),a.auth._notifyListenersIfCurrent(a)),l})()}getIdTokenResult(o){return function jn(c){return Rr.apply(this,arguments)}(this,o)}reload(){return function Pr(c){return k.apply(this,arguments)}(this)}_assign(o){this!==o&&(N(this.uid===o.uid,this.auth,"internal-error"),this.displayName=o.displayName,this.photoURL=o.photoURL,this.email=o.email,this.emailVerified=o.emailVerified,this.phoneNumber=o.phoneNumber,this.isAnonymous=o.isAnonymous,this.tenantId=o.tenantId,this.providerData=o.providerData.map(a=>Object.assign({},a)),this.metadata._copy(o.metadata),this.stsTokenManager._assign(o.stsTokenManager))}_clone(o){return new pe(Object.assign(Object.assign({},this),{auth:o,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(o){N(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=o,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(o){this.reloadListener?this.reloadListener(o):this.reloadUserInfo=o}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(o,a=!1){var l=this;return(0,I.Z)(function*(){let g=!1;o.idToken&&o.idToken!==l.stsTokenManager.accessToken&&(l.stsTokenManager.updateFromServerResponse(o),g=!0),a&&(yield An(l)),yield l.auth._persistUserIfCurrent(l),g&&l.auth._notifyListenersIfCurrent(l)})()}delete(){var o=this;return(0,I.Z)(function*(){const a=yield o.getIdToken();return yield Ot(o,function rr(c,o){return tt.apply(this,arguments)}(o.auth,{idToken:a})),o.stsTokenManager.clearRefreshToken(),o.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(o=>Object.assign({},o)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(o,a){var l,g,_,x,F,Q,ue,Ae;const ve=null!==(l=a.displayName)&&void 0!==l?l:void 0,yt=null!==(g=a.email)&&void 0!==g?g:void 0,Pn=null!==(_=a.phoneNumber)&&void 0!==_?_:void 0,Cu=null!==(x=a.photoURL)&&void 0!==x?x:void 0,mc=null!==(F=a.tenantId)&&void 0!==F?F:void 0,ku=null!==(Q=a._redirectEventId)&&void 0!==Q?Q:void 0,yc=null!==(ue=a.createdAt)&&void 0!==ue?ue:void 0,pl=null!==(Ae=a.lastLoginAt)&&void 0!==Ae?Ae:void 0,{uid:Du,emailVerified:gl,isAnonymous:ml,providerData:Di,stsTokenManager:fs}=a;N(Du&&fs,o,"internal-error");const wh=G.fromJSON(this.name,fs);N("string"==typeof Du,o,"internal-error"),H(ve,o.name),H(yt,o.name),N("boolean"==typeof gl,o,"internal-error"),N("boolean"==typeof ml,o,"internal-error"),H(Pn,o.name),H(Cu,o.name),H(mc,o.name),H(ku,o.name),H(yc,o.name),H(pl,o.name);const _c=new pe({uid:Du,auth:o,email:yt,emailVerified:gl,displayName:ve,isAnonymous:ml,photoURL:Cu,phoneNumber:Pn,tenantId:mc,stsTokenManager:wh,createdAt:yc,lastLoginAt:pl});return Di&&Array.isArray(Di)&&(_c.providerData=Di.map(Eh=>Object.assign({},Eh))),ku&&(_c._redirectEventId=ku),_c}static _fromIdTokenResponse(o,a,l=!1){return(0,I.Z)(function*(){const g=new G;g.updateFromServerResponse(a);const _=new pe({uid:a.localId,auth:o,stsTokenManager:g,isAnonymous:l});return yield An(_),_})()}}const Be=(()=>{class c{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,I.Z)(function*(){return!0})()}_set(a,l){var g=this;return(0,I.Z)(function*(){g.storage[a]=l})()}_get(a){var l=this;return(0,I.Z)(function*(){const g=l.storage[a];return void 0===g?null:g})()}_remove(a){var l=this;return(0,I.Z)(function*(){delete l.storage[a]})()}_addListener(a,l){}_removeListener(a,l){}}return c.type="NONE",c})();function Ut(c,o,a){return`firebase:${c}:${o}:${a}`}class Me{constructor(o,a,l){this.persistence=o,this.auth=a,this.userKey=l;const{config:g,name:_}=this.auth;this.fullUserKey=Ut(this.userKey,g.apiKey,_),this.fullPersistenceKey=Ut("persistence",g.apiKey,_),this.boundEventHandler=a._onStorageEvent.bind(a),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(o){return this.persistence._set(this.fullUserKey,o.toJSON())}getCurrentUser(){var o=this;return(0,I.Z)(function*(){const a=yield o.persistence._get(o.fullUserKey);return a?pe._fromJSON(o.auth,a):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(o){var a=this;return(0,I.Z)(function*(){if(a.persistence===o)return;const l=yield a.getCurrentUser();return yield a.removeCurrentUser(),a.persistence=o,l?a.setCurrentUser(l):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(o,a,l="authUser"){return(0,I.Z)(function*(){if(!a.length)return new Me(ee(Be),o,l);const g=(yield Promise.all(a.map(function(){var ue=(0,I.Z)(function*(Ae){if(yield Ae._isAvailable())return Ae});return function(Ae){return ue.apply(this,arguments)}}()))).filter(ue=>ue);let _=g[0]||ee(Be);const x=Ut(l,o.config.apiKey,o.name);let F=null;for(const ue of a)try{const Ae=yield ue._get(x);if(Ae){const ve=pe._fromJSON(o,Ae);ue!==_&&(F=ve),_=ue;break}}catch{}const Q=g.filter(ue=>ue._shouldAllowMigration);return _._shouldAllowMigration&&Q.length?(_=Q[0],F&&(yield _._set(x,F.toJSON())),yield Promise.all(a.map(function(){var ue=(0,I.Z)(function*(Ae){if(Ae!==_)try{yield Ae._remove(x)}catch{}});return function(Ae){return ue.apply(this,arguments)}}())),new Me(_,o,l)):new Me(_,o,l)})()}}function Kt(c){const o=c.toLowerCase();if(o.includes("opera/")||o.includes("opr/")||o.includes("opios/"))return"Opera";if(ys(o))return"IEMobile";if(o.includes("msie")||o.includes("trident/"))return"IE";if(o.includes("edge/"))return"Edge";if(In(o))return"Firefox";if(o.includes("silk/"))return"Silk";if(yo(o))return"Blackberry";if(Pi(o))return"Webos";if(Mr(o))return"Safari";if((o.includes("chrome/")||ni(o))&&!o.includes("edge/"))return"Chrome";if(sr(o))return"Android";{const l=c.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===l?.length)return l[1]}return"Other"}function In(c=(0,C.z$)()){return/firefox\//i.test(c)}function Mr(c=(0,C.z$)()){const o=c.toLowerCase();return o.includes("safari/")&&!o.includes("chrome/")&&!o.includes("crios/")&&!o.includes("android")}function ni(c=(0,C.z$)()){return/crios\//i.test(c)}function ys(c=(0,C.z$)()){return/iemobile/i.test(c)}function sr(c=(0,C.z$)()){return/android/i.test(c)}function yo(c=(0,C.z$)()){return/blackberry/i.test(c)}function Pi(c=(0,C.z$)()){return/webos/i.test(c)}function ri(c=(0,C.z$)()){return/iphone|ipad|ipod/i.test(c)||/macintosh/i.test(c)&&/mobile/i.test(c)}function Va(c=(0,C.z$)()){return ri(c)||sr(c)||Pi(c)||yo(c)||/windows phone/i.test(c)||ys(c)}function ii(c,o=[]){let a;switch(c){case"Browser":a=Kt((0,C.z$)());break;case"Worker":a=`${Kt((0,C.z$)())}-${c}`;break;default:a=c}const l=o.length?o.join(","):"FirebaseCore-web";return`${a}/JsCore/${ie.SDK_VERSION}/${l}`}class vs{constructor(o){this.auth=o,this.queue=[]}pushCallback(o,a){const l=_=>new Promise((x,F)=>{try{x(o(_))}catch(Q){F(Q)}});l.onAbort=a,this.queue.push(l);const g=this.queue.length-1;return()=>{this.queue[g]=()=>Promise.resolve()}}runMiddleware(o){var a=this;return(0,I.Z)(function*(){var l;if(a.auth.currentUser===o)return;const g=[];try{for(const _ of a.queue)yield _(o),_.onAbort&&g.push(_.onAbort)}catch(_){g.reverse();for(const x of g)try{x()}catch{}throw a.auth._errorFactory.create("login-blocked",{originalMessage:null===(l=_)||void 0===l?void 0:l.message})}})()}}class _o{constructor(o,a,l){this.app=o,this.heartbeatServiceProvider=a,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new xt(this),this.idTokenSubscription=new xt(this),this.beforeStateQueue=new vs(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ee,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=o.name,this.clientVersion=l.sdkClientVersion}_initializeWithPersistence(o,a){var l=this;return a&&(this._popupRedirectResolver=ee(a)),this._initializationPromise=this.queue((0,I.Z)(function*(){var g,_;if(!l._deleted&&(l.persistenceManager=yield Me.create(l,o),!l._deleted)){if(null!==(g=l._popupRedirectResolver)&&void 0!==g&&g._shouldInitProactively)try{yield l._popupRedirectResolver._initialize(l)}catch{}yield l.initializeCurrentUser(a),l.lastNotifiedUid=(null===(_=l.currentUser)||void 0===_?void 0:_.uid)||null,!l._deleted&&(l._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var o=this;return(0,I.Z)(function*(){if(o._deleted)return;const a=yield o.assertedPersistence.getCurrentUser();if(o.currentUser||a){if(o.currentUser&&a&&o.currentUser.uid===a.uid)return o._currentUser._assign(a),void(yield o.currentUser.getIdToken());yield o._updateCurrentUser(a,!0)}})()}initializeCurrentUser(o){var a=this;return(0,I.Z)(function*(){var l;const g=yield a.assertedPersistence.getCurrentUser();let _=g,x=!1;if(o&&a.config.authDomain){yield a.getOrInitRedirectPersistenceManager();const F=null===(l=a.redirectUser)||void 0===l?void 0:l._redirectEventId,Q=_?._redirectEventId,ue=yield a.tryRedirectSignIn(o);(!F||F===Q)&&ue?.user&&(_=ue.user,x=!0)}if(!_)return a.directlySetCurrentUser(null);if(!_._redirectEventId){if(x)try{yield a.beforeStateQueue.runMiddleware(_)}catch(F){_=g,a._popupRedirectResolver._overrideRedirectResult(a,()=>Promise.reject(F))}return _?a.reloadAndSetCurrentUserOrClear(_):a.directlySetCurrentUser(null)}return N(a._popupRedirectResolver,a,"argument-error"),yield a.getOrInitRedirectPersistenceManager(),a.redirectUser&&a.redirectUser._redirectEventId===_._redirectEventId?a.directlySetCurrentUser(_):a.reloadAndSetCurrentUserOrClear(_)})()}tryRedirectSignIn(o){var a=this;return(0,I.Z)(function*(){let l=null;try{l=yield a._popupRedirectResolver._completeRedirectFn(a,o,!0)}catch{yield a._setRedirectUser(null)}return l})()}reloadAndSetCurrentUserOrClear(o){var a=this;return(0,I.Z)(function*(){var l;try{yield An(o)}catch(g){if("auth/network-request-failed"!==(null===(l=g)||void 0===l?void 0:l.code))return a.directlySetCurrentUser(null)}return a.directlySetCurrentUser(o)})()}useDeviceLanguage(){this.languageCode=function pr(){if(typeof navigator>"u")return null;const c=navigator;return c.languages&&c.languages[0]||c.language||null}()}_delete(){var o=this;return(0,I.Z)(function*(){o._deleted=!0})()}updateCurrentUser(o){var a=this;return(0,I.Z)(function*(){const l=o?(0,C.m9)(o):null;return l&&N(l.auth.config.apiKey===a.config.apiKey,a,"invalid-user-token"),a._updateCurrentUser(l&&l._clone(a))})()}_updateCurrentUser(o,a=!1){var l=this;return(0,I.Z)(function*(){if(!l._deleted)return o&&N(l.tenantId===o.tenantId,l,"tenant-id-mismatch"),a||(yield l.beforeStateQueue.runMiddleware(o)),l.queue((0,I.Z)(function*(){yield l.directlySetCurrentUser(o),l.notifyAuthListeners()}))})()}signOut(){var o=this;return(0,I.Z)(function*(){return yield o.beforeStateQueue.runMiddleware(null),(o.redirectPersistenceManager||o._popupRedirectResolver)&&(yield o._setRedirectUser(null)),o._updateCurrentUser(null,!0)})()}setPersistence(o){var a=this;return this.queue((0,I.Z)(function*(){yield a.assertedPersistence.setPersistence(ee(o))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(o){this._errorFactory=new C.LL("auth","Firebase",o())}onAuthStateChanged(o,a,l){return this.registerStateListener(this.authStateSubscription,o,a,l)}beforeAuthStateChanged(o,a){return this.beforeStateQueue.pushCallback(o,a)}onIdTokenChanged(o,a,l){return this.registerStateListener(this.idTokenSubscription,o,a,l)}toJSON(){var o;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(o=this._currentUser)||void 0===o?void 0:o.toJSON()}}_setRedirectUser(o,a){var l=this;return(0,I.Z)(function*(){const g=yield l.getOrInitRedirectPersistenceManager(a);return null===o?g.removeCurrentUser():g.setCurrentUser(o)})()}getOrInitRedirectPersistenceManager(o){var a=this;return(0,I.Z)(function*(){if(!a.redirectPersistenceManager){const l=o&&ee(o)||a._popupRedirectResolver;N(l,a,"argument-error"),a.redirectPersistenceManager=yield Me.create(a,[ee(l._redirectPersistence)],"redirectUser"),a.redirectUser=yield a.redirectPersistenceManager.getCurrentUser()}return a.redirectPersistenceManager})()}_redirectUserForId(o){var a=this;return(0,I.Z)(function*(){var l,g;return a._isInitialized&&(yield a.queue((0,I.Z)(function*(){}))),(null===(l=a._currentUser)||void 0===l?void 0:l._redirectEventId)===o?a._currentUser:(null===(g=a.redirectUser)||void 0===g?void 0:g._redirectEventId)===o?a.redirectUser:null})()}_persistUserIfCurrent(o){var a=this;return(0,I.Z)(function*(){if(o===a.currentUser)return a.queue((0,I.Z)(function*(){return a.directlySetCurrentUser(o)}))})()}_notifyListenersIfCurrent(o){o===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var o,a;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const l=null!==(a=null===(o=this.currentUser)||void 0===o?void 0:o.uid)&&void 0!==a?a:null;this.lastNotifiedUid!==l&&(this.lastNotifiedUid=l,this.authStateSubscription.next(this.currentUser))}registerStateListener(o,a,l,g){if(this._deleted)return()=>{};const _="function"==typeof a?a:a.next.bind(a),x=this._isInitialized?Promise.resolve():this._initializationPromise;return N(x,this,"internal-error"),x.then(()=>_(this.currentUser)),"function"==typeof a?o.addObserver(a,l,g):o.addObserver(a)}directlySetCurrentUser(o){var a=this;return(0,I.Z)(function*(){a.currentUser&&a.currentUser!==o&&(a._currentUser._stopProactiveRefresh(),o&&a.isProactiveRefreshEnabled&&o._startProactiveRefresh()),a.currentUser=o,o?yield a.assertedPersistence.setCurrentUser(o):yield a.assertedPersistence.removeCurrentUser()})()}queue(o){return this.operations=this.operations.then(o,o),this.operations}get assertedPersistence(){return N(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(o){!o||this.frameworks.includes(o)||(this.frameworks.push(o),this.frameworks.sort(),this.clientVersion=ii(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var o=this;return(0,I.Z)(function*(){var a;const l={"X-Client-Version":o.clientVersion};o.app.options.appId&&(l["X-Firebase-gmpid"]=o.app.options.appId);const g=yield null===(a=o.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===a?void 0:a.getHeartbeatsHeader();return g&&(l["X-Firebase-Client"]=g),l})()}}function Le(c){return(0,C.m9)(c)}class xt{constructor(o){this.auth=o,this.observer=null,this.addObserver=(0,C.ne)(a=>this.observer=a)}get next(){return N(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function si(c){const o=c.indexOf(":");return o<0?"":c.substr(0,o+1)}function $a(c){if(!c)return null;const o=Number(c);return isNaN(o)?null:o}class oi{constructor(o,a){this.providerId=o,this.signInMethod=a}toJSON(){return Z("not implemented")}_getIdTokenResponse(o){return Z("not implemented")}_linkToIdToken(o,a){return Z("not implemented")}_getReauthenticationResolver(o){return Z("not implemented")}}function zt(c,o){return Mi.apply(this,arguments)}function Mi(){return(Mi=(0,I.Z)(function*(c,o){return lt(c,"POST","/v1/accounts:resetPassword",ct(c,o))})).apply(this,arguments)}function ws(c,o){return Io.apply(this,arguments)}function Io(){return(Io=(0,I.Z)(function*(c,o){return lt(c,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Es(c,o){return Ts.apply(this,arguments)}function Ts(){return(Ts=(0,I.Z)(function*(c,o){return lt(c,"POST","/v1/accounts:update",ct(c,o))})).apply(this,arguments)}function Li(){return(Li=(0,I.Z)(function*(c,o){return en(c,"POST","/v1/accounts:signInWithPassword",ct(c,o))})).apply(this,arguments)}function ai(c,o){return Lr.apply(this,arguments)}function Lr(){return(Lr=(0,I.Z)(function*(c,o){return lt(c,"POST","/v1/accounts:sendOobCode",ct(c,o))})).apply(this,arguments)}function ja(c,o){return Eo.apply(this,arguments)}function Eo(){return(Eo=(0,I.Z)(function*(c,o){return ai(c,o)})).apply(this,arguments)}function Fr(c,o){return To.apply(this,arguments)}function To(){return(To=(0,I.Z)(function*(c,o){return ai(c,o)})).apply(this,arguments)}function Zu(c,o){return bo.apply(this,arguments)}function bo(){return(bo=(0,I.Z)(function*(c,o){return ai(c,o)})).apply(this,arguments)}function Ao(c,o){return ui.apply(this,arguments)}function ui(){return(ui=(0,I.Z)(function*(c,o){return ai(c,o)})).apply(this,arguments)}function mr(){return(mr=(0,I.Z)(function*(c,o){return en(c,"POST","/v1/accounts:signInWithEmailLink",ct(c,o))})).apply(this,arguments)}function So(){return(So=(0,I.Z)(function*(c,o){return en(c,"POST","/v1/accounts:signInWithEmailLink",ct(c,o))})).apply(this,arguments)}class xn extends oi{constructor(o,a,l,g=null){super("password",l),this._email=o,this._password=a,this._tenantId=g}static _fromEmailAndPassword(o,a){return new xn(o,a,"password")}static _fromEmailAndCode(o,a,l=null){return new xn(o,a,"emailLink",l)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(o){const a="string"==typeof o?JSON.parse(o):o;if(a?.email&&a?.password){if("password"===a.signInMethod)return this._fromEmailAndPassword(a.email,a.password);if("emailLink"===a.signInMethod)return this._fromEmailAndCode(a.email,a.password,a.tenantId)}return null}_getIdTokenResponse(o){var a=this;return(0,I.Z)(function*(){switch(a.signInMethod){case"password":return function wo(c,o){return Li.apply(this,arguments)}(o,{returnSecureToken:!0,email:a._email,password:a._password});case"emailLink":return function $c(c,o){return mr.apply(this,arguments)}(o,{email:a._email,oobCode:a._password});default:R(o,"internal-error")}})()}_linkToIdToken(o,a){var l=this;return(0,I.Z)(function*(){switch(l.signInMethod){case"password":return ws(o,{idToken:a,returnSecureToken:!0,email:l._email,password:l._password});case"emailLink":return function Wu(c,o){return So.apply(this,arguments)}(o,{idToken:a,email:l._email,oobCode:l._password});default:R(o,"internal-error")}})()}_getReauthenticationResolver(o){return this._getIdTokenResponse(o)}}function Gn(c,o){return ci.apply(this,arguments)}function ci(){return(ci=(0,I.Z)(function*(c,o){return en(c,"POST","/v1/accounts:signInWithIdp",ct(c,o))})).apply(this,arguments)}class rn extends oi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(o){const a=new rn(o.providerId,o.signInMethod);return o.idToken||o.accessToken?(o.idToken&&(a.idToken=o.idToken),o.accessToken&&(a.accessToken=o.accessToken),o.nonce&&!o.pendingToken&&(a.nonce=o.nonce),o.pendingToken&&(a.pendingToken=o.pendingToken)):o.oauthToken&&o.oauthTokenSecret?(a.accessToken=o.oauthToken,a.secret=o.oauthTokenSecret):R("argument-error"),a}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(o){const a="string"==typeof o?JSON.parse(o):o,{providerId:l,signInMethod:g}=a,_=(0,oe._T)(a,["providerId","signInMethod"]);if(!l||!g)return null;const x=new rn(l,g);return x.idToken=_.idToken||void 0,x.accessToken=_.accessToken||void 0,x.secret=_.secret,x.nonce=_.nonce,x.pendingToken=_.pendingToken||null,x}_getIdTokenResponse(o){return Gn(o,this.buildRequest())}_linkToIdToken(o,a){const l=this.buildRequest();return l.idToken=a,Gn(o,l)}_getReauthenticationResolver(o){const a=this.buildRequest();return a.autoCreate=!1,Gn(o,a)}buildRequest(){const o={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)o.pendingToken=this.pendingToken;else{const a={};this.idToken&&(a.id_token=this.idToken),this.accessToken&&(a.access_token=this.accessToken),this.secret&&(a.oauth_token_secret=this.secret),a.providerId=this.providerId,this.nonce&&!this.pendingToken&&(a.nonce=this.nonce),o.postBody=(0,C.xO)(a)}return o}}function qa(c,o){return Pt.apply(this,arguments)}function Pt(){return(Pt=(0,I.Z)(function*(c,o){return lt(c,"POST","/v1/accounts:sendVerificationCode",ct(c,o))})).apply(this,arguments)}function dn(){return(dn=(0,I.Z)(function*(c,o){return en(c,"POST","/v1/accounts:signInWithPhoneNumber",ct(c,o))})).apply(this,arguments)}function As(){return(As=(0,I.Z)(function*(c,o){const a=yield en(c,"POST","/v1/accounts:signInWithPhoneNumber",ct(c,o));if(a.temporaryProof)throw it(c,"account-exists-with-different-credential",a);return a})).apply(this,arguments)}const xo={USER_NOT_FOUND:"user-not-found"};function Ss(){return(Ss=(0,I.Z)(function*(c,o){return en(c,"POST","/v1/accounts:signInWithPhoneNumber",ct(c,Object.assign(Object.assign({},o),{operation:"REAUTH"})),xo)})).apply(this,arguments)}class Cn extends oi{constructor(o){super("phone","phone"),this.params=o}static _fromVerification(o,a){return new Cn({verificationId:o,verificationCode:a})}static _fromTokenResponse(o,a){return new Cn({phoneNumber:o,temporaryProof:a})}_getIdTokenResponse(o){return function Fi(c,o){return dn.apply(this,arguments)}(o,this._makeVerificationRequest())}_linkToIdToken(o,a){return function bs(c,o){return As.apply(this,arguments)}(o,Object.assign({idToken:a},this._makeVerificationRequest()))}_getReauthenticationResolver(o){return function Ka(c,o){return Ss.apply(this,arguments)}(o,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:o,phoneNumber:a,verificationId:l,verificationCode:g}=this.params;return o&&a?{temporaryProof:o,phoneNumber:a}:{sessionInfo:l,code:g}}toJSON(){const o={providerId:this.providerId};return this.params.phoneNumber&&(o.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(o.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(o.verificationCode=this.params.verificationCode),this.params.verificationId&&(o.verificationId=this.params.verificationId),o}static fromJSON(o){"string"==typeof o&&(o=JSON.parse(o));const{verificationId:a,verificationCode:l,phoneNumber:g,temporaryProof:_}=o;return l||a||g||_?new Cn({verificationId:a,verificationCode:l,phoneNumber:g,temporaryProof:_}):null}}class Ur{constructor(o){var a,l,g,_,x,F;const Q=(0,C.zd)((0,C.pd)(o)),ue=null!==(a=Q.apiKey)&&void 0!==a?a:null,Ae=null!==(l=Q.oobCode)&&void 0!==l?l:null,ve=function za(c){switch(c){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(g=Q.mode)&&void 0!==g?g:null);N(ue&&Ae&&ve,"argument-error"),this.apiKey=ue,this.operation=ve,this.code=Ae,this.continueUrl=null!==(_=Q.continueUrl)&&void 0!==_?_:null,this.languageCode=null!==(x=Q.languageCode)&&void 0!==x?x:null,this.tenantId=null!==(F=Q.tenantId)&&void 0!==F?F:null}static parseLink(o){const a=function Ui(c){const o=(0,C.zd)((0,C.pd)(c)).link,a=o?(0,C.zd)((0,C.pd)(o)).deep_link_id:null,l=(0,C.zd)((0,C.pd)(c)).deep_link_id;return(l?(0,C.zd)((0,C.pd)(l)).link:null)||l||a||o||c}(o);try{return new Ur(a)}catch{return null}}}let Vr=(()=>{class c{constructor(){this.providerId=c.PROVIDER_ID}static credential(a,l){return xn._fromEmailAndPassword(a,l)}static credentialWithLink(a,l){const g=Ur.parseLink(l);return N(g,"argument-error"),xn._fromEmailAndCode(a,g.code,g.tenantId)}}return c.PROVIDER_ID="password",c.EMAIL_PASSWORD_SIGN_IN_METHOD="password",c.EMAIL_LINK_SIGN_IN_METHOD="emailLink",c})();class qn{constructor(o){this.providerId=o,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(o){this.defaultLanguageCode=o}setCustomParameters(o){return this.customParameters=o,this}getCustomParameters(){return this.customParameters}}class Br extends qn{constructor(){super(...arguments),this.scopes=[]}addScope(o){return this.scopes.includes(o)||this.scopes.push(o),this}getScopes(){return[...this.scopes]}}class yr extends Br{static credentialFromJSON(o){const a="string"==typeof o?JSON.parse(o):o;return N("providerId"in a&&"signInMethod"in a,"argument-error"),rn._fromParams(a)}credential(o){return this._credential(Object.assign(Object.assign({},o),{nonce:o.rawNonce}))}_credential(o){return N(o.idToken||o.accessToken,"argument-error"),rn._fromParams(Object.assign(Object.assign({},o),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(o){return yr.oauthCredentialFromTaggedObject(o)}static credentialFromError(o){return yr.oauthCredentialFromTaggedObject(o.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{oauthIdToken:a,oauthAccessToken:l,oauthTokenSecret:g,pendingToken:_,nonce:x,providerId:F}=o;if(!l&&!g&&!a&&!_||!F)return null;try{return new yr(F)._credential({idToken:a,accessToken:l,nonce:x,pendingToken:_})}catch{return null}}}let li=(()=>{class c extends Br{constructor(){super("facebook.com")}static credential(a){return rn._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.FACEBOOK_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return c.credential(a.oauthAccessToken)}catch{return null}}}return c.FACEBOOK_SIGN_IN_METHOD="facebook.com",c.PROVIDER_ID="facebook.com",c})(),xs=(()=>{class c extends Br{constructor(){super("google.com"),this.addScope("profile")}static credential(a,l){return rn._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.GOOGLE_SIGN_IN_METHOD,idToken:a,accessToken:l})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{oauthIdToken:l,oauthAccessToken:g}=a;if(!l&&!g)return null;try{return c.credential(l,g)}catch{return null}}}return c.GOOGLE_SIGN_IN_METHOD="google.com",c.PROVIDER_ID="google.com",c})(),Co=(()=>{class c extends Br{constructor(){super("github.com")}static credential(a){return rn._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.GITHUB_SIGN_IN_METHOD,accessToken:a})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a||!("oauthAccessToken"in a)||!a.oauthAccessToken)return null;try{return c.credential(a.oauthAccessToken)}catch{return null}}}return c.GITHUB_SIGN_IN_METHOD="github.com",c.PROVIDER_ID="github.com",c})();class hi extends oi{constructor(o,a){super(o,o),this.pendingToken=a}_getIdTokenResponse(o){return Gn(o,this.buildRequest())}_linkToIdToken(o,a){const l=this.buildRequest();return l.idToken=a,Gn(o,l)}_getReauthenticationResolver(o){const a=this.buildRequest();return a.autoCreate=!1,Gn(o,a)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(o){const a="string"==typeof o?JSON.parse(o):o,{providerId:l,signInMethod:g,pendingToken:_}=a;return l&&g&&_&&l===g?new hi(l,_):null}static _create(o,a){return new hi(o,a)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Vt extends qn{constructor(o){N(o.startsWith("saml."),"argument-error"),super(o)}static credentialFromResult(o){return Vt.samlCredentialFromTaggedObject(o)}static credentialFromError(o){return Vt.samlCredentialFromTaggedObject(o.customData||{})}static credentialFromJSON(o){const a=hi.fromJSON(o);return N(a,"argument-error"),a}static samlCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{pendingToken:a,providerId:l}=o;if(!a||!l)return null;try{return hi._create(l,a)}catch{return null}}}let ko=(()=>{class c extends Br{constructor(){super("twitter.com")}static credential(a,l){return rn._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.TWITTER_SIGN_IN_METHOD,oauthToken:a,oauthTokenSecret:l})}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{oauthAccessToken:l,oauthTokenSecret:g}=a;if(!l||!g)return null;try{return c.credential(l,g)}catch{return null}}}return c.TWITTER_SIGN_IN_METHOD="twitter.com",c.PROVIDER_ID="twitter.com",c})();function $r(c,o){return jr.apply(this,arguments)}function jr(){return(jr=(0,I.Z)(function*(c,o){return en(c,"POST","/v1/accounts:signUp",ct(c,o))})).apply(this,arguments)}class bt{constructor(o){this.user=o.user,this.providerId=o.providerId,this._tokenResponse=o._tokenResponse,this.operationType=o.operationType}static _fromIdTokenResponse(o,a,l,g=!1){return(0,I.Z)(function*(){const _=yield pe._fromIdTokenResponse(o,l,g),x=Cs(l);return new bt({user:_,providerId:x,_tokenResponse:l,operationType:a})})()}static _forOperation(o,a,l){return(0,I.Z)(function*(){yield o._updateTokensIfNecessary(l,!0);const g=Cs(l);return new bt({user:o,providerId:g,_tokenResponse:l,operationType:a})})()}}function Cs(c){return c.providerId?c.providerId:"phoneNumber"in c?"phone":null}function Bi(){return(Bi=(0,I.Z)(function*(c){var o;const a=Le(c);if(yield a._initializationPromise,null!==(o=a.currentUser)&&void 0!==o&&o.isAnonymous)return new bt({user:a.currentUser,providerId:null,operationType:"signIn"});const l=yield $r(a,{returnSecureToken:!0}),g=yield bt._fromIdTokenResponse(a,"signIn",l,!0);return yield a._updateCurrentUser(g.user),g})).apply(this,arguments)}class or extends C.ZR{constructor(o,a,l,g){var _;super(a.code,a.message),this.operationType=l,this.user=g,Object.setPrototypeOf(this,or.prototype),this.customData={appName:o.name,tenantId:null!==(_=o.tenantId)&&void 0!==_?_:void 0,_serverResponse:a.customData._serverResponse,operationType:l}}static _fromErrorAndOperation(o,a,l,g){return new or(o,a,l,g)}}function ks(c,o,a,l){return("reauthenticate"===o?a._getReauthenticationResolver(c):a._getIdTokenResponse(c)).catch(_=>{throw"auth/multi-factor-auth-required"===_.code?or._fromErrorAndOperation(c,_,o,l):_})}function sn(c){return new Set(c.map(({providerId:o})=>o).filter(o=>!!o))}function $i(){return($i=(0,I.Z)(function*(c,o){const a=(0,C.m9)(c);yield ar(!0,a,o);const{providerUserInfo:l}=yield Vn(a.auth,{idToken:yield a.getIdToken(),deleteProvider:[o]}),g=sn(l||[]);return a.providerData=a.providerData.filter(_=>g.has(_.providerId)),g.has("phone")||(a.phoneNumber=null),yield a.auth._persistUserIfCurrent(a),a})).apply(this,arguments)}function Kn(c,o){return fn.apply(this,arguments)}function fn(){return(fn=(0,I.Z)(function*(c,o,a=!1){const l=yield Ot(c,o._linkToIdToken(c.auth,yield c.getIdToken()),a);return bt._forOperation(c,"link",l)})).apply(this,arguments)}function ar(c,o,a){return _r.apply(this,arguments)}function _r(){return(_r=(0,I.Z)(function*(c,o,a){yield An(o);const g=!1===c?"provider-already-linked":"no-such-provider";N(sn(o.providerData).has(a)===c,o.auth,g)})).apply(this,arguments)}function ji(c,o){return fi.apply(this,arguments)}function fi(){return(fi=(0,I.Z)(function*(c,o,a=!1){var l;const{auth:g}=c,_="reauthenticate";try{const x=yield Ot(c,ks(g,_,o,c),a);N(x.idToken,g,"internal-error");const F=nn(x.idToken);N(F,g,"internal-error");const{sub:Q}=F;return N(c.uid===Q,g,"user-mismatch"),bt._forOperation(c,_,x)}catch(x){throw"auth/user-not-found"===(null===(l=x)||void 0===l?void 0:l.code)&&R(g,"user-mismatch"),x}})).apply(this,arguments)}function Ye(c,o){return pi.apply(this,arguments)}function pi(){return(pi=(0,I.Z)(function*(c,o,a=!1){const l="signIn",g=yield ks(c,l,o),_=yield bt._fromIdTokenResponse(c,l,g);return a||(yield c._updateCurrentUser(_.user)),_})).apply(this,arguments)}function It(c,o){return No.apply(this,arguments)}function No(){return(No=(0,I.Z)(function*(c,o){return Ye(Le(c),o)})).apply(this,arguments)}function vr(c,o){return Gr.apply(this,arguments)}function Gr(){return(Gr=(0,I.Z)(function*(c,o){const a=(0,C.m9)(c);return yield ar(!1,a,o.providerId),Kn(a,o)})).apply(this,arguments)}function Ns(c,o){return Gi.apply(this,arguments)}function Gi(){return(Gi=(0,I.Z)(function*(c,o){return ji((0,C.m9)(c),o)})).apply(this,arguments)}function Ro(c,o){return qi.apply(this,arguments)}function qi(){return(qi=(0,I.Z)(function*(c,o){return en(c,"POST","/v1/accounts:signInWithCustomToken",ct(c,o))})).apply(this,arguments)}function Ki(){return(Ki=(0,I.Z)(function*(c,o){const a=Le(c),l=yield Ro(a,{token:o,returnSecureToken:!0}),g=yield bt._fromIdTokenResponse(a,"signIn",l);return yield a._updateCurrentUser(g.user),g})).apply(this,arguments)}class ur{constructor(o,a){this.factorId=o,this.uid=a.mfaEnrollmentId,this.enrollmentTime=new Date(a.enrolledAt).toUTCString(),this.displayName=a.displayName}static _fromServerResponse(o,a){return"phoneInfo"in a?zn._fromServerResponse(o,a):R(o,"internal-error")}}class zn extends ur{constructor(o){super("phone",o),this.phoneNumber=o.phoneInfo}static _fromServerResponse(o,a){return new zn(a)}}function zi(c,o,a){var l;N((null===(l=a.url)||void 0===l?void 0:l.length)>0,c,"invalid-continue-uri"),N(typeof a.dynamicLinkDomain>"u"||a.dynamicLinkDomain.length>0,c,"invalid-dynamic-link-domain"),o.continueUrl=a.url,o.dynamicLinkDomain=a.dynamicLinkDomain,o.canHandleCodeInApp=a.handleCodeInApp,a.iOS&&(N(a.iOS.bundleId.length>0,c,"missing-ios-bundle-id"),o.iOSBundleId=a.iOS.bundleId),a.android&&(N(a.android.packageName.length>0,c,"missing-android-pkg-name"),o.androidInstallApp=a.android.installApp,o.androidMinimumVersionCode=a.android.minimumVersion,o.androidPackageName=a.android.packageName)}function Zi(){return(Zi=(0,I.Z)(function*(c,o,a){const l=(0,C.m9)(c),g={requestType:"PASSWORD_RESET",email:o};a&&zi(l,g,a),yield Fr(l,g)})).apply(this,arguments)}function Po(){return(Po=(0,I.Z)(function*(c,o,a){yield zt((0,C.m9)(c),{oobCode:o,newPassword:a})})).apply(this,arguments)}function Wi(){return(Wi=(0,I.Z)(function*(c,o){yield Es((0,C.m9)(c),{oobCode:o})})).apply(this,arguments)}function Os(c,o){return Ps.apply(this,arguments)}function Ps(){return(Ps=(0,I.Z)(function*(c,o){const a=(0,C.m9)(c),l=yield zt(a,{oobCode:o}),g=l.requestType;switch(N(g,a,"internal-error"),g){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":N(l.newEmail,a,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":N(l.mfaInfo,a,"internal-error");default:N(l.email,a,"internal-error")}let _=null;return l.mfaInfo&&(_=ur._fromServerResponse(Le(a),l.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===l.requestType?l.newEmail:l.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===l.requestType?l.email:l.newEmail)||null,multiFactorInfo:_},operation:g}})).apply(this,arguments)}function Hi(){return(Hi=(0,I.Z)(function*(c,o){const{data:a}=yield Os((0,C.m9)(c),o);return a.email})).apply(this,arguments)}function Fs(){return(Fs=(0,I.Z)(function*(c,o,a){const l=Le(c),g=yield $r(l,{returnSecureToken:!0,email:o,password:a}),_=yield bt._fromIdTokenResponse(l,"signIn",g);return yield l._updateCurrentUser(_.user),_})).apply(this,arguments)}function Fo(){return(Fo=(0,I.Z)(function*(c,o,a){const l=(0,C.m9)(c),g={requestType:"EMAIL_SIGNIN",email:o};N(a.handleCodeInApp,l,"argument-error"),a&&zi(l,g,a),yield Zu(l,g)})).apply(this,arguments)}function wr(){return(wr=(0,I.Z)(function*(c,o,a){const l=(0,C.m9)(c),g=Vr.credentialWithLink(o,a||vt());return N(g._tenantId===(l.tenantId||null),l,"tenant-id-mismatch"),It(l,g)})).apply(this,arguments)}function Qi(c,o){return qr.apply(this,arguments)}function qr(){return(qr=(0,I.Z)(function*(c,o){return lt(c,"POST","/v1/accounts:createAuthUri",ct(c,o))})).apply(this,arguments)}function Us(){return(Us=(0,I.Z)(function*(c,o){const l={identifier:o,continueUri:Rt()?vt():"http://localhost"},{signinMethods:g}=yield Qi((0,C.m9)(c),l);return g||[]})).apply(this,arguments)}function zr(){return(zr=(0,I.Z)(function*(c,o){const a=(0,C.m9)(c),g={requestType:"VERIFY_EMAIL",idToken:yield c.getIdToken()};o&&zi(a.auth,g,o);const{email:_}=yield ja(a.auth,g);_!==c.email&&(yield c.reload())})).apply(this,arguments)}function dt(){return(dt=(0,I.Z)(function*(c,o,a){const l=(0,C.m9)(c),_={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield c.getIdToken(),newEmail:o};a&&zi(l.auth,_,a);const{email:x}=yield Ao(l.auth,_);x!==c.email&&(yield c.reload())})).apply(this,arguments)}function Vs(c,o){return Vo.apply(this,arguments)}function Vo(){return(Vo=(0,I.Z)(function*(c,o){return lt(c,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function $o(){return($o=(0,I.Z)(function*(c,{displayName:o,photoURL:a}){if(void 0===o&&void 0===a)return;const l=(0,C.m9)(c),_={idToken:yield l.getIdToken(),displayName:o,photoUrl:a,returnSecureToken:!0},x=yield Ot(l,Vs(l.auth,_));l.displayName=x.displayName||null,l.photoURL=x.photoUrl||null;const F=l.providerData.find(({providerId:Q})=>"password"===Q);F&&(F.displayName=l.displayName,F.photoURL=l.photoURL),yield l._updateTokensIfNecessary(x)})).apply(this,arguments)}function $s(c,o,a){return Ji.apply(this,arguments)}function Ji(){return(Ji=(0,I.Z)(function*(c,o,a){const{auth:l}=c,_={idToken:yield c.getIdToken(),returnSecureToken:!0};o&&(_.email=o),a&&(_.password=a);const x=yield Ot(c,ws(l,_));yield c._updateTokensIfNecessary(x,!0)})).apply(this,arguments)}class Zr{constructor(o,a,l={}){this.isNewUser=o,this.providerId=a,this.profile=l}}class Zn extends Zr{constructor(o,a,l,g){super(o,a,l),this.username=g}}class jo extends Zr{constructor(o,a){super(o,"facebook.com",a)}}class Go extends Zn{constructor(o,a){super(o,"github.com",a,"string"==typeof a?.login?a?.login:null)}}class qo extends Zr{constructor(o,a){super(o,"google.com",a)}}class Wr extends Zn{constructor(o,a,l){super(o,"twitter.com",a,l)}}function Qa(c){const{user:o,_tokenResponse:a}=c;return o.isAnonymous&&!a?{providerId:null,isNewUser:!1,profile:null}:function js(c){var o,a;if(!c)return null;const{providerId:l}=c,g=c.rawUserInfo?JSON.parse(c.rawUserInfo):{},_=c.isNewUser||"identitytoolkit#SignupNewUserResponse"===c.kind;if(!l&&c?.idToken){const x=null===(a=null===(o=nn(c.idToken))||void 0===o?void 0:o.firebase)||void 0===a?void 0:a.sign_in_provider;if(x)return new Zr(_,"anonymous"!==x&&"custom"!==x?x:null)}if(!l)return null;switch(l){case"facebook.com":return new jo(_,g);case"github.com":return new Go(_,g);case"google.com":return new qo(_,g);case"twitter.com":return new Wr(_,g,c.screenName||null);case"custom":case"anonymous":return new Zr(_,null);default:return new Zr(_,l,g)}}(a)}class Er{constructor(o,a){this.type=o,this.credential=a}static _fromIdtoken(o){return new Er("enroll",o)}static _fromMfaPendingCredential(o){return new Er("signin",o)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(o){var a,l;if(o?.multiFactorSession){if(null!==(a=o.multiFactorSession)&&void 0!==a&&a.pendingCredential)return Er._fromMfaPendingCredential(o.multiFactorSession.pendingCredential);if(null!==(l=o.multiFactorSession)&&void 0!==l&&l.idToken)return Er._fromIdtoken(o.multiFactorSession.idToken)}return null}}class gi{constructor(o,a,l){this.session=o,this.hints=a,this.signInResolver=l}static _fromError(o,a){const l=Le(o),g=a.customData._serverResponse,_=(g.mfaInfo||[]).map(F=>ur._fromServerResponse(l,F));N(g.mfaPendingCredential,l,"internal-error");const x=Er._fromMfaPendingCredential(g.mfaPendingCredential);return new gi(x,_,function(){var F=(0,I.Z)(function*(Q){const ue=yield Q._process(l,x);delete g.mfaInfo,delete g.mfaPendingCredential;const Ae=Object.assign(Object.assign({},g),{idToken:ue.idToken,refreshToken:ue.refreshToken});switch(a.operationType){case"signIn":const ve=yield bt._fromIdTokenResponse(l,a.operationType,Ae);return yield l._updateCurrentUser(ve.user),ve;case"reauthenticate":return N(a.user,l,"internal-error"),bt._forOperation(a.user,a.operationType,Ae);default:R(l,"internal-error")}});return function(Q){return F.apply(this,arguments)}}())}resolveSignIn(o){var a=this;return(0,I.Z)(function*(){return a.signInResolver(o)})()}}function Zo(c,o){return lt(c,"POST","/v2/accounts/mfaEnrollment:start",ct(c,o))}class zs{constructor(o){this.user=o,this.enrolledFactors=[],o._onReload(a=>{a.mfaInfo&&(this.enrolledFactors=a.mfaInfo.map(l=>ur._fromServerResponse(o.auth,l)))})}static _fromUser(o){return new zs(o)}getSession(){var o=this;return(0,I.Z)(function*(){return Er._fromIdtoken(yield o.user.getIdToken())})()}enroll(o,a){var l=this;return(0,I.Z)(function*(){const g=o,_=yield l.getSession(),x=yield Ot(l.user,g._process(l.user.auth,_,a));return yield l.user._updateTokensIfNecessary(x),l.user.reload()})()}unenroll(o){var a=this;return(0,I.Z)(function*(){var l;const g="string"==typeof o?o:o.uid,_=yield a.user.getIdToken(),x=yield Ot(a.user,function Xa(c,o){return lt(c,"POST","/v2/accounts/mfaEnrollment:withdraw",ct(c,o))}(a.user.auth,{idToken:_,mfaEnrollmentId:g}));a.enrolledFactors=a.enrolledFactors.filter(({uid:F})=>F!==g),yield a.user._updateTokensIfNecessary(x);try{yield a.user.reload()}catch(F){if("auth/user-token-expired"!==(null===(l=F)||void 0===l?void 0:l.code))throw F}})()}}const kn=new WeakMap,Hr="__sak";class Wo{constructor(o,a){this.storageRetriever=o,this.type=a}_isAvailable(){try{return this.storage?(this.storage.setItem(Hr,"1"),this.storage.removeItem(Hr),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(o,a){return this.storage.setItem(o,JSON.stringify(a)),Promise.resolve()}_get(o){const a=this.storage.getItem(o);return Promise.resolve(a?JSON.parse(a):null)}_remove(o){return this.storage.removeItem(o),Promise.resolve()}get storage(){return this.storageRetriever()}}const Xi=(()=>{class c extends Wo{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(a,l)=>this.onStorageEvent(a,l),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function tu(){const c=(0,C.z$)();return Mr(c)||ri(c)}()&&function zu(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Va(),this._shouldAllowMigration=!0}forAllChangedKeys(a){for(const l of Object.keys(this.listeners)){const g=this.storage.getItem(l),_=this.localCache[l];g!==_&&a(l,_,g)}}onStorageEvent(a,l=!1){if(!a.key)return void this.forAllChangedKeys((F,Q,ue)=>{this.notifyListeners(F,ue)});const g=a.key;if(l?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const F=this.storage.getItem(g);if(a.newValue!==F)null!==a.newValue?this.storage.setItem(g,a.newValue):this.storage.removeItem(g);else if(this.localCache[g]===a.newValue&&!l)return}const _=()=>{const F=this.storage.getItem(g);!l&&this.localCache[g]===F||this.notifyListeners(g,F)},x=this.storage.getItem(g);!function Ua(){return(0,C.w1)()&&10===document.documentMode}()||x===a.newValue||a.newValue===a.oldValue?_():setTimeout(_,10)}notifyListeners(a,l){this.localCache[a]=l;const g=this.listeners[a];if(g)for(const _ of Array.from(g))_(l&&JSON.parse(l))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((a,l,g)=>{this.onStorageEvent(new StorageEvent("storage",{key:a,oldValue:l,newValue:g}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(a,l){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[a]||(this.listeners[a]=new Set,this.localCache[a]=this.storage.getItem(a)),this.listeners[a].add(l)}_removeListener(a,l){this.listeners[a]&&(this.listeners[a].delete(l),0===this.listeners[a].size&&delete this.listeners[a]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(a,l){var g=()=>super._set,_=this;return(0,I.Z)(function*(){yield g().call(_,a,l),_.localCache[a]=JSON.stringify(l)})()}_get(a){var l=()=>super._get,g=this;return(0,I.Z)(function*(){const _=yield l().call(g,a);return g.localCache[a]=JSON.stringify(_),_})()}_remove(a){var l=()=>super._remove,g=this;return(0,I.Z)(function*(){yield l().call(g,a),delete g.localCache[a]})()}}return c.type="LOCAL",c})(),Tr=(()=>{class c extends Wo{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(a,l){}_removeListener(a,l){}}return c.type="SESSION",c})();let Ho=(()=>{class c{constructor(a){this.eventTarget=a,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(a){const l=this.receivers.find(_=>_.isListeningto(a));if(l)return l;const g=new c(a);return this.receivers.push(g),g}isListeningto(a){return this.eventTarget===a}handleEvent(a){var l=this;return(0,I.Z)(function*(){const g=a,{eventId:_,eventType:x,data:F}=g.data,Q=l.handlersMap[x];if(!Q?.size)return;g.ports[0].postMessage({status:"ack",eventId:_,eventType:x});const ue=Array.from(Q).map(function(){var ve=(0,I.Z)(function*(yt){return yt(g.origin,F)});return function(yt){return ve.apply(this,arguments)}}()),Ae=yield function nu(c){return Promise.all(c.map(function(){var o=(0,I.Z)(function*(a){try{return{fulfilled:!0,value:yield a}}catch(l){return{fulfilled:!1,reason:l}}});return function(a){return o.apply(this,arguments)}}()))}(ue);g.ports[0].postMessage({status:"done",eventId:_,eventType:x,response:Ae})})()}_subscribe(a,l){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[a]||(this.handlersMap[a]=new Set),this.handlersMap[a].add(l)}_unsubscribe(a,l){this.handlersMap[a]&&l&&this.handlersMap[a].delete(l),(!l||0===this.handlersMap[a].size)&&delete this.handlersMap[a],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return c.receivers=[],c})();function ts(c="",o=10){let a="";for(let l=0;l<o;l++)a+=Math.floor(10*Math.random());return c+a}class Qo{constructor(o){this.target=o,this.handlers=new Set}removeMessageHandler(o){o.messageChannel&&(o.messageChannel.port1.removeEventListener("message",o.onMessage),o.messageChannel.port1.close()),this.handlers.delete(o)}_send(o,a,l=50){var g=this;return(0,I.Z)(function*(){const _=typeof MessageChannel<"u"?new MessageChannel:null;if(!_)throw new Error("connection_unavailable");let x,F;return new Promise((Q,ue)=>{const Ae=ts("",20);_.port1.start();const ve=setTimeout(()=>{ue(new Error("unsupported_event"))},l);F={messageChannel:_,onMessage(yt){const Pn=yt;if(Pn.data.eventId===Ae)switch(Pn.data.status){case"ack":clearTimeout(ve),x=setTimeout(()=>{ue(new Error("timeout"))},3e3);break;case"done":clearTimeout(x),Q(Pn.data.response);break;default:clearTimeout(ve),clearTimeout(x),ue(new Error("invalid_response"))}}},g.handlers.add(F),_.port1.addEventListener("message",F.onMessage),g.target.postMessage({eventType:o,eventId:Ae,data:a},[_.port2])}).finally(()=>{F&&g.removeMessageHandler(F)})})()}}function wt(){return window}function Qr(){return typeof wt().WorkerGlobalScope<"u"&&"function"==typeof wt().importScripts}function Ws(){return(Ws=(0,I.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Dn="firebaseLocalStorageDb",yi="firebaseLocalStorage",W="fbase_key";class Je{constructor(o){this.request=o}toPromise(){return new Promise((o,a)=>{this.request.addEventListener("success",()=>{o(this.request.result)}),this.request.addEventListener("error",()=>{a(this.request.error)})})}}function Wn(c,o){return c.transaction([yi],o?"readwrite":"readonly").objectStore(yi)}function ae(){const c=indexedDB.open(Dn,1);return new Promise((o,a)=>{c.addEventListener("error",()=>{a(c.error)}),c.addEventListener("upgradeneeded",()=>{const l=c.result;try{l.createObjectStore(yi,{keyPath:W})}catch(g){a(g)}}),c.addEventListener("success",(0,I.Z)(function*(){const l=c.result;l.objectStoreNames.contains(yi)?o(l):(l.close(),yield function ns(){const c=indexedDB.deleteDatabase(Dn);return new Je(c).toPromise()}(),o(yield ae()))}))})}function Ie(c,o,a){return ea.apply(this,arguments)}function ea(){return(ea=(0,I.Z)(function*(c,o,a){const l=Wn(c,!0).put({[W]:o,value:a});return new Je(l).toPromise()})).apply(this,arguments)}function L(){return(L=(0,I.Z)(function*(c,o){const a=Wn(c,!1).get(o),l=yield new Je(a).toPromise();return void 0===l?null:l.value})).apply(this,arguments)}function K(c,o){const a=Wn(c,!0).delete(o);return new Je(a).toPromise()}const _i=(()=>{class c{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var a=this;return(0,I.Z)(function*(){return a.db||(a.db=yield ae()),a.db})()}_withRetries(a){var l=this;return(0,I.Z)(function*(){let g=0;for(;;)try{const _=yield l._openDb();return yield a(_)}catch(_){if(g++>3)throw _;l.db&&(l.db.close(),l.db=void 0)}})()}initializeServiceWorkerMessaging(){var a=this;return(0,I.Z)(function*(){return Qr()?a.initializeReceiver():a.initializeSender()})()}initializeReceiver(){var a=this;return(0,I.Z)(function*(){a.receiver=Ho._getInstance(function mi(){return Qr()?self:null}()),a.receiver._subscribe("keyChanged",function(){var l=(0,I.Z)(function*(g,_){return{keyProcessed:(yield a._poll()).includes(_.key)}});return function(g,_){return l.apply(this,arguments)}}()),a.receiver._subscribe("ping",function(){var l=(0,I.Z)(function*(g,_){return["keyChanged"]});return function(g,_){return l.apply(this,arguments)}}())})()}initializeSender(){var a=this;return(0,I.Z)(function*(){var l,g;if(a.activeServiceWorker=yield function Jo(){return Ws.apply(this,arguments)}(),!a.activeServiceWorker)return;a.sender=new Qo(a.activeServiceWorker);const _=yield a.sender._send("ping",{},800);!_||(null===(l=_[0])||void 0===l?void 0:l.fulfilled)&&(null===(g=_[0])||void 0===g?void 0:g.value.includes("keyChanged"))&&(a.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(a){var l=this;return(0,I.Z)(function*(){if(l.sender&&l.activeServiceWorker&&function Ct(){var c;return(null===(c=navigator?.serviceWorker)||void 0===c?void 0:c.controller)||null}()===l.activeServiceWorker)try{yield l.sender._send("keyChanged",{key:a},l.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,I.Z)(function*(){try{if(!indexedDB)return!1;const a=yield ae();return yield Ie(a,Hr,"1"),yield K(a,Hr),!0}catch{}return!1})()}_withPendingWrite(a){var l=this;return(0,I.Z)(function*(){l.pendingWrites++;try{yield a()}finally{l.pendingWrites--}})()}_set(a,l){var g=this;return(0,I.Z)(function*(){return g._withPendingWrite((0,I.Z)(function*(){return yield g._withRetries(_=>Ie(_,a,l)),g.localCache[a]=l,g.notifyServiceWorker(a)}))})()}_get(a){var l=this;return(0,I.Z)(function*(){const g=yield l._withRetries(_=>function te(c,o){return L.apply(this,arguments)}(_,a));return l.localCache[a]=g,g})()}_remove(a){var l=this;return(0,I.Z)(function*(){return l._withPendingWrite((0,I.Z)(function*(){return yield l._withRetries(g=>K(g,a)),delete l.localCache[a],l.notifyServiceWorker(a)}))})()}_poll(){var a=this;return(0,I.Z)(function*(){const l=yield a._withRetries(x=>{const F=Wn(x,!1).getAll();return new Je(F).toPromise()});if(!l)return[];if(0!==a.pendingWrites)return[];const g=[],_=new Set;for(const{fbase_key:x,value:F}of l)_.add(x),JSON.stringify(a.localCache[x])!==JSON.stringify(F)&&(a.notifyListeners(x,F),g.push(x));for(const x of Object.keys(a.localCache))a.localCache[x]&&!_.has(x)&&(a.notifyListeners(x,null),g.push(x));return g})()}notifyListeners(a,l){this.localCache[a]=l;const g=this.listeners[a];if(g)for(const _ of Array.from(g))_(l)}startPolling(){var a=this;this.stopPolling(),this.pollTimer=setInterval((0,I.Z)(function*(){return a._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(a,l){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[a]||(this.listeners[a]=new Set,this._get(a)),this.listeners[a].add(l)}_removeListener(a,l){this.listeners[a]&&(this.listeners[a].delete(l),0===this.listeners[a].size&&delete this.listeners[a]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return c.type="LOCAL",c})();function ta(c,o){return lt(c,"POST","/v2/accounts/mfaSignIn:start",ct(c,o))}function rs(){return(rs=(0,I.Z)(function*(c){return(yield lt(c,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Hs(c){return new Promise((o,a)=>{const l=document.createElement("script");l.setAttribute("src",c),l.onload=o,l.onerror=g=>{const _=De("internal-error");_.customData=g,a(_)},l.type="text/javascript",l.charset="UTF-8",function su(){var c,o;return null!==(o=null===(c=document.getElementsByTagName("head"))||void 0===c?void 0:c[0])&&void 0!==o?o:document}().appendChild(l)})}function na(c){return`__${c}${Math.floor(1e6*Math.random())}`}const Nn=1e12;class tc{constructor(o){this.auth=o,this.counter=Nn,this._widgets=new Map}render(o,a){const l=this.counter;return this._widgets.set(l,new st(o,this.auth.name,a||{})),this.counter++,l}reset(o){var a;const l=o||Nn;null===(a=this._widgets.get(l))||void 0===a||a.delete(),this._widgets.delete(l)}getResponse(o){var a;return(null===(a=this._widgets.get(o||Nn))||void 0===a?void 0:a.getResponse())||""}execute(o){var a=this;return(0,I.Z)(function*(){var l;return null===(l=a._widgets.get(o||Nn))||void 0===l||l.execute(),""})()}}class st{constructor(o,a,l){this.params=l,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const g="string"==typeof o?document.getElementById(o):o;N(g,"argument-error",{appName:a}),this.container=g,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function be(c){const o=[],a="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let l=0;l<c;l++)o.push(a.charAt(Math.floor(Math.random()*a.length)));return o.join("")}(50);const{callback:o,"expired-callback":a}=this.params;if(o)try{o(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,a)try{a()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const vi=na("rcb"),Ue=new Gt(3e4,6e4);class ot{constructor(){var o;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(o=wt().grecaptcha)||void 0===o||!o.render)}load(o,a=""){return N(function ne(c){return c.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(c)}(a),o,"argument-error"),this.shouldResolveImmediately(a)?Promise.resolve(wt().grecaptcha):new Promise((l,g)=>{const _=wt().setTimeout(()=>{g(De(o,"network-request-failed"))},Ue.get());wt()[vi]=()=>{wt().clearTimeout(_),delete wt()[vi];const F=wt().grecaptcha;if(!F)return void g(De(o,"internal-error"));const Q=F.render;F.render=(ue,Ae)=>{const ve=Q(ue,Ae);return this.counter++,ve},this.hostLanguage=a,l(F)},Hs(`https://www.google.com/recaptcha/api.js??${(0,C.xO)({onload:vi,render:"explicit",hl:a})}`).catch(()=>{clearTimeout(_),g(De(o,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(o){var a;return!(null===(a=wt().grecaptcha)||void 0===a||!a.render)&&(o===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class ia{load(o){return(0,I.Z)(function*(){return new tc(o)})()}clearedOneInstance(){}}const sa="recaptcha",Ii={theme:"light",type:"image"};class jc{constructor(o,a=Object.assign({},Ii),l){this.parameters=a,this.type=sa,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Le(l),this.isInvisible="invisible"===this.parameters.size,N(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const g="string"==typeof o?document.getElementById(o):o;N(g,this.auth,"argument-error"),this.container=g,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ia:new ot,this.validateStartingState()}verify(){var o=this;return(0,I.Z)(function*(){o.assertNotDestroyed();const a=yield o.render(),l=o.getAssertedRecaptcha();return l.getResponse(a)||new Promise(_=>{const x=F=>{!F||(o.tokenChangeListeners.delete(x),_(F))};o.tokenChangeListeners.add(x),o.isInvisible&&l.execute(a)})})()}render(){try{this.assertNotDestroyed()}catch(o){return Promise.reject(o)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(o=>{throw this.renderPromise=null,o})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(o=>{this.container.removeChild(o)})}validateStartingState(){N(!this.parameters.sitekey,this.auth,"argument-error"),N(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),N(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(o){return a=>{if(this.tokenChangeListeners.forEach(l=>l(a)),"function"==typeof o)o(a);else if("string"==typeof o){const l=wt()[o];"function"==typeof l&&l(a)}}}assertNotDestroyed(){N(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var o=this;return(0,I.Z)(function*(){if(yield o.init(),!o.widgetId){let a=o.container;if(!o.isInvisible){const l=document.createElement("div");a.appendChild(l),a=l}o.widgetId=o.getAssertedRecaptcha().render(a,o.parameters)}return o.widgetId})()}init(){var o=this;return(0,I.Z)(function*(){N(Rt()&&!Qr(),o.auth,"internal-error"),yield function Qs(){let c=null;return new Promise(o=>{"complete"!==document.readyState?(c=()=>o(),window.addEventListener("load",c)):o()}).catch(o=>{throw c&&window.removeEventListener("load",c),o})}(),o.recaptcha=yield o._recaptchaLoader.load(o.auth,o.auth.languageCode||void 0);const a=yield function cr(c){return rs.apply(this,arguments)}(o.auth);N(a,o.auth,"internal-error"),o.parameters.sitekey=a})()}getAssertedRecaptcha(){return N(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class ou{constructor(o,a){this.verificationId=o,this.onConfirmation=a}confirm(o){const a=Cn._fromVerification(this.verificationId,o);return this.onConfirmation(a)}}function is(){return(is=(0,I.Z)(function*(c,o,a){const l=Le(c),g=yield ss(l,o,(0,C.m9)(a));return new ou(g,_=>It(l,_))})).apply(this,arguments)}function Zt(){return(Zt=(0,I.Z)(function*(c,o,a){const l=(0,C.m9)(c);yield ar(!1,l,"phone");const g=yield ss(l.auth,o,(0,C.m9)(a));return new ou(g,_=>vr(l,_))})).apply(this,arguments)}function Ys(){return(Ys=(0,I.Z)(function*(c,o,a){const l=(0,C.m9)(c),g=yield ss(l.auth,o,(0,C.m9)(a));return new ou(g,_=>Ns(l,_))})).apply(this,arguments)}function ss(c,o,a){return Hn.apply(this,arguments)}function Hn(){return(Hn=(0,I.Z)(function*(c,o,a){var l;const g=yield a.verify();try{let _;if(N("string"==typeof g,c,"argument-error"),N(a.type===sa,c,"argument-error"),_="string"==typeof o?{phoneNumber:o}:o,"session"in _){const x=_.session;if("phoneNumber"in _)return N("enroll"===x.type,c,"internal-error"),(yield Zo(c,{idToken:x.credential,phoneEnrollmentInfo:{phoneNumber:_.phoneNumber,recaptchaToken:g}})).phoneSessionInfo.sessionInfo;{N("signin"===x.type,c,"internal-error");const F=(null===(l=_.multiFactorHint)||void 0===l?void 0:l.uid)||_.multiFactorUid;return N(F,c,"missing-multi-factor-info"),(yield ta(c,{mfaPendingCredential:x.credential,mfaEnrollmentId:F,phoneSignInInfo:{recaptchaToken:g}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:x}=yield qa(c,{phoneNumber:_.phoneNumber,recaptchaToken:g});return x}}finally{a._reset()}})).apply(this,arguments)}function P(){return(P=(0,I.Z)(function*(c,o){yield Kn((0,C.m9)(c),o)})).apply(this,arguments)}let br=(()=>{class c{constructor(a){this.providerId=c.PROVIDER_ID,this.auth=Le(a)}verifyPhoneNumber(a,l){return ss(this.auth,a,(0,C.m9)(l))}static credential(a,l){return Cn._fromVerification(a,l)}static credentialFromResult(a){return c.credentialFromTaggedObject(a)}static credentialFromError(a){return c.credentialFromTaggedObject(a.customData||{})}static credentialFromTaggedObject({_tokenResponse:a}){if(!a)return null;const{phoneNumber:l,temporaryProof:g}=a;return l&&g?Cn._fromTokenResponse(l,g):null}}return c.PROVIDER_ID="phone",c.PHONE_SIGN_IN_METHOD="phone",c})();function Mt(c,o){return o?ee(o):(N(c._popupRedirectResolver,c,"argument-error"),c._popupRedirectResolver)}class aa extends oi{constructor(o){super("custom","custom"),this.params=o}_getIdTokenResponse(o){return Gn(o,this._buildIdpRequest())}_linkToIdToken(o,a){return Gn(o,this._buildIdpRequest(a))}_getReauthenticationResolver(o){return Gn(o,this._buildIdpRequest())}_buildIdpRequest(o){const a={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return o&&(a.idToken=o),a}}function os(c){return Ye(c.auth,new aa(c),c.bypassAuthState)}function Qn(c){const{auth:o,user:a}=c;return N(a,o,"internal-error"),ji(a,new aa(c),c.bypassAuthState)}function ua(c){return Rn.apply(this,arguments)}function Rn(){return(Rn=(0,I.Z)(function*(c){const{auth:o,user:a}=c;return N(a,o,"internal-error"),Kn(a,new aa(c),c.bypassAuthState)})).apply(this,arguments)}class as{constructor(o,a,l,g,_=!1){this.auth=o,this.resolver=l,this.user=g,this.bypassAuthState=_,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(a)?a:[a]}execute(){var o=this;return new Promise(function(){var a=(0,I.Z)(function*(l,g){o.pendingPromise={resolve:l,reject:g};try{o.eventManager=yield o.resolver._initialize(o.auth),yield o.onExecution(),o.eventManager.registerConsumer(o)}catch(_){o.reject(_)}});return function(l,g){return a.apply(this,arguments)}}())}onAuthEvent(o){var a=this;return(0,I.Z)(function*(){const{urlResponse:l,sessionId:g,postBody:_,tenantId:x,error:F,type:Q}=o;if(F)return void a.reject(F);const ue={auth:a.auth,requestUri:l,sessionId:g,tenantId:x||void 0,postBody:_||void 0,user:a.user,bypassAuthState:a.bypassAuthState};try{a.resolve(yield a.getIdpTask(Q)(ue))}catch(Ae){a.reject(Ae)}})()}onError(o){this.reject(o)}getIdpTask(o){switch(o){case"signInViaPopup":case"signInViaRedirect":return os;case"linkViaPopup":case"linkViaRedirect":return ua;case"reauthViaPopup":case"reauthViaRedirect":return Qn;default:R(this.auth,"internal-error")}}resolve(o){V(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(o),this.unregisterAndCleanUp()}reject(o){V(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(o),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const us=new Gt(2e3,1e4);function cs(){return(cs=(0,I.Z)(function*(c,o,a){const l=Le(c);Pe(c,o,qn);const g=Mt(l,a);return new at(l,"signInViaPopup",o,g).executeNotNull()})).apply(this,arguments)}function la(){return(la=(0,I.Z)(function*(c,o,a){const l=(0,C.m9)(c);Pe(l.auth,o,qn);const g=Mt(l.auth,a);return new at(l.auth,"reauthViaPopup",o,g,l).executeNotNull()})).apply(this,arguments)}function Js(){return(Js=(0,I.Z)(function*(c,o,a){const l=(0,C.m9)(c);Pe(l.auth,o,qn);const g=Mt(l.auth,a);return new at(l.auth,"linkViaPopup",o,g,l).executeNotNull()})).apply(this,arguments)}let at=(()=>{class c extends as{constructor(a,l,g,_,x){super(a,l,_,x),this.provider=g,this.authWindow=null,this.pollId=null,c.currentPopupAction&&c.currentPopupAction.cancel(),c.currentPopupAction=this}executeNotNull(){var a=this;return(0,I.Z)(function*(){const l=yield a.execute();return N(l,a.auth,"internal-error"),l})()}onExecution(){var a=this;return(0,I.Z)(function*(){V(1===a.filter.length,"Popup operations only handle one event");const l=ts();a.authWindow=yield a.resolver._openPopup(a.auth,a.provider,a.filter[0],l),a.authWindow.associatedEvent=l,a.resolver._originValidation(a.auth).catch(g=>{a.reject(g)}),a.resolver._isIframeWebStorageSupported(a.auth,g=>{g||a.reject(De(a.auth,"web-storage-unsupported"))}),a.pollUserCancellation()})()}get eventId(){var a;return(null===(a=this.authWindow)||void 0===a?void 0:a.associatedEvent)||null}cancel(){this.reject(De(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,c.currentPopupAction=null}pollUserCancellation(){const a=()=>{var l,g;this.pollId=null!==(g=null===(l=this.authWindow)||void 0===l?void 0:l.window)&&void 0!==g&&g.closed?window.setTimeout(()=>{this.pollId=null,this.reject(De(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(a,us.get())};a()}}return c.currentPopupAction=null,c})();const pt=new Map;class We extends as{constructor(o,a,l=!1){super(o,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],a,void 0,l),this.eventId=null}execute(){var o=()=>super.execute,a=this;return(0,I.Z)(function*(){let l=pt.get(a.auth._key());if(!l){try{const _=(yield function cu(c,o){return on.apply(this,arguments)}(a.resolver,a.auth))?yield o().call(a):null;l=()=>Promise.resolve(_)}catch(g){l=()=>Promise.reject(g)}pt.set(a.auth._key(),l)}return a.bypassAuthState||pt.set(a.auth._key(),()=>Promise.resolve(null)),l()})()}onAuthEvent(o){var a=()=>super.onAuthEvent,l=this;return(0,I.Z)(function*(){if("signInViaRedirect"===o.type)return a().call(l,o);if("unknown"!==o.type){if(o.eventId){const g=yield l.auth._redirectUserForId(o.eventId);if(g)return l.user=g,a().call(l,o);l.resolve(null)}}else l.resolve(null)})()}onExecution(){return(0,I.Z)(function*(){})()}cleanUp(){}}function on(){return(on=(0,I.Z)(function*(c,o){const a=ft(o),l=Yn(c);if(!(yield l._isAvailable()))return!1;const g="true"===(yield l._get(a));return yield l._remove(a),g})).apply(this,arguments)}function Wt(c,o){return hr.apply(this,arguments)}function hr(){return(hr=(0,I.Z)(function*(c,o){return Yn(c)._set(ft(o),"true")})).apply(this,arguments)}function lu(c,o){pt.set(c._key(),o)}function Yn(c){return ee(c._redirectPersistence)}function ft(c){return Ut("pendingRedirect",c.config.apiKey,c.name)}function d(){return(d=(0,I.Z)(function*(c,o,a){const l=Le(c);Pe(c,o,qn);const g=Mt(l,a);return yield Wt(g,l),g._openRedirect(l,o,"signInViaRedirect")})).apply(this,arguments)}function w(){return(w=(0,I.Z)(function*(c,o,a){const l=(0,C.m9)(c);Pe(l.auth,o,qn);const g=Mt(l.auth,a);yield Wt(g,l.auth);const _=yield me(l);return g._openRedirect(l.auth,o,"reauthViaRedirect",_)})).apply(this,arguments)}function q(){return(q=(0,I.Z)(function*(c,o,a){const l=(0,C.m9)(c);Pe(l.auth,o,qn);const g=Mt(l.auth,a);yield ar(!1,l,o.providerId),yield Wt(g,l.auth);const _=yield me(l);return g._openRedirect(l.auth,o,"linkViaRedirect",_)})).apply(this,arguments)}function ge(){return(ge=(0,I.Z)(function*(c,o){return yield Le(c)._initializationPromise,we(c,o,!1)})).apply(this,arguments)}function we(c,o){return Te.apply(this,arguments)}function Te(){return(Te=(0,I.Z)(function*(c,o,a=!1){const l=Le(c),g=Mt(l,o),x=yield new We(l,g,a).execute();return x&&!a&&(delete x.user._redirectEventId,yield l._persistUserIfCurrent(x.user),yield l._setRedirectUser(null,o)),x})).apply(this,arguments)}function me(c){return rt.apply(this,arguments)}function rt(){return(rt=(0,I.Z)(function*(c){const o=ts(`${c.uid}:::`);return c._redirectEventId=o,yield c.auth._setRedirectUser(c),yield c.auth._persistUserIfCurrent(c),o})).apply(this,arguments)}class Jn{constructor(o){this.auth=o,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(o){this.consumers.add(o),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,o)&&(this.sendToConsumer(this.queuedRedirectEvent,o),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(o){this.consumers.delete(o)}onEvent(o){if(this.hasEventBeenHandled(o))return!1;let a=!1;return this.consumers.forEach(l=>{this.isEventForConsumer(o,l)&&(a=!0,this.sendToConsumer(o,l),this.saveEventToCache(o))}),this.hasHandledPotentialRedirect||!function ha(c){switch(c.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yn(c);default:return!1}}(o)||(this.hasHandledPotentialRedirect=!0,a||(this.queuedRedirectEvent=o,a=!0)),a}sendToConsumer(o,a){var l;if(o.error&&!yn(o)){const g=(null===(l=o.error.code)||void 0===l?void 0:l.split("auth/")[1])||"internal-error";a.onError(De(this.auth,g))}else a.onAuthEvent(o)}isEventForConsumer(o,a){const l=null===a.eventId||!!o.eventId&&o.eventId===a.eventId;return a.filter.includes(o.type)&&l}hasEventBeenHandled(o){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ar(o))}saveEventToCache(o){this.cachedEventUids.add(Ar(o)),this.lastProcessedEventTime=Date.now()}}function Ar(c){return[c.type,c.eventId,c.sessionId,c.tenantId].filter(o=>o).join("-")}function yn({type:c,error:o}){return"unknown"===c&&"auth/no-auth-event"===o?.code}function Sr(c){return xr.apply(this,arguments)}function xr(){return(xr=(0,I.Z)(function*(c,o={}){return lt(c,"GET","/v1/projects",o)})).apply(this,arguments)}const Cr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dr=/^https?/;function du(){return(du=(0,I.Z)(function*(c){if(c.config.emulator)return;const{authorizedDomains:o}=yield Sr(c);for(const a of o)try{if(nh(a))return}catch{}R(c,"unauthorized-domain")})).apply(this,arguments)}function nh(c){const o=vt(),{protocol:a,hostname:l}=new URL(o);if(c.startsWith("chrome-extension://")){const x=new URL(c);return""===x.hostname&&""===l?"chrome-extension:"===a&&c.replace("chrome-extension://","")===o.replace("chrome-extension://",""):"chrome-extension:"===a&&x.hostname===l}if(!dr.test(a))return!1;if(Cr.test(c))return l===c;const g=c.replace(/\./g,"\\.");return new RegExp("^(.+\\."+g+"|"+g+")$","i").test(l)}const rh=new Gt(3e4,6e4);function rc(){const c=wt().___jsl;if(c?.H)for(const o of Object.keys(c.H))if(c.H[o].r=c.H[o].r||[],c.H[o].L=c.H[o].L||[],c.H[o].r=[...c.H[o].L],c.CP)for(let a=0;a<c.CP.length;a++)c.CP[a]=null}let Dt=null;function qc(c){return Dt=Dt||function Gc(c){return new Promise((o,a)=>{var l,g,_;function x(){rc(),gapi.load("gapi.iframes",{callback:()=>{o(gapi.iframes.getContext())},ontimeout:()=>{rc(),a(De(c,"network-request-failed"))},timeout:rh.get()})}if(null!==(g=null===(l=wt().gapi)||void 0===l?void 0:l.iframes)&&void 0!==g&&g.Iframe)o(gapi.iframes.getContext());else{if(null===(_=wt().gapi)||void 0===_||!_.load){const F=na("iframefcb");return wt()[F]=()=>{gapi.load?x():a(De(c,"network-request-failed"))},Hs(`https://apis.google.com/js/api.js?onload=${F}`).catch(Q=>a(Q))}x()}}).catch(o=>{throw Dt=null,o})}(c),Dt}const ut=new Gt(5e3,15e3),ls={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sh=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function da(c){const o=c.config;N(o.authDomain,c,"auth-domain-config-required");const a=o.emulator?Ge(o,"emulator/auth/iframe"):`https://${c.config.authDomain}/__/auth/iframe`,l={apiKey:o.apiKey,appName:c.name,v:ie.SDK_VERSION},g=sh.get(c.config.apiHost);g&&(l.eid=g);const _=c._getFrameworks();return _.length&&(l.fw=_.join(",")),`${a}?${(0,C.xO)(l).slice(1)}`}function Xs(){return Xs=(0,I.Z)(function*(c){const o=yield qc(c),a=wt().gapi;return N(a,c,"internal-error"),o.open({where:document.body,url:da(c),messageHandlersFilter:a.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ls,dontclear:!0},l=>new Promise(function(){var g=(0,I.Z)(function*(_,x){yield l.restyle({setHideOnLeave:!1});const F=De(c,"network-request-failed"),Q=wt().setTimeout(()=>{x(F)},ut.get());function ue(){wt().clearTimeout(Q),_(l)}l.ping(ue).then(ue,()=>{x(F)})});return function(_,x){return g.apply(this,arguments)}}()))}),Xs.apply(this,arguments)}const zc={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Wc{constructor(o){this.window=o,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ic(c,o,a,l,g,_){N(c.config.authDomain,c,"auth-domain-config-required"),N(c.config.apiKey,c,"invalid-api-key");const x={apiKey:c.config.apiKey,appName:c.name,authType:a,redirectUrl:l,v:ie.SDK_VERSION,eventId:g};if(o instanceof qn){o.setDefaultLanguage(c.languageCode),x.providerId=o.providerId||"",(0,C.xb)(o.getCustomParameters())||(x.customParameters=JSON.stringify(o.getCustomParameters()));for(const[Q,ue]of Object.entries(_||{}))x[Q]=ue}if(o instanceof Br){const Q=o.getScopes().filter(ue=>""!==ue);Q.length>0&&(x.scopes=Q.join(","))}c.tenantId&&(x.tid=c.tenantId);const F=x;for(const Q of Object.keys(F))void 0===F[Q]&&delete F[Q];return`${function bi({config:c}){return c.emulator?Ge(c,"emulator/auth/handler"):`https://${c.authDomain}/__/auth/handler`}(c)}?${(0,C.xO)(F).slice(1)}`}const Ai="webStorageSupport";class fr extends class Qc{constructor(o){this.factorId=o}_process(o,a,l){switch(a.type){case"enroll":return this._finalizeEnroll(o,a.credential,l);case"signin":return this._finalizeSignIn(o,a.credential);default:return Z("unexpected MultiFactorSessionType")}}}{constructor(o){super("phone"),this.credential=o}static _fromCredential(o){return new fr(o)}_finalizeEnroll(o,a,l){return function Ks(c,o){return lt(c,"POST","/v2/accounts/mfaEnrollment:finalize",ct(c,o))}(o,{idToken:a,displayName:l,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(o,a){return function ec(c,o){return lt(c,"POST","/v2/accounts/mfaSignIn:finalize",ct(c,o))}(o,{mfaPendingCredential:a,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Yc=(()=>{class c{constructor(){}static assertion(a){return fr._fromCredential(a)}}return c.FACTOR_ID="phone",c})();var hs="@firebase/auth";class ac{constructor(o){this.auth=o,this.internalListeners=new Map}getUid(){var o;return this.assertAuthConfigured(),(null===(o=this.auth.currentUser)||void 0===o?void 0:o.uid)||null}getToken(o){var a=this;return(0,I.Z)(function*(){return a.assertAuthConfigured(),yield a.auth._initializationPromise,a.auth.currentUser?{accessToken:yield a.auth.currentUser.getIdToken(o)}:null})()}addAuthTokenListener(o){if(this.assertAuthConfigured(),this.internalListeners.has(o))return;const a=this.auth.onIdTokenChanged(l=>{var g;o((null===(g=l)||void 0===g?void 0:g.stsTokenManager.accessToken)||null)});this.internalListeners.set(o,a),this.updateProactiveRefresh()}removeAuthTokenListener(o){this.assertAuthConfigured();const a=this.internalListeners.get(o);!a||(this.internalListeners.delete(o),a(),this.updateProactiveRefresh())}assertAuthConfigured(){N(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Nt(){return window}function gu(){return(gu=(0,I.Z)(function*(c,o,a){var l;const{BuildInfo:g}=Nt();V(o.sessionId,"AuthEvent did not contain a session ID");const _=yield tl(o.sessionId),x={};return ri()?x.ibi=g.packageName:sr()?x.apn=g.packageName:R(c,"operation-not-supported-in-this-environment"),g.displayName&&(x.appDisplayName=g.displayName),x.sessionId=_,ic(c,a,o.type,void 0,null!==(l=o.eventId)&&void 0!==l?l:void 0,x)})).apply(this,arguments)}function ga(){return(ga=(0,I.Z)(function*(c){const{BuildInfo:o}=Nt(),a={};ri()?a.iosBundleId=o.packageName:sr()?a.androidPackageName=o.packageName:R(c,"operation-not-supported-in-this-environment"),yield Sr(c,a)})).apply(this,arguments)}function hc(){return(hc=(0,I.Z)(function*(c,o,a){const{cordova:l}=Nt();let g=()=>{};try{yield new Promise((_,x)=>{let F=null;function Q(){var ve;_();const yt=null===(ve=l.plugins.browsertab)||void 0===ve?void 0:ve.close;"function"==typeof yt&&yt(),"function"==typeof a?.close&&a.close()}function ue(){F||(F=window.setTimeout(()=>{x(De(c,"redirect-cancelled-by-user"))},2e3))}function Ae(){"visible"===document?.visibilityState&&ue()}o.addPassiveListener(Q),document.addEventListener("resume",ue,!1),sr()&&document.addEventListener("visibilitychange",Ae,!1),g=()=>{o.removePassiveListener(Q),document.removeEventListener("resume",ue,!1),document.removeEventListener("visibilitychange",Ae,!1),F&&window.clearTimeout(F)}})}finally{g()}})).apply(this,arguments)}function tl(c){return mu.apply(this,arguments)}function mu(){return(mu=(0,I.Z)(function*(c){const o=yu(c),a=yield crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(a)).map(g=>g.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function yu(c){if(V(/[0-9a-zA-Z]+/.test(c),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(c);const o=new ArrayBuffer(c.length),a=new Uint8Array(o);for(let l=0;l<c.length;l++)a[l]=c.charCodeAt(l);return a}!function cc(c){(0,ie._registerComponent)(new fe.wA("auth",(o,{options:a})=>{const l=o.getProvider("app").getImmediate(),g=o.getProvider("heartbeat"),{apiKey:_,authDomain:x}=l.options;return((F,Q)=>{N(_&&!_.includes(":"),"invalid-api-key",{appName:F.name}),N(!x?.includes(":"),"argument-error",{appName:F.name});const ue={apiKey:_,authDomain:x,clientPlatform:c,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ii(c)},Ae=new _o(F,Q,ue);return function et(c,o){const a=o?.persistence||[],l=(Array.isArray(a)?a:[a]).map(ee);o?.errorMap&&c._updateErrorMap(o.errorMap),c._initializeWithPersistence(l,o?.popupRedirectResolver)}(Ae,a),Ae})(l,g)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((o,a,l)=>{o.getProvider("auth-internal").initialize()})),(0,ie._registerComponent)(new fe.wA("auth-internal",o=>{const a=Le(o.getProvider("auth").getImmediate());return new ac(a)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,ie.registerVersion)(hs,"0.20.5",function uc(c){switch(c){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(c)),(0,ie.registerVersion)(hs,"0.20.5","esm2017")}("Browser");class fh extends Jn{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(o=>{this.resolveInialized=o})}addPassiveListener(o){this.passiveListeners.add(o)}removePassiveListener(o){this.passiveListeners.delete(o)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(o){return this.resolveInialized(),this.passiveListeners.forEach(a=>a(o)),super.onEvent(o)}initialized(){var o=this;return(0,I.Z)(function*(){yield o.initPromise})()}}function Si(c){return _u.apply(this,arguments)}function _u(){return(_u=(0,I.Z)(function*(c){const o=yield xi()._get(vu(c));return o&&(yield xi()._remove(vu(c))),o})).apply(this,arguments)}function rl(){const c=[],o="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let a=0;a<20;a++){const l=Math.floor(Math.random()*o.length);c.push(o.charAt(l))}return c.join("")}function xi(){return ee(Xi)}function vu(c){return Ut("authEvent",c.config.apiKey,c.name)}function Iu(c){if(!c?.includes("?"))return{};const[o,...a]=c.split("?");return(0,C.zd)(a.join("?"))}function ya(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:De("no-auth-event")}}function to(){var c;return(null===(c=self?.location)||void 0===c?void 0:c.protocol)||null}function kr(c=(0,C.z$)()){return!("file:"!==to()&&"ionic:"!==to()&&"capacitor:"!==to()||!c.toLowerCase().match(/iphone|ipad|ipod|android/))}function Eu(){try{const c=self.localStorage,o=ts();if(c)return c.setItem(o,"1"),c.removeItem(o),!function ro(c=(0,C.z$)()){return function al(){return(0,C.w1)()&&11===document?.documentMode}()||function ul(c=(0,C.z$)()){return/Edge\/\d+/.test(c)}(c)}()||(0,C.hl)()}catch{return dc()&&(0,C.hl)()}return!1}function dc(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Et(){return(function no(){return"http:"===to()||"https:"===to()}()||(0,C.ru)()||kr())&&!function ol(){return(0,C.b$)()||(0,C.UG)()}()&&Eu()&&!dc()}function $e(){return kr()&&typeof document<"u"}function Tu(){return(Tu=(0,I.Z)(function*(){return!!$e()&&new Promise(c=>{const o=setTimeout(()=>{c(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(o),c(!0)})})})).apply(this,arguments)}const On={LOCAL:"local",NONE:"none",SESSION:"session"},Bt=N,fc="persistence";function bu(c){return Xn.apply(this,arguments)}function Xn(){return(Xn=(0,I.Z)(function*(c){yield c._initializationPromise;const o=io(),a=Ut(fc,c.config.apiKey,c.name);o&&o.setItem(a,c._getPersistence())})).apply(this,arguments)}function io(){var c;try{return(null===(c=function Ci(){return typeof window<"u"?window:null}())||void 0===c?void 0:c.sessionStorage)||null}catch{return null}}const yh=N;class ki{constructor(){this.browserResolver=ee(class hh{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Tr,this._completeRedirectFn=we,this._overrideRedirectResult=lu}_openPopup(o,a,l,g){var _=this;return(0,I.Z)(function*(){var x;V(null===(x=_.eventManagers[o._key()])||void 0===x?void 0:x.manager,"_initialize() not called before _openPopup()");const F=ic(o,a,l,vt(),g);return function Hc(c,o,a,l=500,g=600){const _=Math.max((window.screen.availHeight-g)/2,0).toString(),x=Math.max((window.screen.availWidth-l)/2,0).toString();let F="";const Q=Object.assign(Object.assign({},zc),{width:l.toString(),height:g.toString(),top:_,left:x}),ue=(0,C.z$)().toLowerCase();a&&(F=ni(ue)?"_blank":a),In(ue)&&(o=o||"http://localhost",Q.scrollbars="yes");const Ae=Object.entries(Q).reduce((yt,[Pn,Cu])=>`${yt}${Pn}=${Cu},`,"");if(function _s(c=(0,C.z$)()){var o;return ri(c)&&!(null===(o=window.navigator)||void 0===o||!o.standalone)}(ue)&&"_self"!==F)return function uh(c,o){const a=document.createElement("a");a.href=c,a.target=o;const l=document.createEvent("MouseEvent");l.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),a.dispatchEvent(l)}(o||"",F),new Wc(null);const ve=window.open(o||"",F,Ae);N(ve,c,"popup-blocked");try{ve.focus()}catch{}return new Wc(ve)}(o,F,ts())})()}_openRedirect(o,a,l,g){var _=this;return(0,I.Z)(function*(){return yield _._originValidation(o),function Yo(c){wt().location.href=c}(ic(o,a,l,vt(),g)),new Promise(()=>{})})()}_initialize(o){const a=o._key();if(this.eventManagers[a]){const{manager:g,promise:_}=this.eventManagers[a];return g?Promise.resolve(g):(V(_,"If manager is not set, promise should be"),_)}const l=this.initAndGetManager(o);return this.eventManagers[a]={promise:l},l.catch(()=>{delete this.eventManagers[a]}),l}initAndGetManager(o){var a=this;return(0,I.Z)(function*(){const l=yield function fu(c){return Xs.apply(this,arguments)}(o),g=new Jn(o);return l.register("authEvent",_=>(N(_?.authEvent,o,"invalid-auth-event"),{status:g.onEvent(_.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),a.eventManagers[o._key()]={manager:g},a.iframes[o._key()]=l,g})()}_isIframeWebStorageSupported(o,a){this.iframes[o._key()].send(Ai,{type:Ai},g=>{var _;const x=null===(_=g?.[0])||void 0===_?void 0:_[Ai];void 0!==x&&a(!!x),R(o,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(o){const a=o._key();return this.originValidationPromises[a]||(this.originValidationPromises[a]=function Ti(c){return du.apply(this,arguments)}(o)),this.originValidationPromises[a]}get _shouldInitProactively(){return Va()||Mr()||ri()}}),this.cordovaResolver=ee(class mt{constructor(){this._redirectPersistence=Tr,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=we,this._overrideRedirectResult=lu}_initialize(o){var a=this;return(0,I.Z)(function*(){const l=o._key();let g=a.eventManagers.get(l);return g||(g=new fh(o),a.eventManagers.set(l,g),a.attachCallbackListeners(o,g)),g})()}_openPopup(o){R(o,"operation-not-supported-in-this-environment")}_openRedirect(o,a,l,g){var _=this;return(0,I.Z)(function*(){!function el(c){var o,a,l,g,_,x,F,Q,ue,Ae;const ve=Nt();N("function"==typeof(null===(o=ve?.universalLinks)||void 0===o?void 0:o.subscribe),c,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),N(typeof(null===(a=ve?.BuildInfo)||void 0===a?void 0:a.packageName)<"u",c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),N("function"==typeof(null===(_=null===(g=null===(l=ve?.cordova)||void 0===l?void 0:l.plugins)||void 0===g?void 0:g.browsertab)||void 0===_?void 0:_.openUrl),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),N("function"==typeof(null===(Q=null===(F=null===(x=ve?.cordova)||void 0===x?void 0:x.plugins)||void 0===F?void 0:F.browsertab)||void 0===Q?void 0:Q.isAvailable),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),N("function"==typeof(null===(Ae=null===(ue=ve?.cordova)||void 0===ue?void 0:ue.InAppBrowser)||void 0===Ae?void 0:Ae.open),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(o);const x=yield _._initialize(o);yield x.initialized(),x.resetRedirect(),function kt(){pt.clear()}(),yield _._originValidation(o);const F=function nl(c,o,a=null){return{type:o,eventId:a,urlResponse:null,sessionId:rl(),postBody:null,tenantId:c.tenantId,error:De(c,"no-auth-event")}}(o,l,g);yield function eo(c,o){return xi()._set(vu(c),o)}(o,F);const Q=yield function pa(c,o,a){return gu.apply(this,arguments)}(o,F,a),ue=yield function Jc(c){const{cordova:o}=Nt();return new Promise(a=>{o.plugins.browsertab.isAvailable(l=>{let g=null;l?o.plugins.browsertab.openUrl(c):g=o.InAppBrowser.open(c,function Ku(c=(0,C.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(c)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(c)}()?"_blank":"_system","location=yes"),a(g)})})}(Q);return function Xc(c,o,a){return hc.apply(this,arguments)}(o,x,ue)})()}_isIframeWebStorageSupported(o,a){throw new Error("Method not implemented.")}_originValidation(o){const a=o._key();return this.originValidationPromises[a]||(this.originValidationPromises[a]=function lc(c){return ga.apply(this,arguments)}(o)),this.originValidationPromises[a]}attachCallbackListeners(o,a){const{universalLinks:l,handleOpenURL:g,BuildInfo:_}=Nt(),x=setTimeout((0,I.Z)(function*(){yield Si(o),a.onEvent(ya())}),500),F=function(){var Ae=(0,I.Z)(function*(ve){clearTimeout(x);const yt=yield Si(o);let Pn=null;yt&&ve?.url&&(Pn=function ds(c,o){var a,l;const g=function ma(c){const o=Iu(c),a=o.link?decodeURIComponent(o.link):void 0,l=Iu(a).link,g=o.deep_link_id?decodeURIComponent(o.deep_link_id):void 0;return Iu(g).link||g||l||a||c}(o);if(g.includes("/__/auth/callback")){const _=Iu(g),x=_.firebaseError?function il(c){try{return JSON.parse(c)}catch{return null}}(decodeURIComponent(_.firebaseError)):null,F=null===(l=null===(a=x?.code)||void 0===a?void 0:a.split("auth/"))||void 0===l?void 0:l[1],Q=F?De(F):null;return Q?{type:c.type,eventId:c.eventId,tenantId:c.tenantId,error:Q,urlResponse:null,sessionId:null,postBody:null}:{type:c.type,eventId:c.eventId,tenantId:c.tenantId,sessionId:c.sessionId,urlResponse:g,postBody:null}}return null}(yt,ve.url)),a.onEvent(Pn||ya())});return function(yt){return Ae.apply(this,arguments)}}();typeof l<"u"&&"function"==typeof l.subscribe&&l.subscribe(null,F);const Q=g,ue=`${_.packageName.toLowerCase()}://`;Nt().handleOpenURL=function(){var Ae=(0,I.Z)(function*(ve){if(ve.toLowerCase().startsWith(ue)&&F({url:ve}),"function"==typeof Q)try{Q(ve)}catch(yt){console.error(yt)}});return function(ve){return Ae.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=Tr,this._completeRedirectFn=we,this._overrideRedirectResult=lu}_initialize(o){var a=this;return(0,I.Z)(function*(){return yield a.selectUnderlyingResolver(),a.assertedUnderlyingResolver._initialize(o)})()}_openPopup(o,a,l,g){var _=this;return(0,I.Z)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._openPopup(o,a,l,g)})()}_openRedirect(o,a,l,g){var _=this;return(0,I.Z)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._openRedirect(o,a,l,g)})()}_isIframeWebStorageSupported(o,a){this.assertedUnderlyingResolver._isIframeWebStorageSupported(o,a)}_originValidation(o){return this.assertedUnderlyingResolver._originValidation(o)}get _shouldInitProactively(){return $e()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return yh(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var o=this;return(0,I.Z)(function*(){if(o.underlyingResolver)return;const a=yield function cl(){return Tu.apply(this,arguments)}();o.underlyingResolver=a?o.cordovaResolver:o.browserResolver})()}}function Ne(c){return c.unwrap()}function Au(c){return so(c)}function so(c){const{_tokenResponse:o}=c instanceof C.ZR?c.customData:c;if(!o)return null;if(!(c instanceof C.ZR)&&"temporaryProof"in o&&"phoneNumber"in o)return br.credentialFromResult(c);const a=o.providerId;if(!a||"password"===a)return null;let l;switch(a){case"google.com":l=xs;break;case"facebook.com":l=li;break;case"github.com":l=Co;break;case"twitter.com":l=ko;break;default:const{oauthIdToken:g,oauthAccessToken:_,oauthTokenSecret:x,pendingToken:F,nonce:Q}=o;return _||x||g||F?F?a.startsWith("saml.")?hi._create(a,F):rn._fromParams({providerId:a,signInMethod:a,pendingToken:F,idToken:g,accessToken:_}):new yr(a).credential({idToken:g,accessToken:_,rawNonce:Q}):null}return c instanceof C.ZR?l.credentialFromError(c):l.credentialFromResult(c)}function Qt(c,o){return o.catch(a=>{throw a instanceof C.ZR&&function Ia(c,o){var a,l;const g=null===(a=o.customData)||void 0===a?void 0:a._tokenResponse;if("auth/multi-factor-auth-required"===(null===(l=o)||void 0===l?void 0:l.code))o.resolver=new hl(c,function At(c,o){var a;const l=(0,C.m9)(c),g=o;return N(o.customData.operationType,l,"argument-error"),N(null===(a=g.customData._serverResponse)||void 0===a?void 0:a.mfaPendingCredential,l,"argument-error"),gi._fromError(l,g)}(c,o));else if(g){const _=so(o),x=o;_&&(x.credential=_,x.tenantId=g.tenantId||void 0,x.email=g.email||void 0,x.phoneNumber=g.phoneNumber||void 0)}}(c,a),a}).then(a=>{const g=a.user;return{operationType:a.operationType,credential:Au(a),additionalUserInfo:Qa(a),user:Jr.getOrCreate(g)}})}function Su(c,o){return xu.apply(this,arguments)}function xu(){return(xu=(0,I.Z)(function*(c,o){const a=yield o;return{verificationId:a.verificationId,confirm:l=>Qt(c,a.confirm(l))}})).apply(this,arguments)}class hl{constructor(o,a){this.resolver=a,this.auth=function _h(c){return c.wrapped()}(o)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(o){return Qt(Ne(this.auth),this.resolver.resolveSignIn(o))}}class Jr{constructor(o){this._delegate=o,this.multiFactor=function eu(c){const o=(0,C.m9)(c);return kn.has(o)||kn.set(o,zs._fromUser(o)),kn.get(o)}(o)}static getOrCreate(o){return Jr.USER_MAP.has(o)||Jr.USER_MAP.set(o,new Jr(o)),Jr.USER_MAP.get(o)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(o){return this._delegate.getIdTokenResult(o)}getIdToken(o){return this._delegate.getIdToken(o)}linkAndRetrieveDataWithCredential(o){return this.linkWithCredential(o)}linkWithCredential(o){var a=this;return(0,I.Z)(function*(){return Qt(a.auth,vr(a._delegate,o))})()}linkWithPhoneNumber(o,a){var l=this;return(0,I.Z)(function*(){return Su(l.auth,function au(c,o,a){return Zt.apply(this,arguments)}(l._delegate,o,a))})()}linkWithPopup(o){var a=this;return(0,I.Z)(function*(){return Qt(a.auth,function Ei(c,o,a){return Js.apply(this,arguments)}(a._delegate,o,ki))})()}linkWithRedirect(o){var a=this;return(0,I.Z)(function*(){return yield bu(Le(a.auth)),function D(c,o,a){return function M(c,o,a){return q.apply(this,arguments)}(c,o,a)}(a._delegate,o,ki)})()}reauthenticateAndRetrieveDataWithCredential(o){return this.reauthenticateWithCredential(o)}reauthenticateWithCredential(o){var a=this;return(0,I.Z)(function*(){return Qt(a.auth,Ns(a._delegate,o))})()}reauthenticateWithPhoneNumber(o,a){return Su(this.auth,function oa(c,o,a){return Ys.apply(this,arguments)}(this._delegate,o,a))}reauthenticateWithPopup(o){return Qt(this.auth,function mn(c,o,a){return la.apply(this,arguments)}(this._delegate,o,ki))}reauthenticateWithRedirect(o){var a=this;return(0,I.Z)(function*(){return yield bu(Le(a.auth)),function p(c,o,a){return function y(c,o,a){return w.apply(this,arguments)}(c,o,a)}(a._delegate,o,ki)})()}sendEmailVerification(o){return function Kr(c,o){return zr.apply(this,arguments)}(this._delegate,o)}unlink(o){var a=this;return(0,I.Z)(function*(){return yield function Ds(c,o){return $i.apply(this,arguments)}(a._delegate,o),a})()}updateEmail(o){return function Qu(c,o){return $s((0,C.m9)(c),o,null)}(this._delegate,o)}updatePassword(o){return function Bs(c,o){return $s((0,C.m9)(c),null,o)}(this._delegate,o)}updatePhoneNumber(o){return function uu(c,o){return P.apply(this,arguments)}(this._delegate,o)}updateProfile(o){return function Bo(c,o){return $o.apply(this,arguments)}(this._delegate,o)}verifyBeforeUpdateEmail(o,a){return function Uo(c,o,a){return dt.apply(this,arguments)}(this._delegate,o,a)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Jr.USER_MAP=new WeakMap;const oo=N;let pc=(()=>{class c{constructor(a,l){if(this.app=a,l.isInitialized())return this._delegate=l.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:g}=a.options;oo(g,"invalid-api-key",{appName:a.name}),oo(g,"invalid-api-key",{appName:a.name});const _=typeof window<"u"?ki:void 0;this._delegate=l.initialize({options:{persistence:vh(g,a.name),popupRedirectResolver:_}}),this._delegate._updateErrorMap(nt),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Jr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(a){this._delegate.languageCode=a}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(a){this._delegate.tenantId=a}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(a,l){!function Is(c,o,a){const l=Le(c);N(l._canInitEmulator,l,"emulator-config-failed"),N(/^https?:\/\//.test(o),l,"invalid-emulator-scheme");const g=!!a?.disableWarnings,_=si(o),{host:x,port:F}=function Ba(c){const o=si(c),a=/(\/\/)?([^?#/]+)/.exec(c.substr(o.length));if(!a)return{host:"",port:null};const l=a[2].split("@").pop()||"",g=/^(\[[^\]]+\])(:|$)/.exec(l);if(g){const _=g[1];return{host:_,port:$a(l.substr(_.length+1))}}{const[_,x]=l.split(":");return{host:_,port:$a(x)}}}(o);l.config.emulator={url:`${_}//${x}${null===F?"":`:${F}`}/`},l.settings.appVerificationDisabledForTesting=!0,l.emulatorConfig=Object.freeze({host:x,port:F,protocol:_.replace(":",""),options:Object.freeze({disableWarnings:g})}),g||function vo(){function c(){const o=document.createElement("p"),a=o.style;o.innerText="Running in emulator mode. Do not use with production credentials.",a.position="fixed",a.width="100%",a.backgroundColor="#ffffff",a.border=".1em solid #000000",a.color="#b50000",a.bottom="0px",a.left="0px",a.margin="0px",a.zIndex="10000",a.textAlign="center",o.classList.add("firebase-emulator-warning"),document.body.appendChild(o)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",c):c())}()}(this._delegate,a,l)}applyActionCode(a){return function Mo(c,o){return Wi.apply(this,arguments)}(this._delegate,a)}checkActionCode(a){return Os(this._delegate,a)}confirmPasswordReset(a,l){return function Ir(c,o,a){return Po.apply(this,arguments)}(this._delegate,a,l)}createUserWithEmailAndPassword(a,l){var g=this;return(0,I.Z)(function*(){return Qt(g._delegate,function Ls(c,o,a){return Fs.apply(this,arguments)}(g._delegate,a,l))})()}fetchProvidersForEmail(a){return this.fetchSignInMethodsForEmail(a)}fetchSignInMethodsForEmail(a){return function Yi(c,o){return Us.apply(this,arguments)}(this._delegate,a)}isSignInWithEmailLink(a){return function Ha(c,o){return"EMAIL_SIGNIN"===Ur.parseLink(o)?.operation}(0,a)}getRedirectResult(){var a=this;return(0,I.Z)(function*(){oo(Et(),a._delegate,"operation-not-supported-in-this-environment");const l=yield function J(c,o){return ge.apply(this,arguments)}(a._delegate,ki);return l?Qt(a._delegate,Promise.resolve(l)):{credential:null,user:null}})()}addFrameworkForLogging(a){!function sl(c,o){Le(c)._logFramework(o)}(this._delegate,a)}onAuthStateChanged(a,l,g){const{next:_,error:x,complete:F}=dl(a,l,g);return this._delegate.onAuthStateChanged(_,x,F)}onIdTokenChanged(a,l,g){const{next:_,error:x,complete:F}=dl(a,l,g);return this._delegate.onIdTokenChanged(_,x,F)}sendSignInLinkToEmail(a,l){return function Lo(c,o,a){return Fo.apply(this,arguments)}(this._delegate,a,l)}sendPasswordResetEmail(a,l){return function Rs(c,o,a){return Zi.apply(this,arguments)}(this._delegate,a,l||void 0)}setPersistence(a){var l=this;return(0,I.Z)(function*(){let g;switch(function va(c,o){Bt(Object.values(On).includes(o),c,"invalid-persistence-type"),(0,C.b$)()?Bt(o!==On.SESSION,c,"unsupported-persistence-type"):(0,C.UG)()?Bt(o===On.NONE,c,"unsupported-persistence-type"):dc()?Bt(o===On.NONE||o===On.LOCAL&&(0,C.hl)(),c,"unsupported-persistence-type"):Bt(o===On.NONE||Eu(),c,"unsupported-persistence-type")}(l._delegate,a),a){case On.SESSION:g=Tr;break;case On.LOCAL:g=(yield ee(_i)._isAvailable())?_i:Xi;break;case On.NONE:g=Be;break;default:return R("argument-error",{appName:l._delegate.name})}return l._delegate.setPersistence(g)})()}signInAndRetrieveDataWithCredential(a){return this.signInWithCredential(a)}signInAnonymously(){return Qt(this._delegate,function Do(c){return Bi.apply(this,arguments)}(this._delegate))}signInWithCredential(a){return Qt(this._delegate,It(this._delegate,a))}signInWithCustomToken(a){return Qt(this._delegate,function Oo(c,o){return Ki.apply(this,arguments)}(this._delegate,a))}signInWithEmailAndPassword(a,l){return Qt(this._delegate,function Wa(c,o,a){return It((0,C.m9)(c),Vr.credential(o,a))}(this._delegate,a,l))}signInWithEmailLink(a,l){return Qt(this._delegate,function Hu(c,o,a){return wr.apply(this,arguments)}(this._delegate,a,l))}signInWithPhoneNumber(a,l){return Su(this._delegate,function wi(c,o,a){return is.apply(this,arguments)}(this._delegate,a,l))}signInWithPopup(a){var l=this;return(0,I.Z)(function*(){return oo(Et(),l._delegate,"operation-not-supported-in-this-environment"),Qt(l._delegate,function ca(c,o,a){return cs.apply(this,arguments)}(l._delegate,a,ki))})()}signInWithRedirect(a){var l=this;return(0,I.Z)(function*(){return oo(Et(),l._delegate,"operation-not-supported-in-this-environment"),yield bu(l._delegate),function Yr(c,o,a){return function hu(c,o,a){return d.apply(this,arguments)}(c,o,a)}(l._delegate,a,ki)})()}updateCurrentUser(a){return this._delegate.updateCurrentUser(a)}verifyPasswordResetCode(a){return function Ms(c,o){return Hi.apply(this,arguments)}(this._delegate,a)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return c.Persistence=On,c})();function dl(c,o,a){let l=c;"function"!=typeof c&&({next:l,error:o,complete:a}=c);const g=l;return{next:x=>g(x&&Jr.getOrCreate(x)),error:o,complete:a}}function vh(c,o){const a=function ll(c,o){const a=io();if(!a)return[];const l=Ut(fc,c,o);switch(a.getItem(l)){case On.NONE:return[Be];case On.LOCAL:return[_i,Tr];case On.SESSION:return[Tr];default:return[]}}(c,o);if(typeof self<"u"&&!a.includes(_i)&&a.push(_i),typeof window<"u")for(const l of[Xi,Tr])a.includes(l)||a.push(l);return a.includes(Be)||a.push(Be),a}class gc{constructor(){this.providerId="phone",this._delegate=new br(Ne(se.Z.auth()))}static credential(o,a){return br.credential(o,a)}verifyPhoneNumber(o,a){return this._delegate.verifyPhoneNumber(o,a)}unwrap(){return this._delegate}}gc.PHONE_SIGN_IN_METHOD=br.PHONE_SIGN_IN_METHOD,gc.PROVIDER_ID=br.PROVIDER_ID;const wa=N;class fl{constructor(o,a,l=se.Z.app()){var g;wa(null===(g=l.options)||void 0===g?void 0:g.apiKey,"invalid-api-key",{appName:l.name}),this._delegate=new jc(o,a,l.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function $t(c){c.INTERNAL.registerComponent(new fe.wA("auth-compat",o=>{const a=o.getProvider("app-compat").getImmediate(),l=o.getProvider("auth");return new pc(a,l)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Vr,FacebookAuthProvider:li,GithubAuthProvider:Co,GoogleAuthProvider:xs,OAuthProvider:yr,SAMLAuthProvider:Vt,PhoneAuthProvider:gc,PhoneMultiFactorGenerator:Yc,RecaptchaVerifier:fl,TwitterAuthProvider:ko,Auth:pc,AuthCredential:oi,Error:C.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),c.registerVersion("@firebase/auth-compat","0.2.18")}(se.Z)},4408:(Lt,ze,j)=>{j.d(ze,{o:()=>oe});var I=j(727);class se extends I.w0{constructor(fe,ye){super()}schedule(fe,ye=0){return this}}const C={setInterval(he,fe,...ye){const{delegate:le}=C;return le?.setInterval?le.setInterval(he,fe,...ye):setInterval(he,fe,...ye)},clearInterval(he){const{delegate:fe}=C;return(fe?.clearInterval||clearInterval)(he)},delegate:void 0};var ie=j(8737);class oe extends se{constructor(fe,ye){super(fe,ye),this.scheduler=fe,this.work=ye,this.pending=!1}schedule(fe,ye=0){if(this.closed)return this;this.state=fe;const le=this.id,B=this.scheduler;return null!=le&&(this.id=this.recycleAsyncId(B,le,ye)),this.pending=!0,this.delay=ye,this.id=this.id||this.requestAsyncId(B,this.id,ye),this}requestAsyncId(fe,ye,le=0){return C.setInterval(fe.flush.bind(fe,this),le)}recycleAsyncId(fe,ye,le=0){if(null!=le&&this.delay===le&&!1===this.pending)return ye;C.clearInterval(ye)}execute(fe,ye){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const le=this._execute(fe,ye);if(le)return le;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(fe,ye){let B,le=!1;try{this.work(fe)}catch(z){le=!0,B=z||new Error("Scheduled action threw falsy error")}if(le)return this.unsubscribe(),B}unsubscribe(){if(!this.closed){const{id:fe,scheduler:ye}=this,{actions:le}=ye;this.work=this.state=this.scheduler=null,this.pending=!1,(0,ie.P)(le,this),null!=fe&&(this.id=this.recycleAsyncId(ye,fe,null)),this.delay=null,super.unsubscribe()}}}},7565:(Lt,ze,j)=>{j.d(ze,{v:()=>C});var I=j(6063);class se{constructor(oe,he=se.now){this.schedulerActionCtor=oe,this.now=he}schedule(oe,he=0,fe){return new this.schedulerActionCtor(this,oe).schedule(fe,he)}}se.now=I.l.now;class C extends se{constructor(oe,he=se.now){super(oe,he),this.actions=[],this._active=!1,this._scheduled=void 0}flush(oe){const{actions:he}=this;if(this._active)return void he.push(oe);let fe;this._active=!0;do{if(fe=oe.execute(oe.state,oe.delay))break}while(oe=he.shift());if(this._active=!1,fe){for(;oe=he.shift();)oe.unsubscribe();throw fe}}}},4986:(Lt,ze,j)=>{j.d(ze,{z:()=>C});var I=j(4408);const C=new(j(7565).v)(I.o)},6063:(Lt,ze,j)=>{j.d(ze,{l:()=>I});const I={now:()=>(I.delegate||Date).now(),delegate:void 0}},3942:(Lt,ze,j)=>{j.d(ze,{Z:()=>nt});var I=j(2090),se=j(4859),C=j(9681),ie=j(1877);class oe{constructor(Ee,re){this._delegate=Ee,this.firebase=re,(0,C._addComponent)(Ee,new se.wA("app-compat",()=>this,"PUBLIC")),this.container=Ee.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Ee){this._delegate.automaticDataCollectionEnabled=Ee}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(Ee=>{this._delegate.checkDestroyed(),Ee()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,C.deleteApp)(this._delegate)))}_getService(Ee,re=C._DEFAULT_ENTRY_NAME){var ke;this._delegate.checkDestroyed();const xe=this._delegate.container.getProvider(Ee);return!xe.isInitialized()&&"EXPLICIT"===(null===(ke=xe.getComponent())||void 0===ke?void 0:ke.instantiationMode)&&xe.initialize(),xe.getImmediate({identifier:re})}_removeServiceInstance(Ee,re=C._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(Ee).clearInstance(re)}_addComponent(Ee){(0,C._addComponent)(this._delegate,Ee)}_addOrOverwriteComponent(Ee){(0,C._addOrOverwriteComponent)(this._delegate,Ee)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const fe=new I.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),B=function le(){const je=function ye(je){const Ee={},re={__esModule:!0,initializeApp:function R(Y,N={}){const Z=C.initializeApp(Y,N);if((0,I.r3)(Ee,Z.name))return Ee[Z.name];const V=new je(Z,re);return Ee[Z.name]=V,V},app:xe,registerVersion:C.registerVersion,setLogLevel:C.setLogLevel,onLog:C.onLog,apps:null,SDK_VERSION:C.SDK_VERSION,INTERNAL:{registerComponent:function Qe(Y){const N=Y.name,Z=N.replace("-compat","");if(C._registerComponent(Y)&&"PUBLIC"===Y.type){const V=(Ze=xe())=>{if("function"!=typeof Ze[Z])throw fe.create("invalid-app-argument",{appName:N});return Ze[Z]()};void 0!==Y.serviceProps&&(0,I.ZB)(V,Y.serviceProps),re[Z]=V,je.prototype[Z]=function(...Ze){return this._getService.bind(this,N).apply(this,Y.multipleInstances?Ze:[])}}return"PUBLIC"===Y.type?re[Z]:null},removeApp:function ke(Y){delete Ee[Y]},useAsService:function Pe(Y,N){return"serverAuth"===N?null:N},modularAPIs:C}};function xe(Y){if(!(0,I.r3)(Ee,Y=Y||C._DEFAULT_ENTRY_NAME))throw fe.create("no-app",{appName:Y});return Ee[Y]}return re.default=re,Object.defineProperty(re,"apps",{get:function De(){return Object.keys(Ee).map(Y=>Ee[Y])}}),xe.App=je,re}(oe);return je.INTERNAL=Object.assign(Object.assign({},je.INTERNAL),{createFirebaseNamespace:le,extendNamespace:function Ee(re){(0,I.ZB)(je,re)},createSubscribe:I.ne,ErrorFactory:I.LL,deepExtend:I.ZB}),je}(),z=new ie.Yd("@firebase/app-compat");if((0,I.jU)()&&void 0!==self.firebase){z.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const je=self.firebase.SDK_VERSION;je&&je.indexOf("LITE")>=0&&z.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const nt=B;!function Se(je){(0,C.registerVersion)("@firebase/app-compat","0.1.32",je)}()},9681:(Lt,ze,j)=>{j.r(ze),j.d(ze,{FirebaseError:()=>ie.ZR,SDK_VERSION:()=>tr,_DEFAULT_ENTRY_NAME:()=>hn,_addComponent:()=>Jt,_addOrOverwriteComponent:()=>gt,_apps:()=>Gt,_clearComponents:()=>Nr,_components:()=>Ge,_getProvider:()=>ct,_registerComponent:()=>qt,_removeServiceInstance:()=>lt,deleteApp:()=>rr,getApp:()=>vn,getApps:()=>it,initializeApp:()=>nr,onLog:()=>Bn,registerVersion:()=>Vn,setLogLevel:()=>En});var I=j(5861),se=j(4859),C=j(1877),ie=j(2090),oe=j(8766);class he{constructor(A){this.container=A}getPlatformInfoString(){return this.container.getProviders().map(S=>{if(function fe(T){return"VERSION"===T.getComponent()?.type}(S)){const G=S.getImmediate();return`${G.library}/${G.version}`}return null}).filter(S=>S).join(" ")}}const ye="@firebase/app",B=new C.Yd("@firebase/app"),hn="[DEFAULT]",pr={[ye]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Gt=new Map,Ge=new Map;function Jt(T,A){try{T.container.addComponent(A)}catch(S){B.debug(`Component ${A.name} failed to register with FirebaseApp ${T.name}`,S)}}function gt(T,A){T.container.addOrOverwriteComponent(A)}function qt(T){const A=T.name;if(Ge.has(A))return B.debug(`There were multiple attempts to register component ${A}.`),!1;Ge.set(A,T);for(const S of Gt.values())Jt(S,T);return!0}function ct(T,A){const S=T.container.getProvider("heartbeat").getImmediate({optional:!0});return S&&S.triggerHeartbeat(),T.container.getProvider(A)}function lt(T,A,S=hn){ct(T,A).clearInstance(S)}function Nr(){Ge.clear()}const Ft=new ie.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class en{constructor(A,S,G){this._isDeleted=!1,this._options=Object.assign({},A),this._config=Object.assign({},S),this._name=S.name,this._automaticDataCollectionEnabled=S.automaticDataCollectionEnabled,this._container=G,this.container.addComponent(new se.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(A){this.checkDestroyed(),this._automaticDataCollectionEnabled=A}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(A){this._isDeleted=A}checkDestroyed(){if(this.isDeleted)throw Ft.create("app-deleted",{appName:this._name})}}const tr="9.9.3";function nr(T,A={}){"object"!=typeof A&&(A={name:A});const S=Object.assign({name:hn,automaticDataCollectionEnabled:!1},A),G=S.name;if("string"!=typeof G||!G)throw Ft.create("bad-app-name",{appName:String(G)});const H=Gt.get(G);if(H){if((0,ie.vZ)(T,H.options)&&(0,ie.vZ)(S,H.config))return H;throw Ft.create("duplicate-app",{appName:G})}const pe=new se.H0(G);for(const Be of Ge.values())pe.addComponent(Be);const ht=new en(T,S,pe);return Gt.set(G,ht),ht}function vn(T=hn){const A=Gt.get(T);if(!A)throw Ft.create("no-app",{appName:T});return A}function it(){return Array.from(Gt.values())}function rr(T){return tt.apply(this,arguments)}function tt(){return(tt=(0,I.Z)(function*(T){const A=T.name;Gt.has(A)&&(Gt.delete(A),yield Promise.all(T.container.getProviders().map(S=>S.delete())),T.isDeleted=!0)})).apply(this,arguments)}function Vn(T,A,S){var G;let H=null!==(G=pr[T])&&void 0!==G?G:T;S&&(H+=`-${S}`);const pe=H.match(/\s|\//),ht=A.match(/\s|\//);if(pe||ht){const Be=[`Unable to register library "${H}" with version "${A}":`];return pe&&Be.push(`library name "${H}" contains illegal characters (whitespace or "/")`),pe&&ht&&Be.push("and"),ht&&Be.push(`version name "${A}" contains illegal characters (whitespace or "/")`),void B.warn(Be.join(" "))}qt(new se.wA(`${H}-version`,()=>({library:H,version:A}),"VERSION"))}function Bn(T,A){if(null!==T&&"function"!=typeof T)throw Ft.create("invalid-log-argument");(0,C.Am)(T,A)}function En(T){(0,C.Ub)(T)}const $n="firebase-heartbeat-store";let jn=null;function Rr(){return jn||(jn=(0,oe.X3)("firebase-heartbeat-database",1,{upgrade:(T,A)=>{0===A&&T.createObjectStore($n)}}).catch(T=>{throw Ft.create("idb-open",{originalErrorMessage:T.message})})),jn}function nn(){return(nn=(0,I.Z)(function*(T){var A;try{return(yield Rr()).transaction($n).objectStore($n).get(bn(T))}catch(S){if(S instanceof ie.ZR)B.warn(S.message);else{const G=Ft.create("idb-get",{originalErrorMessage:null===(A=S)||void 0===A?void 0:A.message});B.warn(G.message)}}})).apply(this,arguments)}function gr(T,A){return Ot.apply(this,arguments)}function Ot(){return(Ot=(0,I.Z)(function*(T,A){var S;try{const H=(yield Rr()).transaction($n,"readwrite");return yield H.objectStore($n).put(A,bn(T)),H.done}catch(G){if(G instanceof ie.ZR)B.warn(G.message);else{const H=Ft.create("idb-set",{originalErrorMessage:null===(S=G)||void 0===S?void 0:S.message});B.warn(H.message)}}})).apply(this,arguments)}function bn(T){return`${T.name}!${T.options.appId}`}class ir{constructor(A){this.container=A,this._heartbeatsCache=null;const S=this.container.getProvider("app").getImmediate();this._storage=new Pr(S),this._heartbeatsCachePromise=this._storage.read().then(G=>(this._heartbeatsCache=G,G))}triggerHeartbeat(){var A=this;return(0,I.Z)(function*(){const G=A.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),H=An();if(null===A._heartbeatsCache&&(A._heartbeatsCache=yield A._heartbeatsCachePromise),A._heartbeatsCache.lastSentHeartbeatDate!==H&&!A._heartbeatsCache.heartbeats.some(pe=>pe.date===H))return A._heartbeatsCache.heartbeats.push({date:H,agent:G}),A._heartbeatsCache.heartbeats=A._heartbeatsCache.heartbeats.filter(pe=>{const ht=new Date(pe.date).valueOf();return Date.now()-ht<=2592e6}),A._storage.overwrite(A._heartbeatsCache)})()}getHeartbeatsHeader(){var A=this;return(0,I.Z)(function*(){if(null===A._heartbeatsCache&&(yield A._heartbeatsCachePromise),null===A._heartbeatsCache||0===A._heartbeatsCache.heartbeats.length)return"";const S=An(),{heartbeatsToSend:G,unsentEntries:H}=function Sn(T,A=1024){const S=[];let G=T.slice();for(const H of T){const pe=S.find(ht=>ht.agent===H.agent);if(pe){if(pe.dates.push(H.date),k(S)>A){pe.dates.pop();break}}else if(S.push({agent:H.agent,dates:[H.date]}),k(S)>A){S.pop();break}G=G.slice(1)}return{heartbeatsToSend:S,unsentEntries:G}}(A._heartbeatsCache.heartbeats),pe=(0,ie.L)(JSON.stringify({version:2,heartbeats:G}));return A._heartbeatsCache.lastSentHeartbeatDate=S,H.length>0?(A._heartbeatsCache.heartbeats=H,yield A._storage.overwrite(A._heartbeatsCache)):(A._heartbeatsCache.heartbeats=[],A._storage.overwrite(A._heartbeatsCache)),pe})()}}function An(){return(new Date).toISOString().substring(0,10)}class Pr{constructor(A){this.app=A,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,I.Z)(function*(){return!!(0,ie.hl)()&&(0,ie.eu)().then(()=>!0).catch(()=>!1)})()}read(){var A=this;return(0,I.Z)(function*(){return(yield A._canUseIndexedDBPromise)&&(yield function ei(T){return nn.apply(this,arguments)}(A.app))||{heartbeats:[]}})()}overwrite(A){var S=this;return(0,I.Z)(function*(){var G;if(yield S._canUseIndexedDBPromise){const pe=yield S.read();return gr(S.app,{lastSentHeartbeatDate:null!==(G=A.lastSentHeartbeatDate)&&void 0!==G?G:pe.lastSentHeartbeatDate,heartbeats:A.heartbeats})}})()}add(A){var S=this;return(0,I.Z)(function*(){var G;if(yield S._canUseIndexedDBPromise){const pe=yield S.read();return gr(S.app,{lastSentHeartbeatDate:null!==(G=A.lastSentHeartbeatDate)&&void 0!==G?G:pe.lastSentHeartbeatDate,heartbeats:[...pe.heartbeats,...A.heartbeats]})}})()}}function k(T){return(0,ie.L)(JSON.stringify({version:2,heartbeats:T})).length}!function b(T){qt(new se.wA("platform-logger",A=>new he(A),"PRIVATE")),qt(new se.wA("heartbeat",A=>new ir(A),"PRIVATE")),Vn(ye,"0.7.31",T),Vn(ye,"0.7.31","esm2017"),Vn("fire-js","")}("")},4859:(Lt,ze,j)=>{j.d(ze,{H0:()=>ye,wA:()=>C});var I=j(5861),se=j(2090);class C{constructor(B,z,de){this.name=B,this.instanceFactory=z,this.type=de,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(B){return this.instantiationMode=B,this}setMultipleInstances(B){return this.multipleInstances=B,this}setServiceProps(B){return this.serviceProps=B,this}setInstanceCreatedCallback(B){return this.onInstanceCreated=B,this}}const ie="[DEFAULT]";class oe{constructor(B,z){this.name=B,this.container=z,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(B){const z=this.normalizeInstanceIdentifier(B);if(!this.instancesDeferred.has(z)){const de=new se.BH;if(this.instancesDeferred.set(z,de),this.isInitialized(z)||this.shouldAutoInitialize())try{const Ce=this.getOrInitializeService({instanceIdentifier:z});Ce&&de.resolve(Ce)}catch{}}return this.instancesDeferred.get(z).promise}getImmediate(B){var z;const de=this.normalizeInstanceIdentifier(B?.identifier),Ce=null!==(z=B?.optional)&&void 0!==z&&z;if(!this.isInitialized(de)&&!this.shouldAutoInitialize()){if(Ce)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:de})}catch(Se){if(Ce)return null;throw Se}}getComponent(){return this.component}setComponent(B){if(B.name!==this.name)throw Error(`Mismatching Component ${B.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=B,this.shouldAutoInitialize()){if(function fe(le){return"EAGER"===le.instantiationMode}(B))try{this.getOrInitializeService({instanceIdentifier:ie})}catch{}for(const[z,de]of this.instancesDeferred.entries()){const Ce=this.normalizeInstanceIdentifier(z);try{const Se=this.getOrInitializeService({instanceIdentifier:Ce});de.resolve(Se)}catch{}}}}clearInstance(B=ie){this.instancesDeferred.delete(B),this.instancesOptions.delete(B),this.instances.delete(B)}delete(){var B=this;return(0,I.Z)(function*(){const z=Array.from(B.instances.values());yield Promise.all([...z.filter(de=>"INTERNAL"in de).map(de=>de.INTERNAL.delete()),...z.filter(de=>"_delete"in de).map(de=>de._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(B=ie){return this.instances.has(B)}getOptions(B=ie){return this.instancesOptions.get(B)||{}}initialize(B={}){const{options:z={}}=B,de=this.normalizeInstanceIdentifier(B.instanceIdentifier);if(this.isInitialized(de))throw Error(`${this.name}(${de}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Ce=this.getOrInitializeService({instanceIdentifier:de,options:z});for(const[Se,nt]of this.instancesDeferred.entries())de===this.normalizeInstanceIdentifier(Se)&&nt.resolve(Ce);return Ce}onInit(B,z){var de;const Ce=this.normalizeInstanceIdentifier(z),Se=null!==(de=this.onInitCallbacks.get(Ce))&&void 0!==de?de:new Set;Se.add(B),this.onInitCallbacks.set(Ce,Se);const nt=this.instances.get(Ce);return nt&&B(nt,Ce),()=>{Se.delete(B)}}invokeOnInitCallbacks(B,z){const de=this.onInitCallbacks.get(z);if(de)for(const Ce of de)try{Ce(B,z)}catch{}}getOrInitializeService({instanceIdentifier:B,options:z={}}){let de=this.instances.get(B);if(!de&&this.component&&(de=this.component.instanceFactory(this.container,{instanceIdentifier:(le=B,le===ie?void 0:le),options:z}),this.instances.set(B,de),this.instancesOptions.set(B,z),this.invokeOnInitCallbacks(de,B),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,B,de)}catch{}var le;return de||null}normalizeInstanceIdentifier(B=ie){return this.component?this.component.multipleInstances?B:ie:B}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ye{constructor(B){this.name=B,this.providers=new Map}addComponent(B){const z=this.getProvider(B.name);if(z.isComponentSet())throw new Error(`Component ${B.name} has already been registered with ${this.name}`);z.setComponent(B)}addOrOverwriteComponent(B){this.getProvider(B.name).isComponentSet()&&this.providers.delete(B.name),this.addComponent(B)}getProvider(B){if(this.providers.has(B))return this.providers.get(B);const z=new oe(B,this);return this.providers.set(B,z),z}getProviders(){return Array.from(this.providers.values())}}},1877:(Lt,ze,j)=>{j.d(ze,{Am:()=>le,Ub:()=>ye,Yd:()=>fe,in:()=>se});const I=[];var se=(()=>{return(B=se||(se={}))[B.DEBUG=0]="DEBUG",B[B.VERBOSE=1]="VERBOSE",B[B.INFO=2]="INFO",B[B.WARN=3]="WARN",B[B.ERROR=4]="ERROR",B[B.SILENT=5]="SILENT",se;var B})();const C={debug:se.DEBUG,verbose:se.VERBOSE,info:se.INFO,warn:se.WARN,error:se.ERROR,silent:se.SILENT},ie=se.INFO,oe={[se.DEBUG]:"log",[se.VERBOSE]:"log",[se.INFO]:"info",[se.WARN]:"warn",[se.ERROR]:"error"},he=(B,z,...de)=>{if(z<B.logLevel)return;const Ce=(new Date).toISOString(),Se=oe[z];if(!Se)throw new Error(`Attempted to log a message with an invalid logType (value: ${z})`);console[Se](`[${Ce}]  ${B.name}:`,...de)};class fe{constructor(z){this.name=z,this._logLevel=ie,this._logHandler=he,this._userLogHandler=null,I.push(this)}get logLevel(){return this._logLevel}set logLevel(z){if(!(z in se))throw new TypeError(`Invalid value "${z}" assigned to \`logLevel\``);this._logLevel=z}setLogLevel(z){this._logLevel="string"==typeof z?C[z]:z}get logHandler(){return this._logHandler}set logHandler(z){if("function"!=typeof z)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=z}get userLogHandler(){return this._userLogHandler}set userLogHandler(z){this._userLogHandler=z}debug(...z){this._userLogHandler&&this._userLogHandler(this,se.DEBUG,...z),this._logHandler(this,se.DEBUG,...z)}log(...z){this._userLogHandler&&this._userLogHandler(this,se.VERBOSE,...z),this._logHandler(this,se.VERBOSE,...z)}info(...z){this._userLogHandler&&this._userLogHandler(this,se.INFO,...z),this._logHandler(this,se.INFO,...z)}warn(...z){this._userLogHandler&&this._userLogHandler(this,se.WARN,...z),this._logHandler(this,se.WARN,...z)}error(...z){this._userLogHandler&&this._userLogHandler(this,se.ERROR,...z),this._logHandler(this,se.ERROR,...z)}}function ye(B){I.forEach(z=>{z.setLogLevel(B)})}function le(B,z){for(const de of I){let Ce=null;z&&z.level&&(Ce=C[z.level]),de.userLogHandler=null===B?null:(Se,nt,...je)=>{const Ee=je.map(re=>{if(null==re)return null;if("string"==typeof re)return re;if("number"==typeof re||"boolean"==typeof re)return re.toString();if(re instanceof Error)return re.message;try{return JSON.stringify(re)}catch{return null}}).filter(re=>re).join(" ");nt>=(Ce??Se.logLevel)&&B({level:se[nt].toLowerCase(),message:Ee,args:je,type:Se.name})}}}},8766:(Lt,ze,j)=>{j.d(ze,{Lj:()=>R,X3:()=>xe});var I=j(5861);let C,ie;const fe=new WeakMap,ye=new WeakMap,le=new WeakMap,B=new WeakMap,z=new WeakMap;let Se={get(N,Z,V){if(N instanceof IDBTransaction){if("done"===Z)return ye.get(N);if("objectStoreNames"===Z)return N.objectStoreNames||le.get(N);if("store"===Z)return V.objectStoreNames[1]?void 0:V.objectStore(V.objectStoreNames[0])}return re(N[Z])},set:(N,Z,V)=>(N[Z]=V,!0),has:(N,Z)=>N instanceof IDBTransaction&&("done"===Z||"store"===Z)||Z in N};function Ee(N){return"function"==typeof N?function je(N){return N!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function he(){return ie||(ie=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(N)?function(...Z){return N.apply(ke(this),Z),re(fe.get(this))}:function(...Z){return re(N.apply(ke(this),Z))}:function(Z,...V){const Ze=N.call(ke(this),Z,...V);return le.set(Ze,Z.sort?Z.sort():[Z]),re(Ze)}}(N):(N instanceof IDBTransaction&&function Ce(N){if(ye.has(N))return;const Z=new Promise((V,Ze)=>{const ee=()=>{N.removeEventListener("complete",Xe),N.removeEventListener("error",et),N.removeEventListener("abort",et)},Xe=()=>{V(),ee()},et=()=>{Ze(N.error||new DOMException("AbortError","AbortError")),ee()};N.addEventListener("complete",Xe),N.addEventListener("error",et),N.addEventListener("abort",et)});ye.set(N,Z)}(N),((N,Z)=>Z.some(V=>N instanceof V))(N,function oe(){return C||(C=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(N,Se):N)}function re(N){if(N instanceof IDBRequest)return function de(N){const Z=new Promise((V,Ze)=>{const ee=()=>{N.removeEventListener("success",Xe),N.removeEventListener("error",et)},Xe=()=>{V(re(N.result)),ee()},et=()=>{Ze(N.error),ee()};N.addEventListener("success",Xe),N.addEventListener("error",et)});return Z.then(V=>{V instanceof IDBCursor&&fe.set(V,N)}).catch(()=>{}),z.set(Z,N),Z}(N);if(B.has(N))return B.get(N);const Z=Ee(N);return Z!==N&&(B.set(N,Z),z.set(Z,N)),Z}const ke=N=>z.get(N);function xe(N,Z,{blocked:V,upgrade:Ze,blocking:ee,terminated:Xe}={}){const et=indexedDB.open(N,Z),vt=re(et);return Ze&&et.addEventListener("upgradeneeded",Rt=>{Ze(re(et.result),Rt.oldVersion,Rt.newVersion,re(et.transaction))}),V&&et.addEventListener("blocked",()=>V()),vt.then(Rt=>{Xe&&Rt.addEventListener("close",()=>Xe()),ee&&Rt.addEventListener("versionchange",()=>ee())}).catch(()=>{}),vt}function R(N,{blocked:Z}={}){const V=indexedDB.deleteDatabase(N);return Z&&V.addEventListener("blocked",()=>Z()),re(V).then(()=>{})}const De=["get","getKey","getAll","getAllKeys","count"],Qe=["put","add","delete","clear"],Pe=new Map;function Y(N,Z){if(!(N instanceof IDBDatabase)||Z in N||"string"!=typeof Z)return;if(Pe.get(Z))return Pe.get(Z);const V=Z.replace(/FromIndex$/,""),Ze=Z!==V,ee=Qe.includes(V);if(!(V in(Ze?IDBIndex:IDBObjectStore).prototype)||!ee&&!De.includes(V))return;const Xe=function(){var et=(0,I.Z)(function*(vt,...Rt){const _n=this.transaction(vt,ee?"readwrite":"readonly");let hn=_n.store;return Ze&&(hn=hn.index(Rt.shift())),(yield Promise.all([hn[V](...Rt),ee&&_n.done]))[0]});return function(Rt){return et.apply(this,arguments)}}();return Pe.set(Z,Xe),Xe}!function nt(N){Se=N(Se)}(N=>({...N,get:(Z,V,Ze)=>Y(Z,V)||N.get(Z,V,Ze),has:(Z,V)=>!!Y(Z,V)||N.has(Z,V)}))},5861:(Lt,ze,j)=>{function I(C,ie,oe,he,fe,ye,le){try{var B=C[ye](le),z=B.value}catch(de){return void oe(de)}B.done?ie(z):Promise.resolve(z).then(he,fe)}function se(C){return function(){var ie=this,oe=arguments;return new Promise(function(he,fe){var ye=C.apply(ie,oe);function le(z){I(ye,he,fe,le,B,"next",z)}function B(z){I(ye,he,fe,le,B,"throw",z)}le(void 0)})}}j.d(ze,{Z:()=>se})}}]);